<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 7 2D Domains | TUFLOW Classic/HPC User Manual 2023-03</title>
  <meta name="description" content="Section 7 2D Domains | TUFLOW Classic/HPC User Manual 2023-03" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 7 2D Domains | TUFLOW Classic/HPC User Manual 2023-03" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://docs.tuflow.com/classic-hpc/manual/2023-03/images/TUFLOW_Manual_SEO_007.PNG" />
  <meta property="og:description" content="Section 7 2D Domains | TUFLOW Classic/HPC User Manual 2023-03" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 7 2D Domains | TUFLOW Classic/HPC User Manual 2023-03" />
  
  <meta name="twitter:description" content="Section 7 2D Domains | TUFLOW Classic/HPC User Manual 2023-03" />
  <meta name="twitter:image" content="https://docs.tuflow.com/classic-hpc/manual/2023-03/images/TUFLOW_Manual_SEO_007.PNG" />

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/TUFLOW.ico" type="image/x-icon" />
<link rel="prev" href="OneD-SWMM-1.html"/>
<link rel="next" href="Boundaries-InitialConditions-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
<link rel="stylesheet" href="css\toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://docs.tuflow.com/classic-hpc/manual/2023-03/"><img src="images/TUFLOW-Manual-2023-03.png" style="width:270px" ></a></li>

<li class="divider"></li>
<li><a href="index.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i>Overview</a>
<ul>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#how-to-use-this-manual"><i class="fa fa-check"></i>How to use this Manual</a>
<ul>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#navigation"><i class="fa fa-check"></i>Navigation</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#searching"><i class="fa fa-check"></i>Searching</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#about-this-manual"><i class="fa fa-check"></i>About this Manual</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#glossary-and-notation"><i class="fa fa-check"></i>Glossary and Notation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="contents.html"><a href="contents.html"><i class="fa fa-check"></i>Contents</a>
<ul>
<li class="chapter" data-level="" data-path="contents.html"><a href="contents.html#list-of-figures"><i class="fa fa-check"></i>List of Figures</a></li>
<li class="chapter" data-level="" data-path="contents.html"><a href="contents.html#list-of-tables"><i class="fa fa-check"></i>List of Tables</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="Introduction-1.html"><a href="Introduction-1.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="Introduction-1.html"><a href="Introduction-1.html#TUFLOWProducts-2"><i class="fa fa-check"></i><b>1.1</b> TUFLOW Products</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="Introduction-1.html"><a href="Introduction-1.html#TUFLOW-CLA-3"><i class="fa fa-check"></i><b>1.1.1</b> TUFLOW Classic – 2D Semi-Implicit Solver</a></li>
<li class="chapter" data-level="1.1.2" data-path="Introduction-1.html"><a href="Introduction-1.html#TUFLOW-HPC-3"><i class="fa fa-check"></i><b>1.1.2</b> TUFLOW HPC – 2D GPU Accelerated Solver</a></li>
<li class="chapter" data-level="1.1.3" data-path="Introduction-1.html"><a href="Introduction-1.html#TUFLOW1D-3"><i class="fa fa-check"></i><b>1.1.3</b> TUFLOW 1D (ESTRY) – 1D Solver</a></li>
<li class="chapter" data-level="1.1.4" data-path="Introduction-1.html"><a href="Introduction-1.html#SWMM1D-3"><i class="fa fa-check"></i><b>1.1.4</b> EPA SWMM – 1D Solver</a></li>
<li class="chapter" data-level="1.1.5" data-path="Introduction-1.html"><a href="Introduction-1.html#AddonModules-3"><i class="fa fa-check"></i><b>1.1.5</b> Add-on Modules</a>
<ul>
<li class="chapter" data-level="1.1.5.1" data-path="Introduction-1.html"><a href="Introduction-1.html#ADModule-4"><i class="fa fa-check"></i><b>1.1.5.1</b> Advection Dispersion (AD) Module</a></li>
<li class="chapter" data-level="1.1.5.2" data-path="Introduction-1.html"><a href="Introduction-1.html#TUFLOWCATCH-4"><i class="fa fa-check"></i><b>1.1.5.2</b> TUFLOW CATCH Module</a></li>
<li class="chapter" data-level="1.1.5.3" data-path="Introduction-1.html"><a href="Introduction-1.html#GPUHardware-4"><i class="fa fa-check"></i><b>1.1.5.3</b> GPU Hardware (GPU) Module</a></li>
<li class="chapter" data-level="1.1.5.4" data-path="Introduction-1.html"><a href="Introduction-1.html#QDTorM2DModule-4"><i class="fa fa-check"></i><b>1.1.5.4</b> Quadtree or Multiple 2D Domain (M2D) Module</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="Introduction-1.html"><a href="Introduction-1.html#TUFLOWWebinars-2"><i class="fa fa-check"></i><b>1.2</b> TUFLOW Webinars</a></li>
<li class="chapter" data-level="1.3" data-path="Introduction-1.html"><a href="Introduction-1.html#ModellingEnvironment-2"><i class="fa fa-check"></i><b>1.3</b> Modelling Environment</a></li>
<li class="chapter" data-level="1.4" data-path="Introduction-1.html"><a href="Introduction-1.html#LimitationsandRecommendations-2"><i class="fa fa-check"></i><b>1.4</b> Limitations and Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#HowtoBuildYourFirstModel-2"><i class="fa fa-check"></i><b>2.1</b> How to Build Your First Model</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#TutorialModels-3"><i class="fa fa-check"></i><b>2.1.1</b> Tutorial Models</a></li>
<li class="chapter" data-level="2.1.2" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#ExampleModels-3"><i class="fa fa-check"></i><b>2.1.2</b> Example Models</a></li>
<li class="chapter" data-level="2.1.3" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#DemonstrationModels-3"><i class="fa fa-check"></i><b>2.1.3</b> Demonstration Models</a></li>
<li class="chapter" data-level="2.1.4" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#LicenceFreeDemoMode-3"><i class="fa fa-check"></i><b>2.1.4</b> Licence Free Demo Mode</a></li>
<li class="chapter" data-level="2.1.5" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#eLearningModules-3"><i class="fa fa-check"></i><b>2.1.5</b> eLearning Modules</a></li>
<li class="chapter" data-level="2.1.6" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#InstructorLedTUFLOWTrainingCourses-3"><i class="fa fa-check"></i><b>2.1.6</b> Instructor Led TUFLOW Training Courses</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#TheTUFLOWModellingConcept-2"><i class="fa fa-check"></i><b>2.2</b> The TUFLOW Modelling Concept</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#Notepad-3"><i class="fa fa-check"></i><b>2.2.1</b> Notepad++</a></li>
<li class="chapter" data-level="2.2.2" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#QGISTUFLOWViewer-3"><i class="fa fa-check"></i><b>2.2.2</b> QGIS / TUFLOW Viewer</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#InstallingandRunningTUFLOW-2"><i class="fa fa-check"></i><b>2.3</b> Installing and Running TUFLOW</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#TUFLOWDownloadsandInstallation-3"><i class="fa fa-check"></i><b>2.3.1</b> TUFLOW Downloads and Installation</a></li>
<li class="chapter" data-level="2.3.2" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#Licencing-3"><i class="fa fa-check"></i><b>2.3.2</b> Licencing</a></li>
<li class="chapter" data-level="2.3.3" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#PerformingSimulations-3"><i class="fa fa-check"></i><b>2.3.3</b> Performing Simulations</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#FoldersFileTypesandFileNaming-2"><i class="fa fa-check"></i><b>2.4</b> Folders, File Types and File Naming</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#FolderStructure-3"><i class="fa fa-check"></i><b>2.4.1</b> Folder Structure</a></li>
<li class="chapter" data-level="2.4.2" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#FileTypes-3"><i class="fa fa-check"></i><b>2.4.2</b> File Types</a></li>
<li class="chapter" data-level="2.4.3" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#NamingConventions-3"><i class="fa fa-check"></i><b>2.4.3</b> Naming Conventions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="GettingStarted-1.html"><a href="GettingStarted-1.html#TipsandTricks-2"><i class="fa fa-check"></i><b>2.5</b> Tips and Tricks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html"><i class="fa fa-check"></i><b>3</b> Hydraulic Modelling Fundamentals</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#Fundaments-Introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#Schematisation-2"><i class="fa fa-check"></i><b>3.2</b> Schematisation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#GeneralGuidance-3"><i class="fa fa-check"></i><b>3.2.1</b> General Guidance</a></li>
<li class="chapter" data-level="3.2.2" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#id_1D2Dor3D-3"><i class="fa fa-check"></i><b>3.2.2</b> Model Dimensions: 1D, 2D or 3D?</a>
<ul>
<li class="chapter" data-level="3.2.2.1" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#one-dimensional-1d"><i class="fa fa-check"></i><b>3.2.2.1</b> One Dimensional (1D)</a></li>
<li class="chapter" data-level="3.2.2.2" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#two-dimensional-2d"><i class="fa fa-check"></i><b>3.2.2.2</b> Two Dimensional (2D)</a></li>
<li class="chapter" data-level="3.2.2.3" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#three-dimensional-3d"><i class="fa fa-check"></i><b>3.2.2.3</b> Three Dimensional (3D)</a></li>
</ul></li>
<li class="chapter" data-level="3.2.3" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#Coupled1D2D-3"><i class="fa fa-check"></i><b>3.2.3</b> Coupled 1D-2D</a></li>
<li class="chapter" data-level="3.2.4" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#FixedGridorQuadtreeGrid-3"><i class="fa fa-check"></i><b>3.2.4</b> Quadtree Grid</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#ModelResolutionDiscretisation-2"><i class="fa fa-check"></i><b>3.3</b> Model Resolution (Discretisation)</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#id_1DNetworks-3"><i class="fa fa-check"></i><b>3.3.1</b> 1D Networks</a></li>
<li class="chapter" data-level="3.3.2" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#CellSizes-3"><i class="fa fa-check"></i><b>3.3.2</b> 2D Cell Sizes</a></li>
<li class="chapter" data-level="3.3.3" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#SubGridSamplingSGS-3"><i class="fa fa-check"></i><b>3.3.3</b> Sub-Grid Sampling (SGS)</a>
<ul>
<li class="chapter" data-level="3.3.3.1" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#SGS-benefits-4"><i class="fa fa-check"></i><b>3.3.3.1</b> Benefits of SGS</a></li>
</ul></li>
<li class="chapter" data-level="3.3.4" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#CellSizeResultsConvergence-3"><i class="fa fa-check"></i><b>3.3.4</b> Cell Size Results Convergence</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#SolutionAccuracy-2"><i class="fa fa-check"></i><b>3.4</b> Solution Accuracy</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#FluidFlowPhysicalTerms-3"><i class="fa fa-check"></i><b>3.4.1</b> Fluid Flow Physical Terms</a>
<ul>
<li class="chapter" data-level="3.4.1.1" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#d-continuity-equation"><i class="fa fa-check"></i><b>3.4.1.1</b> 1D Continuity Equation</a></li>
<li class="chapter" data-level="3.4.1.2" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#d-momentum-equation"><i class="fa fa-check"></i><b>3.4.1.2</b> 1D Momentum Equation</a></li>
<li class="chapter" data-level="3.4.1.3" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#d-continuity-equation-1"><i class="fa fa-check"></i><b>3.4.1.3</b> 2D Continuity Equation</a></li>
<li class="chapter" data-level="3.4.1.4" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#d-momentum-equation-1"><i class="fa fa-check"></i><b>3.4.1.4</b> 2D Momentum Equation</a></li>
</ul></li>
<li class="chapter" data-level="3.4.2" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#FormsoftheEquations-3"><i class="fa fa-check"></i><b>3.4.2</b> Forms of the Equations</a>
<ul>
<li class="chapter" data-level="3.4.2.1" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#diffusive-wave-equation"><i class="fa fa-check"></i><b>3.4.2.1</b> Diffusive Wave Equation</a></li>
<li class="chapter" data-level="3.4.2.2" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#kinematic-wave-equation"><i class="fa fa-check"></i><b>3.4.2.2</b> Kinematic Wave Equation</a></li>
</ul></li>
<li class="chapter" data-level="3.4.3" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#NumericalAccuracy-3"><i class="fa fa-check"></i><b>3.4.3</b> Numerical Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#TimestepBackground-2"><i class="fa fa-check"></i><b>3.5</b> Timestep</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#FixedVersusAdaptiveTimestepping-3"><i class="fa fa-check"></i><b>3.5.1</b> Fixed versus Adaptive Timestepping</a></li>
<li class="chapter" data-level="3.5.2" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#OneDDomainsTimestep-3"><i class="fa fa-check"></i><b>3.5.2</b> TUFLOW 1D (ESTRY) and EPA SWMM</a></li>
<li class="chapter" data-level="3.5.3" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#TUFLOWClassicTimestep-3"><i class="fa fa-check"></i><b>3.5.3</b> TUFLOW Classic 2D</a></li>
<li class="chapter" data-level="3.5.4" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#TUFLOWHPCTimestep-3"><i class="fa fa-check"></i><b>3.5.4</b> TUFLOW HPC 2D</a>
<ul>
<li class="chapter" data-level="3.5.4.1" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#TimesteppingEfficiencyOutput-4"><i class="fa fa-check"></i><b>3.5.4.1</b> Timestep Efficiency Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="Fundamentals-1.html"><a href="Fundamentals-1.html#SimulationTimes-2"><i class="fa fa-check"></i><b>3.6</b> Simulation Times</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html"><i class="fa fa-check"></i><b>4</b> Control Files and Input Layers</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#control-files"><i class="fa fa-check"></i><b>4.2</b> Control Files</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#Notation-3"><i class="fa fa-check"></i><b>4.2.1</b> Rules and Notation</a></li>
<li class="chapter" data-level="4.2.2" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#FilePath-3"><i class="fa fa-check"></i><b>4.2.2</b> File Paths</a></li>
<li class="chapter" data-level="4.2.3" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#Units-3"><i class="fa fa-check"></i><b>4.2.3</b> Units</a></li>
<li class="chapter" data-level="4.2.4" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#TCF-3"><i class="fa fa-check"></i><b>4.2.4</b> TCF</a></li>
<li class="chapter" data-level="4.2.5" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#ECF-3"><i class="fa fa-check"></i><b>4.2.5</b> ECF</a></li>
<li class="chapter" data-level="4.2.6" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#TBC-3"><i class="fa fa-check"></i><b>4.2.6</b> TBC</a></li>
<li class="chapter" data-level="4.2.7" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#TGC-3"><i class="fa fa-check"></i><b>4.2.7</b> TGC</a></li>
<li class="chapter" data-level="4.2.8" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#QCF-3"><i class="fa fa-check"></i><b>4.2.8</b> QCF</a></li>
<li class="chapter" data-level="4.2.9" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#TEF-3"><i class="fa fa-check"></i><b>4.2.9</b> TEF</a></li>
<li class="chapter" data-level="4.2.10" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#TOC-3"><i class="fa fa-check"></i><b>4.2.10</b> TOC</a></li>
<li class="chapter" data-level="4.2.11" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#TRFC-3"><i class="fa fa-check"></i><b>4.2.11</b> TRFC</a></li>
<li class="chapter" data-level="4.2.12" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#TESF-3"><i class="fa fa-check"></i><b>4.2.12</b> TESF</a></li>
<li class="chapter" data-level="4.2.13" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#ADCF-3"><i class="fa fa-check"></i><b>4.2.13</b> ADCF</a></li>
<li class="chapter" data-level="4.2.14" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#TSCF-3"><i class="fa fa-check"></i><b>4.2.14</b> TSCF</a></li>
<li class="chapter" data-level="4.2.15" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#ReadFile-3"><i class="fa fa-check"></i><b>4.2.15</b> Read File</a></li>
<li class="chapter" data-level="4.2.16" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#Override-3"><i class="fa fa-check"></i><b>4.2.16</b> Override Files</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#Databases-2"><i class="fa fa-check"></i><b>4.3</b> Databases</a></li>
<li class="chapter" data-level="4.4" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#GISLayers-2"><i class="fa fa-check"></i><b>4.4</b> Input Layers</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#GISFormats-3"><i class="fa fa-check"></i><b>4.4.1</b> Input Formats</a></li>
<li class="chapter" data-level="4.4.2" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#GISCommands-3"><i class="fa fa-check"></i><b>4.4.2</b> GIS Commands</a>
<ul>
<li class="chapter" data-level="4.4.2.1" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#Attributes-4"><i class="fa fa-check"></i><b>4.4.2.1</b> GIS Attribute Interpretation</a></li>
<li class="chapter" data-level="4.4.2.2" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#Objects-4"><i class="fa fa-check"></i><b>4.4.2.2</b> GIS Object Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="4.4.3" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#GPKG-3"><i class="fa fa-check"></i><b>4.4.3</b> GeoPackage Commands</a>
<ul>
<li class="chapter" data-level="4.4.3.1" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#GPKG-input-4"><i class="fa fa-check"></i><b>4.4.3.1</b> GPKG Input Commands</a></li>
<li class="chapter" data-level="4.4.3.2" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#GPKG-output-4"><i class="fa fa-check"></i><b>4.4.3.2</b> GPKG Output Commands</a></li>
</ul></li>
<li class="chapter" data-level="4.4.4" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#GRID-3"><i class="fa fa-check"></i><b>4.4.4</b> Grid Commands</a></li>
<li class="chapter" data-level="4.4.5" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#TIN-3"><i class="fa fa-check"></i><b>4.4.5</b> TIN Commands</a></li>
<li class="chapter" data-level="4.4.6" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#RowCol-3"><i class="fa fa-check"></i><b>4.4.6</b> RowCol Commands (Legacy)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#LayeringData-2"><i class="fa fa-check"></i><b>4.5</b> Layering Data</a></li>
<li class="chapter" data-level="4.6" data-path="ControlFiles-and-Inputs-1.html"><a href="ControlFiles-and-Inputs-1.html#XF-Files-2"><i class="fa fa-check"></i><b>4.6</b> XF Files</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html"><i class="fa fa-check"></i><b>5</b> 1D Network Domains - ESTRY</a>
<ul>
<li class="chapter" data-level="5.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#OneD-Introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Scheme-2"><i class="fa fa-check"></i><b>5.2</b> Schematisation</a></li>
<li class="chapter" data-level="5.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#SolutionScheme-2"><i class="fa fa-check"></i><b>5.3</b> Solution Scheme</a></li>
<li class="chapter" data-level="5.4" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#OneD-nwk-2"><i class="fa fa-check"></i><b>5.4</b> 1d_nwk Attributes</a></li>
<li class="chapter" data-level="5.5" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Channel-Intro-2"><i class="fa fa-check"></i><b>5.5</b> Channels Overview</a></li>
<li class="chapter" data-level="5.6" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Open-Channel-2"><i class="fa fa-check"></i><b>5.6</b> Open Channels</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#I-channels-3"><i class="fa fa-check"></i><b>5.6.1</b> Inertial Channels</a></li>
<li class="chapter" data-level="5.6.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#NI-channels-3"><i class="fa fa-check"></i><b>5.6.2</b> Non-Inertial Channels</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#XS-2"><i class="fa fa-check"></i><b>5.7</b> Cross-Sections</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#XS-flags-3"><i class="fa fa-check"></i><b>5.7.1</b> Type “XZ” Optional Flags</a>
<ul>
<li class="chapter" data-level="5.7.1.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#RR-4"><i class="fa fa-check"></i><b>5.7.1.1</b> Relative Resistance</a></li>
</ul></li>
<li class="chapter" data-level="5.7.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#HW-flags-3"><i class="fa fa-check"></i><b>5.7.2</b> Type “HW” Optional Flags</a>
<ul>
<li class="chapter" data-level="5.7.2.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#HW-A-4"><i class="fa fa-check"></i><b>5.7.2.1</b> Flow Area (A)</a></li>
<li class="chapter" data-level="5.7.2.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#HW-P-4"><i class="fa fa-check"></i><b>5.7.2.2</b> Wetted Perimeter (P)</a></li>
<li class="chapter" data-level="5.7.2.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#HW-N-4"><i class="fa fa-check"></i><b>5.7.2.3</b> Manning’s n Values (N)</a></li>
<li class="chapter" data-level="5.7.2.4" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#HW-F-4"><i class="fa fa-check"></i><b>5.7.2.4</b> Manning’s n Values (F)</a></li>
</ul></li>
<li class="chapter" data-level="5.7.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Parallel-Channel-3"><i class="fa fa-check"></i><b>5.7.3</b> Parallel Channel Analysis</a></li>
<li class="chapter" data-level="5.7.4" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Eff-vs-Total-3"><i class="fa fa-check"></i><b>5.7.4</b> Effective Area versus Total Area</a></li>
<li class="chapter" data-level="5.7.5" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#XS-Mid-3"><i class="fa fa-check"></i><b>5.7.5</b> Mid Cross-Sections</a></li>
<li class="chapter" data-level="5.7.6" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#XS-End-3"><i class="fa fa-check"></i><b>5.7.6</b> End Cross-Sections</a></li>
<li class="chapter" data-level="5.7.7" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Interpolate-XS-3"><i class="fa fa-check"></i><b>5.7.7</b> Interpolated Cross-Section Protocols</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Structures-2"><i class="fa fa-check"></i><b>5.8</b> Structures</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#culverts-pipes-3"><i class="fa fa-check"></i><b>5.8.1</b> Culverts and Pipes</a>
<ul>
<li class="chapter" data-level="5.8.1.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Blockage-4"><i class="fa fa-check"></i><b>5.8.1.1</b> Blockage Matrix</a></li>
<li class="chapter" data-level="5.8.1.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#id_-4"><i class="fa fa-check"></i><b>5.8.1.2</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="5.8.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Bridges-3"><i class="fa fa-check"></i><b>5.8.2</b> Bridges</a>
<ul>
<li class="chapter" data-level="5.8.2.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#BridgeIntro-4"><i class="fa fa-check"></i><b>5.8.2.1</b> Bridges Overview</a></li>
<li class="chapter" data-level="5.8.2.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#XSLoss-4"><i class="fa fa-check"></i><b>5.8.2.2</b> Bridge Cross-Section and Loss Tables</a></li>
<li class="chapter" data-level="5.8.2.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#B-Bridge-4"><i class="fa fa-check"></i><b>5.8.2.3</b> B Bridge Losses Approach</a></li>
<li class="chapter" data-level="5.8.2.4" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#BB-Bridge-4"><i class="fa fa-check"></i><b>5.8.2.4</b> BB Bridge Losses Approach</a></li>
</ul></li>
<li class="chapter" data-level="5.8.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#BArch-3"><i class="fa fa-check"></i><b>5.8.3</b> Arch Bridge</a>
<ul>
<li class="chapter" data-level="5.8.3.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#BArch-Editor-4"><i class="fa fa-check"></i><b>5.8.3.1</b> Arch Bridge Editor</a></li>
<li class="chapter" data-level="5.8.3.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#BArch-Min-Blc-4"><i class="fa fa-check"></i><b>5.8.3.2</b> Arch Minimum Blockage</a></li>
</ul></li>
<li class="chapter" data-level="5.8.4" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Weir-3"><i class="fa fa-check"></i><b>5.8.4</b> Weirs</a>
<ul>
<li class="chapter" data-level="5.8.4.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Weir-Intro-4"><i class="fa fa-check"></i><b>5.8.4.1</b> Weirs Overview</a></li>
<li class="chapter" data-level="5.8.4.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#W-Weir-4"><i class="fa fa-check"></i><b>5.8.4.2</b> Original Weirs (W)</a></li>
<li class="chapter" data-level="5.8.4.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Adv-Weir-4"><i class="fa fa-check"></i><b>5.8.4.3</b> Advanced Weirs (WB, WC, WD, WO, WR, WT, WV, WW)</a></li>
<li class="chapter" data-level="5.8.4.4" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Submerge-4"><i class="fa fa-check"></i><b>5.8.4.4</b> Advanced Weir Submergence Curves</a></li>
<li class="chapter" data-level="5.8.4.5" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Auto-Weir-4"><i class="fa fa-check"></i><b>5.8.4.5</b> Automatically Created Weirs</a></li>
<li class="chapter" data-level="5.8.4.6" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#VW-Channel-4"><i class="fa fa-check"></i><b>5.8.4.6</b> VW Channels (Variable Geometry Weir)</a></li>
</ul></li>
<li class="chapter" data-level="5.8.5" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#SP-3"><i class="fa fa-check"></i><b>5.8.5</b> Spillways (SP)</a></li>
<li class="chapter" data-level="5.8.6" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#SG-3"><i class="fa fa-check"></i><b>5.8.6</b> Sluice Gates (SG)</a></li>
<li class="chapter" data-level="5.8.7" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#LossAdjustment-3"><i class="fa fa-check"></i><b>5.8.7</b> Adjustment of Contraction and Expansion Losses</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Special-Channels-2"><i class="fa fa-check"></i><b>5.9</b> Special Channels</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#M-Channel-3"><i class="fa fa-check"></i><b>5.9.1</b> M Channels (User Defined Flow Matrix)</a></li>
<li class="chapter" data-level="5.9.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Q-Channels-3"><i class="fa fa-check"></i><b>5.9.2</b> Q Channels (Upstream Depth-Discharge Relationship)</a></li>
<li class="chapter" data-level="5.9.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#XConnect-3"><i class="fa fa-check"></i><b>5.9.3</b> X Connectors</a></li>
<li class="chapter" data-level="5.9.4" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Legacy-Channel-3"><i class="fa fa-check"></i><b>5.9.4</b> Legacy Channels</a></li>
<li class="chapter" data-level="5.9.5" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#OneD-nwk-3"><i class="fa fa-check"></i><b>5.9.5</b> 1d_nwk Attributes (M, P, Q, SG, SP Channels)</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#OperationalChannels-2"><i class="fa fa-check"></i><b>5.10</b> Operational Channels</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#TOC-Logic-3"><i class="fa fa-check"></i><b>5.10.1</b> .toc File Commands and Logic</a>
<ul>
<li class="chapter" data-level="5.10.1.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#TOC-Define-4"><i class="fa fa-check"></i><b>5.10.1.1</b> Define Control Command</a></li>
<li class="chapter" data-level="5.10.1.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#UserDef-4"><i class="fa fa-check"></i><b>5.10.1.2</b> User Defined Variables</a></li>
<li class="chapter" data-level="5.10.1.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Logic-4"><i class="fa fa-check"></i><b>5.10.1.3</b> Logic Rules</a></li>
<li class="chapter" data-level="5.10.1.4" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Increment-Operate-4"><i class="fa fa-check"></i><b>5.10.1.4</b> Incremental Operators</a></li>
</ul></li>
<li class="chapter" data-level="5.10.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Pumps-3"><i class="fa fa-check"></i><b>5.10.2</b> Pumps (P and PO)</a></li>
<li class="chapter" data-level="5.10.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#QO-3"><i class="fa fa-check"></i><b>5.10.3</b> QO Channels</a></li>
<li class="chapter" data-level="5.10.4" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#RO-3"><i class="fa fa-check"></i><b>5.10.4</b> Gated Drowned Rectangular Culverts (RO)</a></li>
<li class="chapter" data-level="5.10.5" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#SG-SGO-3"><i class="fa fa-check"></i><b>5.10.5</b> Sluice Gates (SG and SGO)</a></li>
<li class="chapter" data-level="5.10.6" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#SPO-3"><i class="fa fa-check"></i><b>5.10.6</b> Spillways with Gates (SPO)</a></li>
<li class="chapter" data-level="5.10.7" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Weirs-Operational-3"><i class="fa fa-check"></i><b>5.10.7</b> Weirs (WBO, WCO, WDO, WOO, WRO, WTO)</a></li>
<li class="chapter" data-level="5.10.8" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#PFDF-3"><i class="fa fa-check"></i><b>5.10.8</b> Piping and Dam Failure</a>
<ul>
<li class="chapter" data-level="5.10.8.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#PF-4"><i class="fa fa-check"></i><b>5.10.8.1</b> Piping Failure (PF)</a></li>
<li class="chapter" data-level="5.10.8.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#DF-4"><i class="fa fa-check"></i><b>5.10.8.2</b> Dam Failure (DF)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Pipes-2"><i class="fa fa-check"></i><b>5.11</b> Pipe Networks</a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Pipes-3"><i class="fa fa-check"></i><b>5.11.1</b> Pipes</a></li>
<li class="chapter" data-level="5.11.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Pits-3"><i class="fa fa-check"></i><b>5.11.2</b> Pits</a>
<ul>
<li class="chapter" data-level="5.11.2.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#OneD-pit-nwk-4"><i class="fa fa-check"></i><b>5.11.2.1</b> 1d_nwk Pits</a></li>
<li class="chapter" data-level="5.11.2.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#OneD-pit-4"><i class="fa fa-check"></i><b>5.11.2.2</b> 1d_pit Pits</a></li>
<li class="chapter" data-level="5.11.2.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Conn-Pits-Nds-4"><i class="fa fa-check"></i><b>5.11.2.3</b> Connecting Pits and Nodes to 2D Domains</a></li>
</ul></li>
<li class="chapter" data-level="5.11.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#DD-Database-3"><i class="fa fa-check"></i><b>5.11.3</b> Pit Inlet and Depth/Stage vs Discharge Databases</a>
<ul>
<li class="chapter" data-level="5.11.3.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Xfall-4"><i class="fa fa-check"></i><b>5.11.3.1</b> Road Crossfall Options</a></li>
</ul></li>
<li class="chapter" data-level="5.11.4" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Manholes-3"><i class="fa fa-check"></i><b>5.11.4</b> Manholes</a>
<ul>
<li class="chapter" data-level="5.11.4.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Auto-MH-4"><i class="fa fa-check"></i><b>5.11.4.1</b> Automatically Assigned Manholes</a></li>
<li class="chapter" data-level="5.11.4.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#OneD-mh-4"><i class="fa fa-check"></i><b>5.11.4.2</b> Manually Assigned Manholes (1d_mh Layer)</a></li>
<li class="chapter" data-level="5.11.4.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#mh-direction-4"><i class="fa fa-check"></i><b>5.11.4.3</b> Digitising Culverts Connected to Manholes</a></li>
<li class="chapter" data-level="5.11.4.4" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Engelund-4"><i class="fa fa-check"></i><b>5.11.4.4</b> Engelund Manhole Loss Approach</a></li>
<li class="chapter" data-level="5.11.4.5" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#FixedLoss-4"><i class="fa fa-check"></i><b>5.11.4.5</b> Fixed Manhole Loss Approach</a></li>
<li class="chapter" data-level="5.11.4.6" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#JunctionLoss-4"><i class="fa fa-check"></i><b>5.11.4.6</b> Discussion on Approaches to Modelling Pipe Junction Losses</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Virtual-Pipes-2"><i class="fa fa-check"></i><b>5.12</b> Virtual Pipes</a></li>
<li class="chapter" data-level="5.13" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Nodes-2"><i class="fa fa-check"></i><b>5.13</b> Nodes</a>
<ul>
<li class="chapter" data-level="5.13.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Auto-Node-3"><i class="fa fa-check"></i><b>5.13.1</b> Automatically Defined Nodes</a>
<ul>
<li class="chapter" data-level="5.13.1.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#AutoStorageWidths-4"><i class="fa fa-check"></i><b>5.13.1.1</b> Storage Calculated Automatically from Channel Widths</a></li>
<li class="chapter" data-level="5.13.1.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#AutoStorageANA-4"><i class="fa fa-check"></i><b>5.13.1.2</b> Additional Storage Added from Len_or_ANA Attribute</a></li>
</ul></li>
<li class="chapter" data-level="5.13.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Manual-Node-3"><i class="fa fa-check"></i><b>5.13.2</b> Manually Defined Nodes</a>
<ul>
<li class="chapter" data-level="5.13.2.1" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#NA-Table-4"><i class="fa fa-check"></i><b>5.13.2.1</b> Storage Nodes (User Defined NA Tables)</a></li>
<li class="chapter" data-level="5.13.2.2" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#channel-invert-4"><i class="fa fa-check"></i><b>5.13.2.2</b> Using Nodes to Define Channel Inverts</a></li>
<li class="chapter" data-level="5.13.2.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Nd-Auto-Conn-4"><i class="fa fa-check"></i><b>5.13.2.3</b> Automatically Connecting Nodes to 2D domains</a></li>
</ul></li>
<li class="chapter" data-level="5.13.3" data-path="OneD-Domains-1.html"><a href="OneD-Domains-1.html#Obvert-3"><i class="fa fa-check"></i><b>5.13.3</b> Storage Above Top of Channels</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html"><i class="fa fa-check"></i><b>6</b> 1D Network Domains - EPA SWMM</a>
<ul>
<li class="chapter" data-level="6.1" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#SWMM-Introduction-2"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#TUFLOW-SWMM-Capabilities-3"><i class="fa fa-check"></i><b>6.1.1</b> TUFLOW-SWMM Capabilities</a></li>
<li class="chapter" data-level="6.1.2" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#SWMM-UserResources-3"><i class="fa fa-check"></i><b>6.1.2</b> Additional SWMM User Resources</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#ModelSetup-2"><i class="fa fa-check"></i><b>6.2</b> Model Setup</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#SwmmModel-3"><i class="fa fa-check"></i><b>6.2.1</b> SWMM Model</a></li>
<li class="chapter" data-level="6.2.2" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#TUFLOW-SWMM_Simulations-4"><i class="fa fa-check"></i><b>6.2.2</b> TUFLOW-SWMM Model Simulation</a></li>
<li class="chapter" data-level="6.2.3" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#SWMM_ESTRY_Linking-3"><i class="fa fa-check"></i><b>6.2.3</b> Linking SWMM to TUFLOW 2D and ESTRY</a></li>
<li class="chapter" data-level="6.2.4" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#SWMMSettings-3"><i class="fa fa-check"></i><b>6.2.4</b> SWMM Simulation Option Settings</a></li>
<li class="chapter" data-level="6.2.5" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#SWMM-BCDB-3"><i class="fa fa-check"></i><b>6.2.5</b> Using the TUFLOW BC Database in SWMM</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#SWMMGISTools-2"><i class="fa fa-check"></i><b>6.3</b> SWMM GIS Tools</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#SWMMGPKGFormat-3"><i class="fa fa-check"></i><b>6.3.1</b> GeoPackage File Format</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#SWMMOutputs-2"><i class="fa fa-check"></i><b>6.4</b> SWMM Outputs</a></li>
<li class="chapter" data-level="6.5" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#SWMMInclusionTUFLOW-2"><i class="fa fa-check"></i><b>6.5</b> SWMM Inclusion in TUFLOW</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#SWMMLibraryVersion-3"><i class="fa fa-check"></i><b>6.5.1</b> SWMM Library Version</a></li>
<li class="chapter" data-level="6.5.2" data-path="OneD-SWMM-1.html"><a href="OneD-SWMM-1.html#SWMMCode-in-TUFLOW-3"><i class="fa fa-check"></i><b>6.5.2</b> Embedded SWMM Code in TUFLOW</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html"><i class="fa fa-check"></i><b>7</b> 2D Domains</a>
<ul>
<li class="chapter" data-level="7.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#introduction-1"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Solvers-2"><i class="fa fa-check"></i><b>7.2</b> Solvers</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#tuflow-hpc-2d-solver"><i class="fa fa-check"></i><b>7.2.1</b> TUFLOW HPC 2D Solver</a></li>
<li class="chapter" data-level="7.2.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#tuflow-classic-2d-solver"><i class="fa fa-check"></i><b>7.2.2</b> TUFLOW Classic 2D Solver</a></li>
<li class="chapter" data-level="7.2.3" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Schematisation-3"><i class="fa fa-check"></i><b>7.2.3</b> Cell Schematisation</a>
<ul>
<li class="chapter" data-level="7.2.3.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#computational-points-4"><i class="fa fa-check"></i><b>7.2.3.1</b> Computational Points</a></li>
</ul></li>
<li class="chapter" data-level="7.2.4" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#turbulence-overview"><i class="fa fa-check"></i><b>7.2.4</b> Turbulence</a>
<ul>
<li class="chapter" data-level="7.2.4.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Dry-Wall-4"><i class="fa fa-check"></i><b>7.2.4.1</b> Dry Wall Treatment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Common-2"><i class="fa fa-check"></i><b>7.3</b> Common Functionality</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Domain-3"><i class="fa fa-check"></i><b>7.3.1</b> Defining the Domain</a></li>
<li class="chapter" data-level="7.3.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#CellCodes-3"><i class="fa fa-check"></i><b>7.3.2</b> Active / Inactive Cells</a></li>
<li class="chapter" data-level="7.3.3" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#layering-3"><i class="fa fa-check"></i><b>7.3.3</b> Data Layering</a></li>
<li class="chapter" data-level="7.3.4" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#sampling-of-data-sets"><i class="fa fa-check"></i><b>7.3.4</b> Sampling of Data Sets</a>
<ul>
<li class="chapter" data-level="7.3.4.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#traditional-sampling-4"><i class="fa fa-check"></i><b>7.3.4.1</b> Traditional Sampling Approach</a></li>
</ul></li>
<li class="chapter" data-level="7.3.5" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#elevations-3"><i class="fa fa-check"></i><b>7.3.5</b> Elevations</a>
<ul>
<li class="chapter" data-level="7.3.5.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#DEMGrids-3"><i class="fa fa-check"></i><b>7.3.5.1</b> Direct Reading of DEM Grids</a></li>
<li class="chapter" data-level="7.3.5.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#zsh-4"><i class="fa fa-check"></i><b>7.3.5.2</b> Z Shape Layers (2d_zsh)</a></li>
<li class="chapter" data-level="7.3.5.3" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#vzsh-4"><i class="fa fa-check"></i><b>7.3.5.3</b> Variable Z Shape Layer (2d_vzsh)</a></li>
<li class="chapter" data-level="7.3.5.4" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#ztin-4"><i class="fa fa-check"></i><b>7.3.5.4</b> 3D TIN Layers (2d_ztin)</a></li>
<li class="chapter" data-level="7.3.5.5" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#zln-4"><i class="fa fa-check"></i><b>7.3.5.5</b> 3D Breakline Layers (2d_zln)</a></li>
<li class="chapter" data-level="7.3.5.6" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#zpt-4"><i class="fa fa-check"></i><b>7.3.5.6</b> Zpt Layers (2d_zpt)</a></li>
<li class="chapter" data-level="7.3.5.7" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#using-multiple-layers-and-points-layers"><i class="fa fa-check"></i><b>7.3.5.7</b> Using Multiple Layers and Points Layers</a></li>
</ul></li>
<li class="chapter" data-level="7.3.6" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Materials-2"><i class="fa fa-check"></i><b>7.3.6</b> Land Use (Materials)</a>
<ul>
<li class="chapter" data-level="7.3.6.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Bed-Resistance-4"><i class="fa fa-check"></i><b>7.3.6.1</b> Bed Resistance</a></li>
<li class="chapter" data-level="7.3.6.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#log-law-4"><i class="fa fa-check"></i><b>7.3.6.2</b> Log Law Depth Varying Bed Resistance</a></li>
<li class="chapter" data-level="7.3.6.3" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Materials-File-4"><i class="fa fa-check"></i><b>7.3.6.3</b> Materials File</a></li>
<li class="chapter" data-level="7.3.6.4" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Rainfall-Losses-4"><i class="fa fa-check"></i><b>7.3.6.4</b> Rainfall Losses</a></li>
</ul></li>
<li class="chapter" data-level="7.3.7" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Infiltration-2"><i class="fa fa-check"></i><b>7.3.7</b> Infiltration</a>
<ul>
<li class="chapter" data-level="7.3.7.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#infiltration-layer-4"><i class="fa fa-check"></i><b>7.3.7.1</b> Infiltration Layer</a></li>
<li class="chapter" data-level="7.3.7.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#tsoilf-4"><i class="fa fa-check"></i><b>7.3.7.2</b> Soils File (.tsoilf)</a></li>
</ul></li>
<li class="chapter" data-level="7.3.8" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#HydraulicStructures-3"><i class="fa fa-check"></i><b>7.3.8</b> Hydraulic Structures</a>
<ul>
<li class="chapter" data-level="7.3.8.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#introduction-2"><i class="fa fa-check"></i><b>7.3.8.1</b> Introduction</a></li>
<li class="chapter" data-level="7.3.8.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#bg-layer-4"><i class="fa fa-check"></i><b>7.3.8.2</b> 2D Bridge Structures (2d_bg)</a></li>
<li class="chapter" data-level="7.3.8.3" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#lfcsh-4"><i class="fa fa-check"></i><b>7.3.8.3</b> Layered Flow Constrictions (2d_lfcsh Layers)</a></li>
</ul></li>
<li class="chapter" data-level="7.3.9" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#cell-mods-3"><i class="fa fa-check"></i><b>7.3.9</b> Cell Modification</a>
<ul>
<li class="chapter" data-level="7.3.9.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#srf-3"><i class="fa fa-check"></i><b>7.3.9.1</b> Storage Reduction (2d_srf)</a></li>
<li class="chapter" data-level="7.3.9.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#CWF-4"><i class="fa fa-check"></i><b>7.3.9.2</b> Cell Width Factor (CWF)</a></li>
<li class="chapter" data-level="7.3.9.3" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#flc-4"><i class="fa fa-check"></i><b>7.3.9.3</b> Form Loss Coefficient (FLC)</a></li>
<li class="chapter" data-level="7.3.9.4" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#mod-conveyance-4"><i class="fa fa-check"></i><b>7.3.9.4</b> Modify Conveyance</a></li>
</ul></li>
<li class="chapter" data-level="7.3.10" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#urban-areas-3"><i class="fa fa-check"></i><b>7.3.10</b> Modelling Urban Areas</a>
<ul>
<li class="chapter" data-level="7.3.10.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#buildings-4"><i class="fa fa-check"></i><b>7.3.10.1</b> Buildings</a></li>
<li class="chapter" data-level="7.3.10.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#roads-4"><i class="fa fa-check"></i><b>7.3.10.2</b> Roads</a></li>
<li class="chapter" data-level="7.3.10.3" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#fences-4"><i class="fa fa-check"></i><b>7.3.10.3</b> Fences and Walls</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#HPC-specific-2"><i class="fa fa-check"></i><b>7.4</b> TUFLOW HPC Specific</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Quadtree-3"><i class="fa fa-check"></i><b>7.4.1</b> Quadtree</a>
<ul>
<li class="chapter" data-level="7.4.1.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#qcf-commands-4"><i class="fa fa-check"></i><b>7.4.1.1</b> Quadtree .tcf Commands</a></li>
<li class="chapter" data-level="7.4.1.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#qcf-mandatory-4"><i class="fa fa-check"></i><b>7.4.1.2</b> Quadtree Control File (.qcf) – Mandatory Commands</a></li>
<li class="chapter" data-level="7.4.1.3" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#qcf-optional-4"><i class="fa fa-check"></i><b>7.4.1.3</b> Quadtree Control File (.qcf) – Optional Commands</a></li>
<li class="chapter" data-level="7.4.1.4" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#QDT-mesh-4"><i class="fa fa-check"></i><b>7.4.1.4</b> Defining Grid Refinement Polygons</a></li>
</ul></li>
<li class="chapter" data-level="7.4.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#HPC-Turbulence-3"><i class="fa fa-check"></i><b>7.4.2</b> HPC Turbulence</a>
<ul>
<li class="chapter" data-level="7.4.2.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#HPC-Turbulence-4"><i class="fa fa-check"></i><b>7.4.2.1</b> Overview</a></li>
<li class="chapter" data-level="7.4.2.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Constant-4"><i class="fa fa-check"></i><b>7.4.2.2</b> Constant Eddy Viscosity</a></li>
<li class="chapter" data-level="7.4.2.3" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Smagorinsky-4"><i class="fa fa-check"></i><b>7.4.2.3</b> Smagorinsky Approach</a></li>
<li class="chapter" data-level="7.4.2.4" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Wu-4"><i class="fa fa-check"></i><b>7.4.2.4</b> Wu Approach</a></li>
</ul></li>
<li class="chapter" data-level="7.4.3" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#SGS-3"><i class="fa fa-check"></i><b>7.4.3</b> Sub-Grid Sampling (SGS)</a>
<ul>
<li class="chapter" data-level="7.4.3.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#SGS-commands-4"><i class="fa fa-check"></i><b>7.4.3.1</b> SGS Methodology and Commands</a></li>
<li class="chapter" data-level="7.4.3.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#SGS-output-4"><i class="fa fa-check"></i><b>7.4.3.2</b> SGS Output Options</a></li>
</ul></li>
<li class="chapter" data-level="7.4.4" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#HPC-US-Controlled-3"><i class="fa fa-check"></i><b>7.4.4</b> 2D Upstream Controlled Flow (Weirs and Supercritical Flow)</a></li>
<li class="chapter" data-level="7.4.5" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#HPC-Groundwater-3"><i class="fa fa-check"></i><b>7.4.5</b> Groundwater Flow</a>
<ul>
<li class="chapter" data-level="7.4.5.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#implementation"><i class="fa fa-check"></i><b>7.4.5.1</b> Implementation</a></li>
<li class="chapter" data-level="7.4.5.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#top-gw-drying-4"><i class="fa fa-check"></i><b>7.4.5.2</b> Drying of Top Groundwater Layer</a></li>
</ul></li>
<li class="chapter" data-level="7.4.6" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#NN-3"><i class="fa fa-check"></i><b>7.4.6</b> Non-Newtonian Flow</a>
<ul>
<li class="chapter" data-level="7.4.6.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#Implementation-4"><i class="fa fa-check"></i><b>7.4.6.1</b> Implementation</a></li>
<li class="chapter" data-level="7.4.6.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#NN-Mix-4"><i class="fa fa-check"></i><b>7.4.6.2</b> Non-Newtonian Mixing</a></li>
</ul></li>
<li class="chapter" data-level="7.4.7" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#HPC-Unsupported-3"><i class="fa fa-check"></i><b>7.4.7</b> Unsupported Features in TUFLOW HPC</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#tuflow-classic-specific"><i class="fa fa-check"></i><b>7.5</b> TUFLOW Classic Specific</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#CLA-Turbulence-3"><i class="fa fa-check"></i><b>7.5.1</b> Classic Turbulence</a>
<ul>
<li class="chapter" data-level="7.5.1.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#CLA-Constant-4"><i class="fa fa-check"></i><b>7.5.1.1</b> Constant</a></li>
<li class="chapter" data-level="7.5.1.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#CLA-Smagorinsky-4"><i class="fa fa-check"></i><b>7.5.1.2</b> Smagorinsky</a></li>
</ul></li>
<li class="chapter" data-level="7.5.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#CLA-US-Controlled-3"><i class="fa fa-check"></i><b>7.5.2</b> 2D Upstream Controlled Flow (Weirs and Supercritical Flow)</a></li>
<li class="chapter" data-level="7.5.3" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#CLA-mat-3"><i class="fa fa-check"></i><b>7.5.3</b> Land Use (Materials)</a></li>
<li class="chapter" data-level="7.5.4" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#CLA-2D2D-3"><i class="fa fa-check"></i><b>7.5.4</b> Multiple 2D Domain</a></li>
<li class="chapter" data-level="7.5.5" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#CLA-Coriolis-3"><i class="fa fa-check"></i><b>7.5.5</b> Coriolis Term</a></li>
<li class="chapter" data-level="7.5.6" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#legacy-structures"><i class="fa fa-check"></i><b>7.5.6</b> Legacy Structures</a>
<ul>
<li class="chapter" data-level="7.5.6.1" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#CLA-FC-4"><i class="fa fa-check"></i><b>7.5.6.1</b> 2D Flow Constrictions (2d_fcsh and 2d_fc)</a></li>
<li class="chapter" data-level="7.5.6.2" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#applying-form-energy-loss-in-2d-fc-and-fcsh-layers"><i class="fa fa-check"></i><b>7.5.6.2</b> Applying Form (Energy) Loss in 2D FC and FCSH Layers</a></li>
</ul></li>
<li class="chapter" data-level="7.5.7" data-path="TwoD-Domains-1.html"><a href="TwoD-Domains-1.html#CLA-Unsupported-3"><i class="fa fa-check"></i><b>7.5.7</b> Unsupported Features in TUFLOW Classic</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html"><i class="fa fa-check"></i><b>8</b> Boundaries and Initial Conditions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#BC-Intro-2"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#BCArrangements-2"><i class="fa fa-check"></i><b>8.2</b> Recommended BC Arrangements</a></li>
<li class="chapter" data-level="8.3" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#BC-Solver-2"><i class="fa fa-check"></i><b>8.3</b> Solver Specific Considerations</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#ClassicBC-3"><i class="fa fa-check"></i><b>8.3.1</b> Classic Specific Boundaries / Options</a></li>
<li class="chapter" data-level="8.3.2" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#ClassicHPC-3"><i class="fa fa-check"></i><b>8.3.2</b> HPC Specific Boundaries / Options</a>
<ul>
<li class="chapter" data-level="8.3.2.1" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#HPCEnergyOptions-4"><i class="fa fa-check"></i><b>8.3.2.1</b> HPC Energy Options for 2D HT, HQ and QT Boundaries</a></li>
<li class="chapter" data-level="8.3.2.2" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#HpcHQApproach-4"><i class="fa fa-check"></i><b>8.3.2.2</b> HPC HQ Boundary Approach</a></li>
<li class="chapter" data-level="8.3.2.3" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#HpcHQFilter-4"><i class="fa fa-check"></i><b>8.3.2.3</b> HPC HQ Boundary Stability</a></li>
<li class="chapter" data-level="8.3.2.4" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#HpcBoundariesOther-4"><i class="fa fa-check"></i><b>8.3.2.4</b> HPC Additional Boundary Options</a></li>
<li class="chapter" data-level="8.3.2.5" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#HpcQuadtreeParallelInteria-4"><i class="fa fa-check"></i><b>8.3.2.5</b> Quadtree BC Parallel Inertia Approach</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#OneDBoundaries-2"><i class="fa fa-check"></i><b>8.4</b> 1D Boundaries (1d_bc Layers)</a></li>
<li class="chapter" data-level="8.5" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#TwoDBoundaries-2"><i class="fa fa-check"></i><b>8.5</b> 2D Boundaries (2d_bc, 2d_sa and 2d_rf Layers)</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#BC-Layers-3"><i class="fa fa-check"></i><b>8.5.1</b> Boundary Conditions (2d_bc)</a>
<ul>
<li class="chapter" data-level="8.5.1.1" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#id_2DBndSlopingLevel-3"><i class="fa fa-check"></i><b>8.5.1.1</b> Sloping Water Level Boundaries</a></li>
<li class="chapter" data-level="8.5.1.2" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#GT-4"><i class="fa fa-check"></i><b>8.5.1.2</b> Groundwater Boundaries</a></li>
</ul></li>
<li class="chapter" data-level="8.5.2" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#SA-Layers-3"><i class="fa fa-check"></i><b>8.5.2</b> Source Area Boundaries</a>
<ul>
<li class="chapter" data-level="8.5.2.1" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#SA-Option-4"><i class="fa fa-check"></i><b>8.5.2.1</b> Source Area Options (2d_sa)</a></li>
<li class="chapter" data-level="8.5.2.2" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#RFOption-4"><i class="fa fa-check"></i><b>8.5.2.2</b> Rainfall Option (2d_sa_rf)</a></li>
<li class="chapter" data-level="8.5.2.3" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#TriggerOption-4"><i class="fa fa-check"></i><b>8.5.2.3</b> Trigger Option (2d_sa_tr)</a></li>
<li class="chapter" data-level="8.5.2.4" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#FlowFeature-4"><i class="fa fa-check"></i><b>8.5.2.4</b> Flow Feature (2d_sa_po)</a></li>
<li class="chapter" data-level="8.5.2.5" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#OverlappingSA-4"><i class="fa fa-check"></i><b>8.5.2.5</b> Overlapping 2d_sa regions</a></li>
</ul></li>
<li class="chapter" data-level="8.5.3" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#Rainfall-3"><i class="fa fa-check"></i><b>8.5.3</b> Rainfall Boundaries</a>
<ul>
<li class="chapter" data-level="8.5.3.1" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#RainfallOverview-4"><i class="fa fa-check"></i><b>8.5.3.1</b> Rainfall Overview</a></li>
<li class="chapter" data-level="8.5.3.2" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#RainfallConsiderations-4"><i class="fa fa-check"></i><b>8.5.3.2</b> Considerations for Rainfall Modelling</a></li>
<li class="chapter" data-level="8.5.3.3" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#RF-Global-4"><i class="fa fa-check"></i><b>8.5.3.3</b> Global Rainfall</a></li>
<li class="chapter" data-level="8.5.3.4" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#RF-Layers-4"><i class="fa fa-check"></i><b>8.5.3.4</b> Rainfall Polygons (2d_rf)</a></li>
<li class="chapter" data-level="8.5.3.5" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#GriddedRainfall-4"><i class="fa fa-check"></i><b>8.5.3.5</b> Gridded Rainfall</a></li>
<li class="chapter" data-level="8.5.3.6" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#TRFC-File-4"><i class="fa fa-check"></i><b>8.5.3.6</b> Rainfall Control File (.trfc file)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#bcdbase-2"><i class="fa fa-check"></i><b>8.6</b> Boundary Condition (BC) Database</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#bcdbase-Example-3"><i class="fa fa-check"></i><b>8.6.1</b> BC Database Example</a></li>
<li class="chapter" data-level="8.6.2" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#BCEventName-3"><i class="fa fa-check"></i><b>8.6.2</b> BC Event Name Command</a></li>
<li class="chapter" data-level="8.6.3" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#BoundaryGenerators-3"><i class="fa fa-check"></i><b>8.6.3</b> TUFLOW Boundary Generators</a></li>
<li class="chapter" data-level="8.6.4" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#DelftFEWSBoundary-3"><i class="fa fa-check"></i><b>8.6.4</b> Delft FEWS Boundaries</a></li>
<li class="chapter" data-level="8.6.5" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#HECDSS-3"><i class="fa fa-check"></i><b>8.6.5</b> HEC-DSS Boundaries</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#Cyclones-2"><i class="fa fa-check"></i><b>8.7</b> Cyclones / Hurricanes / Typhoons</a></li>
<li class="chapter" data-level="8.8" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#ExternalStress-2"><i class="fa fa-check"></i><b>8.8</b> External Stress Boundaries</a></li>
<li class="chapter" data-level="8.9" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#InitialConditions-2"><i class="fa fa-check"></i><b>8.9</b> Initial Conditions</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#IWL-3"><i class="fa fa-check"></i><b>8.9.1</b> Initial Water Levels (IWL)</a>
<ul>
<li class="chapter" data-level="8.9.1.1" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#IWL-1D-4"><i class="fa fa-check"></i><b>8.9.1.1</b> 1D Domains</a></li>
<li class="chapter" data-level="8.9.1.2" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#IWL-2D-4"><i class="fa fa-check"></i><b>8.9.1.2</b> 2D Domains</a></li>
<li class="chapter" data-level="8.9.1.3" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#IWL-Auto-4"><i class="fa fa-check"></i><b>8.9.1.3</b> Automatic Initial Water Level</a></li>
</ul></li>
<li class="chapter" data-level="8.9.2" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#IGW-3"><i class="fa fa-check"></i><b>8.9.2</b> Initial Groundwater Levels</a></li>
<li class="chapter" data-level="8.9.3" data-path="Boundaries-InitialConditions-1.html"><a href="Boundaries-InitialConditions-1.html#RestartFiles-3"><i class="fa fa-check"></i><b>8.9.3</b> Restart Files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="AD-1.html"><a href="AD-1.html"><i class="fa fa-check"></i><b>9</b> Advection Dispersion</a>
<ul>
<li class="chapter" data-level="9.1" data-path="AD-1.html"><a href="AD-1.html#AD-Overview-2"><i class="fa fa-check"></i><b>9.1</b> Overview</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="AD-1.html"><a href="AD-1.html#AD-Solution-3"><i class="fa fa-check"></i><b>9.1.1</b> 2D Depth Averaged Equation of Motion</a></li>
<li class="chapter" data-level="9.1.2" data-path="AD-1.html"><a href="AD-1.html#AD-Solution-2"><i class="fa fa-check"></i><b>9.1.2</b> Solution Method (TUFLOW Classic)</a></li>
<li class="chapter" data-level="9.1.3" data-path="AD-1.html"><a href="AD-1.html#AD-Solution-HPC-3"><i class="fa fa-check"></i><b>9.1.3</b> Solution Method (TUFLOW HPC)</a></li>
<li class="chapter" data-level="9.1.4" data-path="AD-1.html"><a href="AD-1.html#local-constituent-transformation"><i class="fa fa-check"></i><b>9.1.4</b> Local Constituent Transformation</a></li>
<li class="chapter" data-level="9.1.5" data-path="AD-1.html"><a href="AD-1.html#groundwater"><i class="fa fa-check"></i><b>9.1.5</b> Groundwater</a></li>
<li class="chapter" data-level="9.1.6" data-path="AD-1.html"><a href="AD-1.html#limitations-and-recommendations"><i class="fa fa-check"></i><b>9.1.6</b> Limitations and Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="AD-1.html"><a href="AD-1.html#the-modelling-process"><i class="fa fa-check"></i><b>9.2</b> The Modelling Process</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="AD-1.html"><a href="AD-1.html#data-input-requirements"><i class="fa fa-check"></i><b>9.2.1</b> Data Input Requirements</a></li>
<li class="chapter" data-level="9.2.2" data-path="AD-1.html"><a href="AD-1.html#calibration-and-sensitivity"><i class="fa fa-check"></i><b>9.2.2</b> Calibration and Sensitivity</a></li>
<li class="chapter" data-level="9.2.3" data-path="AD-1.html"><a href="AD-1.html#model-resolution"><i class="fa fa-check"></i><b>9.2.3</b> Model Resolution</a></li>
<li class="chapter" data-level="9.2.4" data-path="AD-1.html"><a href="AD-1.html#AD-Computational-Timestep-3"><i class="fa fa-check"></i><b>9.2.4</b> Computational Timestep</a></li>
<li class="chapter" data-level="9.2.5" data-path="AD-1.html"><a href="AD-1.html#example-ad-models"><i class="fa fa-check"></i><b>9.2.5</b> Example AD Models</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="AD-1.html"><a href="AD-1.html#data-input"><i class="fa fa-check"></i><b>9.3</b> Data Input</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="AD-1.html"><a href="AD-1.html#simulation-control-file"><i class="fa fa-check"></i><b>9.3.1</b> Simulation Control File</a>
<ul>
<li class="chapter" data-level="9.3.1.1" data-path="AD-1.html"><a href="AD-1.html#ADControlFile-4"><i class="fa fa-check"></i><b>9.3.1.1</b> TUFLOW AD Control File (.adcf File)</a></li>
<li class="chapter" data-level="9.3.1.2" data-path="AD-1.html"><a href="AD-1.html#gis-input-file-types-and-naming-conventions"><i class="fa fa-check"></i><b>9.3.1.2</b> GIS Input File Types and Naming Conventions</a></li>
</ul></li>
<li class="chapter" data-level="9.3.2" data-path="AD-1.html"><a href="AD-1.html#d-geometries"><i class="fa fa-check"></i><b>9.3.2</b> 1D Geometries</a></li>
<li class="chapter" data-level="9.3.3" data-path="AD-1.html"><a href="AD-1.html#ADConstituentProp-3"><i class="fa fa-check"></i><b>9.3.3</b> Specification of Constituent Properties</a></li>
<li class="chapter" data-level="9.3.4" data-path="AD-1.html"><a href="AD-1.html#ADBoundaryConditions-3"><i class="fa fa-check"></i><b>9.3.4</b> Boundary Conditions</a>
<ul>
<li class="chapter" data-level="9.3.4.1" data-path="AD-1.html"><a href="AD-1.html#boundary-condition-bc-database"><i class="fa fa-check"></i><b>9.3.4.1</b> Boundary Condition (BC) Database</a></li>
<li class="chapter" data-level="9.3.4.2" data-path="AD-1.html"><a href="AD-1.html#bc-database-example"><i class="fa fa-check"></i><b>9.3.4.2</b> BC Database Example</a></li>
</ul></li>
<li class="chapter" data-level="9.3.5" data-path="AD-1.html"><a href="AD-1.html#initial-conditions"><i class="fa fa-check"></i><b>9.3.5</b> Initial Conditions</a></li>
<li class="chapter" data-level="9.3.6" data-path="AD-1.html"><a href="AD-1.html#GW-initial-conditions"><i class="fa fa-check"></i><b>9.3.6</b> Groundwater Initial Conditions</a></li>
<li class="chapter" data-level="9.3.7" data-path="AD-1.html"><a href="AD-1.html#minimum-dispersion-coefficient"><i class="fa fa-check"></i><b>9.3.7</b> Minimum Dispersion Coefficient</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="AD-1.html"><a href="AD-1.html#data-output"><i class="fa fa-check"></i><b>9.4</b> Data Output</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="AD-1.html"><a href="AD-1.html#tuflow-ad-log-files"><i class="fa fa-check"></i><b>9.4.1</b> TUFLOW AD Log Files</a>
<ul>
<li class="chapter" data-level="9.4.1.1" data-path="AD-1.html"><a href="AD-1.html#AD-log-4"><i class="fa fa-check"></i><b>9.4.1.1</b> Simulation Log File</a></li>
<li class="chapter" data-level="9.4.1.2" data-path="AD-1.html"><a href="AD-1.html#ADCFLLogFile-4"><i class="fa fa-check"></i><b>9.4.1.2</b> CFL Log File</a></li>
<li class="chapter" data-level="9.4.1.3" data-path="AD-1.html"><a href="AD-1.html#ADLogMass-4"><i class="fa fa-check"></i><b>9.4.1.3</b> Mass Log File</a></li>
</ul></li>
<li class="chapter" data-level="9.4.2" data-path="AD-1.html"><a href="AD-1.html#check-files"><i class="fa fa-check"></i><b>9.4.2</b> Check Files</a></li>
<li class="chapter" data-level="9.4.3" data-path="AD-1.html"><a href="AD-1.html#result-files"><i class="fa fa-check"></i><b>9.4.3</b> Result Files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html"><i class="fa fa-check"></i><b>10</b> Combining Domains and Solvers</a>
<ul>
<li class="chapter" data-level="10.1" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#Linked-1D2D-Models-Intro-2"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#OneD2dLinking-2"><i class="fa fa-check"></i><b>10.2</b> 1D and 2D Domain Linking Theory</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#HXBoundary-3"><i class="fa fa-check"></i><b>10.2.1</b> HX 2D Head Boundary</a></li>
<li class="chapter" data-level="10.2.2" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#SXBoundary-3"><i class="fa fa-check"></i><b>10.2.2</b> SX 2D Flow Boundary</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#OneD2DLinking-Estry-2"><i class="fa fa-check"></i><b>10.3</b> TUFLOW 1D (ESTRY) to TUFLOW 2D Linking</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#OneD2DESTRYChannel-3"><i class="fa fa-check"></i><b>10.3.1</b> 1D Open Channel and 2D Domain Linking</a></li>
<li class="chapter" data-level="10.3.2" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#OneD2DESTRYCulverts-3"><i class="fa fa-check"></i><b>10.3.2</b> 1D Structures Embedded within 2D Domains</a></li>
<li class="chapter" data-level="10.3.3" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#OneD2DESTRYPipeNetwork-3"><i class="fa fa-check"></i><b>10.3.3</b> 1D Pipe Network Pits linked to 2D Domains</a></li>
<li class="chapter" data-level="10.3.4" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#id_2DVirtualPits-3"><i class="fa fa-check"></i><b>10.3.4</b> Virtual Pits linked to 2D Domains</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#OneD2DLinkingSWMM-2"><i class="fa fa-check"></i><b>10.4</b> SWMM to TUFLOW Linking</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#OneD2DSWMMCulverts-5"><i class="fa fa-check"></i><b>10.4.1</b> 1D Culvert Connections to 2D Domains</a></li>
<li class="chapter" data-level="10.4.2" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#OneD2DSWMMPipeNetwork-3"><i class="fa fa-check"></i><b>10.4.2</b> 1D Pipe Network Connections to 2D Domains</a></li>
<li class="chapter" data-level="10.4.3" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#OneD2DLinkingSWMM1D-3"><i class="fa fa-check"></i><b>10.4.3</b> SWMM to TUFLOW 1D (ESTRY) Linking</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#OneD2DLinkingFM-2"><i class="fa fa-check"></i><b>10.5</b> Flood Modeller to TUFLOW Linking</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#oneD2DFMLinking2D-3"><i class="fa fa-check"></i><b>10.5.1</b> Flood Modeller 1D to TUFLOW 2D Linking</a></li>
<li class="chapter" data-level="10.5.2" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#oneD2DFMLinking1D-3"><i class="fa fa-check"></i><b>10.5.2</b> Flood Modeller 1D to TUFLOW 1D (ESTRY) Linking</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#oneD2D12D-2"><i class="fa fa-check"></i><b>10.6</b> 12D-DDA to TUFLOW Linking</a></li>
<li class="chapter" data-level="10.7" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#TwoD2DLinking-2"><i class="fa fa-check"></i><b>10.7</b> Multiple 2D Domains</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#TwoD2DLinkingQDT-3"><i class="fa fa-check"></i><b>10.7.1</b> Classic’s M2D Feature versus HPC Quadtree</a></li>
<li class="chapter" data-level="10.7.2" data-path="DomainLinking-1.html"><a href="DomainLinking-1.html#TwoD2DLinkingM2D-3"><i class="fa fa-check"></i><b>10.7.2</b> TUFLOW Classic’s Multiple 2D Domains</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Outputs-1.html"><a href="Outputs-1.html"><i class="fa fa-check"></i><b>11</b> Outputs</a>
<ul>
<li class="chapter" data-level="11.1" data-path="Outputs-1.html"><a href="Outputs-1.html#Location-2"><i class="fa fa-check"></i><b>11.1</b> Output Location</a></li>
<li class="chapter" data-level="11.2" data-path="Outputs-1.html"><a href="Outputs-1.html#Map-2"><i class="fa fa-check"></i><b>11.2</b> Map Outputs</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="Outputs-1.html"><a href="Outputs-1.html#TimeControl-3"><i class="fa fa-check"></i><b>11.2.1</b> Output Time Controls</a></li>
<li class="chapter" data-level="11.2.2" data-path="Outputs-1.html"><a href="Outputs-1.html#Format-3"><i class="fa fa-check"></i><b>11.2.2</b> Map Output Formats</a>
<ul>
<li class="chapter" data-level="11.2.2.1" data-path="Outputs-1.html"><a href="Outputs-1.html#MeshBased-4"><i class="fa fa-check"></i><b>11.2.2.1</b> Mesh Based Formats</a></li>
<li class="chapter" data-level="11.2.2.2" data-path="Outputs-1.html"><a href="Outputs-1.html#Grid-4"><i class="fa fa-check"></i><b>11.2.2.2</b> Grid Based Formats</a></li>
<li class="chapter" data-level="11.2.2.3" data-path="Outputs-1.html"><a href="Outputs-1.html#HRGrid-4"><i class="fa fa-check"></i><b>11.2.2.3</b> High-Resolution Grids</a></li>
<li class="chapter" data-level="11.2.2.4" data-path="Outputs-1.html"><a href="Outputs-1.html#Combined-4"><i class="fa fa-check"></i><b>11.2.2.4</b> Combined Format</a></li>
<li class="chapter" data-level="11.2.2.5" data-path="Outputs-1.html"><a href="Outputs-1.html#GISBased-4"><i class="fa fa-check"></i><b>11.2.2.5</b> GIS Based Format</a></li>
</ul></li>
<li class="chapter" data-level="11.2.3" data-path="Outputs-1.html"><a href="Outputs-1.html#DataTypes-3"><i class="fa fa-check"></i><b>11.2.3</b> Map Output Data Types</a>
<ul>
<li class="chapter" data-level="11.2.3.1" data-path="Outputs-1.html"><a href="Outputs-1.html#Hazards-4"><i class="fa fa-check"></i><b>11.2.3.1</b> Hazard Data Types</a></li>
</ul></li>
<li class="chapter" data-level="11.2.4" data-path="Outputs-1.html"><a href="Outputs-1.html#OneDMap-3"><i class="fa fa-check"></i><b>11.2.4</b> 1D Map Outputs</a>
<ul>
<li class="chapter" data-level="11.2.4.1" data-path="Outputs-1.html"><a href="Outputs-1.html#WLL-4"><i class="fa fa-check"></i><b>11.2.4.1</b> Water Level Lines</a></li>
<li class="chapter" data-level="11.2.4.2" data-path="Outputs-1.html"><a href="Outputs-1.html#WLLp-4"><i class="fa fa-check"></i><b>11.2.4.2</b> Water Level Line Points</a></li>
<li class="chapter" data-level="11.2.4.3" data-path="Outputs-1.html"><a href="Outputs-1.html#WLLtriangles-4"><i class="fa fa-check"></i><b>11.2.4.3</b> Adding Triangles into the 1d_WLL Layer</a></li>
</ul></li>
<li class="chapter" data-level="11.2.5" data-path="Outputs-1.html"><a href="Outputs-1.html#OutputZones-3"><i class="fa fa-check"></i><b>11.2.5</b> Output Zones</a></li>
<li class="chapter" data-level="11.2.6" data-path="Outputs-1.html"><a href="Outputs-1.html#GaugeLevel-3"><i class="fa fa-check"></i><b>11.2.6</b> Gauge Level Output</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="Outputs-1.html"><a href="Outputs-1.html#TimeSeries-2"><i class="fa fa-check"></i><b>11.3</b> Time-Series Outputs</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="Outputs-1.html"><a href="Outputs-1.html#OneDTS-3"><i class="fa fa-check"></i><b>11.3.1</b> 1D Time-Series Output</a></li>
<li class="chapter" data-level="11.3.2" data-path="Outputs-1.html"><a href="Outputs-1.html#TwoDTS-3"><i class="fa fa-check"></i><b>11.3.2</b> 2D Time-Series Output</a>
<ul>
<li class="chapter" data-level="11.3.2.1" data-path="Outputs-1.html"><a href="Outputs-1.html#PlotOutput-4"><i class="fa fa-check"></i><b>11.3.2.1</b> Plot Output</a></li>
<li class="chapter" data-level="11.3.2.2" data-path="Outputs-1.html"><a href="Outputs-1.html#LongProfile-4"><i class="fa fa-check"></i><b>11.3.2.2</b> Long Profile Output</a></li>
</ul></li>
<li class="chapter" data-level="11.3.3" data-path="Outputs-1.html"><a href="Outputs-1.html#ReportingLocation-3"><i class="fa fa-check"></i><b>11.3.3</b> Reporting Locations</a></li>
<li class="chapter" data-level="11.3.4" data-path="Outputs-1.html"><a href="Outputs-1.html#Structure-3"><i class="fa fa-check"></i><b>11.3.4</b> Structure Output</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="Outputs-1.html"><a href="Outputs-1.html#Specialised-2"><i class="fa fa-check"></i><b>11.4</b> Specialised Outputs</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="Outputs-1.html"><a href="Outputs-1.html#Receptors-3"><i class="fa fa-check"></i><b>11.4.1</b> Receptors</a></li>
<li class="chapter" data-level="11.4.2" data-path="Outputs-1.html"><a href="Outputs-1.html#EvaculationRoutes-3"><i class="fa fa-check"></i><b>11.4.2</b> Evacuation Routes</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="Outputs-1.html"><a href="Outputs-1.html#ChecksLogs-2"><i class="fa fa-check"></i><b>11.5</b> Check and Log Files</a></li>
<li class="chapter" data-level="11.6" data-path="Outputs-1.html"><a href="Outputs-1.html#Commands-2"><i class="fa fa-check"></i><b>11.6</b> Output Control Commands</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="Hardware-1.html"><a href="Hardware-1.html"><i class="fa fa-check"></i><b>12</b> Hardware and Operating System</a>
<ul>
<li class="chapter" data-level="12.1" data-path="Hardware-1.html"><a href="Hardware-1.html#HardwareIntro-2"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="Hardware-1.html"><a href="Hardware-1.html#OperatingSystems-2"><i class="fa fa-check"></i><b>12.2</b> Operating Systems</a></li>
<li class="chapter" data-level="12.3" data-path="Hardware-1.html"><a href="Hardware-1.html#TUFLOWClassic-2"><i class="fa fa-check"></i><b>12.3</b> TUFLOW Classic</a></li>
<li class="chapter" data-level="12.4" data-path="Hardware-1.html"><a href="Hardware-1.html#TUFLOWHPC-2"><i class="fa fa-check"></i><b>12.4</b> TUFLOW HPC (Including Quadtree)</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="Hardware-1.html"><a href="Hardware-1.html#HPC-CPU-3"><i class="fa fa-check"></i><b>12.4.1</b> TUFLOW HPC Solver on CPU</a></li>
<li class="chapter" data-level="12.4.2" data-path="Hardware-1.html"><a href="Hardware-1.html#HPC-GPU-3"><i class="fa fa-check"></i><b>12.4.2</b> TUFLOW HPC Solver on GPU</a></li>
<li class="chapter" data-level="12.4.3" data-path="Hardware-1.html"><a href="Hardware-1.html#GPUTypes-3"><i class="fa fa-check"></i><b>12.4.3</b> Types of GPU</a></li>
<li class="chapter" data-level="12.4.4" data-path="Hardware-1.html"><a href="Hardware-1.html#MultipleGPUs-3"><i class="fa fa-check"></i><b>12.4.4</b> Utilising Multiple GPUs for One Model</a></li>
<li class="chapter" data-level="12.4.5" data-path="Hardware-1.html"><a href="Hardware-1.html#MultipleModelsoneGPU-3"><i class="fa fa-check"></i><b>12.4.5</b> Running Multiple Models on a Single GPU</a></li>
<li class="chapter" data-level="12.4.6" data-path="Hardware-1.html"><a href="Hardware-1.html#differences-in-results-between-cpu-and-gpu"><i class="fa fa-check"></i><b>12.4.6</b> Differences in results between CPU and GPU</a></li>
<li class="chapter" data-level="12.4.7" data-path="Hardware-1.html"><a href="Hardware-1.html#HPCRAM-3"><i class="fa fa-check"></i><b>12.4.7</b> RAM</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="Hardware-1.html"><a href="Hardware-1.html#ProxiesforCPUandGPU-2"><i class="fa fa-check"></i><b>12.5</b> Proxies for CPU and GPU performance</a></li>
<li class="chapter" data-level="12.6" data-path="Hardware-1.html"><a href="Hardware-1.html#Virtualisation-2"><i class="fa fa-check"></i><b>12.6</b> Virtualisation</a></li>
<li class="chapter" data-level="12.7" data-path="Hardware-1.html"><a href="Hardware-1.html#CloudCompute-2"><i class="fa fa-check"></i><b>12.7</b> Cloud Compute</a></li>
<li class="chapter" data-level="12.8" data-path="Hardware-1.html"><a href="Hardware-1.html#HardwareCommands-2"><i class="fa fa-check"></i><b>12.8</b> Commands</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html"><i class="fa fa-check"></i><b>13</b> Managing and Starting Simulations</a>
<ul>
<li class="chapter" data-level="13.1" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#RunningSimulationsIntro-2"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#FileNaming-2"><i class="fa fa-check"></i><b>13.2</b> File Naming</a></li>
<li class="chapter" data-level="13.3" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#SimulationManagement-2"><i class="fa fa-check"></i><b>13.3</b> Simulation Management</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#Events-3"><i class="fa fa-check"></i><b>13.3.1</b> Events</a></li>
<li class="chapter" data-level="13.3.2" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#Scenarios-3"><i class="fa fa-check"></i><b>13.3.2</b> Scenarios</a></li>
<li class="chapter" data-level="13.3.3" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#Variables-3"><i class="fa fa-check"></i><b>13.3.3</b> Variables</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#TUFLOWExecDownload-2"><i class="fa fa-check"></i><b>13.4</b> TUFLOW Executable Download</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#InstallOverview-3"><i class="fa fa-check"></i><b>13.4.1</b> Overview and Where to Install</a></li>
<li class="chapter" data-level="13.4.2" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#iSPdSP-3"><i class="fa fa-check"></i><b>13.4.2</b> Single and Double Precision</a>
<ul>
<li class="chapter" data-level="13.4.2.1" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#iSPdSP-Classic"><i class="fa fa-check"></i><b>13.4.2.1</b> TUFLOW Classic</a></li>
<li class="chapter" data-level="13.4.2.2" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#iSPdSP-HPC"><i class="fa fa-check"></i><b>13.4.2.2</b> TUFLOW HPC</a></li>
</ul></li>
<li class="chapter" data-level="13.4.3" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#CustomingTUFLOW-3"><i class="fa fa-check"></i><b>13.4.3</b> Customising TUFLOW using TUFLOW_USER_DEFINED.dll</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#RunningSims-2"><i class="fa fa-check"></i><b>13.5</b> Running Simulations</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#DongleTypesandSetup-3"><i class="fa fa-check"></i><b>13.5.1</b> Dongle Types and Setup</a>
<ul>
<li class="chapter" data-level="13.5.1.1" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#DongleAccessProtocols-4"><i class="fa fa-check"></i><b>13.5.1.1</b> Protocols for Accessing Dongles</a></li>
<li class="chapter" data-level="13.5.1.2" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#DongleSettingsFile-4"><i class="fa fa-check"></i><b>13.5.1.2</b> TUFLOW_Licence_Settings.lcf File</a></li>
<li class="chapter" data-level="13.5.1.3" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#DongleFailure-4"><i class="fa fa-check"></i><b>13.5.1.3</b> Dongle Failure during a Simulation</a></li>
</ul></li>
<li class="chapter" data-level="13.5.2" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#StartingaSim-3"><i class="fa fa-check"></i><b>13.5.2</b> Starting a Simulation</a>
<ul>
<li class="chapter" data-level="13.5.2.1" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#BatchFileExamples-4"><i class="fa fa-check"></i><b>13.5.2.1</b> Batch File Example and Run Options (Switches)</a></li>
<li class="chapter" data-level="13.5.2.2" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#CopyModelBatchFiles-4"><i class="fa fa-check"></i><b>13.5.2.2</b> Copy/Package Model from Batch Files</a></li>
<li class="chapter" data-level="13.5.2.3" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#AdvancedBatchFiles-4"><i class="fa fa-check"></i><b>13.5.2.3</b> Advanced Batch Files</a></li>
</ul></li>
<li class="chapter" data-level="13.5.3" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#RunningHPC-3"><i class="fa fa-check"></i><b>13.5.3</b> Running TUFLOW HPC</a>
<ul>
<li class="chapter" data-level="13.5.3.1" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#HPCGPUCommands-4"><i class="fa fa-check"></i><b>13.5.3.1</b> TUFLOW HPC and GPU Module Commands</a></li>
<li class="chapter" data-level="13.5.3.2" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#GPUCompatibility-4"><i class="fa fa-check"></i><b>13.5.3.2</b> Compatible Graphics Cards</a></li>
<li class="chapter" data-level="13.5.3.3" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#UpdatingGPUDrivers-4"><i class="fa fa-check"></i><b>13.5.3.3</b> Updating NVIDIA Drivers</a></li>
<li class="chapter" data-level="13.5.3.4" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#GPUNVLink-4"><i class="fa fa-check"></i><b>13.5.3.4</b> NVLink – Multi-GPU Performance (HPC Only)</a></li>
<li class="chapter" data-level="13.5.3.5" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#GPUTroubleshooting-4"><i class="fa fa-check"></i><b>13.5.3.5</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="13.5.4" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#Running1D-3"><i class="fa fa-check"></i><b>13.5.4</b> Running TUFLOW 1D Only Simulations</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#TUFLOWExternalSchemes-2"><i class="fa fa-check"></i><b>13.6</b> Using TUFLOW with Flood Modeller, SWMM, XP-SWMM, 12D or from SMS</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#SWMMSimulations-3"><i class="fa fa-check"></i><b>13.6.1</b> Using TUFLOW with EPA SWMM</a></li>
<li class="chapter" data-level="13.6.2" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#FMSimulations-3"><i class="fa fa-check"></i><b>13.6.2</b> Using TUFLOW with Flood Modeller</a></li>
<li class="chapter" data-level="13.6.3" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#TwelveDSimulations-3"><i class="fa fa-check"></i><b>13.6.3</b> Using TUFLOW with 12D</a></li>
<li class="chapter" data-level="13.6.4" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#XPSWMMSimulations-3"><i class="fa fa-check"></i><b>13.6.4</b> Using TUFLOW with XP-SWMM</a></li>
<li class="chapter" data-level="13.6.5" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#SMSSimulations-3"><i class="fa fa-check"></i><b>13.6.5</b> Using TUFLOW with SMS</a></li>
<li class="chapter" data-level="13.6.6" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#OptimisingSims-3"><i class="fa fa-check"></i><b>13.6.6</b> Optimising Startup and Run Times</a>
<ul>
<li class="chapter" data-level="13.6.6.1" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#Improved1DInputs-4"><i class="fa fa-check"></i><b>13.6.6.1</b> Improved pre-processing of 1D Model Inputs</a></li>
<li class="chapter" data-level="13.6.6.2" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#SGSParallelProcessing-4"><i class="fa fa-check"></i><b>13.6.6.2</b> Parallel Processing for SGS initialisation</a></li>
<li class="chapter" data-level="13.6.6.3" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#OptimisingMultiGPUPerformance-4"><i class="fa fa-check"></i><b>13.6.6.3</b> Optimising Multi-GPU Performance (HPC Only)</a></li>
</ul></li>
<li class="chapter" data-level="13.6.7" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#AutoTerminateOptions-3"><i class="fa fa-check"></i><b>13.6.7</b> Auto Terminate (Simulation End) Options</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#ResultsReplication-3"><i class="fa fa-check"></i><b>13.7</b> Reproducibility of Results</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#ResultsReplicationClassic-3"><i class="fa fa-check"></i><b>13.7.1</b> TUFLOW Classic (CPU only)</a></li>
<li class="chapter" data-level="13.7.2" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#ResultsReplicationHPCCPU-3"><i class="fa fa-check"></i><b>13.7.2</b> TUFLOW HPC (incl. Quadtree) on CPU</a></li>
<li class="chapter" data-level="13.7.3" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#ResultsReplicationHPCGPU-3"><i class="fa fa-check"></i><b>13.7.3</b> TUFLOW HPC (incl. Quadtree) on GPU</a></li>
<li class="chapter" data-level="13.7.4" data-path="Running-Simulations-1.html"><a href="Running-Simulations-1.html#ResultsReplicationHPCMultiThread-3"><i class="fa fa-check"></i><b>13.7.4</b> TUFLOW HPC (incl. Quadtree) on multiple GPUs / CPU threads</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html"><i class="fa fa-check"></i><b>14</b> Checks and Log Files</a>
<ul>
<li class="chapter" data-level="14.1" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#Log-Introduction-1"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#ConsoleDisplay-2"><i class="fa fa-check"></i><b>14.2</b> Console (DOS) Window Display</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#Classic-3"><i class="fa fa-check"></i><b>14.2.1</b> TUFLOW Classic</a></li>
<li class="chapter" data-level="14.2.2" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#HPC-3"><i class="fa fa-check"></i><b>14.2.2</b> TUFLOW HPC</a></li>
<li class="chapter" data-level="14.2.3" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#ConsoleDisappear-3"><i class="fa fa-check"></i><b>14.2.3</b> The Console (DOS) Window Does Not Appear</a></li>
<li class="chapter" data-level="14.2.4" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#QuickEdit-3"><i class="fa fa-check"></i><b>14.2.4</b> Unexpected Simulation Pause (DOS Quick Edit Mode)</a></li>
<li class="chapter" data-level="14.2.5" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#ConsoleShortcut-3"><i class="fa fa-check"></i><b>14.2.5</b> Stopping the Console Window</a></li>
<li class="chapter" data-level="14.2.6" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#ConsoleCustomisation-3"><i class="fa fa-check"></i><b>14.2.6</b> Customisation of Console Window</a></li>
<li class="chapter" data-level="14.2.7" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#ErrorLevel-3"><i class="fa fa-check"></i><b>14.2.7</b> TUFLOW Windows ERROR LEVEL Reporting</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#MessageBox-2"><i class="fa fa-check"></i><b>14.3</b> Message Boxes</a></li>
<li class="chapter" data-level="14.4" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#SimLog-2"><i class="fa fa-check"></i><b>14.4</b> Simulations .log</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#LocalLog-3"><i class="fa fa-check"></i><b>14.4.1</b> Local .log File</a></li>
<li class="chapter" data-level="14.4.2" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#GlobalLog-3"><i class="fa fa-check"></i><b>14.4.2</b> Global .log File</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#SimLogFiles-2"><i class="fa fa-check"></i><b>14.5</b> Simulation Log Files</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#TLF-3"><i class="fa fa-check"></i><b>14.5.1</b> TLF</a>
<ul>
<li class="chapter" data-level="14.5.1.1" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#HPCTLF-4"><i class="fa fa-check"></i><b>14.5.1.1</b> HPC TLF and DT</a></li>
</ul></li>
<li class="chapter" data-level="14.5.2" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#TSF-3"><i class="fa fa-check"></i><b>14.5.2</b> TSF</a></li>
<li class="chapter" data-level="14.5.3" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#start-stats-3"><i class="fa fa-check"></i><b>14.5.3</b> Start Stats</a></li>
<li class="chapter" data-level="14.5.4" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#run-stats-3"><i class="fa fa-check"></i><b>14.5.4</b> Run Stats</a></li>
<li class="chapter" data-level="14.5.5" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#Messages-3"><i class="fa fa-check"></i><b>14.5.5</b> Messages</a></li>
<li class="chapter" data-level="14.5.6" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#Workspaces-2"><i class="fa fa-check"></i><b>14.5.6</b> GIS Workspaces</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#EOF-2"><i class="fa fa-check"></i><b>14.6</b> 1D Output File</a></li>
<li class="chapter" data-level="14.7" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#CheckLayers-2"><i class="fa fa-check"></i><b>14.7</b> Check Files</a></li>
<li class="chapter" data-level="14.8" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#MB-2"><i class="fa fa-check"></i><b>14.8</b> Mass Balance Output</a>
<ul>
<li class="chapter" data-level="14.8.1" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#OneD-MB-3"><i class="fa fa-check"></i><b>14.8.1</b> TUFLOW 1D Mass Balance</a></li>
<li class="chapter" data-level="14.8.2" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#MB-CLA-3"><i class="fa fa-check"></i><b>14.8.2</b> TUFLOW Classic Mass Balance</a></li>
<li class="chapter" data-level="14.8.3" data-path="Checks-and-Logs-1.html"><a href="Checks-and-Logs-1.html#MB-HPC-3"><i class="fa fa-check"></i><b>14.8.3</b> TUFLOW HPC Mass Balance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html"><i class="fa fa-check"></i><b>15</b> Viewing Outputs</a>
<ul>
<li class="chapter" data-level="15.1" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#Introduction-Viewing-2"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#Output-Folder-2"><i class="fa fa-check"></i><b>15.2</b> Folder Structure</a></li>
<li class="chapter" data-level="15.3" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#view-1D-2"><i class="fa fa-check"></i><b>15.3</b> 1D Output</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#view-tpc-3"><i class="fa fa-check"></i><b>15.3.1</b> TUFLOW Plot Control file (TPC)</a></li>
<li class="chapter" data-level="15.3.2" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#mm-4"><i class="fa fa-check"></i><b>15.3.2</b> Maximum and Minimum Output</a></li>
<li class="chapter" data-level="15.3.3" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#ccA-4"><i class="fa fa-check"></i><b>15.3.3</b> ccA GIS Layer</a></li>
<li class="chapter" data-level="15.3.4" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#TS-GIS-3"><i class="fa fa-check"></i><b>15.3.4</b> _TS GIS Layer</a></li>
<li class="chapter" data-level="15.3.5" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#Viewing-WLL-4"><i class="fa fa-check"></i><b>15.3.5</b> 1D Water Level Lines (WLL)</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#view-2D-2"><i class="fa fa-check"></i><b>15.4</b> 2D Output</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#view-mesh-3"><i class="fa fa-check"></i><b>15.4.1</b> Mesh Output</a></li>
<li class="chapter" data-level="15.4.2" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#view-raster-3"><i class="fa fa-check"></i><b>15.4.2</b> Raster Output</a></li>
<li class="chapter" data-level="15.4.3" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#View-PO-3"><i class="fa fa-check"></i><b>15.4.3</b> Plot Output</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#Post-Process-2"><i class="fa fa-check"></i><b>15.5</b> Post Processing</a></li>
<li class="chapter" data-level="15.6" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#Impact-Map-2"><i class="fa fa-check"></i><b>15.6</b> Impact Mapping</a></li>
<li class="chapter" data-level="15.7" data-path="Viewing-Output-1.html"><a href="Viewing-Output-1.html#Animations-2"><i class="fa fa-check"></i><b>15.7</b> Animations</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html"><i class="fa fa-check"></i><b>16</b> Quality Control and Troubleshooting</a>
<ul>
<li class="chapter" data-level="16.1" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#QAIntroduction-2"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#ModelHealth-2"><i class="fa fa-check"></i><b>16.2</b> Model Health</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#TUFLOWClassicModelHealth-3"><i class="fa fa-check"></i><b>16.2.1</b> TUFLOW Classic</a>
<ul>
<li class="chapter" data-level="16.2.1.1" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#TUFLOWClassicTimestep-4"><i class="fa fa-check"></i><b>16.2.1.1</b> Timestep</a></li>
</ul></li>
<li class="chapter" data-level="16.2.2" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#TUFLOWHPCModelHealth-3"><i class="fa fa-check"></i><b>16.2.2</b> TUFLOW HPC</a>
<ul>
<li class="chapter" data-level="16.2.2.1" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#TUFLOWHPCTimestep-4"><i class="fa fa-check"></i><b>16.2.2.1</b> Timestep</a></li>
</ul></li>
<li class="chapter" data-level="16.2.3" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#TUFLOWQAIndicators-3"><i class="fa fa-check"></i><b>16.2.3</b> Healthy Model Indicators</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#QATroubleshooting-2"><i class="fa fa-check"></i><b>16.3</b> Troubleshooting</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#QAGeneralComments-3"><i class="fa fa-check"></i><b>16.3.1</b> General Comments</a></li>
<li class="chapter" data-level="16.3.2" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#tuflowinstability-3"><i class="fa fa-check"></i><b>16.3.2</b> Instability Identification</a>
<ul>
<li class="chapter" data-level="16.3.2.1" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#onedinstability-4"><i class="fa fa-check"></i><b>16.3.2.1</b> 1D (ESTRY) Domains</a></li>
<li class="chapter" data-level="16.3.2.2" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#ClassicInstability-4"><i class="fa fa-check"></i><b>16.3.2.2</b> TUFLOW Classic</a></li>
<li class="chapter" data-level="16.3.2.3" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#HPCInstability-4"><i class="fa fa-check"></i><b>16.3.2.3</b> TUFLOW HPC</a></li>
<li class="chapter" data-level="16.3.2.4" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#onedtwodinstability-4"><i class="fa fa-check"></i><b>16.3.2.4</b> 1D/2D Links</a></li>
<li class="chapter" data-level="16.3.2.5" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#othertroublshooting-4"><i class="fa fa-check"></i><b>16.3.2.5</b> Other General Troubleshooting Recommendations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#QAchecklist-2"><i class="fa fa-check"></i><b>16.4</b> QA Check List and Simulation Logging</a></li>
<li class="chapter" data-level="16.5" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#ExceedingRAM-2"><i class="fa fa-check"></i><b>16.5</b> Models Exceeding Hardware RAM</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#ComputerRAM-3"><i class="fa fa-check"></i><b>16.5.1</b> Computer RAM</a></li>
<li class="chapter" data-level="16.5.2" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#TUFLOWVersion-3"><i class="fa fa-check"></i><b>16.5.2</b> TUFLOW Version</a></li>
<li class="chapter" data-level="16.5.3" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#QAmodeldesign-3"><i class="fa fa-check"></i><b>16.5.3</b> Model Design</a></li>
<li class="chapter" data-level="16.5.4" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#memoryusage-3"><i class="fa fa-check"></i><b>16.5.4</b> Memory Usage Reporting</a></li>
<li class="chapter" data-level="16.5.5" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#tempmemoryusage-3"><i class="fa fa-check"></i><b>16.5.5</b> Temporary Memory Usage</a></li>
<li class="chapter" data-level="16.5.6" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#GPURAM-3"><i class="fa fa-check"></i><b>16.5.6</b> TUFLOW HPC GPU Module and RAM requirements</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="QualityControl-and-Troubleshooting-1.html"><a href="QualityControl-and-Troubleshooting-1.html#backwardcompatibility-2"><i class="fa fa-check"></i><b>16.6</b> Past Release Version Backward Compatibility</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="Utilities-1.html"><a href="Utilities-1.html"><i class="fa fa-check"></i><b>17</b> Utilities</a>
<ul>
<li class="chapter" data-level="17.1" data-path="Utilities-1.html"><a href="Utilities-1.html#Util-Introduction-2"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="Utilities-1.html"><a href="Utilities-1.html#GIS-Utilities-2"><i class="fa fa-check"></i><b>17.2</b> GIS Based Utilities</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="Utilities-1.html"><a href="Utilities-1.html#QGIS-Plugin-3"><i class="fa fa-check"></i><b>17.2.1</b> QGIS TUFLOW Plugin</a></li>
<li class="chapter" data-level="17.2.2" data-path="Utilities-1.html"><a href="Utilities-1.html#ArcGIS-Toolbar-3"><i class="fa fa-check"></i><b>17.2.2</b> ArcGIS Pro Toolbar</a></li>
<li class="chapter" data-level="17.2.3" data-path="Utilities-1.html"><a href="Utilities-1.html#ArcMap-Toolbox-3"><i class="fa fa-check"></i><b>17.2.3</b> ArcMap Toolbox</a></li>
<li class="chapter" data-level="17.2.4" data-path="Utilities-1.html"><a href="Utilities-1.html#MiTools-3"><i class="fa fa-check"></i><b>17.2.4</b> MiTools</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="Utilities-1.html"><a href="Utilities-1.html#Console-2"><i class="fa fa-check"></i><b>17.3</b> Console Utilities</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="Utilities-1.html"><a href="Utilities-1.html#Processing-Utilites-3"><i class="fa fa-check"></i><b>17.3.1</b> Pre and Post Processing</a></li>
<li class="chapter" data-level="17.3.2" data-path="Utilities-1.html"><a href="Utilities-1.html#Convert-Utilties-3"><i class="fa fa-check"></i><b>17.3.2</b> Convert to TUFLOW</a></li>
<li class="chapter" data-level="17.3.3" data-path="Utilities-1.html"><a href="Utilities-1.html#Syntax-Highlighting-3"><i class="fa fa-check"></i><b>17.3.3</b> Textfile Syntax Highlighting</a></li>
<li class="chapter" data-level="17.3.4" data-path="Utilities-1.html"><a href="Utilities-1.html#PyTUFLOW-3"><i class="fa fa-check"></i><b>17.3.4</b> PyTUFLOW</a></li>
<li class="chapter" data-level="17.3.5" data-path="Utilities-1.html"><a href="Utilities-1.html#Excel-3"><i class="fa fa-check"></i><b>17.3.5</b> Excel Macros</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="Features-and-Changes-1.html"><a href="Features-and-Changes-1.html"><i class="fa fa-check"></i><b>18</b> Default Changes</a>
<ul>
<li class="chapter" data-level="18.1" data-path="Features-and-Changes-1.html"><a href="Features-and-Changes-1.html#changes-post-2018"><i class="fa fa-check"></i><b>18.1</b> Post 2018-03 Release</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="Features-and-Changes-1.html"><a href="Features-and-Changes-1.html#changes-from-2020-10"><i class="fa fa-check"></i><b>18.1.1</b> 2023-03 Release to 2020-10 Release</a></li>
<li class="chapter" data-level="18.1.2" data-path="Features-and-Changes-1.html"><a href="Features-and-Changes-1.html#changes-from-2020-01"><i class="fa fa-check"></i><b>18.1.2</b> 2020-10 Release to 2020-01 Release</a></li>
<li class="chapter" data-level="18.1.3" data-path="Features-and-Changes-1.html"><a href="Features-and-Changes-1.html#changes-from-2018-03"><i class="fa fa-check"></i><b>18.1.3</b> 2020-01 Release to 2018-03 Release</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="Features-and-Changes-1.html"><a href="Features-and-Changes-1.html#changes-pre-2018"><i class="fa fa-check"></i><b>18.2</b> Pre 2018-03 Release</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="TCFCommands-1.html"><a href="TCFCommands-1.html"><i class="fa fa-check"></i><b>A</b> TCF Commands</a></li>
<li class="chapter" data-level="B" data-path="ECFCommands-1.html"><a href="ECFCommands-1.html"><i class="fa fa-check"></i><b>B</b> ECF Commands</a></li>
<li class="chapter" data-level="C" data-path="TGCCommands-1.html"><a href="TGCCommands-1.html"><i class="fa fa-check"></i><b>C</b> TGC Commands</a></li>
<li class="chapter" data-level="D" data-path="TBCCommands-1.html"><a href="TBCCommands-1.html"><i class="fa fa-check"></i><b>D</b> TBC Commands</a></li>
<li class="chapter" data-level="E" data-path="TOCCommands-1.html"><a href="TOCCommands-1.html"><i class="fa fa-check"></i><b>E</b> TOC Commands</a></li>
<li class="chapter" data-level="F" data-path="TRFCCommands-1.html"><a href="TRFCCommands-1.html"><i class="fa fa-check"></i><b>F</b> TRFC Commands</a></li>
<li class="chapter" data-level="G" data-path="TESFCommands-1.html"><a href="TESFCommands-1.html"><i class="fa fa-check"></i><b>G</b> TESF Commands</a></li>
<li class="chapter" data-level="H" data-path="QCFCommands-1.html"><a href="QCFCommands-1.html"><i class="fa fa-check"></i><b>H</b> QCF Commands</a></li>
<li class="chapter" data-level="I" data-path="TSCFCommands-1.html"><a href="TSCFCommands-1.html"><i class="fa fa-check"></i><b>I</b> TSCF Commands</a></li>
<li class="chapter" data-level="J" data-path="ADCFCommands-1.html"><a href="ADCFCommands-1.html"><i class="fa fa-check"></i><b>J</b> ADCF Commands</a></li>
<li class="chapter" data-level="K" data-path="TEFCommands-1.html"><a href="TEFCommands-1.html"><i class="fa fa-check"></i><b>K</b> TEF Commands</a></li>
<li class="chapter" data-level="L" data-path="SWMMGeopackage-1.html"><a href="SWMMGeopackage-1.html"><i class="fa fa-check"></i><b>L</b> SWMM GeoPackage Format</a>
<ul>
<li class="chapter" data-level="L.1" data-path="SWMMGeopackage-1.html"><a href="SWMMGeopackage-1.html#swmm-geopackage-layer-list"><i class="fa fa-check"></i><b>L.1</b> SWMM GeoPackage Layer List</a></li>
<li class="chapter" data-level="L.2" data-path="SWMMGeopackage-1.html"><a href="SWMMGeopackage-1.html#swmm-geopackage-layer-descriptions"><i class="fa fa-check"></i><b>L.2</b> SWMM GeoPackage Layer Descriptions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://docs.tuflow.com/classic-hpc/manual/2023-03/"><img src="images/WQFooter.jpg" style="width:246px;height:10px;"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><h0 style="color:rgb(0,85,129);">TUFLOW Classic/HPC User Manual 2023-03</h0></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="TwoD-Domains-1" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Section 7</span> 2D Domains<a href="TwoD-Domains-1.html#TwoD-Domains-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-1" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Introduction<a href="TwoD-Domains-1.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter of the Manual discusses features specifically related to 2D model domains. 1D domain features are discussed separately in Chapter <a href="OneD-Domains-1.html#OneD-Domains-1">5</a> and 1D/2D linking is discussed in Chapter <a href="DomainLinking-1.html#DomainLinking-1">10</a>.</p>
</div>
<div id="Solvers-2" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Solvers<a href="TwoD-Domains-1.html#Solvers-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>TUFLOW solves the depth averaged 2D Shallow Water Equations (SWE). The
SWE are the equations of fluid motion used for modelling long waves such
as floods, urban stormwater inundation, dam failure hydraulics, ocean tides and storm surges. They are derived using the assumption of vertically uniform horizontal velocity and negligible vertical acceleration (i.e. a hydrostatic pressure distribution). These assumptions are valid where the wave length is much greater than the depth of water. In the case of the ocean tide, the wavelength is long, and even at the deepest parts of the ocean the SWE are applicable.</p>
<p>The 2D SWE in the horizontal plane are described by the following
partial differential equations of mass continuity and momentum
conservation in the X and Y directions for an in-plan Cartesian
coordinate frame of reference. The equations are:</p>
<p>2D Continuity:</p>
<p><span class="math display" id="eq:equ-2DContinuity-1">\[\begin{equation}
\frac{\partial h}{\partial t} + \frac{\partial(hu)}{\partial x} + \frac{\partial(hv)}{\partial y} = S
\tag{7.1}
\end{equation}\]</span></p>
<p>X Momentum:</p>
<p><span class="math display" id="eq:equ-x-momentum">\[\begin{equation}
\frac{\partial (hu)}{\partial t}
+ \frac{\partial (huu)}{\partial x} + \frac{\partial (hvu)}{\partial y}
- \frac{\partial \left( h \nu_t \frac{\partial u}{\partial x} \right)}{\partial x} - \frac{\partial \left( h \nu_t \frac{\partial u}{\partial y} \right)}{\partial y}
+ gh\frac{\partial (z + h)}{\partial x}
+ gh\frac{n^2\sqrt{u^2+v^2}}{h^\frac{4}{3}}u
= S_u
- \frac{h}{\rho}\frac{\partial P_a}{\partial x}
- c_f h v
+ \frac{\tau_{x,wind}}{\rho}
\tag{7.2}
\end{equation}\]</span></p>
<p>Y Momentum:</p>
<p><span class="math display" id="eq:equ-y-momentum">\[\begin{equation}
\frac{\partial (hv)}{\partial t}
+ \frac{\partial (huv)}{\partial x} + \frac{\partial (hvv)}{\partial y}
- \frac{\partial \left( h \nu_t \frac{\partial v}{\partial x} \right)}{\partial x} - \frac{\partial \left( h \nu_t \frac{\partial v}{\partial y} \right)}{\partial y}
+ gh\frac{\partial (z + h)}{\partial y}
+ gh\frac{n^2\sqrt{u^2+v^2}}{h^\frac{4}{3}}v
= S_v
- \frac{h}{\rho}\frac{\partial P_a}{\partial y}
+ c_f h u
+ \frac{\tau_{y,wind}}{\rho}
\tag{7.3}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(h\)</span> = Depth of water</li>
<li><span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> = Depth averaged velocity components in X and Y directions</li>
<li><span class="math inline">\(t\)</span> = Time</li>
<li><span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> = Distance in X and Y directions</li>
<li><span class="math inline">\(z\)</span> = Bed elevation</li>
<li><span class="math inline">\(n\)</span> = Manning’s bed friction coefficient</li>
<li><span class="math inline">\(c_f\)</span> = Coriolis force coefficient (available for TUFLOW Classic only)</li>
<li><span class="math inline">\(\nu_t\)</span> = Turbulent kinematic viscosity</li>
<li><span class="math inline">\(P_a\)</span> = Atmospheric pressure</li>
<li><span class="math inline">\(\rho\)</span> = Density of water</li>
<li><span class="math inline">\(S\)</span> = Areal volume source (volume per unit time per unit area), used for rain and infiltration</li>
<li><span class="math inline">\(S_u\)</span> and <span class="math inline">\(S_v\)</span> = Areal momentum source terms (force per unit area per unit fluid density), used for local energy losses</li>
</ul>
<p>The terms of the SWE can be attributed to different physical phenomena.
These are:</p>
<ul>
<li>Propagation of the wave due to gravitational forces.<br />
</li>
<li>Transport of momentum by advection.<br />
</li>
<li>Horizontal diffusion of momentum or sub-grid scale turbulence (see
Section <a href="TwoD-Domains-1.html#turbulence-overview">7.2.4</a>).<br />
</li>
<li>External forces such as bed friction, rotation of the earth, wind,
wave radiation stresses, and barometric pressure.</li>
</ul>
<p>For further discussion relating to the SWE, please see Section <a href="Fundamentals-1.html#FluidFlowPhysicalTerms-3">3.4.1</a>.</p>
<p>TUFLOW Classic and TUFLOW HPC use different solution schemes to solve
the SWE. Both approaches are discussed in the following Sections.</p>
<div id="tuflow-hpc-2d-solver" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> TUFLOW HPC 2D Solver<a href="TwoD-Domains-1.html#tuflow-hpc-2d-solver" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>TUFLOW HPC is an explicit solver using a finite volume method. It computes the volume flow across cell boundaries. Volume cannot leave one cell without being placed in its neighbour. As a result, 2D volume is conserved and 2D mass error is
0%. The transfer of momentum across cell boundaries is computed in the
same way and once external forces are considered (bed slope, bottom
friction, and wet perimeters of non-uniform depth) momentum is conserved.</p>
<p>The explicit finite volume scheme applies the conservation of mass over
the cell for calculating the rate of change of cell depth. In Figure <a href="TwoD-Domains-1.html#fig:fig-image59">7.1</a>, the cell centre (for the cell in question) is given the notation cc, while the surrounding neighbours are given the notation n1..n4. The u velocity at the left and right faces are notated u1 and u2, and the v velocities at the bottom and top faces are notated v3 and v4. The cell width and
height are Δx and Δy respectively.</p>
<p>TUFLOW HPC uses an automatic adaptive timestep to achieve unconditional stability, as mentioned in Section <a href="Fundamentals-1.html#TUFLOWHPCTimestep-3">3.5.4</a>. It solves the 2D SWE on a uniform Cartesian grid. Water depth/level is calculated at the cell centres, and velocity components at the cell mid-sides or faces in the same manner as TUFLOW Classic.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image59"></span>
<img src="images/image59.png" alt="TUFLOW HPC 2D SWE Finite Volume Scheme Approach"  />
<p class="caption">
Figure 7.1: TUFLOW HPC 2D SWE Finite Volume Scheme Approach
</p>
</div>
<p>The time rate of change for the cell averaged depth is shown in Equation <a href="TwoD-Domains-1.html#eq:equ-cell-avg-depth">(7.4)</a>.</p>
<p><span class="math display" id="eq:equ-cell-avg-depth">\[\begin{equation}
\frac{A\partial h}{\partial t} = \Phi_{1} - \Phi_{2} + \Phi_{3} - \Phi_{4} + S_{Q}
\tag{7.4}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(A\)</span> = cell area</li>
<li><span class="math inline">\(h\)</span> = depth</li>
<li><span class="math inline">\(t\)</span> = time</li>
<li><span class="math inline">\(\Phi_{1}\)</span> to <span class="math inline">\(\Phi_{4}\)</span> = the four face fluxes</li>
<li><span class="math inline">\(S_Q\)</span> = sources (rain and infiltration)</li>
</ul>
<p>The volume fluxes across the four cell sides and the net volume from
source boundaries determine the rate of volume change and the change in
depth. Source boundaries include SA, ST and RF boundaries, soil
infiltration, evaporation, and any flow linkages to 1D elements via SX
links. By computing the face fluxes for all model faces, and referencing
these when computing the depth derivative for each cell, volume
conservation is guaranteed to numerical precision. At “Head” boundaries, the above equation does not apply. Rather, the defined head (level) is directly used to calculate the water volume and associated depth in the cell.</p>
<p>The calculation of the cell side volume fluxes is available in either
1st or 2nd order spatially. For the 1st order scheme, this uses depth
of the upstream cell (often referred to as upwinding), bounded to be
greater than or equal to 0, and less than or equal to the surface
elevation of the upstream cell less the bed elevation at the cell side
mid-point. For the 2nd order scheme the depth at the face is computed as
the average of the two cell averaged depths, however, this method in its
simplest form is not total variation diminishing (TVD) and is known to
be unstable. A hybrid method is implemented in which the depth at the
cell face transitions from interpolated depth to the upstream depth (1st order upwinding)
when the solution shows short scale reversal or upstream controlled
supercritical flow.</p>
<p>The solution of the cell side fluxes includes the inertia and sub-grid
scale turbulence (eddy or kinematic turbulent viscosity) term. Turbulence is detailed further in Section <a href="TwoD-Domains-1.html#turbulence-overview">7.2.4</a>. The cell side fluxes may also be factored down by flow constriction factors where sub-grid-scale obstructions exist.
<!-- PAR to EFC have removed the below and included a link to the turbulence section.

removed text:
The same options for the eddy viscosity coefficient calculation in Classic
(constant, Smagorinsky or a combination of constant and Smagorinsky) are
available, and the default values for both schemes are presently set the
same. BMT are doing further research in this area, as there is some
dependency on cell size for this term (refer to @CollecuttSyme2017).  
--></p>
<p>Due to the explicit scheme, the calculation of flux
for one cell face may be performed independently of the other faces, and
likewise the summation of flux for each cell volume may be performed
independently of the other cell volumes. Applying the same algorithm to
millions of data elements is well suited to modern multi-core CPUs,
and particularly suited to GPU hardware acceleration.</p>
<p>The 1st order approach can experience numerical diffusion, like all 1st
order schemes, and does not resolve strongly two-dimensional hydraulics
(e.g. flow expansion downstream of a constriction) as well as a 2nd
order solution. The 2nd order solution demonstrates no discernible
numerical diffusion, and resolves complex 2D hydraulics, including
hydraulic jumps as demonstrated using the UK EA Benchmark Flume Test 6A <span class="citation">Collecutt &amp; Syme (<a href="#ref-CollecuttSyme2017">2017</a>)</span>.<!-- PAR to EWC can we include the reference here--><!--done-->
<!-- PAR added next sentence--> When running HPC solver the 2nd order spatial scheme is the default and recommended approach.</p>
<p>For further details on the scheme, refer to <span class="citation">Collecutt &amp; Syme (<a href="#ref-CollecuttSyme2017">2017</a>)</span>.
Note that at the time this paper was written, the scheme utilised cell
centre definitions for velocity, which was prone to a zero-energy
‘checker-board’ mode in the solution. Subsequent to the paper, cell mid-side points were adopted for the definition of u and v velocities which has
eliminated the checker-board mode with only very minor changes to the
results.</p>
</div>
<div id="tuflow-classic-2d-solver" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> TUFLOW Classic 2D Solver<a href="TwoD-Domains-1.html#tuflow-classic-2d-solver" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The scheme is unlike the TUFLOW HPC solution in that it solves the same shallow water
equations implicitly using matrices, allowing much larger timesteps (hence why it is important
to monitor mass error in implicit schemes such as TUFLOW Classic to
check that the solution is converging).</p>
<p>An Alternating Direction Semi-Implicit (ADI) finite difference method is used
for TUFLOW Classic’s computational procedure. It was originally based on
the work of <span class="citation">Stelling (<a href="#ref-Stelling1984">1984</a>)</span>. The method involves two stages per
timestep, each having two steps, giving four steps overall. Two of the steps
sweeps through the model domain solving tri-diagonal matrices, hence the “semi-implicit”. Due to the implicit solution, TUFLOW Classic is not suited to being parallelised for multi-core CPUs or for GPU acceleration.</p>
<p>Step 1 solves the momentum equation in the Y-direction for the
Y-velocities. The equation is solved using a predictor/corrector method,
which involves two sweeps. For the first sweep, the calculation proceeds
column by column in the Y-direction. If the signs of all velocities in
the X-direction are the same the second sweep is not necessary,
otherwise the calculation is repeated sweeping in the opposite
direction.</p>
<p>The second step of Stage 1 solves for the water levels and X-direction
velocities by solving the equations of mass continuity and of momentum
in the X-direction. Tri-diagonal equations are generated and solved across the 2D domain by substituting
the momentum equation into the mass equation and eliminating the
X-velocity. The water levels are calculated and back substituted into
the momentum equation to calculate the X-velocities. This process is
repeated for a recommended two iterations. Testing on a number of models
showed there to be little benefit in using more than two iterations
unless there are rapid changes in the hydraulic conditions per timestep
as may occur with modelling inundation from a dam break.</p>
<p>Stage 2 proceeds in a similar manner to Stage 1 with the first step
using the X-direction momentum equation and the second step using the
mass equation and the Y-direction momentum equation.</p>
<p>The solution as formulated by Stelling has been enhanced and improved to
provide much more robust wetting and drying of elements, upstream
controlled flow regimes (e.g. supercritical flow and upstream controlled
weir flow), modifications to cells to model structure obverts (e.g.
bridge decks) and additional energy losses due to fine-scale features
such as bridge piers.</p>
<p>TUFLOW Classic solves the 2D SWE on the same uniform Cartesian grid as used by TUFLOW HPC. Water depth/level is calculated at the cell centres, and velocity components at the cell mid-sides or faces.</p>
</div>
<div id="Schematisation-3" class="section level3 hasAnchor" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Cell Schematisation<a href="TwoD-Domains-1.html#Schematisation-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>TUFLOW 2D models discretise the real world as a grid of connected square cells. A fixed grid 2D domain is defined by a bounding rectangle in the same manner a computer screen or digital photo is made up of a grid of pixels.</p>
<p>The physical properties (i.e. ground elevations, surface roughness, etc) of a 2D cell are defined as a minimum at the cell’s centre, mid-sides and corners as described in Section <a href="TwoD-Domains-1.html#Domain-3">7.3.1</a>. High resolution topographic detail for the cell’s storage and conveyance across the cell sides (faces) can be incorporated by using the Sub-Grid Sampling (SGS) feature available in TUFLOW HPC, as documented in Section <a href="TwoD-Domains-1.html#SGS-3">7.4.3</a>. SGS has substantial accuracy benefits. It enables the use of much larger cell sizes without loss of hydraulic conveyance accuracy. It also results in less output sensitivity to the grid orientation.</p>
<!-- EFC to PAR: I don't think the below belongs here 
PAR to EFC: agree

TUFLOW Classic allows multiple 2D fixed grid domains or differing orientation and cell size within the one model. The bounding rectangle of a 2D domain can be at any orientation to optimise the computer memory (RAM) footprint, however, with RAM rarely being a constraint many models are typically orientated north-south.

A quadtree grid is a grid of 2D square cells all at the same orientation with the base cell size being the parent or largest cell size. Cells can be decreased in size by dividing the base cell size into four equal square cells, with these smaller cells able to be further reduced in size to four smaller cells and so on. As cell referencing can no longer be on a simple row-column arrangement of a fixed grid 2D domain, a quadtree grid has a data structure more akin to a fully-flexible mesh. Whilst, more information needs to be stored per cell for a quadtree grid compared to fixed grid, memory is not defined by the size of the bounding rectangle, but by the number of active 2D cells. Therefore, if there is a significant area of inactive 2D cells within the bounding rectangle of the quadtree grid the memory footprint can be considerably smaller than a fixed grid model.
-->
<div id="computational-points-4" class="section level4 hasAnchor" number="7.2.3.1">
<h4><span class="header-section-number">7.2.3.1</span> Computational Points<a href="TwoD-Domains-1.html#computational-points-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To fully understand how TUFLOW functions, understanding of the computational role of the 2D cell and its four sides (also referred to as faces) is important. In the following sections, these model components are referred to as the ZC, ZU, ZV and ZH points, as shown in Figure <a href="TwoD-Domains-1.html#fig:fig-image56">7.2</a>. The description of these points are:</p>
<!-- EFC, the row column reference info is probably no longer that relevant, whilst read row col <data> is still supported for Classic and HPC fixed grid, this doesn't support SGS or quadtree.  Maybe the information on row column referencing can be moved to the appendix / commands section where this Read RowCol functionality is described-->
<!-- EFC: removed row/col-->
<!-- PAR to EFC, the lowest elevation is an SGS thing,should we keep this to non SGS as we haven't introduced yet?-->
<!-- EFC to PAR: have commented out the SGS comments-->
<ul>
<li>ZC – the cell centre with ZC being the elevation used computationally within the cell. <!--For non SGS models this is assumed to be a flat square represented by the ZC elevation.--></li>
<li>ZU – middle of the cell side of the Y-axis face with ZU being the elevation used computationally along the cell side. <!--For non SGS models this is assumed to be a rectangular channel defined the the ZU elevation.--></li>
<li>ZV – middle of the cell side of the X-axis face with ZV being the elevation used computationally along the cell side. <!--For non SGS models this is assumed to be a rectangular channel defined the the ZV elevation.--></li>
<li>ZH – corner of the cell. The ZH point plays no role in the computational hydraulics but is used for some output formats that require output at the cell corners.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image56"></span>
<img src="images/image56.png" alt="Location of Zpts and Computation Points"  />
<p class="caption">
Figure 7.2: Location of Zpts and Computation Points
</p>
</div>
<!--EFC to PAR: does your comment about SGS from above remain here? SGS is mentioned in C point but not U/V-->
<div id="zc-point" class="section level5 hasAnchor" number="7.2.3.1.1">
<h5><span class="header-section-number">7.2.3.1.1</span> ZC Point<a href="TwoD-Domains-1.html#zc-point" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The cell centre or ZC point:</p>
<ul>
<li>Defines the location where water levels are computed based on mass
balance equation. Simply put, the net volume of water entering (or
leaving) the cell across the four cell sides (or faces) must equal the
change in volume of the cell over a timestep.<br />
</li>
<li>The volume of a cell can either be simply based on the depth of water
multiplied by the cell area or, if Sub-Grid Sampling (SGS) (Section <a href="TwoD-Domains-1.html#SGS-3">7.4.3</a>) has been
applied, a curve of volume versus depth.<br />
</li>
<li>The ZC value is typically the elevation at the cell centre or, if
using SGS, elevations are sampled across the cell, as outlined in Section <a href="TwoD-Domains-1.html#SGS-3">7.4.3</a>. The ZC value
plus the <a href="TCFCommands-1.html#tcfCellWetDryDepth">Cell Wet/Dry Depth</a> is the water
surface elevation that controls when a cell becomes wet or dry (note
that cell sides can also wet and dry).<br />
</li>
<li>The ZC value also determines the bed slope when testing for the
upstream controlled flow regime in TUFLOW Classic (see Section <a href="TwoD-Domains-1.html#CLA-US-Controlled-3">7.5.2</a>) and TUFLOW HPC (Section <a href="TwoD-Domains-1.html#HPC-US-Controlled-3">7.4.4</a>).</li>
</ul>
</div>
<div id="zu-and-zv-points" class="section level5 hasAnchor" number="7.2.3.1.2">
<h5><span class="header-section-number">7.2.3.1.2</span> ZU and ZV Points<a href="TwoD-Domains-1.html#zu-and-zv-points" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The cell sides or faces:</p>
<ul>
<li>Control how water is conveyed from one cell to another using the
momentum equation, or when upstream controlled flow occurs, the
relevant flow equation (eg. weir equation).</li>
<li>Are deactivated if the whole of the cell has dried based on the ZC
elevation as described above.<br />
</li>
<li>Can wet and dry when the whole cell is wet (see <a href="TCFCommands-1.html#tcfCellWetDryDepth">Cell Wet/Dry
Depth</a>). This allows for the modelling of “thin”
obstructions such as fences and thin embankments relative to the cell
size (e.g. a concrete levee).</li>
<li>Surface roughness information (e.g. Manning’s n) is inspected at the ZU and ZV points. See <a href="TCFCommands-1.html#tcfBedResistanceCellSides">Bed Resistance Cell Sides</a></li>
</ul>
</div>
<div id="zh-point" class="section level5 hasAnchor" number="7.2.3.1.3">
<h5><span class="header-section-number">7.2.3.1.3</span> ZH Point<a href="TwoD-Domains-1.html#zh-point" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The cell corners:</p>
<ul>
<li>Play no role in the computational hydraulic calculations.<br />
</li>
<li>Are used by the more common map output formats to map results due to
mesh based outputs requiring elevations and results at the element
(cell) vertices.</li>
</ul>
</div>
</div>
</div>
<div id="turbulence-overview" class="section level3 hasAnchor" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Turbulence<a href="TwoD-Domains-1.html#turbulence-overview" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Turbulence within rivers plays a significant role in determining the mean flow velocity field and is integral to the overall energy loss mechanism. During a significant flood event, the majority of the flow is carried within, or near to, the river or open channel system (the primary flow path), and the water levels on the
surrounding floodplains are principally determined by the energy losses along this flow
path. Manning’s equation is accurate for straight or slowly varying channels but does
not calculate energy losses due to sudden changes in flow direction or velocity, and it
does not capture super-elevation at bends. To automatically and accurately capture these additional energy
losses, a scheme must be physics based with a turbulence closure model. The turbulence closure model must be thoroughly bench-marked against appropriate test cases at a range of resolution scales. It is important that the turbulence closure model is cell size and timestep independent (i.e. the turbulence closure model parameters do not need to be adjusted if cell size or timestep changes). <span class="citation">Collecutt et al. (<a href="#ref-Collecutt2020">2020</a>)</span> provides benchmarking of the TUFLOW turbulence schemes.</p>
<p>There are three approaches available to model losses associated with turbulence when using TUFLOW HPC, these are discussed in Section <a href="TwoD-Domains-1.html#HPC-Turbulence-3">7.4.2</a>. The default scheme for TUFLOW HPC is the Wu approach (Section <a href="TwoD-Domains-1.html#Wu-4">7.4.2.4</a>). There are two approaches available to model turbulence when using TUFLOW Classic, these are discussed in Section <a href="TwoD-Domains-1.html#CLA-Turbulence-3">7.5.1</a>. The default scheme for TUFLOW Classic is a hybrid approach that includes elements of both the Constant and Smagorinsky approaches (Section <a href="TwoD-Domains-1.html#CLA-Smagorinsky-4">7.5.1.2</a>).</p>
<!-- EFC to PAR: does this belong here? should it go under solvers? Does the dry wall section in the HPC turbulence section belong here instead?-->
<!-- PAR to EFC: move cell schemetisation and turbulence overview to solver section
HPC and CLA use the same dry wall. move that section into here
-->
<!-- EFC has done-->
<div id="Dry-Wall-4" class="section level4 hasAnchor" number="7.2.4.1">
<h4><span class="header-section-number">7.2.4.1</span> Dry Wall Treatment<a href="TwoD-Domains-1.html#Dry-Wall-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>All of TUFLOW’s viscosity approaches feature an enhanced treatment of the
viscosity term at dry boundaries. The enhanced boundary treatment corrects for unrealistic flow separation that would otherwise occur at the wet/dry interface. Figure <a href="TwoD-Domains-1.html#fig:fig-image61">7.3</a> presents a example of a benchmark model test with and without the enhanced boundary treatment. The top image is the result without the enhanced boundary treatment. Non-physical flow separation is observed along the oblique wet/dry boundary.The enhanced approach is shown in the bottom image. It
does not suffer from the flow separation, and the velocity increases
gradually from left to right as the water depth gradually shallows (the
model has a horizontal bed). The correct water surface slope is produced
when compared with theory.</p>
<p>All of the viscosity approaches are cell-centred. This guarantees symmetry is achieved in hydraulic results when using a symmetrical
model.</p>
<p>The top image in Figure <a href="TwoD-Domains-1.html#fig:fig-image61">7.3</a> shows flow separation along a dry oblique boundary without enhanced treatment
of viscosity term. The bottom image shows a correct velocity distribution using enhanced treatment of viscosity term
at dry boundaries.</p>
<img src="images/image60.png" style="display: block; margin: auto;" />
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image61"></span>
<img src="images/image61.png" alt=" Effect of Enhanced Dry Boundary Viscosity Term Treatment"  />
<p class="caption">
Figure 7.3:  Effect of Enhanced Dry Boundary Viscosity Term Treatment
</p>
</div>
</div>
</div>
</div>
<div id="Common-2" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Common Functionality<a href="TwoD-Domains-1.html#Common-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following sections are the same (or mostly so) between TUFLOW HPC and TUFLOW Classic.</p>
<div id="Domain-3" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Defining the Domain<a href="TwoD-Domains-1.html#Domain-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Each fixed grid 2D domain is treated as a rectangle at any orientation. The orientation and dimensions of each 2D domain are defined using .tgc
file commands. For the orientation it is recommended that the X-axis
falls between 90° and –90° of East due to some post-processing software
only operating within this range.</p>
<p>Several options are available for setting the 2D domains grid location and
orientation. The options are:</p>
<ul>
<li>Using a four-sided polygon in a GIS layer to define the 2D grid
orientation and dimensions (see <a href="TGCCommands-1.html#tgcReadGISLocation">Read GIS
Location</a>).<br />
</li>
<li>Using a line (two vertices only) in a 2d_loc GIS layer (attributes shown in Table <a href="TwoD-Domains-1.html#tab:tab-LocationAttribute">7.1</a>) to define the origin (first point of line) and orientation (based on the second point of the line) of the X-axis (see <a href="TGCCommands-1.html#tgcReadGISLocation">Read GIS Location</a>), and <a href="TGCCommands-1.html#tgcGridSizeNM">Grid Size (N,M)</a> or <a href="TGCCommands-1.html#tgcGridSizeXY">Grid Size (X,Y)</a> to set the 2D grid X and Y
dimensions.<br />
</li>
<li>Using <a href="TGCCommands-1.html#tgcOrigin">Origin</a>, <a href="TGCCommands-1.html#tgcOrientation">Orientation</a> or
<a href="TGCCommands-1.html#tgcOrientationAngle">Orientation Angle</a>, and <a href="TGCCommands-1.html#tgcGridSizeNM">Grid Size
(N,M)</a> or <a href="TGCCommands-1.html#tgcGridSizeXY">Grid Size (X,Y)</a>. No GIS
layers are required for this option. This option is used in Tutorial 1 of the <a href="https://wiki.tuflow.com/Tutorial_M01#2D_Domain">TUFLOW Wiki Tutorials</a>.</li>
<li>Using a DEM to set the size and location of a 2D domain (see <a href="TGCCommands-1.html#tgcReadGridLocation">Read
Grid Location</a>). This option is useful where the
model extent is the same as the DEM.</li>
</ul>
<p>It is recommended during the initial model build process, to view the <a href="https://wiki.tuflow.com/Check_Files_2d_dom">_dom_check</a> file to ensure that the model domain is set up as intended.</p>
<p>Note, if using the TUFLOW HPC Quadtree functionality, the 2D domain is set up in the Quadtree Control File (.qcf), see Section <a href="TwoD-Domains-1.html#qcf-mandatory-4">7.4.1.2</a>.</p>
<table>
<caption>
<span id="tab:tab-LocationAttribute">Table 7.1: </span><strong>Location (2d_loc) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Comment
</td>
<td style="text-align:left;">
Optional field for entering comments. Not used.
</td>
<td style="text-align:left;">
Char(250)
</td>
</tr>
</tbody>
</table>
<p>After establishing the domain’s origin, orientation and extent, the .tgc
command <a href="TGCCommands-1.html#tgcCellSize">Cell Size</a> is used to define the domain’s fixed
grid resolution. For example, the below command in the .tgc sets the cell size to 10m (or 10ft is using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd><teq> == </teq><tblk> US Customary</tblk>:</p>
<p><tcmd><a href="TGCCommands-1.html#tgcCellSize">Cell Size</a></tcmd><teq> == </teq><tblk>10</tblk></p>
<p>Note, it is not necessary to specify domain dimensions that are an exact multiple of the domain’s <a href="TGCCommands-1.html#tgcCellSize">Cell Size</a> (e.g. when using the <a href="TGCCommands-1.html#tgcGridSizeXY">Grid Size (X,Y)</a> command).</p>
<p>Within this computational domain, 2D cells can be set to be active or
inactive, as described in Section <a href="TwoD-Domains-1.html#CellCodes-3">7.3.2</a>. The redundant (inactive) areas around the edges of the domain’s bounding rectangle are automatically
removed from the computation. However, when allocating memory for processing of the arrays this is still accounted for. To determine the redundant area, search the TUFLOW log file (.tlf) for “redundant”, as shown in Figure <a href="TwoD-Domains-1.html#fig:fig-redundant-perimeter">7.4</a>. If the redundant value is large, revising the model domain dimensions will reduce the memory usage during startup.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-redundant-perimeter"></span>
<img src="images/redundant_perimeter.png" alt="Redundant Perimeter Sections Reported in the TLF"  />
<p class="caption">
Figure 7.4: Redundant Perimeter Sections Reported in the TLF
</p>
</div>
</div>
<div id="CellCodes-3" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Active / Inactive Cells<a href="TwoD-Domains-1.html#CellCodes-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Each 2D cell is assigned a code to indicate its role. The available code types are listed in Table <a href="TwoD-Domains-1.html#tab:tab-CellCodes">7.2</a>. The default value is one (1) for active (i.e. the cell can be wet or dry during a simulation).</p>
<p>Commands used to modify the cell codes are:</p>
<ul>
<li><a href="TGCCommands-1.html#tgcSetCode">Set Code</a> in the .tgc file. This option sets the cell codes for the entire domain.</li>
<li><a href="TGCCommands-1.html#tgcReadGISCode">Read GIS Code</a> in the .tgc file. This option sets the cell codes based on the value in 2d_code input polygons, see Table <a href="TwoD-Domains-1.html#tab:tab-CodeAttribute">7.3</a>.</li>
<li><a href="TGCCommands-1.html#tgcReadGridCode">Read Grid Code</a> in the .tgc file. This option sets the cell codes based on the values of an input raster grid.</li>
<li><a href="TGCCommands-1.html#tgcReadGISCode">Read GIS Code BC</a> in the .tgc file. This option sets the cell codes from the 2d_bc input polygon. The Type attribute must be set to “CD” and the code value is taken from the 2d_bc f attribute, see Table <a href="Boundaries-InitialConditions-1.html#tab:tab-ConditionsAttribute">8.6</a>.</li>
</ul>
<p><strong>Note when using the <a href="TGCCommands-1.html#tgcReadGISCode">Read GIS Code</a> command, code values are extracted from objects in a 2d_code layer (see Table <a href="TwoD-Domains-1.html#tab:tab-CodeAttribute">7.3</a>). When using the <a href="TGCCommands-1.html#tgcReadGISCode">Read GIS Code BC</a>, code values are extracted from objects in a 2d_bc layer (see Table <a href="Boundaries-InitialConditions-1.html#tab:tab-ConditionsAttribute">8.6</a>). Confusing the two GIS layer types and commands will result in <a href="http://wiki.tuflow.com/TUFLOW_Message_2320">WARNING 2320</a> message being issued.</strong></p>
<p>A typical approach is to set all the cells to be inactive using <tcmd><a href="TGCCommands-1.html#tgcSet">Set Code</a></tcmd><teq> == </teq><tblk>0</tblk> and then read a GIS layer defining the active cells with <tcmd><a href="TGCCommands-1.html#tgcReadGISCode">Read GIS Code</a></tcmd><teq> == </teq><tblk>&lt;layer&gt;</tblk>. The GIS layer regions would have the attribute set to 1 for active. For example:</p>
<p><tcmd>Set Code</tcmd><teq> == </teq><tblk>0</tblk><tgrn> ! Set all cells to inactive (i.e. Code 0)<tgrn><br />
<tcmd>Read GIS Code</tcmd><teq> == </teq><tblk>..\model\gis\2d_code_M01_002.shp</tblk> ! Reads in a polygon that sets cells to active (i.e. Code 1)<tgrn></p>
<p>Boundary Cells are automatically set to 2 along external boundaries and links (e.g. HX, HS, HT, QT boundaries). This code value of 2 (see Table <a href="TwoD-Domains-1.html#tab:tab-CellCodes">7.2</a>), is output in the TUFLOW grid check file and a value of 2 should not be used in input commands. The <a href="https://wiki.tuflow.com/Check_Files_2d_grd">_grd_check</a> file can be used to view the active cells (and their code values e.g. 1, 2 or -1) within the domain.</p>
<p>For TUFLOW Classic models containing multiple 2D domains (see Section <a href="DomainLinking-1.html#TwoD2DLinkingM2D-3">10.7.2</a>), a useful option for setting the cell codes is the INVERT flag (see <a href="TGCCommands-1.html#tgcReadGISCode">Read GIS Code Invert</a> or <a href="TGCCommands-1.html#tgcReadGISCode">Read GIS Code BC Invert</a>), which allows the same code layer/polygons to be used for activate and deactivate regions in multiple 2D domains using a single GIS input.</p>
<!--EFC to PAR: I think we can delete this paragraph? I've added Read GRID Code in the above bullet points. The second command can't be used with SGS or Quadtree, and I've never actually seen anyone use it?-->
<!--PAR: yes remove.-->
<!--Other useful commands include [Read GRID Code](#tgcReadGrid), which
allows for the assigning of cell codes from a raster grid and [Set Code
and Clean Zpt](#tgcSetCodeandCleanZpt), which assigns cells as active or
inactive based on whether an elevation has been assigned to the cell. Set Code
and Clean Zpt is not available for either SGS models or Quadtree models.-->
<p>TUFLOW automatically strips any redundant rows and columns around the
active area of the model to reduce simulation times. This is described
in Section <a href="TwoD-Domains-1.html#Domain-3">7.3.1</a>.</p>
<!-- EFC to PAR: is the note in the null cells row still relevant?-->
<!--PAR: no remove-->
<!--EFC:removed-->
<table>
<caption>
<span id="tab:tab-CellCodes">Table 7.2: </span><strong>Cell Codes</strong>
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Code
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Inactive Cells
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
<p>Inactive cells are cells that are totally removed from the computation. Maximising the area of inactive cells reduces computation time and output file sizes.</p>
<p>For a fixed grid 2D domain, inactive cells still consume memory during a simulation, as these domains are stored on a row column rectangular grid.</p>
For a quadtree grid, inactive cells will consume temporary memory (CPU RAM) during model startup, but do not consume memory (CPU or GPU) during the simulation.
</td>
</tr>
<tr>
<td style="text-align:left;">
Active Cells
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Active cells are cells that can wet and dry during a simulation.
</td>
</tr>
<tr>
<td style="text-align:left;">
Boundary Cells
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
<p>Boundary cells indicate cells that are an external boundary (including some types of 1D/2D dynamic links). There should be an active cell on one side and an inactive or null cell on the other at an external boundary. If an external boundary is digitised inside an active area (i.e. not along the active area boundary), water can flow in both directions either side of the boundary line (only in rare situations would the modeller require this).</p>
<b>Note:</b> It is not necessary to manually specify boundary cells. Boundary lines are digitised in GIS layer(s) and TUFLOW automatically assigns the boundary code to the cells (see Section <a href="Boundaries-InitialConditions-1.html#BC-Layers-3">8.5.1</a> and <a href="TBCCommands-1.html#tbcReadGISBC">Read GIS BC</a>).
</td>
</tr>
<tr>
<td style="text-align:left;">
Null Cells
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:left;">
<p>Inactive cells used to deactivate cells within the active domain. Null cells may be preferred to inactive cells as they are not excluded from the output mesh structure (eg. not excluded from the XMDF mesh). For two simulations to be compared in some post-processers (eg. SMS), they must have exactly the same mesh. For example, if an area in a model is removed (e.g. filling part of a floodplain), use null cells or raise the ground elevations in preference to using inactive cells so that the two simulations can be compared.</p>
Setting null cells is not supported when using the TUFLOW HPC Quadtree (see Section <a href="TwoD-Domains-1.html#Quadtree-3">7.4.1</a>) functionality.
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:tab-CodeAttribute">Table 7.3: </span><strong>2D Code (2d_code) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Code
</td>
<td style="text-align:left;">
The code value (see Table <a href="TwoD-Domains-1.html#tab:tab-CellCodes">7.2</a>) to be assigned to cells falling on or within the object.
</td>
<td style="text-align:left;">
Integer
</td>
</tr>
</tbody>
</table>
</div>
<div id="layering-3" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Data Layering<a href="TwoD-Domains-1.html#layering-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--EFC: Bill wanted this section, not sure what the best way to explain this is. I think putting in a picture that shows data layering? -->
<!--EFC to PAR: what would this section contain that the 'layering of elevation data' section doesn't already?-->
<!-- PAR to EFC: keep super high level here, mention elevations / land use / soils-->
<!--done-->
<p>TUFLOW models are set up using data layering. This is an important, and very useful concept.</p>
<p>Commands are applied in sequential order; therefore, it is possible to override previous information with new data to modify the model in selected areas. For topography modifications, this is extremely useful where a base dataset exists, over which areas need to be modified to represent other scenarios such as a proposed development. This eliminates or minimises data duplication. This concept of layering datasets may also be applied to other GIS , including (but not limited to) 2d_mat, 2d_code and 2d_soil layers. For example, setting all cell codes inactive, then reading in a GIS polygon covering the active cells (as discussed in Section <a href="TwoD-Domains-1.html#CellCodes-3">7.3.2</a>).</p>
<p>Figure <a href="TwoD-Domains-1.html#fig:fig-data-layering">7.5</a> shows a visual representation of how TUFLOW interprets the following set of .tgc commands:</p>
<p><tcmd>Read Grid Zpts</tcmd><teq> == </teq><tblk>grid\DEM_5m.tif</tblk><br />
<tcmd>Read Grid Zpts</tcmd><teq> == </teq><tblk>grid\Bathy_1m.tif</tblk><br />
<tcmd>Read GIS Z Shape</tcmd><teq> == </teq><tblk>gis\2d_zsh_building.shp</tblk><br />
The command lower in the TGC will take precedence over a command above where data overlaps and the command has the same functional purpose (eg. topography definition).
The DEM_5m layer is read in first. The elevations are then replaced by the overlapping Bathy_1m layer. A 2D Z Shape (2d_zsh_buildings) is then read in which raises all elevations inside the polygon by 5m. The result is shown in the <a href="https://wiki.tuflow.com/Check_Files_2d_DEM_Z">DEM_Z</a>. The <a href="https://wiki.tuflow.com/Check_Files_2d_DEM_Z">DEM_Z</a> is a check file representing the elevation data that TUFLOW has used for the hydraulic calculations. For more information on check files see Section <a href="Checks-and-Logs-1.html#CheckLayers-2">14.7</a>.</p>
<!--PAR: make colours more obvious in DEM_Z + less jarring in bathy-->
<!--done-->
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-data-layering"></span>
<img src="images/data-layering.png" alt="Visual Representation of Data Layering in TUFLOW"  />
<p class="caption">
Figure 7.5: Visual Representation of Data Layering in TUFLOW
</p>
</div>
<p>Data layering is discussed in further detail for elevation updates in Section <a href="TwoD-Domains-1.html#elevations-3">7.3.5</a>.</p>
</div>
<div id="sampling-of-data-sets" class="section level3 hasAnchor" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Sampling of Data Sets<a href="TwoD-Domains-1.html#sampling-of-data-sets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- EFC to PAR: we spoke about sampling of datasets all as one in the old section, not sure how to split it up now that SGS is this was in the old section. What are your thoughts on this set up?-->
<p>To setup the boundary of the 2D grid and assign data values to the cells
from DEMs, TINs, land-use polygons, soil polygons and so forth, these
data layers need to sampled, interrogated or interpolated. There are two approaches to sampling datasets in TUFLOW:</p>
<ul>
<li>Traditional approach (Section <a href="TwoD-Domains-1.html#traditional-sampling-4">7.3.4.1</a>)</li>
<li>Sub-Grid Sampling (SGS) approach - recommended (Section <a href="TwoD-Domains-1.html#SGS-3">7.4.3</a>)</li>
</ul>
<p>The traditional approach by 2D solvers is to sample a
single value at the 2D cell centre (ZC). TUFLOW also supports sampling
values, for some data types, at the centre of each cell side (ZV and ZU) and the corner of the cell (ZH). The cell side sampling for example, enables a cell side to be set to the height of a levee that is narrower in width than the 2D cell. Subsequently controlling when water can move from adjacent cells depending on the water level relative to the levee crest elevation. The traditional sampling approach is explained in Section <a href="TwoD-Domains-1.html#traditional-sampling-4">7.3.4.1</a>.</p>
<p>As of the 2020-01 TUFLOW release, TUFLOW HPC supports the sampling of
elevations at sub-grid locations, referred to as Sub-Grid Sampling
(SGS). The TUFLOW Classic solver does not support SGS due to the nature
of the implicit solution and preferred use of a fixed timestep. The many benefits of using SGS are detailed in Section <a href="Fundamentals-1.html#SubGridSamplingSGS-3">3.3.3</a>, implementing the SGS approach is described in Section <a href="TwoD-Domains-1.html#SGS-3">7.4.3</a>.</p>
<div id="traditional-sampling-4" class="section level4 hasAnchor" number="7.3.4.1">
<h4><span class="header-section-number">7.3.4.1</span> Traditional Sampling Approach<a href="TwoD-Domains-1.html#traditional-sampling-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Topographically, the cell is treated as having a flat horizontal bed at a
height set to the cell centre (ZC) elevation, and the cell faces as
having flat, rectangular shaped sides at a height set to the cell
mid-side (ZU and ZV) sampled elevations as illustrated in Figure <a href="TwoD-Domains-1.html#fig:fig-image66">7.6</a>.
Using the traditional sampling approach, the topography of a cell is
treated as follows:</p>
<ul>
<li>The cell volume is represented as a square bucket with a flat
horizontal bed, and simply calculated as the cell centre depth times
the cell area.<br />
</li>
<li>The flow area across a cell face used for the momentum and mass
balance equations is simply represented as a rectangular section (i.e.
cell side centre depth times the cell width).<br />
</li>
<li>The bed resistance term in the momentum equation (e.g. Manning’s
equation) uses the Resistance Radius approach (i.e. the cell face
radius value as used in Manning’s equation is set to the depth and the
cell width or cell size is used for the wetted perimeter).</li>
</ul>
<!-- CDH I disagree, this isn't true. land-use is sampled at cell sizes. I assume soils are sampled at the cell centre only. I've commented the sentence out.  

The sampling of materials (land-use), soil and other data types is
performed in a similar manner. -->
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image66"></span>
<img src="images/image66a.png" alt="2D Cell Topography - Traditional Approach"  />
<p class="caption">
Figure 7.6: 2D Cell Topography - Traditional Approach
</p>
</div>
</div>
</div>
<div id="elevations-3" class="section level3 hasAnchor" number="7.3.5">
<h3><span class="header-section-number">7.3.5</span> Elevations<a href="TwoD-Domains-1.html#elevations-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>2D domain elevations are defined in the .tgc file. As mentioned in Section <a href="TwoD-Domains-1.html#layering-3">7.3.3</a>, a powerful feature of TUFLOW is its capacity to build the 2D elevations from any number of GIS layers and/or TINs. The typical approach adopted is as follows:</p>
<ol style="list-style-type: decimal">
<li>All elevations in the model start with an un-initialised value
of 99999. TUFLOW will output an error if any elevations of 99999 (or
higher) occur after the processing of the elevations. This is to
indicate that elevations in active cells have not been initialised
or set.</li>
<li>A default elevation is specified first in the .tgc file using <a href="TGCCommands-1.html#tgcSetZpt">Set
Zpt</a>. An inundation free elevation is usually specified.
If your elevation data sets are intended to cover your entire active
area this step can be omitted so as to trigger the error described
above in case elevation data are unintentionally missing (e.g.
unintended null areas in a DEM or accidental omission of a layer).</li>
<li>The elevations read directly from a DEM using <a href="TGCCommands-1.html#tgcReadGridZpts">Read Grid
Zpts</a>, or read from TIN in the SMS, 12D or
LandXML TIN formats (see <a href="TGCCommands-1.html#tgcReadTINZpts">Read TIN Zpts</a>).</li>
<li>If there are areas where data is either missing or erroneous, these
can easily be corrected via interpolation using <a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z
Shape</a> regions or polygons. This is achieved by
digitising a polygon around the missing or erroneous data. TUFLOW
interpolates elevations across the region based on the existing Zpts
around the perimeter of the polygon. An example is shown in
Section <a href="TwoD-Domains-1.html#zsh-4">7.3.5.2</a>. Missing or erroneous data often occurs with
aerial surveys where the sampling is in areas of thick vegetation,
water or where post processing has poorly filtered the removal of
elevated objects (e.g. buildings).</li>
<li>Sometimes there is a need to remove cut and fill works from the
topography. For example, model calibration often requires the
removal of infrastructure, such as levees, road embankments and developments that may not have existed at the time of the historic event to back date the
topography within the model. This is easily done using <a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z
Shape</a> by simply digitising polygons around the
various features.</li>
<li>The base elevations set up in the previous step(s) can be modified
to represent hydraulic controls, proposed works, failure of a flood
defence wall, etc. Some examples are:
<ul>
<li>The crests of road/rail embankments, levees, fences and other solid obstructions are easily inserted using <a href="TGCCommands-1.html#tgcReadGISZLine">Read GIS Z
Line</a>, <a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> or <a href="TGCCommands-1.html#tgcReadGISZHXLine">Read GIS Z HX Line</a>.
<a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> is particularly powerful as 3D
lines can be given a thickness making it very easy to quickly raise,
or lower, elevations along a road alignment or a diversion channel
where the width of the embankment/channel is wider than the 2D cell
size.<br />
</li>
<li>The proposed cut and fill for a development or other works can be
incorporated using <a href="TGCCommands-1.html#tgcReadGISZpt">Read GIS Zpts</a>, <a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z
Shape</a>, <a href="TGCCommands-1.html#tgcReadTINZpts">Read TIN Zpts</a> or <a href="TGCCommands-1.html#tgcCreateTINZpts">Create
TIN Zpts</a>. These powerful commands can set
elevations based on regions. Within regions TINs can be generated from
points and lines, and the perimeter of the TIN can be automatically
merged with the existing Zpts. A TIN of the cut and fill produced by
SMS or 12D can be read directly into TUFLOW using <a href="TGCCommands-1.html#tgcReadGISZpt">Read GIS
Zpts</a>.<br />
</li>
</ul></li>
<li>If there is a need to simulate the failure of a flood defence wall
or road/rail embankment, or the collapse of fences, <a href="TGCCommands-1.html#tgcReadGISVariableZShape">Read GIS
Variable Z Shape</a> can be used to control
the collapse of the embankment or fences over time. The collapse can
be triggered to occur at a specified time, when a water level
reached somewhere within the model, or based on the water level
difference between two locations.</li>
</ol>
<p>A 2D domain’s Zpts are built up using one or more of the commands shown
in Table <a href="TwoD-Domains-1.html#tab:tab-ZptCommands">7.4</a> and discussed in the following sections.</p>
<!-- PAR to EFC: can we re-order this so the common ones are at the top and and make it clear which ones such as read rowcol are legacy, not sure how to mark this have done Read RowCol in the spreadsheet by starting the description with "Legacy Command:" -->
<!-- EFC to PAR: yes, can we also move this to the end of the elvatins section? feels weird having it up here?-->
<!--EFC: moved-->
<!--PAR to EFC: move read tin up to under read grid-->
<!-- done-->
<table>
<caption>
<span id="tab:tab-ZptCommands">Table 7.4: </span><strong>2D Zpt Commands</strong>
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Command
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="TGCCommands-1.html#tgcSetZpt">Set Zpt</a>
</td>
<td style="text-align:left;">
Sets all Zpts over the whole 2D domain to the same value. Useful for providing an initial elevation prior to other commands as some Zpts in inactive (land) parts of the model may not receive a value. The default value for all Zpts is 99999. Every Zpt must be assigned a value, essentially making this command mandatory.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="TGCCommands-1.html#tgcReadGridZpts">Read Grid Zpts</a>
</td>
<td style="text-align:left;">
Directly interrogates a raster grid (e.g. tif, .flt or .asc) to define Zpt elevations. This command is similar to <a href="TGCCommands-1.html#tgcReadTINZpts">Read TIN Zpts</a> but works on a grid rather than a TIN.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="TGCCommands-1.html#tgcReadTINZpts">Read TIN Zpts</a>
</td>
<td style="text-align:left;">
Reading of a TIN to set the Zpt values within the TIN.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a>
</td>
<td style="text-align:left;">
<p>Powerful command to modify Zpt values using points, lines and polygons. Lines can vary in width from just the cell sides (thin), whole cells (thick) or be assigned a width (thickness). TINs are created within the polygons and incorporate elevations from points and lines that fall within the polygon. The perimeter of the polygon can be merged with the current Zpt values in part, or in its entirety.</p>
<a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> and <a href="TGCCommands-1.html#tgcCreateTINZpts">Create TIN Zpts</a> are excellent for removing bad data areas and for filling in null areas where the aerial survey has provided poor or no data. Another example is to remove buildings from a DEM.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="TGCCommands-1.html#tgcReadGISVariableZShape">Read GIS Variable Z Shape</a>
</td>
<td style="text-align:left;">
Allows the user to define the eroded 3D shape of a section of the 2D domain, specify the period for collapse, and how the collapse is triggered (i.e. at a specified time or when a water level is reached or when a water level difference is exceeded). Raising of the Zpts over time is also permitted (e.g. to model the influence of flood defences during an event or a landslide filling a river).
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="TGCCommands-1.html#tgcCreateTINZpts">Create TIN Zpts</a>
</td>
<td style="text-align:left;">
Useful for having TUFLOW create a TIN using polygons for TIN boundaries and points and lines within the polygons to create the TIN. If no points are snapped to the perimeter vertices of a polygon, the elevations around the polygon’s perimeter are merged with the current Zpt values. The resulting TIN can optionally be exported to SMS and 12D TIN formats.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="TGCCommands-1.html#tgcReadGISZLine">Read GIS Z Line</a>
</td>
<td style="text-align:left;">
This is a legacy feature and it is recommended to use the Z Shape functionality (Section <a href="TwoD-Domains-1.html#zsh-4">7.3.5.2</a>) instead.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="TGCCommands-1.html#tgcReadGISZHXLine">Read GIS Z HX Line</a>
</td>
<td style="text-align:left;">
Similar to <a href="TGCCommands-1.html#tgcReadGISZLine">Read GIS Z Line</a>, but uses HX lines and ZP points in a 2d_bc layer (see Table <a href="Boundaries-InitialConditions-1.html#tab:tab-ConditionsAttribute">8.6</a>) to adjust the 2D cell elevations along HX lines.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="TGCCommands-1.html#tgcReadGISZpt">Read GIS Zpts</a>
</td>
<td style="text-align:left;">
<p>Typically used for simple modifications of sections of the topography. Examples are filling an area (defined by a region or polygon object) to the same elevation or dredging (lowering) a section of river using <a href="TGCCommands-1.html#tgcReadGISZpt">Read GIS Zpts ADD</a>.</p>
<a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> offers greater functionality and may be preferable to using <a href="TGCCommands-1.html#tgcReadGISZpt">Read GIS Zpts</a> to modify Zpts.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="TCFCommands-1.html#tcfMaximumPoints">Maximum Points</a><br />
<a href="TCFCommands-1.html#tcfMaximumVertices">Maximum Vertices</a>
</td>
<td style="text-align:left;">
Use these commands to increase the maximum number of elevation points or maximum number of vertices in a single line or polygon.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="TGCCommands-1.html#tgcDefaultLandZ">Default Land Z</a>
</td>
<td style="text-align:left;">
Now rarely used in lieu of <a href="TGCCommands-1.html#tgcSetZpt">Set Zpt</a>.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="TGCCommands-1.html#tgcInterpolateZC">Interpolate ZC</a><br />
<a href="TGCCommands-1.html#tgcInterpolateZHC">Interpolate ZHC</a><br />
<a href="TGCCommands-1.html#tgcInterpolateZUV">Interpolate ZUV</a><br />
<a href="TGCCommands-1.html#tgcInterpolateZUVC">Interpolate ZUVC</a><br />
<a href="TGCCommands-1.html#tgcInterpolateZUVH">Interpolate ZUVH</a>
</td>
<td style="text-align:left;">
<p>Allows the interpolation of Zpts from other types of Zpts. Now rarely used as nearly all models assign values directly to all the Zpts. The original TUFLOW code only required input of ZH points, and Interpolate ZUVC provided a tool for interpolating the other Zpts.</p>
<p>Models with “bumpy” terrain, such as that from airborne laser surveys, might benefit from using Interpolate ZHC or Interpolate ZUV.</p>
Models through urban areas where the DTM includes the buildings may benefit from using Interpolate ZC ALL LOWER, which reduces the amount of cells that become blocked out due to high ZC elevations from buildings.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="TGCCommands-1.html#tgcZC">ZC</a> <teq>==</teq> MIN(ZU,ZV)
</td>
<td style="text-align:left;">
Rarely used. Sets the ZC (cell centre elevation) to the lower of the ZU and ZV (cell sides).
</td>
</tr>
</tbody>
</table>
<div id="DEMGrids-3" class="section level4 hasAnchor" number="7.3.5.1">
<h4><span class="header-section-number">7.3.5.1</span> Direct Reading of DEM Grids<a href="TwoD-Domains-1.html#DEMGrids-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The use of the .tgc command <a href="TGCCommands-1.html#tgcReadGridZpts">Read Grid Zpts</a> allows
TUFLOW to directly interrogate (point inspect) a DEM to set the Zpt
elevations. This command is similar to <a href="TGCCommands-1.html#tgcReadTINZpts">Read TIN Zpts</a>
but works on a grid rather than a TIN.</p>
<p>Grid formats currently supported are:</p>
<ul>
<li>GeoTIFF (.tif)</li>
<li>Geopackage raster (.gpkg)</li>
<li>Binary grid format (.flt/.hdr)</li>
<li>ESRI ASCII Grid format (.asc)</li>
</ul>
<p>Nearly all GIS software will support one of the above grid formats.</p>
<p>The GeoTIFF format is the default output format and preferred input format. It is faster to read and write compared to the .flt and .asc formats, and also supports compression. The format of grids can be converted (e.g. from .flt to .tif), the <a href="https://wiki.tuflow.com/Raster_Format_Conversion_Using_gdal_translate">Raster Format Conversion TUFLOW Wiki page</a> details how to do this.</p>
<p>Like other .tgc commands, the command <a href="TGCCommands-1.html#tgcReadGridZpts">Read Grid Zpts</a>
can be specified multiple times. An option to specify ADD, MIN or MAX in
the same way as for other similar commands is also available.</p>
<p>Clip regions can be specified as a second argument in the command <a href="TGCCommands-1.html#tgcReadGridZpts">Read
Grid Zpts</a> (and also <a href="TGCCommands-1.html#tgcReadTINZpts">Read TIN Zpts</a>)
by reading in a GIS layer containing one or more polygons to clip the
area of Zpts to be inspected. For example, the command below will only
assign elevations to Zpts that lie inside polygons within the
2d_clip_DEM layer:</p>
<p><tcmd><a href="TGCCommands-1.html#tgcReadGridZpts">Read Grid Zpts</a> </tcmd><teq>==</teq><tblk> grid\DEM_M01.tif | DEM\2d_clip_DEM.shp</tblk></p>
<p>The attributes of the clip layer are not used, and only polygons are
processed. As such, any of the TUFLOW empty files can be used as the
template for this layer. Polygons can have holes in them if required.</p>
<p>This is particularly useful for clipping out a TIN or DEM due to
unwanted or irregular triangulation around the periphery, especially for
secondary TINs/DEMs of proposed developments lying within the primary
TIN/DEM.</p>
<p><strong>Note: For your base Zpts from the primary DEM or TIN, do not clip this
with your active 2d_code layer as this will cause problems with Zpts
along any external 2d_bc boundaries. If no clip layer is specified, the
<a href="TGCCommands-1.html#tgcReadGridZpts">Read Grid Zpts</a> or <a href="TGCCommands-1.html#tgcReadTINZpts">Read TIN Zpts</a>
commands assign all Zpts falling within the Grid / TIN an elevation
irrespective of whether a cell is active or inactive.</strong></p>
<p>When reading grids into TUFLOW, the same interpolation approach occurs for all formats. The procedure TUFLOW follows is:</p>
<ul>
<li>The DEM elevation is assumed to be in the centre of the DEM grid cell (pixel), as shown by the four red circles in the picture below.</li>
<li>A midpoint vertex (green circle) is defined in the middle of the four DEM elevations.</li>
<li>The elevation of the midpoint vertex (green circle) is equal to the average of the four DEM elevations (red circles).</li>
<li>The DEM grid cell centre points (red circles) and midpoint vertex (green circle) are used to create a TIN.</li>
<li>Elevations within the TIN are interpolated from the associated TIN points. For example, a Zpt is included in the image below as a yellow point. The elevation assigned to that Zpt is the planar (linear) interpolation of the surrounding three elevation points associated with the top TIN triangle in the image.</li>
</ul>
<center>
<img src="images/InterpolationExample.png"  style="width:2.6in;height:2.4in"/>
</center>
</div>
<div id="zsh-4" class="section level4 hasAnchor" number="7.3.5.2">
<h4><span class="header-section-number">7.3.5.2</span> Z Shape Layers (2d_zsh)<a href="TwoD-Domains-1.html#zsh-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> offers a wide range of options for
manipulating and modifying the Zpt values. These include 3D breaklines
and TINs. Table <a href="TwoD-Domains-1.html#tab:tab-ZShapeAttribute">7.5</a> provides a description of the different 2d_zsh GIS layer attributes.</p>
<p>When a mixture of different shapes and shape options occur within the
same layer the following protocols are used to control how Zpt values
are modified.</p>
<ol style="list-style-type: decimal">
<li>The order in which objects are processed is:
<ol style="list-style-type: decimal">
<li><strong>Polygons:</strong> All polygons are triangulated according to the
process described for <a href="TGCCommands-1.html#tgcCreateTINZpts">Create TIN Zpts</a> in
Section <a href="TwoD-Domains-1.html#ztin-4">7.3.5.4</a>. The only difference to note is that if a
line is to be used for the TIN generation, the Shape_Options
attribute for the line must include the keyword “TIN”.<br />
</li>
<li><strong>Wide Lines:</strong> Wide lines are lines that have a
Shape_Width_or_dMax attribute value greater than 1.5 times the
2D <a href="TGCCommands-1.html#tgcCellSize">Cell Size</a>. A buffer polygon is created along
the line, and all Zpts falling within the buffer polygon are
assigned elevations based on a perpendicular intersection with
the line. Note that wide lines are processed in the order that
they occur in the GIS layer, so if the buffer polygons of two
wide lines overlap each other, the latter one prevails. In this
situation it would be wise to separate the two lines into two
different layers. Buffer polygons can be viewed in the
<a href="https://wiki.tuflow.com/Check_Files_2d_sh_obj">_sh_obj_check</a> layer.<br />
</li>
<li><strong>Thin and Thick Lines:</strong> Thin lines have a Shape_Width_or_dMax
value of zero and Thick lines a value less than or equal to 1.5
times the 2D <a href="TGCCommands-1.html#tgcCellSize">Cell Size</a>. For a more detailed
description of Thin and Thick lines see <a href="TGCCommands-1.html#tgcReadGISZLine">Read GIS Z
Line</a>. Thin and Thick lines are applied
depending on the Shape_Options attribute setting as follows:
<ol style="list-style-type: decimal">
<li>All ADD lines are applied first.<br />
</li>
<li>Followed by lines without any option (these will modify all
Zpts affected by the line).<br />
</li>
<li>Followed by GULLY, LOWER or MIN lines.<br />
</li>
<li>And finally, any RIDGE, RAISE or MAX lines.<br />
</li>
</ol></li>
</ol></li>
<li>The priority can of course be further controlled by using different
layers and controlling the order which layers are listed and
subsequently processed in the .tgc file.</li>
</ol>
<p>Some examples of using <a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> are given
below. Models set up using these topography update features are provided in the <a href="https://wiki.tuflow.com/TUFLOW_Example_Models#Topography_Features">Topography Features Example Model Dataset</a></p>
<p><strong>Example 1: Triangulating Elevations over a Null Area</strong></p>
<p>The image below shows an example of a DEM that is missing data over a
small area within the 2D domain. Gaps in DEM coverage can sometimes occur over
water bodies and occasionally between the tiles of ALS or LiDAR data
received from a third-party provider. An example of using the MERGE topography update feature is provided in the <a href="https://wiki.tuflow.com/Tutorial_M02">TUFLOW Tutorial Module 2</a></p>
<table>
<colgroup>
<col style="width: 39%" />
<col style="width: 60%" />
</colgroup>
<tbody>
<tr class="odd">
<td>
<img src="images/image83.png"
style="width:2.51in;height:2.27in" />
</td>
<td>
<p>
The .tgc command <a href="TGCCommands-1.html#tgcSetZpt">Set Zpt</a> may be used to
quickly and easily assign elevations to Zpts falling within these areas,
however the limitations of the command mean the same elevation will be
assigned to all null Zpts across the entire 2D domain. This may not be
suitable in situations where there are multiple gaps in coverage or
where the gap is located on steep terrain.
</p>
<p>
<a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> with 2d_zsh polygons may instead be used to triangulate Zpt values based on the Zpt elevations of the polygon perimeter.
</p>
</td>
</tr>
<tr class="odd">
<td>
<img src="images/image84.png"
style="width:2.57in;height:2.31in" />
</td>
<td>
<p>
Import in an empty 2d_zsh GIS layer, and digitise a polygon around
the gap in coverage as shown. Ensure there is a reasonable buffer around
the null area. The attributes of the polygon may be left blank.
Alternatively, a value may be entered in the “Shape_Width_or_dMax”
attribute to control the maximum distance between intermediate points
inserted around the polygon’s perimeter to interpolate elevations. When
left blank, this distance is half the 2D cell’s size.
</p>
</td>
</tr>
<tr class="odd">
<td>
<img src="images/image85.png"
style="width:2.42994in;height:2.3in" />
</td>
<td>
<p>
This image shows the resulting _DEM_Z.flt check file. The
<a href="https://wiki.tuflow.com/Check_Files_2d_zsh_zpt">_zsh_zpt_check</a> layer can be used to view the final Zpt elevation
assigned
</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Example 2: Use of the NO MERGE and ADD Shape Options</strong></p>
<p>The 2d_zsh NO MERGE option can be used to assign a single elevation to all Zpts
falling within the 2d_zsh polygon (read by the <a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> command). An example of using the NO MERGE topography update feature is provided in <a href="https://wiki.tuflow.com/Tutorial_M02">TUFLOW Tutorial Module 2</a>. This may be useful to set the
elevation of a polygon to a known finished floor level of a proposed
development. Digitise a polygon within an empty 2d_zsh GIS layer, and
populate the “Z” attribute of each object with the desired elevation.
Set the “Shape_Options” attribute to NO MERGE. The example below will
assign an elevation of 42.1mAHD to all Zpts located within the 2d_zsh
polygon.</p>
<center>
<img src="images/image86.png" />
</center>
<p>Note that if the NO MERGE option is omitted and no points are snapped to the perimeter of the polygon, the Z attribute will be ignored and the Zpt elevations will be triangulated based on the Zpt elevations of the polygon perimeter.</p>
<p>Alternatively, to raise the polygon by a fixed value (i.e. to represent
the slab height of a building) enter this value in the Z attribute and
set the “Shape_Options” to ADD. An example of using the ADD topography update feature is also provided in <a href="https://wiki.tuflow.com/Tutorial_M02">TUFLOW Tutorial Module 2</a>.</p>
<center>
<img src="images/image87.png"  />
</center>
<p>TUFLOW will add the value entered in the Z attribute to the existing Zpt elevations within the polygon. The entry within the figure to the left will raise Zpt elevations by 0.15m. The use of a negative value will lower the Zpt elevations by the value of the “Z” attribute. The <a href="http://wiki.tuflow.com/Check_Files_2d_zsh_zpt">_zsh_zpt_check</a> layer can be used to view the elevation points (Zpts) that have been modified.</p>
<p><strong>Example 3: Raising an Embankment</strong></p>
<p>The ADD option may also be used when the 2d_zsh object has been
digitised as a line. An example of using the ADD topography update feature is provided in <a href="https://wiki.tuflow.com/Tutorial_M02">TUFLOW Tutorial Module 2</a>. Populate the Z attribute with the amount the
embankment is to be raised by. Populate the “Shape_Options” attribute
with ADD as shown in the second figure of Example 2 above. This will
raise the existing Zpt elevations by the value of the Z attribute. By
default, TUFLOW will assume a thin line, and only alter the ZH, ZU and
ZV Zpt elevations of a cell. The “Shape_Width_or_dMax” attribute may be
optionally specified to represent a THICK or a WIDE line (refer to
Section <a href="TwoD-Domains-1.html#zsh-4">7.3.5.2</a>).</p>
<p>Alternatively, if a 3D breakline has been digitised, the dZ attribute on
the snapped points may be used to raise or lower the embankment. The dZ
attribute increases or decreases the elevation of the point’s Z
attribute by the amount of dZ. In the example below, a 3D breakline has
been created by snapping points to either end of the line. The
elevations along the line are determined by a linear interpolation of
the Z attribute of the points. Entering a positive dZ value at each
point will raise the elevations at the points by the amount of dZ at
each point (0.2m for one of the points in the figure below). The
elevations along the line are then interpolated based on these revised
values. The <a href="https://wiki.tuflow.com/Check_Files_2d_zsh_zpt">_zsh_zpt_check</a> layer can be used to view the final Zpt
elevation assigned.</p>
<center>
<img src="images/image88.png" /><img src="images/image89.png" />
</center>
<p><strong>Example 4: Removing ridges from a poorly triangulated DEM.</strong></p>
<table>
<colgroup>
<col style="width: 39%" />
<col style="width: 60%" />
</colgroup>
<tbody>
<tr class="odd">
<td>
<img src="images/image90.png"
style="width:2.93in;height:2.65in" />
</td>
<td>
<p>
The image shows two false ridges indicated by the H letters.
These were caused by a poor triangulation by the TIN software used to
create the DEM. These ridges caused unrealistic flow patterns, as shown
by the velocity vectors.
</p>
<p>
Note, The blue cells at the bottom are the downstream boundary
cells.
</p>
</td>
</tr>
<tr class="even">
<td>
<img src="images/image91.png"
style="width:2.93in;height:2.65in" />
</td>
<td>
This image is of the <a href="https://wiki.tuflow.com/Check_Files_2d_DEM_Z">DEM_Z</a> and <a href="https://wiki.tuflow.com/Check_Files_2d_zpt">_zpt_check</a> check file layers
from the TUFLOW simulation. This is how TUFLOW interprets the DEM data. The false ridges are clearly shown.
</td>
</tr>
<tr class="odd">
<td>
<img src="images/image92.png"
style="width:2.95in;height:2.66in" />
</td>
<td>
<p>
To remove the ridges, import an empty 2d_zsh layer, and digitise
a polygon around the ridges as shown. By default (i.e. using the default
attribute values), the elevations assigned around the perimeter of the
polygon are interpolated from the current Zpt values.
</p>
<p>
One problem with this approach is that the elevations along the
right-hand side (i.e. along the edge of the floodplain between Locations
A and B) are interpolated from the high Zpts along this
boundary.
</p>
</td>
</tr>
<tr class="even">
<td>
<img src="images/image93.png"
style="width:2.92in;height:2.64in" />
</td>
<td>
To solve this problem, digitise points either into the 2d_zsh layer
or into a 2d_zsh…_pts layer that snap to the vertices of the polygon
where the high elevations occur. Assign a Z attribute of -99999 to each
point, as shown in the image. The -99999 indicates to not interpolate an
elevation from the existing Zpts. Instead, the elevations at Locations A
and B are used to interpolate elevations at vertices where -99999 has
been assigned.
</td>
</tr>
<tr class="odd">
<td>
<img src="images/image94.png"
style="width:2.93in;height:2.64in" />
</td>
<td>
Use <a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> to process the
polygon and points and generate the TIN as shown in the image. The TIN
can be viewed by importing the <a href="https://wiki.tuflow.com/Check_Files_2d_sh_obj">_sh_obj_check</a> GIS layer.
</td>
</tr>
<tr class="even">
<td>
<img src="images/image95.png"
style="width:2.97in;height:2.68in" />
</td>
<td>
This image shows the new <a href="https://wiki.tuflow.com/Check_Files_2d_DEM_Z">DEM_Z</a> check file after the above 2d_zsh layer has been applied. As can be seen, the ridges have been removed and the flow patterns are now realistic.
</td>
</tr>
</tbody>
</table>
<p><strong>Example 5: Highway Embankment Removal Example</strong></p>
<p>The figures below present another example where a new highway, which
exists in the DEM, needed to be removed because the calibration flood
events occurred before the highway was built. Removal of the highway
only required the digitising of a 2d_zsh polygon around the highway. All
attributes were left as their defaults, and there was no need to specify
any elevation points. This example then used an additional Z shape line and point feature to reflect the existing highways topography (using the method discussed in Example 3). Either <a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> or <a href="TGCCommands-1.html#tgcCreateTINZpts">Create TIN Zpts</a> can be used for this purpose.</p>
<center>
<img src="images/zshape-highway-removal.png"/>
</center>
<table>
<caption>
<span id="tab:tab-ZShapeAttribute">Table 7.5: </span><strong>2D Z-Shape (2d_zsh) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:left;">
<p><b>Point:</b><br />
Elevation of the point. Points are only used to assign elevations along lines and polygon perimeters, or for the creation of TINs within polygons. They do not modify Zpts directly.</p>
<p>An elevation of -99999 has a special meaning when the point is snapped to a vertex of a polygon. The -99999 indicates to ignore the elevation at that vertex and of any automatically inserted vertices between that vertex and the two neighbouring vertices. Instead the elevations are based on the elevations of the neighbouring vertices. If a neighbouring vertex also has a -99999 point snapped to it, the next vertex is used, and so on. This feature is very useful, as illustrated in the example above.</p>
<p><b>Line:</b><br />
Elevation of the line if no points are snapped to the line.</p>
<p>If the ADD option is specified, the value entered is used to increase (positive ‘Z’ values) or decrease (negative ‘Z’ values) the elevation of the Zpt values by the amount specified (i.e. a value of 0.5 will raise existing Zpt values by 0.5m).</p>
<p>Otherwise ignored.</p>
<p><b>Polygon:</b><br />
If the NO MERGE option is specified, used to set the elevation of the polygon perimeter if there are no points snapped to the perimeter.</p>
<p>If the ADD option is specified, the value entered is used to increase (positive ‘Z’ values) or decrease (negative ‘Z’ values) the elevation of the Zpt values by the amount specified.</p>
Otherwise ignored.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
dZ
</td>
<td style="text-align:left;">
<p><b>Point:</b><br />
Change in elevation of the ‘Z’ attribute of the z-shape object at the point. To leave ‘Z’ unchanged, set to zero. Useful for easily adjusting the height of the shape object without having to change the original ‘Z’ value. For example, if the Z attribute has been set to 5mAHD, a dZ value of 0.1m will raise the point’s Z elevation to 5.1mAHD.</p>
<p><b>Line:</b><br />
Not used. Recommend setting to zero.</p>
<b>Polygon:</b><br />
Not used. Recommend setting to zero.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Shape_Width_or_dMax
</td>
<td style="text-align:left;">
<p><b>Point:</b> Not used.</p>
<p><b>Line (no TIN):</b><br />
Provided “TIN” is not specified for the Shape_Options attribute, this attribute specifies the width (thickness) of the breakline in metres. If equal to zero, only the elevations along the cell sides and corners are adjusted (i.e. a thin breakline). If less than or equal to 1.5 times the 2D <a href="TGCCommands-1.html#tgcCellSize">Cell Size</a>, a line of whole cells is adjusted (i.e. a thick line). Otherwise all Zpts within a distance of half Shape_Width_or_dMax are adjusted.</p>
<p><b>Line (TIN):</b><br />
If “TIN” is specified for the Shape_Options attribute, this attribute controls the maximum distance between automatically added intermediate vertices. If set to zero, half the 2D domain’s <a href="TGCCommands-1.html#tgcCellSize">Cell Size</a> is used. If less than zero no intermediate vertices are inserted.</p>
<p><b>Polygon:</b><br />
The maximum distance between intermediate points inserted around the polygon’s perimeter to interpolate elevations from the current Zpts. If set to zero, half the 2D <a href="TGCCommands-1.html#tgcCellSize">Cell Size</a> is used. If less than zero no intermediate vertices are inserted.</p>
Not used if the NO MERGE or ADD options are specified.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Shape_Options
</td>
<td style="text-align:left;">
<p><b>Point:</b> Not used.</p>
<p><b>Line or Polygon:</b><br />
ADD: Add the shape’s ‘Z’ attribute value to the current Zpts. If ADD is specified, any automatic merging around the region perimeter is ignored (to merge the perimeter with existing Zpts when using the ADD option, specify a value of zero for the Z and dZ attributes for the region).</p>
<p>MAX, RIDGE or RAISE: Only changes a Zpt elevation if the Z Shape elevation at the Zpt is higher.</p>
<p>MIN, GULLY or LOWER: Only changes a Zpt elevation if the Z Shape elevation at the Zpt is lower.</p>
<p><b>Line Only:</b><br />
TIN: Indicates the line is only to be used for of generation of TINS from polygons (therefore, only sections of TIN lines that fall within the polygon(s) are used).</p>
<p><b>Polygon Only:</b><br />
If none of the options below are specified, the elevations at perimeter vertices that do not have an elevation point snapped to them are merged with the current Zpt values.</p>
<p>MERGE ALL: Ignores elevations from any points snapped to the perimeter and merges all perimeter vertices with the current Zpt values.</p>
NO MERGE: Does not merge the perimeter elevations with the current Zpt values.
</td>
<td style="text-align:left;">
Char(20)
</td>
</tr>
</tbody>
</table>
</div>
<div id="vzsh-4" class="section level4 hasAnchor" number="7.3.5.3">
<h4><span class="header-section-number">7.3.5.3</span> Variable Z Shape Layer (2d_vzsh)<a href="TwoD-Domains-1.html#vzsh-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>TUFLOW 2D model topography can be varied over time to simulate breaching
of embankments, raising of flood defences during an event, or the filling of a river due to a landslide, by
using <a href="TGCCommands-1.html#tgcReadGISVariableZShape">Read GIS Variable Z Shape</a>. The 2d_vzsh
layer is used to define the final topographic shape at the end of the topography change period. As summary of the GIS layer attributes is provided in Table <a href="TwoD-Domains-1.html#tab:tab-twoDVariable">7.6</a>. The first four attributes of 2d_vzsh are the same as the 2d_zsh layer. They are used to define the finished state of the variable geometry. Additional attributes have been added to allow the user to define
how/when the breach commences and for how long. The breach/fill can be
triggered using a number of methods:</p>
<ul>
<li>At a specified time (example provided in <a href="https://wiki.tuflow.com/Tutorial_M10#Part_1_-_2D_Variable_Geometry_Time_Trigger">TUFLOW Tutorial Module 10 - Part 1</a>);<br />
</li>
<li>When the water level reaches a specified height at a specified
(trigger) location (example provided in <a href="https://wiki.tuflow.com/Tutorial_M10#Part_2_-_2D_Variable_Geometry_Water_Level_Trigger">TUFLOW Tutorial Module 10 - Part 2</a>); or<br />
</li>
<li>When the water level difference between two triggers exceeds a
specified amount.</li>
</ul>
<p>Variable Z Shapes can be restored once or repeatedly. Examples would be
a breach of a flood defence wall or levee that is reinstated 6 hours
later, or a sand bar of a creek entrance that repeatedly opens and
closes. To use the restore feature, two additional attributes
Restore_Interval and Restore_Period are required as described below in
Table <a href="TwoD-Domains-1.html#tab:tab-twoDVariable">7.6</a>. For a single restoration event, only these two additional attributes are required. To restore repeatedly, “REPEAT” must be
specified in the Shape Options in column 4. Repeated restoration is only
possible for the water level and water level difference trigger methods,
as a time trigger will not be able to be reached on a second occasion.</p>
<p>Note, this variable geometry feature should be used instead of the 2d_bc VG option (unless the rate of change of the erosion/fill is non-linear) as 2d_vzsh layers are easier to define and manage.</p>
<table>
<caption>
<span id="tab:tab-twoDVariable">Table 7.6: </span><strong>2D Variable Z-Shape (2d_vzsh) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:left;">
Same as for Table <a href="TwoD-Domains-1.html#tab:tab-ZShapeAttribute">7.5</a>.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
dZ
</td>
<td style="text-align:left;">
<p>Same as for Table <a href="TwoD-Domains-1.html#tab:tab-ZShapeAttribute">7.5</a>.<br />
The exception is for a thin line, for which the final elevations along the line can be set to dZ metres above the current Zpt values.</p>
For example, if a thin line represents a fence that is being collapsed, and the finished height of the collapsed fence is to be 0.2m above existing ground levels, specify a dZ value of 0.2. Note this only applies if the NO MERGE Shape_Options has not been specified.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Shape_Width_or_dMax
</td>
<td style="text-align:left;">
Same as for Table <a href="TwoD-Domains-1.html#tab:tab-ZShapeAttribute">7.5</a>.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Shape_Options
</td>
<td style="text-align:left;">
<p><b>Point:</b></p>
<p>TRIGGER or TRIGGER 1D: Indicates the point is not an elevation point, but a trigger location. The trigger must be given a name using the Trigger_1 attribute. TRIGGER 1D is required if a 1D node water level is used to trigger a 2D variable Z-Shape. The trigger point must be snapped to the 1D node or channel end in the 2d_vzsh layer to achieve this.</p>
<p><b>Line or Polygon:</b> Same as for Table <a href="TwoD-Domains-1.html#tab:tab-ZShapeAttribute">7.5</a>. Except the ADD option is not supported.</p>
<p>REPEAT: Specify this option for the variable Z shape to repeatedly function indefinitely based on the below trigger and restore attributes.</p>
<p><b>Thin Line:</b></p>
<p>NO MERGE: For thin lines (Shape_Width_or_dMax = 0), the final elevations along the line are as specified. If NO MERGE is not specified for a thin line, the final elevations are set to be the same as the current Zpt values plus the dZ value.</p>
REPEAT: Specify this option for the variable Z shape to repeatedly function indefinitely based on the below trigger and restore attributes.
</td>
<td style="text-align:left;">
Char(20)
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
Trigger_1
</td>
<td style="text-align:left;">
<p><b>Point:</b> If Shape_Options is set to TRIGGER or TRIGGER 1D, enter the name of the trigger location. The name can contain any characters and can include spaces. Otherwise not used.</p>
<p><b>Line or Polygon:</b> To commence the failure at a specified time leave blank.</p>
<p>To commence failure based on reaching a water level elsewhere in the model, enter the name of the trigger location.</p>
<b>Thin Line:</b> For thin lines there are two special options as follows. Specify DEPTH to have the failure commence once the depth of water adjacent to the cell side exceeds the amount specified for Trigger_Value. Specify DEPTH DIFF to have the failure commence once the difference in water level across the cell side exceeds the amount specified for Trigger_Value.
</td>
<td style="text-align:left;">
Char(20)
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
Trigger_2
</td>
<td style="text-align:left;">
<p><b>Point:</b> Not used.</p>
<b>Line or Polygon:</b> The name of a second trigger location (only needed if the breach is to be initiated on a water level difference between two trigger locations).
</td>
<td style="text-align:left;">
Char(20)
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
Trigger_Value
</td>
<td style="text-align:left;">
<p><b>Point:</b> Not used.</p>
<p><b>Line or Polygon:</b> If Trigger_1 is blank, the simulation time in hours that the breach is to commence.</p>
<p>If Trigger_1 is specified and Trigger_2 is left blank, the water level at Trigger_1 that needs to be reached to trigger the failure.</p>
<p>If both Trigger_1 and Trigger_2 are specified, the water level difference between Trigger_1 and Trigger_2 that needs to be exceeded to trigger the failure. The water level difference is taken as the absolute of the difference between Trigger_1 and Trigger_2, so there is no need to specify a negative value.</p>
<p><b>Thin Line:</b></p>
<p>If “DEPTH” is specified for Trigger_1, the depth in metres adjacent to the cell side that needs to be exceeded to trigger the failure at the cell side.</p>
<p>If “DEPTH DIFF” is specified for Trigger_1, the water level difference in metres across the cell side that needs to be exceeded to trigger the failure.</p>
For all of the above options the length units are metres if modelling in SI units, or feet, if using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a> </tcmd><teq>==</teq><tblk> US Customary</tblk>.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
Period
</td>
<td style="text-align:left;">
<p><b>Point:</b> Not used.</p>
<b>Line or Polygon:</b> Time in hours over which the variation in Zpt elevations occurs.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
Restore_Interval
</td>
<td style="text-align:left;">
<p>The time in hours between when the variable Z shape has finished altering the geometry and when to start restoring the Zpts back to their original values.</p>
<b>Note:</b> “REPEAT” must be specified in Column 4 to allow repeated triggering and restoration of the Variable Z Shape (for the water level and water level difference options), otherwise restoration will only occur once.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
Restore_Period
</td>
<td style="text-align:left;">
Time in hours over which the variation in Zpt elevations occurs to restore the Zpts back to their original values.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
</tbody>
</table>
<p><strong>Example 1: Variable Z Shape Example: Breaching of an Embankment</strong></p>
<p>The image below shows an example of a 2d_vzsh layer. The solid magenta
line is the polygon, the magenta dashed lines are lines used to
enforce TIN breaklines, and the four magenta points all have an
elevation of 41.0m. The Shape_Options attribute for the polygon was set
to MIN (this means that the Zpt elevation can only be lowered (i.e.
eroded), and the dashed lines have Shape_Options of TIN (to indicate
that they are to be used for TIN generation, and not for Z lines). The
vertices of the polygon that do not have a point snapped to them will be automatically assigned an elevation based on the existing Zpt values. The polygon
vertices with the points snapped to them are assigned the elevation of
the point (in this case, all at 41.0m). The elevation of the dashed
lines will be constant at 41m as they are snapped to the 41m points.</p>
<p>The only other object in the layer is the yellow pin point labelled A.
This is a trigger point. Its only attribute values are: TRIGGER for
the Shape_Options attribute; and A for the Trigger_1 attribute. This sets
the point as a trigger point and the “A” is the name of the trigger
point. The magenta polygon also has attribute values of: A for Trigger_1
(this indicates that the erosion trigger is based on the water level at
Trigger Location A); a Trigger_Value of 42.0 (i.e. when the water level
at location A reaches 42m, start the erosion); and a Period value of 1.0
indicating that the erosion takes one hour to complete.</p>
<center>
<img src="images/image96.png"
style="width:5.33627in;height:3.23684in" />
</center>
<p>The final eroded Zpt values are based on the TIN created by TUFLOW (the
grey triangles in the image below). The central section will be
horizontal at 41m, sloping up either end to elevations based on the road
level. The <a href="https://wiki.tuflow.com/Check_Files_2d_vzsh">_vzsh_zpt_check</a> layer is useful to view the Zpts
affected by the variable Z shape. This layer is also shown in the image
below. The green triangles indicate that the Zpt level is to be eroded,
and the crosses indicate no change (this is because of the MIN
Shape_Options). The final eroded Zpt values are labelled in the image
below. Other useful attributes are also available in this layer.</p>
<center>
<img src="images/image97.jpeg" style="width:5.43972in;height:3.04408in"
alt="ZSH Example 2" />
</center>
<p>The images below show the modelled breach which occurs using the example
above. Each image is in half hour intervals. The colour shading is of
the elevations (specify ZH as a <a href="TCFCommands-1.html#tcfMapOutputDataTypes">Map Output Data
Types</a> to view the changes in ground level over
time).</p>
<center>
<img src="images/image98.png" style="width:2.96in;height:2.07in" />
<img src="images/image99.png" style="width:2.96in;height:2.07in" />
</center>
<center>
<img src="images/image100.png"
style="width:2.98237in;height:2.09378in" />
<img src="images/image101.png" style="width:2.96in;height:2.08in" />
</center>
</div>
<div id="ztin-4" class="section level4 hasAnchor" number="7.3.5.4">
<h4><span class="header-section-number">7.3.5.4</span> 3D TIN Layers (2d_ztin)<a href="TwoD-Domains-1.html#ztin-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<!-- PAR to EFC: remove first example, replace with text and link to example models.  Second example move to 2d zsh section. Update so 3 panels rather than 4 panels-->
<!--done-->
<p>TINs (triangulations) of elevation points and 3D lines within a polygon
can be carried out using <a href="TGCCommands-1.html#tgcCreateTINZpts">Create TIN Zpts</a>. This is
particularly useful for modifying the Zpt elevations where there have
been, or are proposed, changes to the base DEM Zpt values.</p>
<p>Note, for large datasets it is likely to be much more efficient to use GIS or 3D surface modelling software to triangulate the data, and read triangulated data in a supported format (see <a href="TGCCommands-1.html#tgcReadTINZpts">Read TIN Zpts</a>) or to convert to raster (see <a href="TGCCommands-1.html#tgcReadGridZpts">Read Grid Zpts</a>).</p>
<p>The protocols applied to the <a href="TGCCommands-1.html#tgcCreateTINZpts">Create TIN Zpts</a>
command are:</p>
<ol style="list-style-type: decimal">
<li>A TIN is created for each polygon in the 2d_ztin layer.<br />
</li>
<li>Any points found within a polygon are used when generating the TIN.<br />
</li>
<li>Any lines are converted to points, and those points falling within
the polygon are used for the TIN creation. Lines are converted to
points as follows:
<ol style="list-style-type: decimal">
<li>All vertices (nodes) of the line are converted to points.<br />
</li>
<li>The dMax attribute is used to insert additional vertices between
the line’s vertices. For example, if dMax is set to 10, then
additional intermediate vertices are inserted at least every 10
metres (or feet if using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd><teq> == </teq><tblk> US Customary</tblk>) between the existing vertices where the distance between
the existing vertices exceeds this value. If the dMax attribute does
not exist or is zero, half the 2D domain’s <a href="TGCCommands-1.html#tgcCellSize">Cell
Size</a> is used as the dMax value.<br />
</li>
<li>If there are any points snapped to the line’s vertices, the
elevations of these points are used to set the elevations at all
the vertices generated along the line. In this way, a 3D
breakline effect can be produced within the TIN. If there are no
points snapped to the line, the line’s Z attribute elevation is
used giving the effect of a horizontal line.<br />
</li>
</ol></li>
<li>The perimeter of the polygon/TIN can either be merged with the
current Zpt values or have its own values as follows:
<ol style="list-style-type: decimal">
<li>If there are no points snapped to the perimeter of the polygon,
the elevations of the polygon’s perimeter vertices, and of any
automatically inserted vertices, are based on the current Zpt
values (i.e. the Zpt values assigned by any prior commands).<br />
</li>
<li>If there are one or more points snapped to the polygon’s
perimeter vertices, the perimeter is not merged with the Zpt
values, and the elevations of the snapped points are used to
assign elevations to the perimeter vertices and any
automatically inserted vertices.<br />
</li>
<li>The frequency of any automatically inserted points around the
perimeter is controlled by the dMax attribute. If the dMax
attribute does not exist or is zero, half the 2D domain’s <a href="TGCCommands-1.html#tgcCellSize">Cell
Size</a> is used.</li>
</ol></li>
</ol>
<p>Models using the <a href="TGCCommands-1.html#tgcCreateTINZpts">Create TIN Zpts</a> functionality are provided in the <a href="https://wiki.tuflow.com/TUFLOW_Example_Models#Topography_Features">Static Topography Updates Example Model Dataset</a> on the TUFLOW Wiki.</p>
<p>A useful quality control option of <a href="TGCCommands-1.html#tgcCreateTINZpts">Create TIN Zpts</a>
is the WRITE TIN option. If this option is specified, a SMS .tin file is
written for each TIN generated, and the triangles are written to the
<a href="https://wiki.tuflow.com/Check_Files_2d_sh_obj">_sh_obj_check</a> layer. This means that the TIN can be cross-checked
in SMS, viewed in 3D, and edited and modified if desired. <a href="TGCCommands-1.html#tgcReadTINZpts">Read TIN
Zpts</a> can be used to assign Zpt elevations from the
modified SMS TIN.</p>
<p>A second argument to specify a GIS layer containing one or more polygons
to clip the area of Zpts to be inspected can be used with the <a href="TGCCommands-1.html#tgcReadTINZpts">Read TIN
Zpts</a> command. Refer to Section <a href="TwoD-Domains-1.html#DEMGrids-3">7.3.5.1</a> for more information.</p>
<table>
<caption>
<span id="tab:tab-TinAttribute">Table 7.7: </span><strong>2D Tin (2d_ztin) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:left;">
<p><b>Point:</b> Elevation of the point.</p>
<p><b>Line:</b> Elevation of the line. Ignored if there are any points snapped to the line’s vertices.</p>
<b>Polygon:</b> Not used.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
dMax
(optional)
</td>
<td style="text-align:left;">
<p><b>Point:</b> Not used.</p>
<p><b>Line:</b> Maximum distance between automatically created intermediate vertices. If set to zero or this attribute does not exist, half the 2D domain’s <a href="TGCCommands-1.html#tgcCellSize">Cell Size</a> is used. If less than zero no intermediate vertices are inserted.</p>
<b>Polygon:</b> Same as for Line above.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
</tbody>
</table>
<!--EFC to PAR: how much to we need to update below? Still refers to mif. Would it be equivalent if I change to shp?-->
<!--PAR to EFC: remove entire example-->
<!-- CAD package export out a TIN and use read tin rather than this example. Change to -->
<!--
**Example 1: Haul Road Example of Using Create TIN Zpts**

The images and text below illustrate an example of using [Create TIN
Zpts](#tgcCreateTINZpts) to easily incorporate a proposed haul road into
a TUFLOW model. [Read GIS Z Shape](#tgcReadGISZShape) can also be used in
a similar manner. The data for this example was provided courtesy of
[Hatch](https://www.hatch.com/).

The image below shows the base DEM and a layer of points provided from a
civil design CAD package in XYZ format. The points represent a proposed
haul road to be built across the floodplain.

<center><img src="images/image74.png" style="width:6in;height:3.63542in" /></center>

The points were copied into a MapInfo layer named
2d_ztin_haul_road_pts.tab, with the only attribute being the Elevation
attribute that contains the Z values. A new layer was created and named
2d_ztin_haul_road.tab, and the polygon shown as the black solid line in
the image below was digitised. Note the polygon does not need to snap to
any of the points and can be digitised roughly. Alternatively, the
points and polygon can be placed in the same layer if desired.

<center><img src="images/image75.png" style="width:6in;height:3.63542in" /></center>

[Create TIN Zpts](#tgcCreateTINZpts) == 2d_ztin_haul_road.shp was used
to have TUFLOW create a TIN within the polygon as shown in the image
below and override the DEM Zpt values.

<center><img src="images/image76.png" style="width:6in;height:3.63542in" /></center>

The image below is of a DEM created from the TUFLOW Zpts with the
polygon shown in grey. As can be seen the haul road TIN has merged
seamlessly with the existing Zpts from the base DEM.

<center><img src="images/image77.png" style="width:6in;height:3.63542in" /></center>

The WRITE TIN option (see [Create TIN Zpts](#tgcCreateTINZpts)) can be
used to write the TUFLOW TIN as a SMS .tin file. This file can be opened
in SMS for viewing and editing the TIN. The image below shows the haul
road TIN in 3D. If the TIN is modified, [Read TIN Zpts](#tgcReadTINZpts)
can be used to read the TIN back into TUFLOW.

<center><img src="images/image78.png"
style="width:6.29167in;height:3.96875in" /></center>
-->
</div>
<div id="zln-4" class="section level4 hasAnchor" number="7.3.5.5">
<h4><span class="header-section-number">7.3.5.5</span> 3D Breakline Layers (2d_zln)<a href="TwoD-Domains-1.html#zln-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is a legacy feature and it is recommended to use the Z Shape functionality (Section <a href="TwoD-Domains-1.html#zsh-4">7.3.5.2</a>) instead. For details on this feature see <a href="TGCCommands-1.html#tgcReadGISZLine">Read GIS Z Line</a> in Appendix <a href="TGCCommands-1.html#TGCCommands-1">C</a>.</p>
</div>
<div id="zpt-4" class="section level4 hasAnchor" number="7.3.5.6">
<h4><span class="header-section-number">7.3.5.6</span> Zpt Layers (2d_zpt)<a href="TwoD-Domains-1.html#zpt-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is a legacy feature, to define base elevations it is recommended to use the <a href="TGCCommands-1.html#tgcReadGridZpts">Read Grid Zpts</a> functionality (Section <a href="TwoD-Domains-1.html#DEMGrids-3">7.3.5.1</a>) instead. For details on this legacy feature see <a href="TGCCommands-1.html#tgcReadRowColGrid">Read RowCol Zpts</a> in Appendix <a href="TGCCommands-1.html#TGCCommands-1">C</a>.</p>
<p>Similarly, <a href="tgcReadGISZpt">Read GIS Zpts</a> is also a legacy command. It is recommended to use the Z Shape functionality (Section <a href="TwoD-Domains-1.html#zsh-4">7.3.5.2</a>) instead of it.</p>
</div>
<div id="using-multiple-layers-and-points-layers" class="section level4 hasAnchor" number="7.3.5.7">
<h4><span class="header-section-number">7.3.5.7</span> Using Multiple Layers and Points Layers<a href="TwoD-Domains-1.html#using-multiple-layers-and-points-layers" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>GIS layers used for <a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a>, <a href="TGCCommands-1.html#tgcReadGISVariableZShape">Read GIS Variable Z
Shape</a>, <a href="TGCCommands-1.html#tgcCreateTINZpts">Create TIN Zpts</a>, <a href="TGCCommands-1.html#tgcReadGISLayeredFCShape">Read GIS Layered FC Shape</a>, <a href="TGCCommands-1.html#tgcReadGISZLine">Read GIS Z Line</a> (legacy), <a href="TGCCommands-1.html#tgcReadGISZHXLine">Read GIS Z HX Line</a> (legacy) and <a href="TGCCommands-1.html#tgcReadGISFCShape">Read GIS FC Shape</a> (legacy) can be split into more than one layer to better manage the variety of data these commands sometimes require.</p>
<p>For example, one layer may contain the elevation points, another the TIN
lines and polygons and another the 3D Z lines. This is useful in terms
of managing the data, and especially when interrogating and/or viewing
the data in GIS. It is a requirement of the shapefile format that the
different geometries (points, lines and regions) are in separate
shapefiles. The TUFLOW empty template files include the following
filename suffixes to differentiate which files are suitable for point,
line or region features.</p>
<ul>
<li>_P for point features (e.g. 2d_zsh_M03_002_P.shp)<br />
</li>
<li>_L for line features (e.g. 2d_zsh_M03_002_L.shp)<br />
</li>
<li>_R for region or polygon features (e.g. 2d_zsh_M03_002_R.shp)</li>
</ul>
<p>This is optional for MapInfo users; the different geometries can occur
in the same MapInfo file or can be separated if preferred.</p>
<p>A maximum of nine (9) layers per command line is allowed, and each layer
is separated by a vertical bar (“|”). For example, to read a Z Shape
layer which has both line and points, the command may be:</p>
<p><tcmd><a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a></tcmd><teq> == </teq><tblk>gis\2d_zsh_M03_002_L.shp | gis\2d_zsh_M03_002_P.shp</tblk></p>
<p>If using the GeoPackage format &amp;&amp; is also used to specify more than one layer from a common database in the same command line. An example is provided below. See Section <a href="ControlFiles-and-Inputs-1.html#GPKG-3">4.4.3</a> for further details.</p>
<p><tcmd><a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a></tcmd><teq> ==</teq> <tblk>gis\2d_zsh_R.gpkg | gis\2d_zsh_002.gpkg &gt;&gt; 2d_zsh_L &amp;&amp; 2d_zsh_P</tblk></p>
<div id="point-only-5" class="section level5 hasAnchor" number="7.3.5.7.1">
<h5><span class="header-section-number">7.3.5.7.1</span> Point Only Layers<a href="TwoD-Domains-1.html#point-only-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To minimise the number of attributes, some/all points may optionally be
placed into a separate layer with less attributes as discussed below.
This simplifies the datasets making them easier to manage and
interrogate.</p>
<p>A layer is treated as a separate points layer if:</p>
<ol style="list-style-type: decimal">
<li>It has less attributes than the minimum required for the command.
For most commands there is only one attribute for the points layer
(i.e. Elevation or Z) as described in Table <a href="TwoD-Domains-1.html#tab:tab-twoDZAttribute">7.8</a>. The
exception is <a href="TGCCommands-1.html#tgcReadGISFCShape">Read GIS FC Shape</a>, which
requires the first two attributes. This option requires that the
points layer be defined within the command line syntax. For example:<br />
<tcmd><a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a></tcmd><teq> == </teq><tblk>gis\2d_zsh_M03_002_L.shp | gis\2d_zsh_M03_002_P.shp</tblk><br />
</li>
<li>The points file uses the same filename as the associated line or
region file with the addition of “_pts” as a suffix to its filename
(for example 2d_zsh_M03_002_pts.shp will be automatically associated
with the line file 2d_zsh_M03_002.shp). This option is supported for
backward compatibility; however, it’s recommended that this option
not be used (it is preferable to enter the filename of the second
layer so that it is clear as to which layers are being used).<br />
<tcmd><a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a></tcmd><teq> == </teq><tblk>gis\2d_zsh_M03_002.shp</tblk></li>
</ol>
<p>The data processing logic for points layers is outlined below:</p>
<ol style="list-style-type: decimal">
<li>The specified layer, 2d_zsh_M03_002.shp, is opened. This layer may
or may not contain elevation points. If any elevation points exist
they are used.<br />
</li>
<li>A separate points layer can optionally be used to specify additional
points or all of the points. The layer can be specified in one of
two ways:
<ol style="list-style-type: decimal">
<li>Entering the pathname of the points layer after the main layer.
A “|” must be used to separate the two layers. The points layer
must be the second layer specified. For example:<br />
<tcmd><a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a></tcmd><teq> == </teq><tblk>gis\2d_zsh_M03_002_L.shp | gis\2d_zsh_M03_002_P.shp </tblk></li>
<li>Alternatively, name the points layer the same as the main layer, but
with a “_pts” extension. If a layer exists with the “_pts”
extension, TUFLOW automatically assumes this layer is associated
with the main layer and includes all points within this layer when
applying the above commands. For this example, the layer would be
named 2d_zsh_M03_002_L_pts.shp.<br />
</li>
</ol></li>
<li>The first approach (i) above prevails over the second (ii) if both
apply.<br />
</li>
<li>If neither (i) or (ii) apply, TUFLOW assumes there is no separate
points layer.</li>
</ol>
<p>Multiple points layers can be specified. The points layer can be
referenced in any location except for the first layer within the command
line entry. For example, the below syntax will produce an error due to
the points file being the first entry.</p>
<p><strong>Incorrect:<br />
</strong><tcmd><a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a></tcmd><teq> == </teq><tblk>
gis\2d_zsh_M03_002<mark>_P</mark>.shp |
gis\2d_zsh_M03_002<mark>_L</mark>.shp</tblk></p>
<p><strong>Correct:<br />
</strong><tcmd><a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a></tcmd><teq> == </teq><tblk>
gis\2d_zsh_M03_002<mark>_L</mark>.shp |
gis\2d_zsh_M03_002<mark>_P</mark>.shp</tblk></p>
<table>
<caption>
<span id="tab:tab-twoDZAttribute">Table 7.8: </span><strong>2D Z (2d_z_) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:left;">
Elevation (or change in elevation for ADD option) of the point.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="Materials-2" class="section level3 hasAnchor" number="7.3.6">
<h3><span class="header-section-number">7.3.6</span> Land Use (Materials)<a href="TwoD-Domains-1.html#Materials-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="Bed-Resistance-4" class="section level4 hasAnchor" number="7.3.6.1">
<h4><span class="header-section-number">7.3.6.1</span> Bed Resistance<a href="TwoD-Domains-1.html#Bed-Resistance-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The bed resistance values for 2D domains are created by using GIS layer polygons or rasters of different bed resistance zones. The default and recommended bed resistance formulation is Manning’s n. Manning’s n values can be varied with depth (as user specified curve or using the Log Law formula (see Section <a href="TwoD-Domains-1.html#mat-csv-5">7.3.6.3.1</a>)) or varied with velocity-depth product (VxD).</p>
<p>For TUFLOW Classic, bed resistance can also be set to use either Manning’s M values (1/n) or Chezy coefficients using the <a href="TCFCommands-1.html#tcfBedResistanceValues">Bed Resistance Values</a> command in the .tcf file. As this is a TUFLOW Classic feature only, it is further discussed in Section <a href="TwoD-Domains-1.html#CLA-mat-3">7.5.3</a>.</p>
<p>The recommended approach is to use materials to define how the bed roughness varies over the model. Each material is defined by a positive integer ID which represents a different roughness category. GIS layers of land-use or vegetation often make excellent material layers. Examples of different material categories are river in-bank, bank vegetation, pasture, maintained grass, roads, buildings, forest, mangroves, etc. Each material is assigned a constant Manning’s n value, depth or VxD varying Manning’s n. The material layer can also be used to set rainfall losses (if using direct rainfall - see Section <a href="Boundaries-InitialConditions-1.html#Rainfall-3">8.5.3</a>), fraction impervious, storage area and land-use hazard categories (see Section <a href="TwoD-Domains-1.html#mat-csv-5">7.3.6.3.1</a>).</p>
<p>Material/roughness values are used by TUFLOW during conveyance calculations at the cell mid-sides (refer to Section <a href="TwoD-Domains-1.html#Solvers-2">7.2</a> and <a href="TwoD-Domains-1.html#Schematisation-3">7.2.3</a>). However, rainfall losses and fraction impervious are applied to the cell and not cell sides, therefore, materials ID values are sampled at both cell mid-sides and cell centres.</p>
<p>The most common approach is to digitise one or more 2d_mat materials
layers (see Table <a href="TwoD-Domains-1.html#tab:tab-twoDMaterials">7.9</a>) and assign Manning’s n values to the materials using <a href="TCFCommands-1.html#tcfReadMaterialsFile">Read Materials File</a>. This approach allows the easy adjustment of Manning’s n values, for example during model
calibration or sensitivity testing.</p>
<p>When creating the base 2d_mat layer, it is common practice to not digitise
the most common or the most difficult to digitise material, and instead use the
following data layering of commands in the .tgc file (see Section <a href="ControlFiles-and-Inputs-1.html#TGC-3">4.2.7</a>).</p>
<ul>
<li>Use <a href="TGCCommands-1.html#tgcSetMat">Set Mat</a> to set the most common material to all cells in a 2D domain.<br />
</li>
<li>Use <a href="TGCCommands-1.html#tgcReadGISMat">Read GIS Mat</a> or <a href="TGCCommands-1.html#tgcReadGridMat">Read Grid Mat</a> to allocate the remaining material values.</li>
</ul>
<p>The <a href="TGCCommands-1.html#tgcReadGISMat">Read GIS Mat</a> and <a href="TGCCommands-1.html#tgcReadGridMat">Read Grid Mat</a>
commands may be used as many times as required to further modify the
materials in parts of a 2D domain. Each subsequent dataset will
overwrite the preceding assigned material value, as described in Section <a href="TwoD-Domains-1.html#layering-3">7.3.3</a>.</p>
<p>The default material value is zero. As a material value of zero is not allowed, every cell and cell-side must be assigned a material value using <a href="TGCCommands-1.html#tgcSetMat">Set Mat</a>, <a href="TGCCommands-1.html#tgcReadGISMat">Read GIS Mat</a> and/or <a href="TGCCommands-1.html#tgcReadGridMat">Read Grid Mat</a> in the .tgc file
(it is good practice to always set a default materials value using the <a href="TGCCommands-1.html#tgcSetMat">Set Mat</a> as the first material command in the .tgc file). The assigned material ID values do not need to be contiguous but must be within the range 1 to 32,767.</p>
<table>
<caption>
<span id="tab:tab-twoDMaterials">Table 7.9: </span><strong>2D Materials (2d_mat) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Material
</td>
<td style="text-align:left;">
The material ID value referenced within a Materials File (see Section <a href="TwoD-Domains-1.html#Materials-File-4">7.3.6.3</a>).
</td>
<td style="text-align:left;">
Integer
</td>
</tr>
</tbody>
</table>
</div>
<div id="log-law-4" class="section level4 hasAnchor" number="7.3.6.2">
<h4><span class="header-section-number">7.3.6.2</span> Log Law Depth Varying Bed Resistance<a href="TwoD-Domains-1.html#log-law-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>At very shallow depths the Manning’s n value and/or equation may not be
a reliable estimate of bed resistance. The Log Law or “Law of the Wall”
approach offers a theoretically based derivation of resistance based on
a bed shear analysis. This relationship along with benchmarking against
flume test results was used by <span class="citation">Boyte (<a href="#ref-Boyte2014">2014</a>)</span> to derive the following
equation that varies Manning’s n with depth based on the roughness
height of the surface. A limiting Manning’s n value based on the n value
that would normally be applied is also specified to transition to
conventional n values at greater depths.</p>
<p><span class="math display" id="eq:equ-law-of-wall-1">\[\begin{equation}
n = \max_{}\left\lbrack \frac{\kappa y^{\frac{1}{6}}}{\sqrt{g}\ln\left( \frac{y}{z_{0}e} \right)},n_{limit}\  \right\rbrack
\tag{7.5}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:equ-law-of-wall-2">\[\begin{equation}
z_{0} = \ \frac{k_{s}}{30} + \frac{0.11\nu}{U_{f}}
\tag{7.6}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(k_s\)</span> is the roughness height in m<br />
</li>
<li><span class="math inline">\(\kappa\)</span> is typically in the range 0.38 to 0.42 (recommend 0.4)<br />
</li>
<li><span class="math inline">\(y\)</span> is depth<br />
</li>
<li><span class="math inline">\(\nu\)</span> is the kinematic viscosity and is set to 10<sup>-6</sup> m<sup>2</sup>/s<br />
</li>
<li><span class="math inline">\(U_f\)</span> is the friction velocity defined as <span class="math inline">\(\sqrt{Sgy}\)</span> where <span class="math inline">\(y\)</span> approximates <span class="math inline">\(A/P\)</span> and <span class="math inline">\(S\)</span> is the water surface slope<br />
</li>
<li><span class="math inline">\(n_{limit}\)</span> is the limiting n value, ie. the Manning’s n value applicable to greater depths</li>
</ul>
<p>Figure <a href="TwoD-Domains-1.html#fig:fig-image102">7.7</a> illustrates how the equivalent Manning’s n varies with depth using the
log law for a roughness height of 10mm (0.01m) that would be applicable
to a small pebble bed. The different series are the variations in the
slope, <span class="math inline">\(S\)</span>, where 0.001 is 0.1% slope, 0.02 is 2% slope and 0.1 is a 10%
slope. As can be seen there is a significant variation in Manning’s n
below 2cm (0.02m) and a trend to a n value of around 0.018, with only a
minor variation due to slope.</p>
<p>In terms of applying a limiting n value, if, for example, <span class="math inline">\(n_{limit}\)</span> was set to 0.02, then the Manning’s n value would
not fall below 0.02.</p>
<p>Figure <a href="TwoD-Domains-1.html#fig:fig-image103">7.8</a> shows a comparison using the Log Law versus a constant Manning’s n value <span class="citation">(<a href="#ref-Boyte2014">Boyte, 2014</a>)</span>.
The thesis investigated the use of the Law of the Wall for direct rainfall modelling using TUFLOW. The flow depths in this example range from 4 to 20cm and the roughness height, <span class="math inline">\(k_s\)</span>, was 3cm.</p>
<p>The Log Law Depth Varying Bed Resistance is activated by entering special characters in the 2nd column of the Materials File. See Section <a href="TwoD-Domains-1.html#Materials-File-4">7.3.6.3</a> and Table <a href="TwoD-Domains-1.html#tab:tab-MaterialsFormat">7.10</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image102"></span>
<img src="images/image102.jpeg" alt="Example of Log Law Variation of Manning’s n with Depth" width="60%" />
<p class="caption">
Figure 7.7: Example of Log Law Variation of Manning’s n with Depth
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image103"></span>
<img src="images/image103.jpeg" alt="Example of Log Law versus Constant Manning’s n with Depth" width="60%" />
<p class="caption">
Figure 7.8: Example of Log Law versus Constant Manning’s n with Depth
</p>
</div>
</div>
<div id="Materials-File-4" class="section level4 hasAnchor" number="7.3.6.3">
<h4><span class="header-section-number">7.3.6.3</span> Materials File<a href="TwoD-Domains-1.html#Materials-File-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Materials file(s) contain information on a material’s roughness and, optionally, rainfall losses if using direct rainfall. The file is referenced within the .tcf file using <a href="TCFCommands-1.html#tcfReadMaterialsFile">Read Materials File</a> and can be in one of two formats (.csv or .tmf). The .csv format is the recommended of the two options. It supports all functionality. The .tmf format does not. For example, the log law bed resistance option is only available via the .csv format. The .csv format also supports curves of Manning’s n versus depth.</p>
<p>More than one materials file may be specified by repeat occurrences of the command <a href="TCFCommands-1.html#tcfReadMaterialsFile">Read Materials File</a> however, most models will use only a single materials file. Any combination of .tmf and .csv files can be used and up to 1,000 materials are allowed in total.</p>
<p>If a second argument is provided with <a href="TCFCommands-1.html#tcfReadMaterialsFile">Read Materials File</a>, this value is used to factor all Manning’s n values. For example, the following command increasing all Manning’s n values by 10%:</p>
<p><tcmd><a href="TCFCommands-1.html#tcfReadMaterialsFile">Read Materials File</a></tcmd><teq> == </teq><tblk>My_Materials.tmf | 1.1</tblk></p>
<div id="mat-csv-5" class="section level5 hasAnchor" number="7.3.6.3.1">
<h5><span class="header-section-number">7.3.6.3.1</span> .csv Format<a href="TwoD-Domains-1.html#mat-csv-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The .csv format materials file is a comma delimited text file containing Manning’s n and other information for different materials (e.g. land-uses).
The format is intended to be generated from an Excel file database of materials and associated data in a similar manner to BC databases (with the option of using the Excel TUFLOW Macro .xlam macros to export to the .csv format - the Excel TUFLOW Tools.xlam can be downloaded from <a href="https://www.tuflow.com/downloads/#utilities">here</a>). The .csv can also be written from text editor if preferred.</p>
<p>The format of the materials.csv file is described in Table <a href="TwoD-Domains-1.html#tab:tab-MaterialsFormat">7.10</a>.</p>
<p>Note: The .csv format offers access to all materials features, whereas the .tmf format does not.</p>
<table>
<caption>
<span id="tab:tab-MaterialsFormat">Table 7.10: </span><strong>Materials .csv File Format</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Mat (Material ID) number, which must be an integer.
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
<p>Contains information on the bed resistance values (usually Manning’s n). The options available are:</p>
<ul>
<li>Single n value (the n value is assumed constant at all water depths).</li>
<li>Two pairs of depth and n values (see the y<sub>1</sub>, n<sub>1</sub>, y<sub>2</sub>, n<sub>2</sub> option described in Table <a href="TwoD-Domains-1.html#tab:tab-MaterialsFile">7.11</a> for the .tmf format (i.e. Columns 5 to 8). The values must be separated by commas.</li>
<li>A .csv file containing n vs depth values. By default, when the n vs depth values are read they are assumed to be in the first two columns of the .csv file containing the curve’s data. However, you can specify the columns to be used by placing the column label after the .csv filename using a vertical bar “|” to separate the column label from the .csv filename. If only one column label is given, this is assumed to be the depth column and the next column must contain the Manning’s n values. As for boundary data, TUFLOW searches down the rows until it finds the first numeric values and will start reading from this row until a row is found with no more numeric values. To view how the n values vary with depth over time, use the “n” option for <a href="TCFCommands-1.html#tcfMapOutputDataTypes">Map Output Data Types</a>.</li>
<li>If the first four characters are “VxD:” the Manning’s n values for the material will be varied according the velocity times depth product, rather than depth. The VxD versus n values are provided in the same manner as for depths described above. Note that the Manning’s n value never increases during the simulation, it can only remain the same or decrease. This feature was provided to allow the user to reduce Manning’s n with increasing VxD to represent the “stripping” of river banks in high VxD areas, and then keeping the reduced Manning’s n as the flood recedes, hence why the n value cannot increase once decreased during the simulation. VxD was used in preference for simply V to avoid reducing n values at very shallow depths (but high velocities) when the flood first inundates the 2D cells.</li>
<li>If the first four characters are “Log:” the bed resistance as defined by the theoretically derived log law for shallow flows is applied. Three numbers are required after the “Log:” in space or comma delimited format. These are: Ks (roughness height), Kappa (0.3 to 0.4) and the limiting Manning’s n value. See Section <a href="TwoD-Domains-1.html#log-law-4">7.3.6.2</a> for more information.
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Sets the rainfall loss parameters using the initial loss/continuing loss option. The initial/continuing loss is entered as two comma delimited numbers in a similar manner to the third and fourth column values in the .tmf format. See Table <a href="TwoD-Domains-1.html#tab:tab-MaterialsFile">7.11</a>. Refer to Section <a href="TwoD-Domains-1.html#Rainfall-Losses-4">7.3.6.4</a>.
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Reserved.
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
Defines the Storage Reduction Factor (SRF) value. If no fifth column entry exists, no SRF is applied. The default is an SRF of 0 (i.e. no change in storage). See Section <a href="TwoD-Domains-1.html#srf-3">7.3.9.1</a> for more information.
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
Defines the Fraction Impervious of the overlying material type. The value entered should be a number from 0.0 to 1.0 where 0.0 is fully pervious and 1.0 is fully impervious. The default is a value of 0.0, assuming that the overlying material is 100% pervious. This feature is used to influence the amount of water that is infiltrated into the ground with the soil infiltration feature. Refer to Section <a href="TwoD-Domains-1.html#Infiltration-2">7.3.7</a> for more information.</li>
</ul>
<b>Note: This option works with the Soli Infiltration feature (see Section <a href="TwoD-Domains-1.html#Infiltration-2">7.3.7</a>). It does not apply to materials rainfall losses (Column No 3 above) when applying direct rainfall (see Section <a href="Boundaries-InitialConditions-1.html#Rainfall-3">8.5.3</a>).</b>
</td>
</tr>
</tbody>
</table>
<p>An example of a materials.csv is provided in Figure <a href="TwoD-Domains-1.html#fig:fig-image104">7.9</a>. To give a description of the material, this must be done after all inputs for that material and must be preceded by a “!” or “#”.</p>
<p>In the example shown in Figure <a href="TwoD-Domains-1.html#fig:fig-image104">7.9</a>:</p>
<ul>
<li>Material 1 has a constant n value of 0.03 and no rainfall loss
parameters.<br />
</li>
<li>Material 5 varies n with depth using the four y<sub>1</sub>,
n<sub>1</sub>, y<sub>2</sub>, n<sub>2</sub> values (as per .tmf format
approach) and no rainfall loss parameters.<br />
</li>
<li>Materials 11 and 12 use depth vaying n sourced from a file called
Grass.csv. As only one column label has been specified, the y values
must occur under that label and the n values must occur in the next
adjoining column (see Figure <a href="TwoD-Domains-1.html#fig:fig-image105">7.10</a>). An IL of 10mm and CL of 2mm/h for both materials will be used for any direct rainfall.<br />
</li>
<li>Materials 21 and 22 use depth vaying n sourced from a file called Trees.csv. As two column labels have been specified, the y and n values must occur under
the specified labels (see <a href="TwoD-Domains-1.html#fig:fig-image105">7.10</a>). An IL of 20mm
and CL of 2mm/h for Material 21, and 25 and 2 for Material 22, will be
used.<br />
</li>
<li>Material 31 uses the log law approach (Section <a href="TwoD-Domains-1.html#log-law-4">7.3.6.2</a>) with a roughness height of 0.01m, Kappa value of 0.4 and limiting Manning’s n of 0.02. IL = 0mm and CL = 0mm. The fraction impervious value is set to 1.0 (fully impervious).</li>
<li>Material 32 use depth vaying n sourced from a file called Buildings.csv. In Buildings.csv Column A is used for y values and Column B for n values. IL = 0 and CL = 0. The storage reduction factor is set to 0.3 (30% reduction in storage) and the fraction impervious value is set to 1 (fully impervious).</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image104"></span>
<img src="images/image104b.png" alt="Example of Materials .csv File Format"  />
<p class="caption">
Figure 7.9: Example of Materials .csv File Format
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image105"></span>
<img src="images/image105a.png" alt="Example of the Grass.csv file read into the Materials.csv"  />
<p class="caption">
Figure 7.10: Example of the Grass.csv file read into the Materials.csv
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image106"></span>
<img src="images/image106a.png" alt="Example of the Trees.csv file read into the Materials.csv"  />
<p class="caption">
Figure 7.11: Example of the Trees.csv file read into the Materials.csv
</p>
</div>
</div>
<div id="tmf-5" class="section level5 hasAnchor" number="7.3.6.3.2">
<h5><span class="header-section-number">7.3.6.3.2</span> .tmf Format<a href="TwoD-Domains-1.html#tmf-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The .tmf format is a text file containing Manning’s n and other
information for different materials (e.g. land-uses). The file can
contain comments using the “#” and/or “!” comment characters at any location.
When comment characters are specified, the remainder of the line is ignored.
The format of the materials .tmf file is described in Table <a href="TwoD-Domains-1.html#tab:tab-MaterialsFile">7.11</a>. The first two
columns are mandatory and must be specified. All other columns are
optional. A maximum of 100 different materials can be specified in this format.</p>
<p>Note: The .tmf format does not offer all materials functionality,
whereas the .csv format in the above section does.</p>
<table>
<caption>
<span id="tab:tab-MaterialsFile">Table 7.11: </span><strong>Materials .tmf File Format</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Mat (Material ID) number, which must be an integer.
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
<p>Manning’s n value.</p>
<b>Note, if the four values in columns 5 to 8 are specified, the Manning’s n value in this column is ignored and not used.</b>
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Sets the initial loss if using a direct rainfall boundary (via <a href="TBCCommands-1.html#tbcReadGISRF">Read GIS RF</a> or <a href="TCFCommands-1.html#tcfRainfallControlFile">Rainfall Control File</a>). Refer to Section <a href="TwoD-Domains-1.html#Rainfall-Losses-4">7.3.6.4</a>. This does not apply to <a href="TBCCommands-1.html#tbcGlobalRainfallBC">Global Rainfall BC</a>. The units are mm, or if <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd> <teq>==</teq><tblk> US Customary</tblk> inches.
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Sets the continuing loss rate if using a direct rainfall boundary (via <a href="TBCCommands-1.html#tbcReadGISRF">Read GIS RF</a> or <a href="TCFCommands-1.html#tcfRainfallControlFile">Rainfall Control File</a>). Refer to Section <a href="TwoD-Domains-1.html#Rainfall-Losses-4">7.3.6.4</a>. This does not apply to <a href="TBCCommands-1.html#tbcGlobalRainfallBC">Global Rainfall BC</a>. The units are mm/hr, or if <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd> <teq>==</teq><tblk> US Customary</tblk> inches/hr.
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
y<sub>1</sub> – The depth below which the Manning’s n value n1 (column 6) is applied.
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
n<sub>1</sub> –The Manning’s n value applied below depth y<sub>1</sub> (column 5).
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
y<sub>2</sub> – The depth above which the Manning’s n value n<sub>2</sub> (column 8) is applied.
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
<p>n<sub>2</sub> –The Manning’s n value applied above depth y<sub>2</sub> (column 7).</p>
Between y<sub>1</sub> and y<sub>2</sub>, the Manning’s n value is interpolated between n<sub>1</sub> and n<sub>2</sub> according to <a href="TCFCommands-1.html#tcfBedResistanceDepthInterpolation">Bed Resistance Depth Interpolation</a>. When specifying values for columns 5 to 8, initial and continuing loss values must be specified in columns 3 and 4 as described above (use zero values if not using direct rainfall).
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
Reserved.
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
Defines the Storage Reduction Factor (SRF) value. The default is an SRF of 0. Enter 0 to ensure there is no change in 2D cell storage for the material type. See Section <a href="TwoD-Domains-1.html#srf-3">7.3.9.1</a> for more information.
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
<p>Defines the fraction impervious of the overlying material type. The value entered should be a number from 0.0 to 1.0 where 0.0 is fully pervious and 1.0 is fully impervious. The default is a value of 0.0, assuming that the overlying material is 100% pervious. This feature is used to influence the amount of water that is infiltrated into the ground with the soil infiltration feature. Refer to Section <a href="TwoD-Domains-1.html#Infiltration-2">7.3.7</a> for more information.</p>
<b>Note: This option works with the Soli Infiltration feature (see Section <a href="TwoD-Domains-1.html#Infiltration-2">7.3.7</a>). It does not apply to materials rainfall losses (Column No 3 above) when applying direct rainfall (see Section <a href="Boundaries-InitialConditions-1.html#Rainfall-3">8.5.3</a>).</b>
</td>
</tr>
</tbody>
</table>
<p>The .tmf file format is shown in the examples below. See <a href="TGCCommands-1.html#tgcSetMat">Set Mat</a>, <a href="TGCCommands-1.html#tgcReadGISMat">Read GIS Mat</a> and <a href="TGCCommands-1.html#tgcReadGridMat">Read Grid Mat</a> for assigning the material IDs to the 2D domains. These material values may also be used to define bed resistance values across 1D XZ cross-sections (see Section <a href="OneD-Domains-1.html#RR-M-5">5.7.1.1.2</a>).</p>
<ol>
<tgrn>! Comments and blank lines are allowed in this file</tgrn><br />
<tgrn>! First value is the Mat value, Second is the Manning’s n value</tgrn><br />
<tblk>1, 0.03</tblk><tgrn>! waterways</tgrn><br />
<tblk>2, 0.08</tblk><tgrn>! river banks</tgrn><br />
<tblk>11, 0.06</tblk><tgrn>! grazing land</tgrn><br />
<tblk>12, 0.04</tblk><tgrn>! parks and gardens</tgrn><br />
<tblk>13, 0.15</tblk><tgrn>! sugar cane</tgrn><br />
<tblk>14, 0.12</tblk><tgrn>! natural forest</tgrn><br />
<tblk>15, 0.02</tblk><tgrn>! roads</tgrn>
</ol>
<p>To include the initial loss (mm) and the continuing loss rate (mm/h)
optionally enter a third and fourth value as shown below. If an IL is
specified, a CL must also be specified otherwise an ERROR occurs. Both
can be omitted, in which case, they are both set to zero.</p>
<ol>
<tblk>1, 0.03</tblk><tgrn>! waterways</tgrn><br />
<tblk>2, 0.08, 20, 2</tblk><tgrn>! river banks</tgrn><br />
<tblk>11, 0.06, 20, 2</tblk><tgrn>! grazing land</tgrn><br />
<tblk>12, 0.04, 5, 1.5</tblk><tgrn>! parks and gardens</tgrn><br />
<tblk>13, 0.15, 10, 2</tblk><tgrn>! sugar cane</tgrn><br />
<tblk>14, 0.12, 30, 2.5</tblk><tgrn>! natural forest</tgrn><br />
<tblk>15, 0.02, 2, 0</tblk><tgrn>! roads</tgrn>
</ol>
<p>To vary n values with depth (m) using two pairs of values optionally
enter values in the fifth to eighth columns as shown below in lines 2
and 3 (Materials 2 and 11) below. IL and CL values must be entered (use
zero if not relevant). If depth varying manning’s n is not used, column
5 to 8 should be left blank, not set to zero.</p>
<ol>
<tblk>1, 0.03</tblk><tgrn>! waterways</tgrn><br />
<tblk>2, 0.08, 20, 2, 0.3, 0.15, 0.5, 0.08</tblk><tgrn>! river banks with long grass 0.3m high</tgrn><br />
<tblk>11, 0.06, 20, 2, 0.1, 0.1, 0.15, 0.06</tblk><tgrn>! grazing land</tgrn><br />
<tblk>12, 0.04, 5, 1.5</tblk><tgrn>! parks and gardens</tgrn><br />
<tblk>13, 0.15, 10, 2</tblk><tgrn>! sugar cane</tgrn><br />
<tblk>14, 0.12, 30, 2.5</tblk><tgrn>! natural forest</tgrn><br />
<tblk>15, 0.02, 2, 0</tblk><tgrn>! roads</tgrn>
</ol>
<p>To reduce the storage of cells, enter a SRF value in the tenth column as
shown in line 7 for Material 15 below. The example shown reduces the
storage of all cells with Material ID of 15 by 20%. Note
that a value of -1 has been entered for the ninth column as this field
has been reserved. If not used, specify 0 to ensure
no change in storage for the material.</p>
<ol>
<tblk>1, 0.03</tblk><tgrn>! waterways</tgrn><br />
<tblk>2, 0.08, 20, 2, 0.3, 0.15, 0.5, 0.08</tblk><tgrn>! river banks with long grass 0.3m high</tgrn><br />
<tblk>11, 0.06, 20, 2, 0.1, 0.1, 0.15, 0.06</tblk><tgrn>! grazing land</tgrn><br />
<tblk>12, 0.04, 5, 1.5</tblk><tgrn>! parks and gardens</tgrn><br />
<tblk>13, 0.15, 10, 2</tblk><tgrn>! sugar cane</tgrn><br />
<tblk>14, 0.12, 30, 2.5</tblk><tgrn>! natural forest</tgrn><br />
<tblk>15, 0.02, 2, 0, , , , , -1, 0.2</tblk><tgrn>! roads with width reduced by 20%</tgrn>
</ol>
<p>To specify a fraction impervious, enter a value between 0.0 and 1.0 in
the eleventh column as shown in line 4 for Material 12 below. The
example shown partially restricts the rate of infiltration by applying a
fraction impervious of 0.1 or 10%.</p>
<ol>
<tblk>1, 0.03</tblk><tgrn>! waterways</tgrn><br />
<tblk>2, 0.08, 20, 2, 0.3, 0.15, 0.5, 0.08</tblk><tgrn>! river banks with long grass 0.3m high</tgrn><br />
<tblk>11, 0.06, 20, 2, 0.1, 0.1, 0.15, 0.06</tblk><tgrn>! grazing land</tgrn><br />
<tblk>12, 0.04, 5, 1.5, , , , , -1, 0, 0.1</tblk><tgrn>! parks and gardens (10% impervious)</tgrn><br />
<tblk>13, 0.15, 10, 2</tblk><tgrn>! sugar cane</tgrn><br />
<tblk>14, 0.12, 30, 2.5</tblk><tgrn>! natural forest</tgrn><br />
<tblk>15, 0.02, 2, 0, , , , , -1, 0.2</tblk><tgrn>! roads with width reduced by 20%</tgrn>
</ol>
</div>
</div>
<div id="Rainfall-Losses-4" class="section level4 hasAnchor" number="7.3.6.4">
<h4><span class="header-section-number">7.3.6.4</span> Rainfall Losses<a href="TwoD-Domains-1.html#Rainfall-Losses-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Rainfall losses applied through the Materials file (.tmf or
.csv format) remove the loss depth from the rainfall before it is
applied as a boundary on the 2D cells. Rainfall losses are ideal for
modelling situations in which water is prevented from reaching the
ground, such as through the interception by trees.</p>
<p><strong>Note that the ILCL rainfall losses are different to the ILCL infiltration
losses that can be applied using the .tsoilf file (refer to Section <a href="TwoD-Domains-1.html#tsoilf-4">7.3.7.2</a>).</strong> The
ILCL soil infiltration losses will infiltrate ponded water into the
ground. It is possible to use both methods in the same simulation – for
example, rainfall that doesn’t reach the ground would be modelled as a
material IL/CL (applied as a loss to the rainfall) and infiltration into
the ground as IL/CL via soil types. The log file (see Section
<a href="Checks-and-Logs-1.html#TLF-3">14.5.1</a>) will report the material and soil properties separately as
shown in the example below:</p>
<p>Example Material Properties:</p>
<ol>
<tgrn>#4 - Material 4:</tgrn><br />
<tblk>Fixed Manning’s n = 0.030<br />
IL = 1.0mm, CL = 0.0mm/h<br />
Landuse Hazard ID not set.<br />
SRF (Storage Reduction Factor) = 0.<br />
Fraction Impervious = 0. <tblk>
</ol>
<p>Example Soil Properties:</p>
<ol>
<tgrn>#1 - Soil 1 [based on pre-defined soil type SAND]:</tgrn><br />
<tblk>Suction = 49.5 mm<br />
HydCond = 117.8 mm/hr<br />
Porosity = 0.417<br />
Initial Moisture = 0.2<br />
Soil Capacity = 0.217 </tblk>
</ol>
<p>Specifying the “fraction impervious” on the material allows the
materials and the soils to be independent (i.e. the same soil can be
present under both road and forest). <strong>This fraction impervious only
applies to the infiltration into the soil, not to the Materials file rainfall
losses.</strong></p>
</div>
</div>
<div id="Infiltration-2" class="section level3 hasAnchor" number="7.3.7">
<h3><span class="header-section-number">7.3.7</span> Infiltration<a href="TwoD-Domains-1.html#Infiltration-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Three methods are available to infiltrate ponded water from the surface into the ground:</p>
<ul>
<li>Green-Ampt (GA);<br />
</li>
<li>Horton (HO); and</li>
<li>Initial Loss/Continuing Loss (ILCL).</li>
</ul>
<p>When using TUFLOW HPC, it is possible to model multiple vertical groundwater layers, as well as enable horizontal flow of groundwater. As these features are only available in TUFLOW HPC, they are discussed in Section <a href="TwoD-Domains-1.html#HPC-Groundwater-3">7.4.5</a>.</p>
<p>All three methods mentioned above monitor the amount of water infiltrated and if the ground becomes saturated, infiltration ceases. The amount of water that can be infiltrated depends on:</p>
<ul>
<li>The infiltration approach and soil parameters used for the top most
(infiltration) soil layer.<br />
</li>
<li>The number, thickness, porosities, and initial moisture of the
groundwater layers.<br />
</li>
<li>The fraction impervious value of the overlying material layer.</li>
</ul>
<p>The cumulative infiltration data is stored and computed at cell centres. As such all soil data and groundwater layer geometry is sampled from the GIS / Grid layers at cell centres. Likewise the material “fraction impervious” data is sampled at cell centres (unlike the Manning’s values which are sampled at face
centres).</p>
<p>The following .tgc commands are used to set the ID for the soil type referenced in the TUFLOW soils file (.tsoilf) (Section <a href="TwoD-Domains-1.html#tsoilf-4">7.3.7.2</a>):</p>
<ul>
<li><a href="TGCCommands-1.html#tgcSetSoil">Set Soil</a>;<br />
</li>
<li><a href="TGCCommands-1.html#tgcReadGISSoil">Read GIS Soil</a>; and<br />
</li>
<li><a href="TGCCommands-1.html#tgcReadGridSoil">Read Grid Soil</a>.</li>
</ul>
<p>Each of these commands has the option of specifying which soil layer(s) the command applies to. Note that 2D infiltration is activated by the occurrence of one of these commands. If none of the commands exists for a 2D domain, soil infiltration does not occur for that domain.</p>
<p>If soils are specified, the soil ID for each cell are written to the
<a href="https://wiki.tuflow.com/Check_Files_2d_grd">_grd_check</a> layer. The .tlf file contains the parameters for each Soil
ID.</p>
<div id="infiltration-layer-4" class="section level4 hasAnchor" number="7.3.7.1">
<h4><span class="header-section-number">7.3.7.1</span> Infiltration Layer<a href="TwoD-Domains-1.html#infiltration-layer-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Only wet 2D cells can infiltrate water into the ground. If using soil
infiltration with a single groundwater layer, the default groundwater
depth is infinite. The depth (thickness) of the groundwater layer can be set globally using the following commands:</p>
<ul>
<li><a href="TGCCommands-1.html#tgcSetSoilThickness">Set Soil Thickness</a><br />
</li>
<li><a href="TGCCommands-1.html#tgcSetSoilBaseElevation">Set Soil Base Elevation</a></li>
</ul>
<p>They can also be set spatially with the following GIS and Grid commands:</p>
<ul>
<li><a href="TGCCommands-1.html#tgcReadGISSoilThickness">Read GIS Soil Thickness</a><br />
</li>
<li><a href="TGCCommands-1.html#tgcReadGISSoilBaseElevation">Read GIS Soil Base Elevation</a></li>
<li><a href="TGCCommands-1.html#tgcReadGridSoilThickness">Read Grid Soil Thickness</a></li>
<li><a href="TGCCommands-1.html#tgcReadGridSoilBaseElevation">Read Grid Soil Base Elevation</a></li>
</ul>
<p>The soil thickness sets the layer depth from the surface elevation. The soil base elevation sets the absolute elevation of the bottom of the layer. If both methods are specified for a given grid cell, the highest of the two will be adopted. The input units should be in metres or feet. To set an initial groundwater level within the soil layer, see Section <a href="Boundaries-InitialConditions-1.html#IGW-3">8.9.2</a>.</p>
<p>In releases prior to 2023-03, the groundwater level (or depth) was set to represent a water table. For backward compatibility, it is still possible to the set a water table, using these commands:</p>
<ul>
<li><a href="TGCCommands-1.html#tgcSetGWD">Set GWD</a> or <a href="TGCCommands-1.html#tgcSetGWL">Set GWL</a></li>
<li><a href="TGCCommands-1.html#tgcReadGISGWD">Read GIS GWD</a> or <a href="TGCCommands-1.html#tgcReadGISGWL">Read GIS GWL</a></li>
<li><a href="TGCCommands-1.html#tgcReadGridGWD">Read Grid GWD</a> or <a href="TGCCommands-1.html#tgcReadGridGWL">Read Grid GWL</a></li>
</ul>
<p>The amount of water that enters the soil is also dependent on the
fraction impervious value of the overlying material layer. The default
is that the overlying material is 100% pervious (i.e. 0% impervious).
However, if, for example, a concrete parking lot overlies a sandy soil,
the imperviousness of the parking lot can be specified as 100% (i.e.
totally), or 90% (i.e. partially) restrict the rate of infiltration.
This is described in the materials file in Section <a href="TwoD-Domains-1.html#Materials-2">7.3.6</a>.</p>
<p>If using TUFLOW HPC’s SGS functionality (Section <a href="TwoD-Domains-1.html#SGS-3">7.4.3</a>), cells can be considered “partially wet”. This necessitated options for factoring down the rate of infiltration into the topmost groundwater layer, the methods are discussed in Section <a href="TwoD-Domains-1.html#SGS-Advanced-5">7.4.3.1.2</a>.</p>
<div id="green-ampt-ga" class="section level5 hasAnchor" number="7.3.7.1.1">
<h5><span class="header-section-number">7.3.7.1.1</span> Green-Ampt (GA)<a href="TwoD-Domains-1.html#green-ampt-ga" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The Green-Ampt approach varies the rate of infiltration over time based
on the soil’s hydraulic conductivity, suction, porosity and initial
moisture content. The method assumes that as water begins to infiltrate
into the soil, a line develops differentiating between the “dry” soil
(with moisture content<span class="math inline">\(\ \theta_{i}\)</span>) and the “wet” soil (with moisture
content equal to the porosity of the soil <em>η</em>). As the infiltrated water
continues to move through the soil profile in a vertical direction, the
soil moisture changes instantly from the initial content to a saturated
state. This concept is presented in Figure <a href="TwoD-Domains-1.html#fig:fig-image109">7.12</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image109"></span>
<img src="images/image109a.png" alt="Green-Ampt Model Concept[^2]"  />
<p class="caption">
Figure 7.12: Green-Ampt Model Concept<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>
</p>
</div>
<p>The basic form of the Green-Ampt equation is expressed as follows:</p>
<p><span class="math display" id="eq:equ-GA">\[\begin{equation}
f(t) = K\left( 1 + \ \frac{\mathrm{\Delta}\theta\left( \varphi + h_{0} \right)}{F(t)} \right)
\tag{7.7}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(t\)</span> = time<br />
</li>
<li><span class="math inline">\(K\)</span> = saturated hydraulic conductivity<br />
</li>
<li><span class="math inline">\(\mathrm{\Delta}\theta\)</span> = defined as the soil capacity (the difference between the saturated and initial moisture content)<br />
</li>
<li><span class="math inline">\(\varphi\)</span> = soil suction head<br />
</li>
<li><span class="math inline">\(h_{0}\)</span> = depth of ponded water<br />
</li>
<li><span class="math inline">\(F(t)\)</span> = cumulative infiltration calculated from:</li>
</ul>
<p><span class="math display">\[F(t) - \ \mathrm{\Delta}\theta\left( \varphi + h_{0} \right)\ln\left( 1\  + \ \frac{F(t)}{\mathrm{\Delta}\theta\left( \varphi + h_{0} \right)} \right) = Kt\]</span></p>
<p>The <a href="https://wiki.tuflow.com/Green-Ampt_Infiltration_Parameters">TUFLOW Wiki</a> provides a detail description of the various Green-Ampt parameters, including how each influences the soil infiltration behaviour.</p>
<p>United States Department of Agriculture (USDA) soil types have been
hardwired into TUFLOW and are presented in Table <a href="TwoD-Domains-1.html#tab:tab-GreenAmpt">7.12</a>, along with the soil parameters. Alternatively, it is possible to define a
customised soil type by specifying user defined values as shown in
Table <a href="TwoD-Domains-1.html#tab:tab-tsoilf">7.13</a>.</p>
<table>
<caption>
<span id="tab:tab-GreenAmpt">Table 7.12: </span><strong>USDA Soil types for the Green-Ampt Infiltration Method</strong>
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
USDA Soil Type
</th>
<th style="text-align:center;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Suction (mm)
</th>
<th style="text-align:center;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Suction (inches)
</th>
<th style="text-align:center;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Hydraulic Conductivity (mm/hr)
</th>
<th style="text-align:center;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Hydraulic Conductivity (in/hr)
</th>
<th style="text-align:center;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Porosity (Fraction)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Clay
</td>
<td style="text-align:center;">
316.3
</td>
<td style="text-align:center;">
12.453
</td>
<td style="text-align:center;">
0.3
</td>
<td style="text-align:center;">
0.012
</td>
<td style="text-align:center;">
0.385
</td>
</tr>
<tr>
<td style="text-align:left;">
Silty Clay
</td>
<td style="text-align:center;">
292.2
</td>
<td style="text-align:center;">
11.504
</td>
<td style="text-align:center;">
0.5
</td>
<td style="text-align:center;">
0.020
</td>
<td style="text-align:center;">
0.423
</td>
</tr>
<tr>
<td style="text-align:left;">
Sandy Clay
</td>
<td style="text-align:center;">
239.0
</td>
<td style="text-align:center;">
9.409
</td>
<td style="text-align:center;">
0.6
</td>
<td style="text-align:center;">
0.024
</td>
<td style="text-align:center;">
0.321
</td>
</tr>
<tr>
<td style="text-align:left;">
Clay Loam
</td>
<td style="text-align:center;">
208.8
</td>
<td style="text-align:center;">
8.220
</td>
<td style="text-align:center;">
1.0
</td>
<td style="text-align:center;">
0.039
</td>
<td style="text-align:center;">
0.309
</td>
</tr>
<tr>
<td style="text-align:left;">
Silty Clay Loam
</td>
<td style="text-align:center;">
273.0
</td>
<td style="text-align:center;">
10.748
</td>
<td style="text-align:center;">
1.0
</td>
<td style="text-align:center;">
0.039
</td>
<td style="text-align:center;">
0.432
</td>
</tr>
<tr>
<td style="text-align:left;">
Sandy Clay Loam
</td>
<td style="text-align:center;">
218.5
</td>
<td style="text-align:center;">
8.602
</td>
<td style="text-align:center;">
1.5
</td>
<td style="text-align:center;">
0.059
</td>
<td style="text-align:center;">
0.330
</td>
</tr>
<tr>
<td style="text-align:left;">
Silt Loam
</td>
<td style="text-align:center;">
166.8
</td>
<td style="text-align:center;">
6.567
</td>
<td style="text-align:center;">
3.4
</td>
<td style="text-align:center;">
0.134
</td>
<td style="text-align:center;">
0.486
</td>
</tr>
<tr>
<td style="text-align:left;">
Loam
</td>
<td style="text-align:center;">
88.9
</td>
<td style="text-align:center;">
3.500
</td>
<td style="text-align:center;">
7.6
</td>
<td style="text-align:center;">
0.299
</td>
<td style="text-align:center;">
0.434
</td>
</tr>
<tr>
<td style="text-align:left;">
Sandy Loam
</td>
<td style="text-align:center;">
110.1
</td>
<td style="text-align:center;">
4.335
</td>
<td style="text-align:center;">
10.9
</td>
<td style="text-align:center;">
0.429
</td>
<td style="text-align:center;">
0.412
</td>
</tr>
<tr>
<td style="text-align:left;">
Loamy Sand
</td>
<td style="text-align:center;">
61.3
</td>
<td style="text-align:center;">
2.413
</td>
<td style="text-align:center;">
29.9
</td>
<td style="text-align:center;">
1.177
</td>
<td style="text-align:center;">
0.401
</td>
</tr>
<tr>
<td style="text-align:left;">
Sand
</td>
<td style="text-align:center;">
49.5
</td>
<td style="text-align:center;">
1.949
</td>
<td style="text-align:center;">
117.8
</td>
<td style="text-align:center;">
4.638
</td>
<td style="text-align:center;">
0.417
</td>
</tr>
</tbody>
</table>
<p>The 2023-03 release introduces a slight change to the soil moisture
initialisation which impacts the computation of the Green-Ampt
infiltration rate. In previous TUFLOW releases, the initial moisture was
used to revise the soil porosity downwards, and the cumulative
infiltration was initialised to zero. In the 2023-03 release the soil
porosity is not modified, and the cumulative infiltration is initialised
as the lesser of the initial moisture fraction and the soil porosity,
times the thickness of the layer. These two approaches produce slightly
different results for the infiltration rate with the Green-Ampt method.
The new approach is perhaps more logical, and was necessary for the
purpose of initialising to a groundwater table. If the previous approach
is required, and the model has only one soil layer and no horizontal
advection, then it can be selected by using the <tcmd><a href="TCFCommands-1.html#tcfDefaults">Defaults</a>
</tcmd><teq>==</teq><tblk> Pre 2023</tblk> command.</p>
</div>
<div id="horton-ho" class="section level5 hasAnchor" number="7.3.7.1.2">
<h5><span class="header-section-number">7.3.7.1.2</span> Horton (HO)<a href="TwoD-Domains-1.html#horton-ho" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The Horton approach to infiltration uses the following equation:</p>
<p><span class="math display" id="eq:equ-HO">\[\begin{equation}
{f = f}_{c} + \left( f_{0} - f_{c} \right)e^{- kt}
\tag{7.8}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(f_0\)</span> is the initial infiltration rate in mm/hr or inches/hr (if using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd><teq> == </teq><tblk> US Customary</tblk>)<br />
</li>
<li><span class="math inline">\(f_c\)</span> is the final (indefinite) infiltration rate<br />
</li>
<li><span class="math inline">\(t\)</span> is time in hours (period of time that the cell is wet)<br />
</li>
<li><span class="math inline">\(k\)</span> is the Horton decay rate.</li>
</ul>
<p>If an initial loss (IL) is specified, the initial loss is applied first,
followed by the Horton infiltration. Figure <a href="TwoD-Domains-1.html#fig:fig-image110">7.13</a> shows an example of how the infiltration rate varies over time for <span class="math inline">\(f_0\)</span> equal
to 3, <span class="math inline">\(f_c\)</span> equal to 1 and <span class="math inline">\(k\)</span> equal to 0.1.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image110"></span>
<img src="images/image110.jpeg" alt="Example of Horton Infiltration Rate over Time"  />
<p class="caption">
Figure 7.13: Example of Horton Infiltration Rate over Time
</p>
</div>
</div>
<div id="initial-losscontinuing-loss-ilcl" class="section level5 hasAnchor" number="7.3.7.1.3">
<h5><span class="header-section-number">7.3.7.1.3</span> Initial Loss/Continuing Loss (ILCL)<a href="TwoD-Domains-1.html#initial-losscontinuing-loss-ilcl" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The Initial Loss/Continuing Loss (IL/CL) method is a more simplistic approach
compared to the Green-Ampt and Horton infiltration methods. The IL/CL
method infiltrates water based on an initial volume (at any rate) then transitions to a constant rate after the initial loss volume is exceeded.</p>
<p><strong>Note that the IL/CL infiltration is separate to the IL/CL
materials values used to generate excess rainfall for direct rainfall
simulations (refer to Section <a href="TwoD-Domains-1.html#Rainfall-Losses-4">7.3.6.4</a> for further
information).</strong></p>
</div>
</div>
<div id="tsoilf-4" class="section level4 hasAnchor" number="7.3.7.2">
<h4><span class="header-section-number">7.3.7.2</span> Soils File (.tsoilf)<a href="TwoD-Domains-1.html#tsoilf-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Soils infiltration is applied to the model by defining a soils (.tsoilf)
file, which is read into the .tcf using the <a href="TCFCommands-1.html#tcfReadSoilFile">Read Soils
File</a> command. Table <a href="TwoD-Domains-1.html#tab:tab-tsoilf">7.13</a> presents the parameters of the .tsoilf file and Figure <a href="TwoD-Domains-1.html#fig:fig-image111">7.14</a> shows an example of a completed file. A number of example models demonstrating the various soil options are available on the <a href="https://wiki.tuflow.com/TUFLOW_Example_Models#Soil_Options">TUFLOW Wiki - Soil Options</a>. The soils (.tsoilf) file is similar to the materials file where you assign a positive integer ID to each soil, define the infiltration method (options are “NONE”, “GA”, “HO” and “ILCL”) followed by the soil parameters as the remaining
values. The Porosity (saturated moisture content), Initial Moisture (fraction of the soil that is initially wet), Max Ponding Depth and Horizontal Hydraulic Conductivity are all optional with default values of 1.0, 0.0, 0.0 and 0.0 respectively.</p>
<p><strong>Note: Table <a href="TwoD-Domains-1.html#tab:tab-tsoilf">7.13</a> does not include the additional attributes (in regards to horizontal advection) and soil type (convection) available when using TUFLOW HPC. For groundwater modelling including horizontal and vertical subsurface fluid movement, refer to Table <a href="TwoD-Domains-1.html#tab:tab-tsoilf-hpc">7.21</a> instead. </strong></p>
<table>
<caption>
<span id="tab:tab-tsoilf">Table 7.13: </span>Soil File (.tsoilf) Parameters
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Column No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No Intriltration
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Green-Ampt
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Green-Ampt
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Horton
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Initial/Continuing Loss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Soil ID
</td>
<td style="text-align:left;">
Soil ID
</td>
<td style="text-align:left;">
Soil ID
</td>
<td style="text-align:left;">
Soil ID
</td>
<td style="text-align:left;">
Soil ID
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
NONE
</td>
<td style="text-align:left;">
GA
</td>
<td style="text-align:left;">
GA
</td>
<td style="text-align:left;">
HO
</td>
<td style="text-align:left;">
ILCL
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
USDA<br />
Soil Type<br />
(see Table <a href="TwoD-Domains-1.html#tab:tab-GreenAmpt">7.12</a>)
</td>
<td style="text-align:left;">
Suction<br />
(mm or in)
</td>
<td style="text-align:left;">
Initial Loss<br />
(mm or inches)
</td>
<td style="text-align:left;">
Initial Loss<br />
(mm or inches)
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Initial Moisture<br />
(Fraction)
</td>
<td style="text-align:left;">
Hydraulic Conductivity<br />
(mm/h or in/h)
</td>
<td style="text-align:left;">
Initial Loss Rate (<span class="math inline">\(f_0\)</span>) (mm/h or in/h)
</td>
<td style="text-align:left;">
Continuing Loss<br />
(mm/h or in/h)
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Max Ponding Depth<br />
(m or ft)
</td>
<td style="text-align:left;">
Porosity<br />
(Fraction)
</td>
<td style="text-align:left;">
Final Loss Rate (<span class="math inline">\(f_c\)</span>) (mm/h or in/h)
</td>
<td style="text-align:left;">
Porosity<br />
(Fraction)
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Initial Moisture<br />
(Fraction)
</td>
<td style="text-align:left;">
Exponential Decay Rate (k)<br />
(h-1)
</td>
<td style="text-align:left;">
Initial Moisture<br />
(Fraction)
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Max Ponding<br />
Depth (m or ft)
</td>
<td style="text-align:left;">
Porosity<br />
(Fraction)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Initial Moisture<br />
(Fraction)
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<!-- EFC to PAR: do you think this note should be moved to the green-ampt chapter?-->
<!--PAR fine with this here-->
<p>Note for the Green-Ampt method:</p>
<ul>
<li>the initial moisture and porosity values in Table <a href="TwoD-Domains-1.html#tab:tab-tsoilf">7.13</a> above are fractions. The soil capacity is defined as the difference between the saturated moisture content (porosity) and the initial moisture content, hence the initial moisture should not exceed the porosity otherwise the soil capacity is set to zero and no infiltration will occur for that soil type. A <a href="http://wiki.tuflow.com/TUFLOW_Message_2508">WARNING 2508</a> is issued if this occurs.<br />
</li>
<li>the max ponding depth value is an optional value that can be used, if desired, to set a limit for the depth of ponded water (<span class="math inline">\(h_0\)</span>) value used in the Green-Ampt equation <a href="TwoD-Domains-1.html#eq:equ-GA">(7.7)</a>. The minimum of the water depth and the max ponding depth value is used as the <span class="math inline">\(h_0\)</span> value. The default max ponding depth value is 0, to be consistent with the basic form of the Green-Ampt equation, as hydrology models do not necessarily have a depth calculated at cells.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image111"></span>
<img src="images/image111.png" alt=" Example Soils .tsoilf File Format"  />
<p class="caption">
Figure 7.14:  Example Soils .tsoilf File Format
</p>
</div>
<p>One or more soils need to be specified globally and/or via GIS
layers/raster grids to activate the infiltration feature. The first
attribute of the GIS layer/s must be the Soil ID referenced within the
.tsoilf file, in the same way that a 2d_mat layer references a Material
ID stored within the materials .tmf or .csv file.</p>
<table>
<caption>
<span id="tab:tab-SoilAttribute">Table 7.14: </span><strong>2D Soil (2d_soil) GIS Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Soil
</td>
<td style="text-align:left;">
The soil ID value referenced within a Soils File (see Table <a href="TwoD-Domains-1.html#tab:tab-tsoilf">7.13</a>).
</td>
<td style="text-align:left;">
Integer
</td>
</tr>
</tbody>
</table>
<p>Each soil type can have a different infiltration method and infiltration parameters assigned to it, including a no infiltration option, as shown
in Table <a href="TwoD-Domains-1.html#tab:tab-tsoilf">7.13</a>. Other parameters that can optionally be set are:</p>
<ul>
<li>The imperviousness of the surface (see Fraction Impervious parameter
within the materials definition in Table <a href="TwoD-Domains-1.html#tab:tab-MaterialsFile">7.11</a> or Table <a href="TwoD-Domains-1.html#tab:tab-MaterialsFormat">7.10</a>); and<br />
</li>
<li>Groundwater or impervious level beneath the ground surface (refer to
Section <a href="Boundaries-InitialConditions-1.html#IGW-3">8.9.2</a>).</li>
</ul>
<p>The current limit to the number of soils types is 1,000 for TUFLOW classic simulations and 255 for TUFLOW HPC simulations.</p>
<!-- 
### Groundwater {#Groundwater-3}
<!-- EFC to PAR: I think we take out groundwater from 2D domains chapter and put in the initial conditions of the Boundaries chapter, this is where we have set IWL commands. That way we can talk about both GWD/GWL and IGW commands in one section rather than common vs HPC?-->
<!--
#### Groundwater Layer Geometry (2d_gw)

<!--EFC to PAR: how do I split this from the soils section in the 'common' section. I think we should maybe take soils out of common and put it in childs like turbulence?-->
<!-- PAR to EFC: keep in common, but add another tsoilf table in here, highligh additional attributes-->
<!-- move 2d_gw to boundaries chapter. -->
<!--
The geometry of the groundwater layers may be defined with either
<span class="mark">Set</span>, <span class="mark">Read GIS</span>, or
<span class="mark">Read Grid</span> commands with \<Soil Thickness \|
Soil Base Elevation\> (required) and \<Layer N\> (optional). Layer
number 1 is the top most layer. If specifying the layers thicknesses,
the base elevation of each layer is offset below the base of the layer
above (or the surface DEM elevation in the case of the first or topmost groundwater layer) by the thickness of that layer. The bottom most layer (or the top layer for a single layer), if not defined in this way, will
be infinitely deep, with infinite water holding capacity. As such a
layer has no sensible water surface elevation, advection of water is not
possible in an infinitely deep layer. Models with more than one layer
require all layers above the bottom layer to have a specified thickness
or base elevation level. Note that the use of Green-Ampt infiltration
model requires that the top most layer has a finite thickness.

For backward compatibility, it is still possible to set groundwater
depth (GWD) or a groundwater level (GWL) with the
“<span class="mark">Set</span>”, “<span class="mark">Read GIS</span>”,
and “<span class="mark">Read GRID</span>” commands.
<span class="mark">More explanation</span> <span class="mark">needed
…</span>

<span class="mark">It is also possible to define a groundwater depth
(GWD) or a groundwater level (GWL). Any infiltrated water causes the
groundwater level to rise. The rate of rise is influenced by the soil
porosity and initial moisture, for the Green-Ampt method, these
attributes are required, they can optionally be specified for ILCL and
Horton infiltration as described above. If the groundwater level rises
to the ground surface, no additional infiltration will occur. The
default setting is for an infinitely deep groundwater level. Only the
vertical filling of the groundwater table can occur (i.e. there is no
horizontal movement of groundwater, groundwater does not fall over
time).</span>

<span class="mark">The depth to groundwater or groundwater level may be
specified globally and/or via GIS layers/ASCII grids to activate the
feature using one or a combination of the following commands:</span>

<span class="mark">[Set GWD](#tgcSet) or [Set GWL](#tgcSet)  
[Read GIS GWD](#tgcReadGIS) or [Read GIS GWL](#tgcReadGIS)  
[Read GRID GWD](#tgcReadGrid) or [Read GRID GWL](#tgcReadGrid)</span>

<span class="mark">If both a groundwater level and groundwater depth are
specified the higher level is applied. For example, if a GWL of 1.0m is
applied to a cell with elevation of 2.5m and a GWD of 1.0 is applied the
starting groundwater level will be 1.5m (2.5m elevation – 1.0m
GWD).</span>
-->
</div>
</div>
<div id="HydraulicStructures-3" class="section level3 hasAnchor" number="7.3.8">
<h3><span class="header-section-number">7.3.8</span> Hydraulic Structures<a href="TwoD-Domains-1.html#HydraulicStructures-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="introduction-2" class="section level4 hasAnchor" number="7.3.8.1">
<h4><span class="header-section-number">7.3.8.1</span> Introduction<a href="TwoD-Domains-1.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<!--PAR to EFC: don't talk in detail about method D, suggest to use 2d_bg instead. The loss approach is the same-->
<!--EFC: Method D removed. SHG recalled that we decided not to mention it at all-->
<p>Bridges, box culverts and other structures that constrict flow can be
modelled in 2D directly, rather than using 1D elements, provided the flow width of
the structure is of a similar or larger size than the 2D cell size. Cells
are modified in their height (invert and obvert) and width. For bridges,
additional losses associated with piers and flow reaching the underside of the
deck are specified. For box culverts, the additional resistance for
vertical walls is specified. Additional form losses (energy head losses)
can be specified for all flow constrictions.</p>
<p>Weir flow (across levees and other embankments) is modelled in 2D
domains by default, this is handled differently between TUFLOW Classic and TUFLOW HPC. Refer to Sections <a href="TwoD-Domains-1.html#CLA-US-Controlled-3">7.5.2</a> and <a href="TwoD-Domains-1.html#HPC-US-Controlled-3">7.4.4</a> respectively.</p>
<p>Modelling hydraulic structures in 2D domains must be carried out with a
good understanding of the limitations of different approaches and the
different flow regimes possible. The modeller must understand why and
where the energy losses occur when assigning form losses to a 2D cell or
contraction and expansion losses to a 1D element <span class="citation">(<a href="#ref-Syme2001b">Syme, 2001b</a>)</span>.</p>
<p>It is important to note that contraction and expansion losses associated
with structures are modelled differently in 1D and 2D schemes. 1D
schemes rely on applying form loss coefficients, as they cannot simulate
the horizontal or vertical changes in velocity direction and speed. 2D
schemes model these horizontal changes and, therefore, do not require
the introduction of form losses to the same extent as that required for
1D schemes. 2D schemes still however require the introduction of
additional form losses since they do not model losses in the vertical or
fine-scale horizontal effects (such as around a bridge pier). See <span class="citation">Syme (<a href="#ref-Syme2001b">2001b</a>)</span> for further details.</p>
<p>The following webinars by Bill Syme and Greg Collecutt (two TUFLOW Developers) discuss the theory behind the energy losses and affluxes modelling associated with hydraulic structures.</p>
<ul>
<li><a href="https://www.tuflow.com/library/webinars/#structures">Modelling Energy Losses at Structures</a></li>
<li><a href="https://www.tuflow.com/library/webinars/#nov2022_hydraulic_modelling_bridge">1D, 2D &amp; 3D Hydraulic Modelling of Bridges</a></li>
</ul>
<p>Additionally, <a href="https://wiki.tuflow.com/TUFLOW_2D_Hydraulic_Structures">the 2D Hydralic Structures Wiki Page</a> contains information regarding 2D hydraulic structures, including theory, setup and Frequently Asked Questions (FAQs).</p>
<p>It is recommended that the losses through a structure be validated through:</p>
<ul>
<li>Calibration to recorded information (if available).</li>
<li>Cross-checked using desktop calculations based on theory and/or
standard publications (e.g. “Hydraulics of Bridge Waterways” <span class="citation">(<a href="#ref-Bradley1978">Bradley, 1978</a>)</span> or “Guide to Bridge Technology Part 8, Hydraulic Design of
Waterway Structures” <span class="citation">(<a href="#ref-Austroads2018">Austroads, 2018</a>)</span>.</li>
<li>Crosschecked with results using other hydraulic software.</li>
</ul>
<p>To validate structure flows and energy losses:</p>
<ul>
<li>Specify time-series output (PO) lines of flow (Q_) and flow area (QA)
across the structure (see Section <a href="Outputs-1.html#TwoDTS-3">11.3.2</a>). Upstream and
downstream water levels may also be specified using PO points or
extracted from the map (e.g. XMDF) output.<br />
</li>
<li>Using the upstream and downstream water levels, determine whether flow
is upstream or downstream controlled and estimate the flow using
theoretical equations or other methods.<br />
</li>
<li>Using publications such as “Hydraulics of Bridge Waterways”
<span class="citation">(<a href="#ref-Bradley1978">Bradley, 1978</a>)</span> or “Guide to Bridge Technology Part 8, Hydraulic
Design of Waterway Structures” <span class="citation">(<a href="#ref-Austroads2018">Austroads, 2018</a>)</span>, determine the energy
loss coefficient and compare this with the total energy loss
calculated in the model. The total energy loss is given below.
Clearly, any energy losses associated with bed resistance (e.g.
Manning’s equation) need to be allowed for by subtracting this term
from the calculated head difference <span class="math inline">\({(h}_{1} - h_{2})\)</span>.<br />
<span class="math display">\[\zeta_{total} = {(h}_{1} - h_{2})\frac{2g}{V^{2}}\]</span><br />
Where:
<ul>
<li><span class="math inline">\(\zeta_{total}\)</span> = total energy loss<br />
</li>
<li><span class="math inline">\(h_{1}\)</span> = upstream head<br />
</li>
<li><span class="math inline">\(h_{2}\)</span> = downstream head<br />
</li>
<li><span class="math inline">\(V\)</span> = depth and width averaged velocity (i.e. <span class="math inline">\(\frac{Q\_}{QA}\)</span>)</li>
</ul></li>
</ul>
<p>Table <a href="TwoD-Domains-1.html#tab:tab-ModellingApproaches">7.15</a> lists the recommended approaches for modelling 1D and 2D structures using TUFLOW. This is discussed further in the following paragraphs.</p>
<table>
<caption>
<span id="tab:tab-ModellingApproaches">Table 7.15: </span><strong>Hydraulic Structure Modelling Approaches</strong>
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Structure
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
1D Approach
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
2D Approach
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Box Culvert<br />
(For culverts with a steep slope, use a 1D element)
</td>
<td style="text-align:left;">
OK
</td>
<td style="text-align:left;">
OK
</td>
</tr>
<tr>
<td style="text-align:left;">
Circular Culvert
</td>
<td style="text-align:left;">
OK
</td>
<td style="text-align:left;">
N/A
</td>
</tr>
<tr>
<td style="text-align:left;">
Bridge
</td>
<td style="text-align:left;">
OK
</td>
<td style="text-align:left;">
OK
</td>
</tr>
<tr>
<td style="text-align:left;">
Weirs
</td>
<td style="text-align:left;">
OK
</td>
<td style="text-align:left;">
OK
</td>
</tr>
</tbody>
</table>
<p><strong>1D Approach</strong></p>
<p>1D structures are discussed in Section <a href="OneD-Domains-1.html#Structures-2">5.8</a>. 1D modelling is the
preferred approach where the total structure width is less than one
or two 2D cells. Entry and/or exit losses are defined for each structure.
Testing has shown that these losses may need to be reduced where the
structure width is significant compared with the cell size <span class="citation">(<a href="#ref-Syme2001b">Syme, 2001b</a>)</span>.</p>
<p>1D structures can be linked to the 2D domain using either an SX or HX
connection, as outlined in (see Section <a href="DomainLinking-1.html#OneD2dLinking-2">10.2</a>). The influence of these connection types on the modelled flow behaviour is shown in Figure <a href="TwoD-Domains-1.html#fig:fig-image114">7.17</a>.</p>
<p><strong>SX Link:</strong> Momentum is not transferred into or out of the 1D element
to/from the 2D domain. “Suppressed” flow patterns in the 2D domain occur
at the structure outlet when using 1D elements, especially if the
structure width is significant compared with the cell size. The water
tends to spread, rather than jet out, as there is no inertia across the
link. The effect of this is illustrated in Figure <a href="TwoD-Domains-1.html#fig:fig-image113">7.16</a>, which shows the effect on flow patterns and the preservation of inertia across 1D/2D links when modelling a structure. Figure <a href="TwoD-Domains-1.html#fig:fig-image113">7.16</a> (red velocity arrows) is that using SX links, whilst Figure <a href="TwoD-Domains-1.html#fig:fig-image112">7.15</a> (green arrows) is that using a fully 2D solution. As can be seen, using a SX link the water tends to spread from the structure outlet, as opposed to forming a jet as in the fully 2D solution which is conserving momentum. When using the SX link,
a jet like effect can be created using “wing walls” in the 2D domain at
the structure outlet by assigning flood free elevations to the ZU and ZV
Zpts either side of where the 1D element discharges into the 2D domain.</p>
<p><strong>HX Link:</strong> Momentum is not transferred into or out of the 1D element
to/from the 2D domain, however the velocity field across the HX link is
assumed to be undisturbed. Provided the HX link is appropriately located
(i.e. perpendicular to the flow field) this produces the effect of
preserving momentum, as illustrated by the dark blue arrows (Figure <a href="TwoD-Domains-1.html#fig:fig-image114">7.17</a>). Use of HX links at a structure may require a smaller 1D timestep than that required by a SX link.</p>
<p><strong>2D Approach</strong></p>
<p>2D representation of structures is preferred where the
total structure width is greater than one or two 2D cells. The flow area
must be adequately represented by the 2D Zpts and any adjustments to
cell widths (see Section <a href="TwoD-Domains-1.html#lfcsh-4">7.3.8.3</a> and <a href="TwoD-Domains-1.html#bg-layer-4">7.3.8.2</a>. The head drop across the structure during different flow regimes should be validated against other methods and/or literature. Some additional form losses are normally required to achieve correct head drop (see <span class="citation">Syme (<a href="#ref-Syme2001b">2001b</a>)</span>). Momentum is transferred through the
structure as shown in the top image (green arrows) in Figure <a href="TwoD-Domains-1.html#fig:fig-image112">7.15</a>, providing more realistic flow patterns than using a 1D element with a SX link, as illustrated by the middle image (red arrows) in Figure <a href="TwoD-Domains-1.html#fig:fig-image113">7.16</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image112"></span>
<img src="images/image112.png" alt="Flow patterns using 2D FC cells (i.e. a fully 2D solution)"  />
<p class="caption">
Figure 7.15: Flow patterns using 2D FC cells (i.e. a fully 2D solution)
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image113"></span>
<img src="images/image113.png" alt="Flow patterns using a 1D element connected to 2D SX links"  />
<p class="caption">
Figure 7.16: Flow patterns using a 1D element connected to 2D SX links
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image114"></span>
<img src="images/image114.png" alt="Flow patterns using a 1D element connected to 2D HX links"  />
<p class="caption">
Figure 7.17: Flow patterns using a 1D element connected to 2D HX links
</p>
</div>
</div>
<div id="bg-layer-4" class="section level4 hasAnchor" number="7.3.8.2">
<h4><span class="header-section-number">7.3.8.2</span> 2D Bridge Structures (2d_bg)<a href="TwoD-Domains-1.html#bg-layer-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Modelling bridge structures in the 2D domain is possible using the BG
Shape input layer (2d_bg). The 2d_bg layer facilitates the modelling of
bridge structures based on research on energy losses <span class="citation">(<a href="#ref-BridgeDeckAfflux">Collecutt et al., 2022</a>)</span>. This method is similar to the Layered Flow
Constrictions (described below in Section <a href="TwoD-Domains-1.html#lfcsh-4">7.3.8.3</a>), however, some key updates have been made. The layers in a
2d_bg are called the “pier layer” and the “super structure layer”, which
consists of the “deck layer” and the “rail layer”.</p>
<p>Bridges can be defined as either a line or polygon GIS feature using the
.tgc command <a href="TGCCommands-1.html#tgcReadGISBGShape">Read GIS BG Shape</a>. The layer
attribute description is provided in Figure <a href="TwoD-Domains-1.html#fig:fig-2DBGAttributes">7.18</a> and Table <a href="TwoD-Domains-1.html#tab:tab-BridgeShapeAttributeDescriptions">7.16</a>.</p>
<p>Points can be used to spatially vary the bridge soffit, deck depth and
rail depth, with the BG Shape points input layer (2d_bg_pts). The layer
attribute description is provided in Table <a href="TwoD-Domains-1.html#tab:tab-BridgePointAttributeDescriptions">7.17</a>. This can be used to model an arch bridge or sloping deck. The point objects can be placed in
a separate layer to the line or polygon GIS features.</p>
<p>The 2d_bg layer adjusts the FLC value in the vertical as follows:</p>
<p><span class="math display">\[\zeta_{total} = \left( \zeta_{pier} + \zeta_{SuperS}\frac{y_{SuperS}}{D_{IP}} \right)\frac{(y_{pier} + y_{SuperS})}{y_{total}}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\zeta_{pier}\)</span> = FLC of the pier layer.<br />
</li>
<li><span class="math inline">\(\zeta_{SuperS}\)</span> = FLC to the superstructure layer.<br />
</li>
<li><span class="math inline">\(y_{SuperS}\)</span> = depth of water in the superstructure layer (cannot exceed</li>
<li><span class="math inline">\(D_{IP}\)</span>).<br />
</li>
<li><span class="math inline">\(D_{IP}\)</span> = depth to the inflection point from the bridge soffit.<br />
</li>
<li><span class="math inline">\(y_{pier}\)</span> = depth of water in the pier layer (cannot exceed</li>
<li><span class="math inline">\(D_{pier}\)</span>).<br />
</li>
<li><span class="math inline">\(D_{pier}\)</span> = depth of the pier layer, i.e. from the bed elevation to the bridge soffit.<br />
</li>
<li><span class="math inline">\(\zeta_{total}\)</span> = overall form loss coefficient applied</li>
</ul>
<p>The vertical distribution of the form loss coefficient has the following
characteristics:</p>
<ul>
<li>Water level below the deck layer: The same result as the 2d_lfcsh
approaches, i.e. a constant form loss based on that specified for the
pier layer (<span class="math inline">\(\zeta_{pier}\)</span>) is applied.<br />
</li>
<li>Water level between the deck soffit and the inflection point: The FLC
value is linearly increased from <span class="math inline">\(\zeta_{pier}\)</span> to
<span class="math inline">\(\zeta_{pier} + \zeta_{SuperS}\)</span>. The observations from the CFD and the
field measurement indicate the inflection point is located around 1.6
times the bridge deck depth above the bridge soffit. The “Inflection
Depth” (<span class="math inline">\(D_{IP}\)</span>) is assumed as:<br />
<span class="math display">\[D_{IP} = {IPf}_{SuperS}\left( D_{deck}\phi_{Deck} + D_{Rail}\phi_{Rail} \right)\]</span><br />
Where:
<ul>
<li><span class="math inline">\({IPf}_{SuperS}\)</span> = A factor to set the elevation of the inflection point
(IP).<br />
</li>
<li><span class="math inline">\(D_{deck}\)</span> = depth of the bridg deck layer.<br />
</li>
<li><span class="math inline">\(\phi_{Deck}\)</span> = blockage of the deck layer.<br />
</li>
<li><span class="math inline">\(D_{Rail}\)</span> = depth of the rail layer.<br />
</li>
<li><span class="math inline">\(\phi_{Rail}\)</span> = blockage of the rail layer.<br />
</li>
</ul></li>
<li>Note that the effect of partial blockage at the rail layer is
considered by adding the rail layer depth (<span class="math inline">\(D_{Rail}\)</span>) to the
inflection depth proportionally based on the rail layer blockage
(<span class="math inline">\(\phi_{Deck}\)</span>).<br />
</li>
<li>Above the inflection point the FLC gradually reduces with increasing
depth (in a similar manner to the 2D Layered Flow Constrictions METHOD
B and METHOD C approaches). This is to simulate the transition to
drowned flow and tendency to zero energy losses with increasing depth
over the bridge deck.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-2DBGAttributes"></span>
<img src="images/image117.jpeg" alt="2D BG Shape Attributes and Vertical Distribution of Form Loss Coefficient" width="80%" />
<p class="caption">
Figure 7.18: 2D BG Shape Attributes and Vertical Distribution of Form Loss Coefficient
</p>
</div>
<p>The 2023-03-AD build implemented three extra approaches to adjust the FLC value between in the deck soffit and the inflection point:</p>
<p><tcmd><a href="TCFCommands-1.html#tcfBGFLCDefaultApproach">BG FLC Default Approach</a></tcmd><teq> == </teq><tblk>{LINEAR} | LINEAR-CONSTANT | PARABOLIC | INVERTED-PARABOLIC </tblk></p>
<ul>
<li>LINEAR: the default option introduced above. The depth averaged FLC value is linearly increased from the bottom of the bridge deck to the inflection point. After the inflection point it gradually reduces.</li>
<li>LINEAR-CONSTANT: the depth averaged FLC is linearly increased from the bottom of the bridge deck to the top of the bridge deck. Between the top of the bridge deck and the inflection point, the FLC is kept constant. After the inflection point it gradually reduces.</li>
<li>PARABOLIC: the depth averaged FLC is increased using a parabolic function from the bottom of the bridge deck to the inflection point. After the inflection point it gradually reduces.</li>
<li>INVERTED-PARABOLIC: the depth averaged FLC is increased using an inverted parabolic function from the bottom of the bridge deck to the inflection point. After the inflection point it gradually reduces.</li>
</ul>
<p>This approach can be changed for individual BG structure using the Options attribute (see Table <a href="TwoD-Domains-1.html#tab:tab-BridgeShapeAttributeDescriptions">7.16</a>). The vertical profiles of the depth averaged FLC values applied by the four methods are illustrated in the figure below:</p>
<center>
<div class="figure"><span style="display:block;" id="fig:fig-BGFLCApproach"></span>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-6b1ff493ca8f9ef7fffd" style="width:80%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-6b1ff493ca8f9ef7fffd">{"x":{"visdat":{"cf6c19054175":["function () ","plotlyVisDat"]},"cur_data":"cf6c19054175","attrs":{"cf6c19054175":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"name":"LINEAR","y":[0,2,2.1000000000000001,2.2000000000000002,2.2999999999999998,2.3999999999999999,2.5,2.6000000000000001,2.7000000000000002,2.7999999999999998,2.8999999999999999,3,3.1000000000000001,3.2000000000000002,3.2999999999999998,3.3999999999999999,3.5,3.6000000000000001,3.7999999999999998,4,4.2000000000000002,4.4000000000000004,4.5999999999999996,4.7999999999999998,5,5.2000000000000002,5.4000000000000004,5.5999999999999996,5.7999999999999998],"x":[0.10000000000000001,0.10000000000000001,0.12500000000000003,0.15000000000000005,0.17499999999999996,0.19999999999999998,0.22500000000000001,0.25,0.27500000000000002,0.29999999999999993,0.32499999999999996,0.34999999999999998,0.375,0.40000000000000002,0.42499999999999993,0.44999999999999996,0.47500000000000009,0.50000000000000011,0.47368421052631593,0.45000000000000012,0.42857142857142866,0.40909090909090917,0.39130434782608708,0.37500000000000011,0.3600000000000001,0.34615384615384626,0.33333333333333343,0.32142857142857156,0.31034482758620702],"hovertemplate":"%{y:.2f}<extra><\/extra>","line":{"color":"rgb(26,189,201)"},"type":"scatter","mode":"lines","inherit":true},"cf6c19054175.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"name":"LINEAR-CONSTANT","y":[0,2,2.1000000000000001,2.2000000000000002,2.2999999999999998,2.3999999999999999,2.5,2.6000000000000001,2.7000000000000002,2.7999999999999998,2.8999999999999999,3,3.1000000000000001,3.2000000000000002,3.2999999999999998,3.3999999999999999,3.5,3.6000000000000001,3.7999999999999998,4,4.2000000000000002,4.4000000000000004,4.5999999999999996,4.7999999999999998,5,5.2000000000000002,5.4000000000000004,5.5999999999999996,5.7999999999999998],"x":[0.10000000000000001,0.10000000000000001,0.14000000000000004,0.18000000000000008,0.21999999999999995,0.26000000000000001,0.30000000000000004,0.34000000000000008,0.38000000000000012,0.41999999999999993,0.45999999999999996,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.47368421052631593,0.45000000000000012,0.42857142857142866,0.40909090909090917,0.39130434782608708,0.37500000000000011,0.3600000000000001,0.34615384615384626,0.33333333333333343,0.32142857142857156,0.31034482758620702],"hovertemplate":"%{y:.2f}<extra><\/extra>","line":{"color":"rgb(0,85,129)"},"type":"scatter","mode":"lines","inherit":true},"cf6c19054175.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"name":"PARABOLIC","y":[0,2,2.1000000000000001,2.2000000000000002,2.2999999999999998,2.3999999999999999,2.5,2.6000000000000001,2.7000000000000002,2.7999999999999998,2.8999999999999999,3,3.1000000000000001,3.2000000000000002,3.2999999999999998,3.3999999999999999,3.5,3.6000000000000001,3.7999999999999998,4,4.2000000000000002,4.4000000000000004,4.5999999999999996,4.7999999999999998,5,5.2000000000000002,5.4000000000000004,5.5999999999999996,5.7999999999999998],"x":[0.10000000000000001,0.10000000000000001,0.1484375,0.19375000000000009,0.23593749999999991,0.27500000000000002,0.31093749999999998,0.34375,0.37343750000000009,0.40000000000000002,0.42343750000000002,0.44374999999999998,0.4609375,0.47499999999999998,0.48593750000000002,0.49375000000000002,0.49843749999999998,0.5,0.47368421052631593,0.45000000000000012,0.42857142857142866,0.40909090909090917,0.39130434782608708,0.37500000000000011,0.3600000000000001,0.34615384615384626,0.33333333333333343,0.32142857142857156,0.31034482758620702],"hovertemplate":"%{y:.2f}<extra><\/extra>","line":{"color":"rgb(79,86,80)"},"type":"scatter","mode":"lines","inherit":true},"cf6c19054175.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"name":"INVERTED-PARABOLIC","y":[0,2,2.1000000000000001,2.2000000000000002,2.2999999999999998,2.3999999999999999,2.5,2.6000000000000001,2.7000000000000002,2.7999999999999998,2.8999999999999999,3,3.1000000000000001,3.2000000000000002,3.2999999999999998,3.3999999999999999,3.5,3.6000000000000001,3.7999999999999998,4,4.2000000000000002,4.4000000000000004,4.5999999999999996,4.7999999999999998,5,5.2000000000000002,5.4000000000000004,5.5999999999999996,5.7999999999999998],"x":[0.10000000000000001,0.10000000000000001,0.10156250000000001,0.10625000000000001,0.11406249999999998,0.125,0.13906250000000001,0.15625000000000003,0.17656250000000007,0.19999999999999996,0.22656249999999997,0.25624999999999998,0.2890625,0.32500000000000007,0.36406249999999996,0.40624999999999989,0.45156249999999998,0.5,0.47368421052631593,0.45000000000000012,0.42857142857142866,0.40909090909090917,0.39130434782608708,0.37500000000000011,0.3600000000000001,0.34615384615384626,0.33333333333333343,0.32142857142857156,0.31034482758620702],"hovertemplate":"%{y:.2f}<extra><\/extra>","line":{"color":"rgb(226,1,119)"},"type":"scatter","mode":"lines","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Depth Averaged FLC","range":[0,0.59999999999999998]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Depth","range":[0,5]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":true,"displaylogo":false},"data":[{"name":"LINEAR","y":[0,2,2.1000000000000001,2.2000000000000002,2.2999999999999998,2.3999999999999999,2.5,2.6000000000000001,2.7000000000000002,2.7999999999999998,2.8999999999999999,3,3.1000000000000001,3.2000000000000002,3.2999999999999998,3.3999999999999999,3.5,3.6000000000000001,3.7999999999999998,4,4.2000000000000002,4.4000000000000004,4.5999999999999996,4.7999999999999998,5,5.2000000000000002,5.4000000000000004,5.5999999999999996,5.7999999999999998],"x":[0.10000000000000001,0.10000000000000001,0.12500000000000003,0.15000000000000005,0.17499999999999996,0.19999999999999998,0.22500000000000001,0.25,0.27500000000000002,0.29999999999999993,0.32499999999999996,0.34999999999999998,0.375,0.40000000000000002,0.42499999999999993,0.44999999999999996,0.47500000000000009,0.50000000000000011,0.47368421052631593,0.45000000000000012,0.42857142857142866,0.40909090909090917,0.39130434782608708,0.37500000000000011,0.3600000000000001,0.34615384615384626,0.33333333333333343,0.32142857142857156,0.31034482758620702],"hovertemplate":["%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>"],"line":{"color":"rgb(26,189,201)"},"type":"scatter","mode":"lines","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"name":"LINEAR-CONSTANT","y":[0,2,2.1000000000000001,2.2000000000000002,2.2999999999999998,2.3999999999999999,2.5,2.6000000000000001,2.7000000000000002,2.7999999999999998,2.8999999999999999,3,3.1000000000000001,3.2000000000000002,3.2999999999999998,3.3999999999999999,3.5,3.6000000000000001,3.7999999999999998,4,4.2000000000000002,4.4000000000000004,4.5999999999999996,4.7999999999999998,5,5.2000000000000002,5.4000000000000004,5.5999999999999996,5.7999999999999998],"x":[0.10000000000000001,0.10000000000000001,0.14000000000000004,0.18000000000000008,0.21999999999999995,0.26000000000000001,0.30000000000000004,0.34000000000000008,0.38000000000000012,0.41999999999999993,0.45999999999999996,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.47368421052631593,0.45000000000000012,0.42857142857142866,0.40909090909090917,0.39130434782608708,0.37500000000000011,0.3600000000000001,0.34615384615384626,0.33333333333333343,0.32142857142857156,0.31034482758620702],"hovertemplate":["%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>"],"line":{"color":"rgb(0,85,129)"},"type":"scatter","mode":"lines","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"name":"PARABOLIC","y":[0,2,2.1000000000000001,2.2000000000000002,2.2999999999999998,2.3999999999999999,2.5,2.6000000000000001,2.7000000000000002,2.7999999999999998,2.8999999999999999,3,3.1000000000000001,3.2000000000000002,3.2999999999999998,3.3999999999999999,3.5,3.6000000000000001,3.7999999999999998,4,4.2000000000000002,4.4000000000000004,4.5999999999999996,4.7999999999999998,5,5.2000000000000002,5.4000000000000004,5.5999999999999996,5.7999999999999998],"x":[0.10000000000000001,0.10000000000000001,0.1484375,0.19375000000000009,0.23593749999999991,0.27500000000000002,0.31093749999999998,0.34375,0.37343750000000009,0.40000000000000002,0.42343750000000002,0.44374999999999998,0.4609375,0.47499999999999998,0.48593750000000002,0.49375000000000002,0.49843749999999998,0.5,0.47368421052631593,0.45000000000000012,0.42857142857142866,0.40909090909090917,0.39130434782608708,0.37500000000000011,0.3600000000000001,0.34615384615384626,0.33333333333333343,0.32142857142857156,0.31034482758620702],"hovertemplate":["%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>"],"line":{"color":"rgb(79,86,80)"},"type":"scatter","mode":"lines","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"name":"INVERTED-PARABOLIC","y":[0,2,2.1000000000000001,2.2000000000000002,2.2999999999999998,2.3999999999999999,2.5,2.6000000000000001,2.7000000000000002,2.7999999999999998,2.8999999999999999,3,3.1000000000000001,3.2000000000000002,3.2999999999999998,3.3999999999999999,3.5,3.6000000000000001,3.7999999999999998,4,4.2000000000000002,4.4000000000000004,4.5999999999999996,4.7999999999999998,5,5.2000000000000002,5.4000000000000004,5.5999999999999996,5.7999999999999998],"x":[0.10000000000000001,0.10000000000000001,0.10156250000000001,0.10625000000000001,0.11406249999999998,0.125,0.13906250000000001,0.15625000000000003,0.17656250000000007,0.19999999999999996,0.22656249999999997,0.25624999999999998,0.2890625,0.32500000000000007,0.36406249999999996,0.40624999999999989,0.45156249999999998,0.5,0.47368421052631593,0.45000000000000012,0.42857142857142866,0.40909090909090917,0.39130434782608708,0.37500000000000011,0.3600000000000001,0.34615384615384626,0.33333333333333343,0.32142857142857156,0.31034482758620702],"hovertemplate":["%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>"],"line":{"color":"rgb(226,1,119)"},"type":"scatter","mode":"lines","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 7.19: Depth Averaged FLC Applied Using Four Adjustment Approaches
</p>
</div>
</center>
<p>Other key features of the BG layer that are different from the Layered
Flow Constriction are:</p>
<ul>
<li>The BG layer does not apply geometry updates. This not only offers
simplicity, but also is a desirable option considering that the size
of TIN polygons used to modify the bridge bed elevations are often
different from the size of polygon used to select BG cell faces.<br />
</li>
<li>For a line layer a “Deck_Width” value of zero sets the layer as a thin
line. It selects one row of faces in the direction of flow, and the
FLC value is applied to the faces unchanged. A “Deck_Width” value
larger than zero sets the layer as a thick line that selects a whole
cell, i.e. two faces in the direction of flow. The FLC values at the
faces are divided by two. The wide line feature is not supported by
the BG layer. BG polygon shapes are recommended if more than 3 rows of
faces must be selected.<br />
</li>
<li>For a polygon layer, the “Deck_Width” defines the bridge width in the
predominant direction of flow. This value is used to distribute the
total FLC value to the selected faces, i.e.:<br />
<span class="math display">\[\zeta_{face} = \zeta_{total} \times Deck\_Width \times Cell Size  \]</span>
This means users no longer need to convert the FLC value to “form loss
per metre”, which is required by the Layered Flow Constrictions
polygons.</li>
</ul>
<p>The overall blockage of the face is calculated using the same method as
the Layered Flow Constriction:</p>
<p><span class="math display">\[\phi_{total} = \frac{{(y}_{pier}\phi_{pier} + y_{deck}\phi_{deck} + y_{rail}\phi_{rail})}{y_{total}}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\phi_{n}\)</span> = layer n blockage.<br />
</li>
<li><span class="math inline">\(y_{n}\)</span> = layer n water depth (set to zero if dry and cannot exceed
depth of layer).<br />
</li>
<li><span class="math inline">\(\phi_{total}\)</span> = overall cell face blockage applied.</li>
</ul>
<p>The FLC value applies an energy loss across 2D cell faces as:</p>
<p><span class="math display">\[\mathrm{\Delta}h = \zeta_{total}\frac{V^{2}}{2g}\]</span></p>
<p>where <span class="math inline">\(V\)</span> is the 2D cell face velocity in the presence of the blockage.
When setting the blockage values, considerations need to be taken into
account whether the source of the FLC value is based on the approach
velocity (the velocity in the absence of piers blockage) or structure
velocity (the velocity with area blocked out by the piers). For example, Hydraulics of Bridge Waterways <span class="citation">(<a href="#ref-Bradley1978">Bradley, 1978</a>)</span> or Guide to Bridge Technology <span class="citation">(<a href="#ref-Austroads2018">Austroads, 2018</a>)</span> derives FLC value based on the
cross-sectional averaged velocity in the absence of piers, and thus it
is recommended to set the Layer 1 blockage value as zero
(0). For more information, please see the <a href="https://wiki.tuflow.com/TUFLOW_2D_Hydraulic_Structures">2D Hydraulic Structures</a> TUFLOW Wiki page.</p>
<!-- PAR to EFC: is this sentence necessary, i thought we had a sentence in the 2d_lfcsh layer about using a blockage of zero in layer 1 as that the velocity used in bradley 1978 doen not accoutn for the blockage of the peirs, did you delete this?-->
<!--resolved-->
<table>
<caption>
<span id="tab:tab-BridgeShapeAttributeDescriptions">Table 7.16: </span><strong>2D Bridge Shape (2d_bg) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
ID
</td>
<td style="text-align:left;">
Unique identifier up to 32 characters in length. It may contain any character except for quotes and commas, and cannot be blank. As a general rule, spaces and special characters (e.g. “\”) should be avoided, although they are accepted. The same ID can be used for a channel and a node, but no two nodes and no two channels can have the same ID.
</td>
<td style="text-align:left;">
Char(32)
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Options
</td>
<td style="text-align:left;">
This attribute can be used to overwrite the global setting specified with the .tcf command <a href="TCFCommands-1.html#tcfBGFLCDefaultApproach">BG FLC Default Approach</a> to change FLC calulation method individually.
</td>
<td style="text-align:left;">
Char(32)
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Pier_pBlockage
</td>
<td style="text-align:left;">
<p>The percentage blockage of the pier Layer. For example, enter ‘5’ for a blockage of 5%.</p>
Note: there is no need to apply a blockage value if the FLC is estimated based on the approach velocity (the velocity in the absence of piers). For more discussion, please see the <a href="https://wiki.tuflow.com/index.php?title=TUFLOW_2D_Hydraulic_Structures">TUFLOW Wiki</a> page on the 2D Hydraulic Structures.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Pier_FLC
</td>
<td style="text-align:left;">
Pier layer form loss coefficient.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
Deck_Soffit
</td>
<td style="text-align:left;">
The elevation of the bridge soffit (m or ft).
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
Deck_Depth
</td>
<td style="text-align:left;">
The thickness of the bridge deck (m or ft).
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
Deck_Width
</td>
<td style="text-align:left;">
<p><b>Line:</b></p>
<p>If equal to zero, sets the layer as a thin line and selects one row of faces in the direction of flow. The FLC value is applied to the faces unchanged. If larger than zero, sets the layer as a thick line that selects a whole cell, i.e. two faces in the direction of flow. The FLC values at the faces are divided by two.</p>
<p><b>Polygon:</b></p>
Defines the bridge width in the predominant direction of flow (m or ft). This value is used to distribute the total FLC value to the selected faces.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
Deck_pBlockage
</td>
<td style="text-align:left;">
The percentage blockage of the deck layer. Enter ‘100’ for a solid bridge deck obstruction.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
Rail_Depth
</td>
<td style="text-align:left;">
The depth of the rail layer (m or ft).
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
Rail_pBlockage
</td>
<td style="text-align:left;">
The percentage blockage of the rail layer.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
SuperS_FLC
</td>
<td style="text-align:left;">
The combined form loss coefficient for the deck and the rail layers. Two layers are treated as a single “super structure” layer in this new bridge method.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
SuperS_Ipf
</td>
<td style="text-align:left;">
A factor to set the elevation of the inflection point (IP) at which the transition from pressure flow to drowned flow commences. The default value is 1.6.
</td>
<td style="text-align:left;">
Char(64)
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
Cf
</td>
<td style="text-align:left;">
A calibration factor used to adjust the automatically generated FLC (default = 1.0).
</td>
<td style="text-align:left;">
Float
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:tab-BridgePointAttributeDescriptions">Table 7.17: </span><strong>2D Bridge Shape Points (2d_bg_pts) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Deck_Soffit
</td>
<td style="text-align:left;">
The elevation of the bridge soffit (m or ft).
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Deck_Depth
</td>
<td style="text-align:left;">
The thickness of the bridge deck (m or ft).
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Rail_Depth
</td>
<td style="text-align:left;">
The depth of the rail layer (m or ft).
</td>
<td style="text-align:left;">
Float
</td>
</tr>
</tbody>
</table>
<div id="bg-autoFLC-4" class="section level5 hasAnchor" number="7.3.8.2.1">
<h5><span class="header-section-number">7.3.8.2.1</span> Automatic Generation of Superstructure FLC<a href="TwoD-Domains-1.html#bg-autoFLC-4" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The 2023-03-AD build implemented a feature to automatically generate the superstructure FLC value based on the CFD benchmarking study <span class="citation">(<a href="#ref-BridgeDeckAfflux">Collecutt et al., 2022</a>)</span> if the SuperS_FLC attribute is left blank.</p>
<p><tcmd><a href="TCFCommands-1.html#tcfBlankBGFLCApproach">Blank BG FLC Approach</a></tcmd><teq> == </teq><tblk>{NONE} | METHOD A | METHOD B </tblk></p>
<ul>
<li>NONE: The default approach, i.e. the superstructure FLC must be specified manually.<br />
</li>
<li>METHOD A: The blank superstructure FLC values will be calculated based on the ratio of the depth of the pier layer (<span class="math inline">\(D_{Pier}\)</span> in the equations above) and the thickness of the super structure layer:<br />
<span class="math display">\[T_{SuperS}  = D_{Deck}{Blockage}_{Deck} + D_{Rail}{Blockage}_{Rail}\]</span><br />
</li>
<li>METHOD B: The blank superstructure FLC values will be calculated based on the ratio of the depth of the pier layer (<span class="math inline">\(D_{Pier}\)</span>) and the thickness of the deck layer:<br />
<span class="math display">\[T_{SuperS} = D_{Deck}{Blockage}_{Deck}\]</span></li>
</ul>
<p>With Method A and B, the superstructure FLC value is linearly interpolated within the <span class="math inline">\(D_{Pier}\)</span>/<span class="math inline">\(T_{SuperS}\)</span> range of 1~10 and capped at 0.6 and 0.16 outside this range, as shown in the Figure <a href="TwoD-Domains-1.html#fig:fig-CFDBridgeFLC">7.20</a>.</p>
<p>A calibration factor specified by the 2d_bg ‘Cf’ attribute is applied as a multiplier to the automatically generated superstructure FLC (Cf = 1 if not specified).</p>
<center>
<div class="figure"><span style="display:block;" id="fig:fig-CFDBridgeFLC"></span>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f32d5803686037411acb" style="width:50%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-f32d5803686037411acb">{"x":{"visdat":{"cf6c4b2b72d1":["function () ","plotlyVisDat"]},"cur_data":"cf6c4b2b72d1","attrs":{"cf6c4b2b72d1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"name":"Category 1","y":[0.59999999999999998,0.59999999999999998,0.41999999999999998,0.28000000000000003,0.20000000000000001,0.16,0.16],"x":[-10,1,2,4,6,10,20],"hovertemplate":"%{y:.2f}<extra><\/extra>","line":{"color":"rgb(26,189,201)"},"point":{"color":"rgb(26,189,201)"},"type":"scatter","markers":"true","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"D<sub>Pier<\/sub>/T<sub>SuperS<\/sub>","range":[0,12]},"yaxis":{"domain":[0,1],"automargin":true,"title":"FLC","range":[0,0.69999999999999996]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":true,"displaylogo":false},"data":[{"name":"Category 1","y":[0.59999999999999998,0.59999999999999998,0.41999999999999998,0.28000000000000003,0.20000000000000001,0.16,0.16],"x":[-10,1,2,4,6,10,20],"hovertemplate":["%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>","%{y:.2f}<extra><\/extra>"],"line":{"color":"rgb(26,189,201)"},"point":{"color":"rgb(26,189,201)"},"type":"scatter","markers":"true","mode":"markers+lines","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 7.20: <strong>CFD benchmarking study of FLC vs <span class="math inline">\(D_{Pier}\)</span>/<span class="math inline">\(T_{SuperS}\)</span> ratio (<span class="math inline">\(h_{B}\)</span>/<span class="math inline">\(T\)</span> in the original paper)</strong>
</p>
</div>
</center>
</div>
</div>
<div id="lfcsh-4" class="section level4 hasAnchor" number="7.3.8.3">
<h4><span class="header-section-number">7.3.8.3</span> Layered Flow Constrictions (2d_lfcsh Layers)<a href="TwoD-Domains-1.html#lfcsh-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<!-- PAR: have reworded as previously we said it is similar to FCs, but these had not been introduced yet-->
<p>Layered flow constrictions allow losses and blockages to be varied with water
depth. This provides the opportunity to model the flow under and over a
bridge deck, or a pipeline crossing a waterway.</p>
<p><strong>Note: The 2023-03-AA release introduced the 2d_bg layer, see <a href="TwoD-Domains-1.html#bg-layer-4">2D Bridge Structures</a>. It is recommended that it be used for representation of bridges. Prior to this, bridges were commonly modelled using a 2d_lfcsh.</strong></p>
<p>Four vertical layers within a layered flow constriction (not GIS layers) are represented. The lower three layers each have their own attributes. Each layer is
assigned its own percentage blockage and form loss coefficient. The top
(fourth) layer assumes the flow in Layer 4 is unimpeded. Within the same
shape, the invert of the bed, and thickness of each layer can vary in
3D.</p>
<p>For example, the layers of a bridge structure could be defined as
follows.</p>
<ul>
<li><strong>Layer 1:</strong> Beneath the bridge deck. Might be 5% blocked due to the
bridge piers and have a small form loss for the energy losses
associated with the piers.<br />
</li>
<li><strong>Layer 2:</strong> The bridge deck. This would be 100% blocked and the form
loss coefficient would increase due to the additional energy losses
associated with flow surcharging the deck.<br />
</li>
<li><strong>Layer 3:</strong> The bridge rails. These might be anything from 100%
blocked (solid concrete rails) to 10% blocked (very open rails). Some
form losses would be specified depending on the type of rails.<br />
</li>
<li><strong>Layer 4:</strong> Flow over the top of the rails - flow is assumed to be
unimpeded.</li>
</ul>
<p>Layered flow constrictions function by adjusting the flow width of the 2D cell so as to
represent the combination of blockages of the four layers. When the flow
is only within Layer 1, only the attributes of Layer 1 are applied. As
the water level rises into Layer 2, the influence of the Layer 2
attributes increase as the water continues to rise. Similarly, for Layer
3 and Layer 4.</p>
<p>The cell side flow width is calculated by summing the flow areas of each
layer (including the effects of layer blockages) and dividing by the
water depth.</p>
<p>As of the 2020-10 release three options are available to specify the
method in which form losses are applied:</p>
<ul>
<li><strong>METHOD A</strong> (CUMULATE in releases prior to 2020-10): Accumulates losses through each of the layers in the 2d_lfcsh as the depth of water increases.<br />
</li>
<li><strong>METHOD B</strong> (PORTION in releases prior to 2020-10) – the default: Proportions the losses through each of the layers in the 2d_lfcsh based on the depth of water. - <strong>METHOD C</strong>: Combines the METHOD A and METHOD B approaches by utilising METHOD A through to the top of Layer 3 and METHOD B above Layer 3.<br />
<!-- - **METHOD D**: Allows the modeller to control the depth at which the losses start to reduce when the flow transitions between pressure flow and drowned flow. From the 2023-03-AA release and onwards it is recommended to use the 2d_bg layer, see Section \@ref(bg-layer-4).--></li>
</ul>
<p>The following .tcf command can be used to set the default method to be applied to all structures in the model:</p>
<p><tcmd><a href="TCFCommands-1.html#tcfLayeredFLCDefaultApproach">Layered FLC Default Approach</a></tcmd><teq> == </teq><tblk>[ METHOD A | {METHOD B} | METHOD C ]</tblk></p>
<p>To specify the method on a structure by structure basis, populate the Shape_Options attribute (refer to Table <a href="TwoD-Domains-1.html#tab:tab-LayeredFlow">7.18</a>) with
either “Method A”, “Method B” (the default) or “Method C”.</p>
<p>Whilst the default approach of using METHOD B is unchanged for backward compatibility purposes, it is recommended the new approaches of METHOD C or the TUFLOW HPC’s 2d_bg layer approach be considered as they are shown to emulate behaviour from CFD modelling more closely for pressurised flow conditions <span class="citation">(<a href="#ref-BridgeDeckAfflux">Collecutt et al., 2022</a>)</span>.</p>
<p>Detailed explanation outlining how the losses are applied is provided in the following sections.</p>
<p><strong>METHOD A</strong></p>
<p>If the form loss method has been set to METHOD A (CUMULATE), the losses
are accumulated as the water level rises through the layers according to
the following equation. This approach was replaced as the default
setting for the 2016-03 release due to it producing inconsistent results
where the bridge is substantially overtopped (drowned out) with a large
percentage of the flow occurring through Layer 4, and the overall energy
loss reducing with increasing water depth once the structure is
submerged.</p>
<p><span class="math display">\[\zeta_{total} = \zeta_{1} + \zeta_{2}\frac{y_{2}}{D_{2}} + \zeta_{3}\frac{y_{3}}{D_{3}}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\zeta_{n}\)</span> = layer n FLC<br />
</li>
<li><span class="math inline">\(D_{n}\)</span> = depth of layer n<br />
</li>
<li><span class="math inline">\(y_{n}\)</span> = layer n water depth (set to zero if dry and cannot exceed depth of layer)<br />
</li>
<li><span class="math inline">\(\zeta_{total}\)</span> = overall form loss coefficient applied</li>
</ul>
<p><strong>METHOD B</strong></p>
<p>If the form loss method has been set to METHOD B (PORTION), the losses
are applied pro-rata according to the depth of water in each layer using
the equation below. Note that Layer 4 (e.g. above the bridge deck rails)
is always assumed to contribute a zero FLC. If a layer is not flooded
the depth for that layer, <em>y<sub>n</sub></em>, is set to zero.</p>
<p><span class="math display">\[\zeta_{total} = \frac{{(y}_{1}\zeta_{1} + y_{2}\zeta_{2} + y_{3}\zeta_{3})}{y_{total}}\]</span></p>
<p><span class="math display">\[y_{total} = y_{1} + y_{2} + y_{3} + y_{4}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\zeta_{n}\)</span> = layer n FLC<br />
</li>
<li><span class="math inline">\(y_{n}\)</span> = layer n water depth (set to zero if dry and cannot exceed depth of layer)<br />
</li>
<li><span class="math inline">\(\zeta_{total}\)</span> = overall form loss coefficient applied</li>
</ul>
<p><strong>METHOD C</strong></p>
<p>METHOD C effectively combines the METHOD A (CUMULATE) and METHOD B
(PORTION) approaches by utilising METHOD A through to the top of Layer 3
and METHOD B above Layer 3. METHOD C adjusts the FLC value in the
vertical as follows.</p>
<ul>
<li>Water level below Layer 2: The same result as for all other
approaches (i.e. a form loss based on that specified for Layer 1 is
applied). This is typically used for the energy losses associated with
bridge piers.<br />
</li>
<li>Water level below top of Layer 3: Same approach as for METHOD A.<br />
</li>
<li>Water level above Layer 3: Gradually reduces the energy loss with
increasing depth by proportioning with depth. The energy loss is
calculated as that accumulated from Layers 1 to 3 pro-rated by the
depth of Layers 1 to 3, plus no losses pro-rated by the depth above
the Layer 3.<br />
<span class="math display">\[\zeta_{total} = \left( \zeta_{1} + \zeta_{2}\frac{y_{2}}{D_{2}} + \zeta_{3}\frac{y_{3}}{D_{3}} \right)\frac{{(y}_{1} + y_{2} + y_{3})}{y_{total}}\]</span><br />
<span class="math display">\[y_{total} = y_{1} + y_{2} + y_{3} + y_{4}\]</span><br />
Where:
<ul>
<li><span class="math inline">\(\zeta_{n}\)</span> = layer n FLC<br />
</li>
<li><span class="math inline">\(y_{n}\)</span> = layer n water depth (set to zero if dry and cannot exceed depth of layer)<br />
</li>
<li><span class="math inline">\(\zeta_{total}\)</span> = overall form loss coefficient applied<br />
</li>
<li><span class="math inline">\(D_{n}\)</span> = layer n thickness</li>
</ul></li>
</ul>
<!-- PAR to EFC, given this is the case should we remove this and steer people to 2d_bg?-->
<!--
METHOD D is similar to METHOD C but allows the modeller to control the
depth at which the losses start to reduce when the flow transitions
between pressure flow and drowned flow. METHOD D was a beta feature in
the 2020-10 Release, see the [2020-10 Release
Notes](https://downloads.tuflow.com/TUFLOW/Releases/2020-10/TUFLOW%20Release%20Notes.2020-10-AD.pdf)
for more information. As of the 2023-03 release it is replaced by the 2d_bg layer, which has GIS
attributes altered for clarity.  

The overall blockage of the face is calculated using the same method
regardless of the FLC approach:

$$\phi_{total} = \frac{{(y}_{1}\phi_{1} + y_{2}\phi_{2} + y_{3}\phi_{3})}{y_{total}}$$

Where:

$\phi_{n}$ = layer n blockage  
$y_{n}$ = layer n water depth (set to zero if dry and cannot exceed
depth of layer)  
$\phi_{total}$ = overall cell face blockage applied-->
<p>Regardless of the FLC approach, the FLC value applies an energy loss across 2D cell faces as:</p>
<p><span class="math display">\[\mathrm{\Delta}h = \zeta_{total}\frac{V^{2}}{2g}\]</span></p>
<p>where <em>V</em> is the 2D cell face velocity in the presence of the blockage.
When setting the blockage values, considerations need to be taken into
account whether the source of the FLC value is based on the approach
velocity (the velocity in the absence of piers blockage) or structure
velocity (the velocity with area blocked out by the piers). For example, Hydraulics of Bridge Waterways <span class="citation">(<a href="#ref-Bradley1978">Bradley, 1978</a>)</span> or Guide to Bridge Technology <span class="citation">(<a href="#ref-Austroads2018">Austroads, 2018</a>)</span> derives FLC values based on the
cross-sectional averaged velocity in the absence of piers, and thus it
is recommended to set the Layer 1 blockage value as zero
(0). For more information, please see the <a href="https://wiki.tuflow.com/TUFLOW_2D_Hydraulic_Structures">2D Hydraulic Structures</a> TUFLOW Wiki page.</p>
<!--The L2_FLC attribute value refers to the energy loss caused by pressure
flow against the Layer 2 and 3 combined (i.e. the bridge deck and
rails), and the L3_FLC attribute value is used to set the inflection
point (IP) at which the transition from pressure flow to drowned flow
commences. (These attributes have now been labelled as L2_or_L23_FLC and
L3_FLC_or_fIP if empty files are created.) L3_FLC is specified as a
factor of the combined depths of Layers 2 and 3, with observations thus
far indicating this inflection point is around 1.5 to 2 times the depth
of the bridge deck (assuming no rails). The effect of partial blockage
(e.g. 20% blockage of Layer 3 representing the bridge deck rails) is to
reduce the inflection point proportionally by the blockage amount.

METHOD D adjusts the FLC value in the vertical as follows:

- Water level below Layer 2: The same result as for all other
  approaches, i.e. a form loss based on that specified for Layer 1 is
  applied. This is typically used for the energy losses associated with
  bridge piers.  
- Water level between invert of Layer 2 and below the Inflection Depth
  measured from the invert of Layer 2. The Inflection Depth and total
  energy loss are calculated as follows:

  $$D_{IP} = f_{IP}\left( D_{2}{Blockage}_{2} + D_{3}{Blockage}_{3} \right)$$

  $$\zeta_{total} = \left( \zeta_{1} + \zeta_{2}\frac{y_{I}}{D_{IP}} \right)\frac{(y_{1} + y_{Inflection})}{y_{total}}$$

Where:

- $D_{IP}$ = Inflection Depth discussed above.  
- $f_{IP}$ = Factor entered into the L3_FLC attribute to set the inflection point. 
- $D_{n}$ = layer n thickness  
- ${Blockage}_{n}$ = <span class="mark">???</span>  
- $\zeta_{total}$ = overall form loss coefficient applied  
- $\zeta_{n}$ = layer n FLC  
- $y_{n}$ = layer n water depth (set to zero if dry and cannot exceed depth of layer)  
- $y_{Inflection}$ = water depth above the invert of Layer 2 up to (but not exceeding) the Inflection Depth ($D_{IP}$)  
- $y_{total}$ = <span class="mark">???</span>

Above the Inflection Point the energy gradually reduces with
increasing depth in a similar manner to METHOD B and METHOD C to
simulate the transition to drowned flow and tendency to zero energy
losses with increasing depth over the bridge deck.

As of the 2023-03 release the 2d_bg (see   <u>Section 6.11.4</u>) is recommended to be used to model bridge
structures. This method is similar to METHOD D, with the GIS layer
attributes adjusted for easier user input.
-->
<p>Layered FC shapes are defined as either a line or polygon GIS objects
using the .tgc command <a href="TGCCommands-1.html#tgcReadGISLayeredFCShape">Read GIS Layered FC
Shape</a>. The file attribute description is
provided in Table <a href="TwoD-Domains-1.html#tab:tab-LayeredFlow">7.18</a>.</p>
<p>Points can be used to vary the invert of the bed, and thickness of each
layer in 3D. In this case, four attributes are required as outlined in Table <a href="TwoD-Domains-1.html#tab:tab-ShapePoint">7.19</a>.
This can for example be used to model an arched bridge or sloping deck.
The point objects can be placed in a separate layer to the line or
polygon GIS features.</p>
<p>Please note, overlapping flow constriction inputs is not supported.</p>
<table>
<caption>
<span id="tab:tab-LayeredFlow">Table 7.18: </span>Layered Flow Constriction Shape (2d_lfcsh) Attribute Descriptions
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Invert
</td>
<td style="text-align:left;">
<p>Performs same function as described for the Z attribute in Table <a href="TwoD-Domains-1.html#tab:tab-ZShapeAttribute">7.5</a> and is applied to the Invert elevation values. To leave the Zpt levels unchanged (i.e. use the existing Zpt elevations), enter a value of 99999.</p>
<p><b>Point or <b>Line:</b></b><br />
Invert of constriction (m above datum).</p>
<b>Polygon:</b> Used to set the elevation of the polygon perimeter only if NO MERGE option is specified and there are no points snapped to the perimeter. Otherwise ignored and the Zpt elevations within the polygon will be adjusted by triangulated around the perimeter at every half-cell size.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
dZ
</td>
<td style="text-align:left;">
Performs same function as described for dZ in Table <a href="TwoD-Domains-1.html#tab:tab-ZShapeAttribute">7.5</a> and is applied to the Invert elevation values.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Shape_Width_or_dMax
</td>
<td style="text-align:left;">
Same as for the same attribute in Table <a href="TwoD-Domains-1.html#tab:tab-ZShapeAttribute">7.5</a>.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Shape_Options
</td>
<td style="text-align:left;">
<p><b>Point:</b> Not used.</p>
<p><b>Line or Polygon:</b></p>
<p>ADD: Add the shape’s ‘Z’ attribute value to the current Zpts. If ADD is specified, any automatic merging around the region perimeter is ignored.</p>
<p>MAX, RIDGE or RAISE: Only changes a Zpt (Invert) elevation if the Z Shape elevation at the Zpt is higher.</p>
<p>MIN, GULLY or LOWER: Only changes a Zpt (Invert) elevation if the Z Shape elevation at the Zpt is lower.</p>
<p>METHOD A (CUMULATE in releases prior to 2020-10): Accumulates losses through each of the layers in the 2d_lfcsh as the depth of water increases. This will overwrite the global setting specified with the .tcf command Layered FLC Default Approach.</p>
<p>METHOD B (PORTION in releases prior to 2020-10): Proportions the losses through each of the layers in the 2d_lfcsh based on the depth of water. This will overwrite the global setting specified with the .tcf command Layered FLC Default Approach.</p>
<p>METHOD C: Combines the METHOD A and METHOD B approaches by utilising METHOD A through to the top of Layer 3 and METHOD B above Layer 3. This will overwrite the global setting specified with the .tcf command Layered FLC Default Approach.</p>
<p><b>Line:</b></p>
<p>NO MERGE: For thin lines (Shape_Width_or_dMax = 0), the final elevations along the line are as specified. If NO MERGE is not specified for a thin line, the final elevations are set to be the same as the current Zpt values plus the dZ value.</p>
<p>TIN: Indicates the line is to only be used for generation of TINs within polygons (only sections of TIN lines that fall within polygons are used).</p>
<p><b>Polygon:</b> If none of the options below are specified, the Invert elevations at perimeter vertices that do not have an elevation point snapped to them are merged with the current Zpt values (provided Invert does not equal 99999).</p>
<p>MERGE ALL: Ignores invert elevations from any points snapped to the perimeter and merges all perimeter vertices with the current Zpt values.</p>
NO MERGE: Does not merge the perimeter elevations with the current Zpt values.
</td>
<td style="text-align:left;">
Char(20)
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
L1_Obvert
</td>
<td style="text-align:left;">
The obvert (soffit) of Layer 1.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
L1_pBlockage
</td>
<td style="text-align:left;">
The percentage blockage of Layer 1. For example, enter 5 for a blockage of 5%.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
L1_FLC
</td>
<td style="text-align:left;">
<p>Layer 1 form loss coefficient. Used for modelling fine-scale “micro” contraction/expansion losses not picked up by the change in the 2D domain’s velocity patterns (e.g. bridge pier losses, vena-contracta losses, 3<sup>rd</sup> (vertical) dimension etc.).</p>
<p>This parameter should be used as a calibration parameter.</p>
<p><b>Note: So that this attribute is independent of 2D cell size it has different treatment depending on the object it is attached to as follows:</b></p>
<ul>
<li><b><b>Line:</b></b> For thin lines, the FLC value is applied to the cell sides unchanged. For thick (whole cell) lines, the FLC value is divided by two (two cell sides in the direction of flow). For wide lines the FLC value is divided by the number of cells across the line (i.e. the line’s width divided by the cell size) and applied to all cell-sides.</li>
<li><b>Polygon:</b> FLC is the form loss per unit length (in the predominant direction of flow). FLC values are not dependent on the flow width, but are on the length of travel in the direction of flow. The unit of length is metres, or feet if using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd> <teq>==</teq><tblk> US Customary</tblk>.</li>
</ul>
<p><b>However, if a negative FLC value is specified, the absolute value is taken and applied unadjusted to all cell-sides affected by the shape.<br />
Note, this is not cell size independent, therefore if the 2D cell size is changed, this attribute also needs to be changed.</b></p>
<p>The form loss coefficient is applied as an energy loss based on the dynamic head equation below where <span class="math inline">\(\displaystyle \zeta_{a}\)</span> is the FLC vlaue.</p>
<span class="math display">\[\Delta h = \zeta_{a}\:\frac{V^2}{2g}\]</span>
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
L2_Depth
</td>
<td style="text-align:left;">
The depth of Layer 2. Depth units are in metres, or feet if using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd> <teq>==</teq><tblk> US Customary</tblk>.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
L2_pBlockage
</td>
<td style="text-align:left;">
The percentage blockage of Layer 2. For example, enter 100 for a solid obstruction such as a bridge deck or pipe.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
L2_FLC
</td>
<td style="text-align:left;">
Layer 2 form loss coefficient. See notes for L1_FLC
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
L3_Depth
</td>
<td style="text-align:left;">
The depth of Layer 3. Depth units are in metres, or feet if using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd> <teq>==</teq><tblk> US Customary</tblk>.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
L3_pBlockage
</td>
<td style="text-align:left;">
The percentage blockage of Layer 3.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
L3_FLC
</td>
<td style="text-align:left;">
Layer 3 form loss coefficient. See notes for L1_FLC
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
Notes
</td>
<td style="text-align:left;">
Optional field for entering comments. Not used.
</td>
<td style="text-align:left;">
Char(40)
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:tab-ShapePoint">Table 7.19: </span>Layered Flow Constriction Shape Point (2d_lfcsh…_pts) Attribute Descriptions
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Invert
</td>
<td style="text-align:left;">
<p>Invert of constriction (metres above datum, or feet above datum if using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd> <teq>==</teq><tblk> US Customary</tblk>).</p>
To leave the Zpt levels unchanged (i.e. use the existing Zpt elevations), enter a value of 99999.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
L1_Obvert
</td>
<td style="text-align:left;">
The obvert (soffit) of Layer 1.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
L2_Depth
</td>
<td style="text-align:left;">
The depth of Layer 2. Depth units are in metres, or feet if using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd> <teq>==</teq><tblk> US Customary</tblk>.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
L3_Depth
</td>
<td style="text-align:left;">
The depth of Layer 3. Depth units are in metres, or feet if using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd> <teq>==</teq><tblk> US Customary</tblk>.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-mods-3" class="section level3 hasAnchor" number="7.3.9">
<h3><span class="header-section-number">7.3.9</span> Cell Modification<a href="TwoD-Domains-1.html#cell-mods-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- EFC to PAR: I think we should be move this after hydraulic structures. Or even just before modelling urban areas-->
<!--done-->
<div id="srf-3" class="section level4 hasAnchor" number="7.3.9.1">
<h4><span class="header-section-number">7.3.9.1</span> Storage Reduction (2d_srf)<a href="TwoD-Domains-1.html#srf-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The storage of 2D cells may be reduced (e.g. to model hypothetical filling, or reduced storage from buildings), or increased (e.g. for stability). For example, if a cell has a Storage Reduction Factor (SRF) value of
0.1, then its storage (surface area) is reduced by 10%. If the SRF value
is less than zero, the storage is increased. The default SRF value is
zero (i.e. no change in storage).</p>
<p>SRF values are assigned to cells in one or both of the following ways:</p>
<ol style="list-style-type: decimal">
<li>Using the <a href="TGCCommands-1.html#tgcSetSRF">Set SRF</a> and <a href="TGCCommands-1.html#tgcReadGISSRF">Read GIS SRF</a> .tgc commands. The 2d_srf layer has only one attribute, a float or real value nominally called SRF.<br />
</li>
<li>Assigned to materials .csv/.tmf files as the 5<sup>th</sup> and
10<sup>th</sup> column values respectively (refer to Table <a href="TwoD-Domains-1.html#tab:tab-MaterialsFormat">7.10</a> and Table <a href="TwoD-Domains-1.html#tab:tab-MaterialsFile">7.11</a>).<br />
</li>
<li>Using the .tgc command <a href="TGCCommands-1.html#tgcReadGridSRF">Read Grid SRF</a> to assign SRF
values from a raster input grid.</li>
<li>Via SX connections to 1D. The default approach increases the storage in the 2D cells by the average associated 1D node storage. Refer to Section <a href="DomainLinking-1.html#SXBoundary-3">10.2.2</a> and .tcf command <a href="TCFCommands-1.html#tcfSXStorageApproach">SX Storage Approach</a>.<br />
The applied SRF value is reported in the SRF attribute of the
<a href="https://wiki.tuflow.com/Check_Files_2d_grd">_grd_check</a> layer.</li>
</ol>
<p><strong>Note that a user can apply a combination of material SRF values and
<a href="TGCCommands-1.html#tgcReadGISSRF">Read GIS SRF</a> layers. The item that is used by the simulation depends on the order of commands in the .tgc file. The last read input takes precedence. For example, if a cell’s storage is adjusted by layers read in using both the <a href="TGCCommands-1.html#tgcReadGISSRF">Read GIS SRF</a> and <a href="TGCCommands-1.html#tgcReadGISMat">Read GIS Mat</a> commands, though<a href="TGCCommands-1.html#tgcReadGISMat">Read GIS Mat</a> is lower in the .tgc file, it will prevail.</strong></p>
<p>If a large reduction in cell storage is applied, for stability reasons it
may be necessary to also reduce the cell conveyance using a higher
roughness or cell flow width (see Section <a href="TwoD-Domains-1.html#CWF-4">7.3.9.2</a>). For example,
if a 10m cell size model has a SRF value of 0.99, without any SRF the
cell area is 100m<sup>2</sup> (10m x 10m), with a SRF of 0.99 this would
be reduced to 1m<sup>2</sup>. If no reduction in conveyance for flow entering or
leaving the cell is made, a significant volume of flow may enter
the cell between timesteps, this would cause the water level in the cell
to jump a large amount, potentially leading to oscillations in water
levels.</p>
</div>
<div id="CWF-4" class="section level4 hasAnchor" number="7.3.9.2">
<h4><span class="header-section-number">7.3.9.2</span> Cell Width Factor (CWF)<a href="TwoD-Domains-1.html#CWF-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The .tgc commands <a href="TGCCommands-1.html#tgcSetCWF">Set CWF</a>, <a href="TGCCommands-1.html#tgcReadGISCWF">Read GIS CWF</a> and <a href="TGCCommands-1.html#tgcReadGridCWF">Read Grid CWF</a> can be used to adjust the 2D cell flow widths (in the same manner as for 2D flow constrictions (refer to Section <a href="TwoD-Domains-1.html#lfcsh-4">7.3.8.3</a>). The CWF is a factor, for example 0.1 will limit the flow width to 10%. The changed flow width applies to all depths. When reading from a polygon object in GIS format, any cell sides that fall within the
polygon will have the width factor applied. These factors can be
reviewed within the
<a href="http://wiki.tuflow.com/Check_Files_2d_uvpt">uvpt_check</a>
file.</p>
</div>
<div id="flc-4" class="section level4 hasAnchor" number="7.3.9.3">
<h4><span class="header-section-number">7.3.9.3</span> Form Loss Coefficient (FLC)<a href="TwoD-Domains-1.html#flc-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Form loss coefficients can be applied in the .tgc to add an additional energy
loss at the 2D cell side (in the same manner as for 2D flow
constrictions, see Section <a href="TwoD-Domains-1.html#lfcsh-4">7.3.8.3</a> and <a href="TwoD-Domains-1.html#bg-layer-4">7.3.8.2</a>). Unlike flow constrictions, the FLC applied using this approach
does not vary with depth. The form or energy loss can be applied as fixed values with the .tgc commands <a href="TGCCommands-1.html#tgcSetFLC">Set FLC</a>, <a href="TGCCommands-1.html#tgcReadGISFLC">Read GIS FLC</a> and
<a href="TGCCommands-1.html#tgcReadGridFLC">Read Grid FLC</a> or on a form loss per unit length basis with
the .tgc commands <a href="TGCCommands-1.html#tgcSetFLC/L">Set FLC/L</a>, <a href="TGCCommands-1.html#tgcReadGISFLC/L">Read GIS FLC/L</a> and
<a href="TGCCommands-1.html#tgcReadGridFLC/L">Read Grid FLC/L</a>. The advantage to applying the FLC on a per
unit length basis is that it makes these inputs independent
of the 2D cell size when using regions (polygons). As such, if the 2D
cell size is changed, the same energy loss will be applied to both models
over the area of the region.</p>
<p>Any cell sides that fall within the polygon will have the additional form loss
These loss can be reviewed within the
<a href="http://wiki.tuflow.com/Check_Files_2d_uvpt">uvpt_check</a> file.</p>
<p>Section <a href="TwoD-Domains-1.html#HydraulicStructures-3">7.3.8</a> provides a detailed discussion about the application of additional form losses.</p>
</div>
<div id="mod-conveyance-4" class="section level4 hasAnchor" number="7.3.9.4">
<h4><span class="header-section-number">7.3.9.4</span> Modify Conveyance<a href="TwoD-Domains-1.html#mod-conveyance-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The. tgc command <a href="TGCCommands-1.html#tgcReadGISZptModifyConveyance">Read GIS Zpts Modify Conveyance</a> can be used to modify the elevation of a series of cells based on an increase or decrease in conveyance. Three inputs are required for this operation. These are:</p>
<ol style="list-style-type: decimal">
<li>A GIS layer containing a region / polygon object within which the
modification will apply;<br />
</li>
<li>A conveyance multiplication factor; and<br />
</li>
<li>A water level grid.</li>
</ol>
<p>The command syntax is:</p>
<p><tcmd><a href="TGCCommands-1.html#tgcReadGISZptModifyConveyance">Read GIS Zpts Modify Conveyance</a></tcmd><teq> == </teq><tblk>&lt;gis layer&gt; | &lt;K_factor&gt; | &lt;Water_Level_Grid&gt;</tblk></p>
<p>The terrain levels are adjusted based on the depth of water relative to the
water surface provided. The elevations are modified by
<span class="math inline">\(depth\left( 1 - f^{\frac{3}{5}} \right)\)</span>, which is effectively a change
in conveyance of <span class="math inline">\(K\times f\)</span> where <span class="math inline">\(K\)</span> is conveyance and <span class="math inline">\(f\)</span> is the multiplication
factor. For example, f = 1.2 would be a 20% increase in conveyance
resulting in a deepening of the waterway. The specified base water level
grid is a grid surface in a supported input raster format. The grid
does not need to be in the same resolution as the 2D domains, but is
typically the _h_Max grid output by TUFLOW from a previous simulation (see Section <a href="Outputs-1.html#Grid-4">11.2.2.2</a>).</p>
<p>This feature is useful for sensitivity testing the changes in flood
behaviour due to a deepening or accretion of a river’s bed based on a
change in conveyance.</p>
<p>This command would normally be applied in the .tgc, after all elevation (Zpt) commands as the Zpt adjustment is based
on the Zpt elevations processed up until the location of this command in
the .tgc file. An example is provided below:</p>
<p><tcmd><a href="TGCCommands-1.html#tgcReadGISZptModifyConveyance">Read GIS Zpts Modify Conveyance</a></tcmd><teq> == </teq><tblk>gis\2d_mod_river.shp | 0.9 | base_h_Max.tif</tblk></p>
<p>Where:</p>
<ul>
<li>2d_mod_river.shp contains polygons of the areas to be modified, in
this case along the river. This can be in any supported vector format (.gpkg, .shp or .mif).<br />
</li>
<li>0.9 is the factor change in conveyance compared to a base case (i.e.
10% decrease in conveyance).<br />
</li>
<li>base_h_Max.tif is a raster grid of the peak water level grid from a base
case simulation. It is recommended to copy this grid layer from the
results folder and place it somewhere under model\grid\. If this grid
layer varies with AEP, it is recommended to use the one .tcf with a
Variable to define the AEP, or alternatively a Scenario variable.</li>
</ul>
</div>
</div>
<div id="urban-areas-3" class="section level3 hasAnchor" number="7.3.10">
<h3><span class="header-section-number">7.3.10</span> Modelling Urban Areas<a href="TwoD-Domains-1.html#urban-areas-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The modelling of urbanised floodplains presents many more challenges to
hydraulic modellers than those of rural floodplains. It requires careful
consideration of the representation of buildings, walls and fences to
accurately replicate the overland flow routes. With the advancement of
modern computing hardware and software, 2D solutions are increasingly
being used over 1D solutions to represent urban areas.</p>
<p>This section of the manual discusses the various methods available in
TUFLOW to represent the features within an urban area. It does not aim
to identify the most appropriate method, however, discusses the pros and
cons to provide the modeller with guidance on selecting the most
suitable method for their study.</p>
<p><span class="citation">Syme (<a href="#ref-Syme2008">2008</a>)</span> explores modelling approaches for buildings and fences, it can be found along with other publications in the <a href="https://www.tuflow.com/library/publications/">TUFLOW Library</a>.</p>
<div id="buildings-4" class="section level4 hasAnchor" number="7.3.10.1">
<h4><span class="header-section-number">7.3.10.1</span> Buildings<a href="TwoD-Domains-1.html#buildings-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A number of methods can be used for representing buildings in a TUFLOW
2D model. These are:</p>
<ul>
<li>Utilising a higher bed resistance (roughness);<br />
</li>
<li>Raising the elevation of 2D cells where buildings exist;<br />
</li>
<li>Deactivating the 2D cells (code = 0) where buildings exist;</li>
<li>Reducing the cell storage;<br />
</li>
<li>Restricting the flow using a cell width reduction or additional form loss; or<br />
</li>
<li>Applying a breakline along the upstream faces of buildings.</li>
</ul>
<p>Utilising a high bed resistance parameter for buildings is a commonly
used method to encourage the development of preferential flow paths
around buildings during urban flooding scenarios. This method is
commonly used and preferred over others as it accounts for the storage
that the building provides once it becomes inundated <span class="citation">(<a href="#ref-Syme2008">Syme, 2008</a>)</span>. Depth
varying roughness is recommended if using this approach in combination
with direct rainfall modelling. A low roughness value is recommended at
shallow depths, representing the rapid run-off response associated with
rainfall on building roofs. High bed roughness is recommended for deeper
flows when the building structure impedes overland flow. The application
of depth varying roughness is described in Section <a href="TwoD-Domains-1.html#Materials-2">7.3.6</a>.</p>
<p>Buildings may also be “removed” from the 2D domain by categorising the
buildings as “Land” cells (see Section <a href="TwoD-Domains-1.html#CellCodes-3">7.3.2</a>) or raising the Zpt elevations
above the predicted flood level (see Section <a href="TwoD-Domains-1.html#zsh-4">7.3.5.2</a>). This method may be appropriate when the
building/s have been designed to not flood. In this case, care should be
taken to ensure the chosen cell size is able to appropriately represent
the area of the building and therefore the storage ‘removed’ from the
floodplain. Representing buildings in this fashion will not take into
account any below ground storage, such as that provided by underground
car parks or basement properties. If using a direct rainfall approach
(rain on grid), this method is most likely not suitable. Any land
(inactive) cells will have no rainfall applied, meaning the flow volume
will be incorrect, artificially high cells (e.g. 10m above ground
levels) may cause stability issues as flows exit the building.</p>
<p>Flood studies often require the simulation of extreme flood events,
where a great number of buildings are expected to become inundated. It
may not be appropriate in these cases to “remove” the building entirely
from the 2D domain. A more suitable approach may be to raise the Zpt
elevations (see Section <a href="TwoD-Domains-1.html#zsh-4">7.3.5.2</a>) of the building polygons to match the finished floor level,
thereby specifying the elevation at which the building is able to flood.
This may allow for direct rainfall simulations using a modification of
the cell elevations.</p>
<p>The use of a thin breakline around the edges of the building can be used to
prevent the building becoming a flow path, whilst not removing the
storage volume (see Section <a href="TwoD-Domains-1.html#zsh-4">7.3.5.2</a>). For example, three sides of the building could be blocked, this will still allow water to enter the building but not flow through it.</p>
<p>Layered flow constrictions (see Section <a href="TwoD-Domains-1.html#lfcsh-4">7.3.8.3</a>) or Cell Width Factor (see Section
<a href="TwoD-Domains-1.html#CWF-4">7.3.9.2</a>) may be used to impede the flow of water as it passes
through the building. The sides of 2D cells may be partially blocked to
represent obstructions such as internal or external walls. Additionally,
a form loss can be applied using form loss coefficients (see Section <a href="TwoD-Domains-1.html#flc-4">7.3.9.3</a>).</p>
<p>A storage reduction factor can also be used to reduce the area in the
cell available for water using the SRF options (see Section
<a href="TwoD-Domains-1.html#srf-3">7.3.9.1</a>). This can be used in conjunction with the other methods,
for example, a building may have the storage reduced by 20% by applying
a SRF of 0.2, this could be combined with a Cell Width Factor of 0.8
(20% reduction in flow area through the building).</p>
<p>In the absence of guidelines in the literature it is recommend that the
approaches for modelling buildings be sensitivity tested or calibrated,
if possible.</p>
</div>
<div id="roads-4" class="section level4 hasAnchor" number="7.3.10.2">
<h4><span class="header-section-number">7.3.10.2</span> Roads<a href="TwoD-Domains-1.html#roads-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Roads typically represent the main flow routes through urban areas. The
chosen cell size of the 2D domain is a key factor in ensuring an
appropriate number of cells have been used to represent the width of the
roads, as previously discussed in Section <a href="Fundamentals-1.html#CellSizes-3">3.3.2</a>. Choosing too coarse a resolution may result in the roads not being accurately represented and minor flow routes not being represented at all. An unnecessarily fine resolution
may translate to excessively long simulation times and stability problems if the
Courant condition is exceeded. Ideally, it is recommended that the main
flow routes be represented with a width of approximately 3-4 cells
across. Note, when using the TUFLOW HPC SGS functionality (see Section <a href="TwoD-Domains-1.html#SGS-3">7.4.3</a>) identification of locations where a breakline should be used to represent a flow control crest may be important. The <a href="TCFCommands-1.html#tcfSGSBreaklineDetectionDelta">SGS Breakline Detection Delta</a> tool (see Section <a href="TwoD-Domains-1.html#SGS-Advanced-5">7.4.3.1.2</a>) can assist modellers in identifying where breaklines may need to be added.</p>
<p>For overland flood studies where a high proportion of sheet flow is
predicted, differentiation between the road and pavement elevations may
influence the predicted areas of inundation. A DTM based on LiDAR or ALS
data, may not necessarily pick up this detail, therefore requiring
manual modification of the topography using breaklines.</p>
<p>It is possible to apply the Log Law rule for very shallow flow through automatically varying Manning’s n. This is of particularly interest for modelling flow over smooth surfaces such as roads and concrete (see Section <a href="TwoD-Domains-1.html#log-law-4">7.3.6.2</a>).</p>
</div>
<div id="fences-4" class="section level4 hasAnchor" number="7.3.10.3">
<h4><span class="header-section-number">7.3.10.3</span> Fences and Walls<a href="TwoD-Domains-1.html#fences-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Fences and walls can cause significant blockages during a flood event,
influencing the direction that flood waters take. Walls act to deflect
the path of flood waters and if overtopped, may act as weirs. Fences may
partially impede the flow of water and can be prone to becoming blocked
with debris. There is also the potential for both walls and fences to
collapse during a flood event.</p>
<p>Fences and walls are typically included within a TUFLOW model by
digitising a series of breaklines. The 2d_zsh GIS layer permits the
width of the breakline to be specified (see Section <a href="TwoD-Domains-1.html#zsh-4">7.3.5.2</a>). A “thin” line
modifying only the ZU and ZV (cell side) elevations may be preferred to
represent fences, in situations where the width of the cell size is
notably greater than the width of the obstruction. A “thin” line does
not modify the ZC (cell centre) elevations hence has no impact on the
cell storage. A “thick” line on the other hand, modifies the ZU, ZV and
ZC Zpt elevations and may be more appropriate to represent wider
obstructions such as railway embankments.</p>
<p>The 2d_vzsh GIS layer (see Section <a href="TwoD-Domains-1.html#vzsh-4">7.3.5.3</a>) may be used to
represent an embankment that collapses during the simulation. The breach
may be triggered at a specified time, by the water level at a defined
location or the water level difference between two locations exceeding a
specified amount.</p>
</div>
</div>
</div>
<div id="HPC-specific-2" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> TUFLOW HPC Specific<a href="TwoD-Domains-1.html#HPC-specific-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section describes 2D domain functionality that is unique to TUFLOW HPC.</p>
<div id="Quadtree-3" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Quadtree<a href="TwoD-Domains-1.html#Quadtree-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Quadtree grid refinement functionality enables the user to vary the 2D cell resolution within a TUFLOW HPC model. Quadtree refinement allows for recursive division of square TUFLOW cells into four smaller square cells. Up to 9 levels of cell size refinement are permitted. All cells for all levels of refinement share a common orientation. Bill Syme, one of the TUFLOW author’s, discusses the benefits and implementation of Quadtree within the <a href="https://youtu.be/eJJtsS91XNo?t=1495">Future of 2D Hydraulic Modelling AWS Video</a>. The <a href="https://www.youtube.com/watch?v=2zrNwWUNTXE">How to Implement Quadtree</a> video also useful. An example quadtree mesh is presented in Figure <a href="TwoD-Domains-1.html#fig:fig-QTMeshIntro">7.21</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-QTMeshIntro"></span>
<img src="images/1D2DHPCQTMesh.png" alt="TUFLOW HPC Quadtree Grid"  />
<p class="caption">
Figure 7.21: TUFLOW HPC Quadtree Grid
</p>
</div>
<p>The Quadtree solver uses a modified version of the HPC solver. It uses an explicit finite volume solution that is 2<sup>nd</sup> order in space and 4<sup>th</sup> order in time, however there are some subtle differences between the HPC single grid and Quadtree solvers that mean they produce near identical, though not identical results if both run are over the same single grid (same cell size) grid – see Section <a href="Fundamentals-1.html#FixedGridorQuadtreeGrid-3">3.2.4</a> for further discussion.</p>
<p>TUFLOW Wiki Tutorial <a href="https://wiki.tuflow.com/Tutorial_M07">Module 7</a> provides a demonstration of quadtree. The followings Sections outline how to use the feature.</p>
<div id="qcf-commands-4" class="section level4 hasAnchor" number="7.4.1.1">
<h4><span class="header-section-number">7.4.1.1</span> Quadtree .tcf Commands<a href="TwoD-Domains-1.html#qcf-commands-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To use a Quadtree grid, the solution scheme should be set to HPC and a
Quadtree Control file specified using the command
<a href="TCFCommands-1.html#tcfQuadtreeControlFile">Quadtree Control File</a>. GPU Hardware is also recommended. For example:</p>
<p><tcmd>If Scenario</tcmd><teq> == </teq><tblk>HPC </tblk> <br>
 <tcmd>Solution Scheme</tcmd><teq> == </teq><tblk>HPC </tblk> <br>
 <tcmd>Hardware</tcmd><teq> == </teq><tblk>GPU </tblk> <br>
<tcmd>Else If Scenario</tcmd><teq> == </teq><tblk>Quadtree </tblk> <br>
 <tcmd>Solution Scheme</tcmd><teq> == </teq><tblk>HPC </tblk> <br>
 <tcmd>Quadtree Control File</tcmd><teq> == </teq><tblk>..\model\quadtree_001.qcf </tblk><br>
 <tcmd>Hardware</tcmd><teq> == </teq><tblk>GPU </tblk><br>
<tcmd>End If</tcmd></p>
<p>Note, the keyword “Single Level” can be used instead of a control file (e.g.
“<tcmd><a href="TCFCommands-1.html#tcfQuadtreeControlFile">Quadtree Control File</a></tcmd><teq> == </teq><tblk>Single Level</tblk>”), to run the Quadtree module as a single 2D domain fixed grid model (ie. a fixed cell size). A simulation run in this manner will likely run slower than HPC, though may require a smaller
memory footprint. This is due to quadtree only storing a grid of active cells compared with single fixed grid models that use the bounding rectangle to allocate memory, which may include large areas of inactive (redundant) cells and
therefore consuming memory.</p>
<p>The Quadtree Control File (.qcf) is described in the next section.</p>
</div>
<div id="qcf-mandatory-4" class="section level4 hasAnchor" number="7.4.1.2">
<h4><span class="header-section-number">7.4.1.2</span> Quadtree Control File (.qcf) – Mandatory Commands<a href="TwoD-Domains-1.html#qcf-mandatory-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Quadtree Control File (.qcf) is used to define the grid refinement areas and optionally the model location and extent for a Quadtree grid. Appendix <a href="QCFCommands-1.html#QCFCommands-1">H</a> lists and describes the available .qcf commands.</p>
<p>The following commands are mandatory in a .qcf file.</p>
<p><tcmd><a href="QCFCommands-1.html#qcfModelOriginandExtent">Model Origin and Extent</a></tcmd><teq> == </teq><tblk>AUTO | TGC</tblk></p>
<p>If set to “AUTO” the extents of the Level 1 GIS polygon are used to
define the model origin and extents. If set to “TGC”, the model is
located as per the commands in the .tgc file. Note, the angle of the
model is defined in the .qcf file using the <a href="QCFCommands-1.html#qcfOrientationAngle">Orientation Angle</a> command
below. Also, if set to “AUTO” the GIS nesting polygons must have a
Level 1 polygon defined, otherwise an ERROR is generated.</p>
<p><tcmd><a href="QCFCommands-1.html#qcfReadGISNesting">Read GIS Nesting</a></tcmd><teq> == </teq><tblk>&lt;gis file&gt; &gt;</tblk></p>
<p>The <a href="QCFCommands-1.html#qcfReadGISNesting">Read GIS Nesting</a> command can be used to define polygons of grid refinement (different levels) in the 2d_qnl format file, as described in Section <a href="TwoD-Domains-1.html#QDT-mesh-4">7.4.1.4</a>.</p>
</div>
<div id="qcf-optional-4" class="section level4 hasAnchor" number="7.4.1.3">
<h4><span class="header-section-number">7.4.1.3</span> Quadtree Control File (.qcf) – Optional Commands<a href="TwoD-Domains-1.html#qcf-optional-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The following commands are optional in the Quadtree Control File:</p>
<p><tcmd><a href="QCFCommands-1.html#qcfBaseCellSize">Base Cell Size</a></tcmd><teq> == </teq><tblk>&lt;cell size in m/ft&gt; | {TGC}</tblk></p>
<p><a href="QCFCommands-1.html#qcfBaseCellSize">Base Cell Size</a> sets the Level 1 (parent) cell size.
This will be the largest cell size in the Quadtree grid. If set to a
numerical value this will override the cell size command in the .tgc
file. If this command is not specified or is set to “TGC”, the cell size defined in the .tgc file is used.</p>
<p><tcmd><a href="QCFCommands-1.html#qcfOrientationAngle">Orientation Angle</a></tcmd><teq> == </teq><tblk>&lt;angle in degrees&gt; | OPTIMISE | {TGC}</tblk></p>
<p>If set to a numerical value this defines the grid orientation angle and
overrides any angle / location .tgc commands. If Set to “OPTIMISE” the
parent Level 1 polygon is used to optimise the angle of the grid to
minimise the area of the bounding rectangle, thereby minimising
temporary memory requirements during the simulation startup (the memory
footprint during the simulation is not affected). As such the GIS
nesting polygon must have a Level 1 polygon defined. If the command is not specified
or is set to “TGC”, the orientation angle in the .tgc is used.</p>
<p>When pre-processing the Quadtree grid, a hidden 2D domain is used for
areas of refinement to allow fast processing of geometry on a regular
grid. The default approach is that each nesting level is treated as a 2D
rectangular domain, therefore, for example, with three levels of nesting
the geometry control file is processed three times. To reduce
initialisation memory demands it is possible to treat each GIS polygon
in the 2d_qnl layer as a separate domain for the processing of geometry
inputs. This is set using the optional .qcf control file command:</p>
<p><tcmd><a href="QCFCommands-1.html#qcfQuadtreeMeshProcessingMethod">Quadtree Mesh Processing Method</a></tcmd><teq> == </teq><tblk>{FAST} | Memory Efficient</tblk></p>
<p>This allows changing to a more memory efficient approach to process
each polygon in the 2d_qnl layer. However, whilst being more memory
efficient during grid creation, the model startup may be slower. How the grid
is processed has no effect on the speed of the hydraulic computations or
the memory demand during the hydraulic calculations.</p>
</div>
<div id="QDT-mesh-4" class="section level4 hasAnchor" number="7.4.1.4">
<h4><span class="header-section-number">7.4.1.4</span> Defining Grid Refinement Polygons<a href="TwoD-Domains-1.html#QDT-mesh-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A 2d_qnl (Quadtree Nesting Level) GIS layer (see Table <a href="TwoD-Domains-1.html#tab:tab-QNLAttribute">7.20</a>) is used to define the
location and levels of grid refinement. The 2d_qnl layers should only contain
polygon / region objects, with all other GIS object types (lines, points, etc.) ignored.</p>
<p>The nesting level attribute must be in the range 1 to 9. A value of:</p>
<ul>
<li>1: indicates that the cell size to be used for that polygon is the Level 1
or base cell size (see <a href="QCFCommands-1.html#qcfBaseCellSize">Base Cell Size</a>).</li>
<li>2: indicates the cell size within the polygon would be at Level 2 (i.e.
half the base cell size).</li>
<li>3: indicates the cell size within the polygon would be at Level 3 (i.e. 1/4<sup>th</sup> of the base cell size).</li>
<li>4: indicates the cell size within the polygon would be at Level 4 (i.e. 1/8<sup>th</sup> of the base cell size).</li>
<li>…</li>
<li>9: so on up to a maximum of Level 9 (1/256<sup>th</sup> of the base cell size).</li>
</ul>
<p>For numerical precision reasons when running single precision, the maximum nesting level of 9 or 1/256 of the base cell size has been adopted, but can be increased for double precision mode should there be a demand from users.</p>
<table>
<caption>
<span id="tab:tab-QNLAttribute">Table 7.20: </span><strong>2D Quadtree (2d_qnl) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Nest_Level
</td>
<td style="text-align:left;">
<p>The value of the quadtree nested level used for grid refinement.</p>
<p>The nesting level attribute must be in the range 1 to 9. For example:</p>
<ul>
<li>1: indicates that the cell size to be used for that polygon is the Level 1 or base cell size (see <a href="QCFCommands-1.html#qcfBaseCellSize">Base Cell Size</a>.</li>
<li>2: indicates the cell size within the polygon would be at Level 2 (i.e. half the base cell size).</li>
<li>3: indicates the cell size within the polygon would be at Level 3 (i.e. 1/4th of the base cell size).</li>
<li>4: indicates the cell size within the polygon would be at Level 4 (i.e. 1/8th of the base cell size).</li>
<li>…</li>
<li>9: so on up to a maximum of Level 9 (1/256th of the base cell size).
</td>
<td style="text-align:left;">
Integer
</td>
</tr>
</tbody>
</table></li>
</ul>
<p><strong>Note: there should only be one Level 1 polygon defined in the 2d_qnl
layer, but for all other levels there is no limit on the number of
polygons.</strong></p>
<p>When refining grid areas, if a refinement polygon sits within a polygon
of the next higher level (e.g. a Level 3 polygon is defined within a
Level 2), as per Figure <a href="TwoD-Domains-1.html#fig:fig-image62">7.22</a>, no automatic grid refining is required.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image62"></span>
<img src="images/image62.png" alt="Example of Quadtree Nesting Level Polygons"  />
<p class="caption">
Figure 7.22: Example of Quadtree Nesting Level Polygons
</p>
</div>
<p>However, if a nesting level polygon does not sit within a polygon
of the next higher level (e.g. a Level 4 polygon is defined within a
Level 1 or Level 2 polygon), intermediate areas of refinement are
automatically generated by TUFLOW. For example, Figure <a href="TwoD-Domains-1.html#fig:fig-image64">7.23</a> show the grid generated when transitioning from a Level 1 to Level 3 and a
Level 1 to Level 5.</p>
<p><img src="images/image63.jpg" width="50%" style="display: block; margin: auto;" /></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image64"></span>
<img src="images/image64.jpg" alt="Examples of Automatic Quadtree Refinement" width="50%" />
<p class="caption">
Figure 7.23: Examples of Automatic Quadtree Refinement
</p>
</div>
<p>No Level 1 polygon is required if the model origin and extent
are defined in the .tgc file. In this situation the rectangle
representing the .tgc computational domain is used as the Level 1
polygon. For example, if the .qcf file includes the following commands
and the only 2d_qnl polygon is Level 3 (red polygon in Figure <a href="TwoD-Domains-1.html#fig:fig-image68">7.26</a>.
The grid created is based on the rectangular computational domain in the
.tgc file (as shown by the thick dashed black line) with inactive cells
removed from the grid to reduce memory.</p>
<p><tcmd><a href="QCFCommands-1.html#qcfBaseCellSize">Base Cell Size</a></tcmd><teq> == </teq><tblk>TGC</tblk><br />
<tcmd><a href="QCFCommands-1.html#qcfModelOriginandExtent">Model Origin and Extent</a></tcmd><teq> == </teq><tblk>TGC</tblk><br />
<tcmd><a href="QCFCommands-1.html#qcfOrientationAngle">Orientation Angle</a></tcmd><teq> == </teq><tblk>TGC</tblk><br />
<tcmd><a href="QCFCommands-1.html#qcfReadGISNesting">Read GIS Nesting</a></tcmd><teq> == </teq><tblk>gis\2d_qnl_999_R.shp</tblk></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image65"></span>
<img src="images/image65.png" alt="Example Showing Removal of Inactive Cells" width="50%" />
<p class="caption">
Figure 7.24: Example Showing Removal of Inactive Cells
</p>
</div>
</div>
</div>
<div id="HPC-Turbulence-3" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> HPC Turbulence<a href="TwoD-Domains-1.html#HPC-Turbulence-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This section contains information relating to sub-grid-scale turbulence options for TUFLOW HPC.</p>
<div id="HPC-Turbulence-4" class="section level4 hasAnchor" number="7.4.2.1">
<h4><span class="header-section-number">7.4.2.1</span> Overview<a href="TwoD-Domains-1.html#HPC-Turbulence-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For TUFLOW HPC, three options exist (Constant, Smagorinsky and Wu) for specifying eddy viscosity for the 2D domains to approximate the effect of sub-grid-scale turbulence. <span class="citation">Collecutt et al. (<a href="#ref-Collecutt2020">2020</a>)</span> discusses the turbulence models in respect to model cell size sensitivity, resulting in the Wu approach (Section <a href="TwoD-Domains-1.html#Wu-4">7.4.2.4</a>) becoming the default for TUFLOW HPC from the 2020-01 release and onwards. Discussion on the change in defaults is available in the <a href="https://wiki.tuflow.com/HPC_Turbulence_FAQ">HPC Turbulence FAQ</a> TUFLOW Wiki Page.</p>
<p>The <a href="TCFCommands-1.html#tcfViscosityFormulation">Viscosity Formulation</a> and <a href="TCFCommands-1.html#tcfViscosityCoefficient">Viscosity Coefficient</a> commands are used to set the formulation and coefficients. Note that these commands may also be used to select the non-Newtonian module, which is discussed in Section <a href="TwoD-Domains-1.html#NN-3">7.4.6</a> since it is not a sub-grid turbulence model.</p>
</div>
<div id="Constant-4" class="section level4 hasAnchor" number="7.4.2.2">
<h4><span class="header-section-number">7.4.2.2</span> Constant Eddy Viscosity<a href="TwoD-Domains-1.html#Constant-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Constant approach (<tcmd><a href="TCFCommands-1.html#tcfViscosityFormulation">Viscosity Formulation</a> </tcmd><teq>==</teq><tblk> CONSTANT</tblk>)
applies a constant value throughout the model, irrespective of velocity
gradients and variations. This is generally satisfactory when the bed
resistance is dominant or when modelling large ocean basins (in which
case the recommended coefficient for the constant formulation is 1
m<sup>2</sup>/s), but is not recommended for riverine flow paths.</p>
</div>
<div id="Smagorinsky-4" class="section level4 hasAnchor" number="7.4.2.3">
<h4><span class="header-section-number">7.4.2.3</span> Smagorinsky Approach<a href="TwoD-Domains-1.html#Smagorinsky-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>TUFLOW’s Smagorinsky approach (<tcmd><a href="TCFCommands-1.html#tcfViscosityFormulation">Viscosity
Formulation</a> </tcmd><teq>==</teq><tblk> SMAGORINSKY</tblk>) applies a hybrid method that includes elements of both the Constant and Smagorinsky approaches, as given by the equation below. This formulation is better than the CONSTANT option, as the eddy viscosity is
recalculated every timestep at every cell mid-side according to the
change in velocity magnitude and direction. This results in higher
coefficients being applied where there is greater turbulence.</p>
<p>However, this approach has two known limitations:</p>
<ol style="list-style-type: decimal">
<li>It assumes that all turbulent kinetic energy with length scales greater than the
cell size is resolved within the velocity field. This assumption is
reasonable when the 2D cell size is larger then physical depth of the
flow, but becomes incorrect when the 2D cell size becomes smaller than
the depth of the flow – turbulence in the vertical direction contributes
significantly to viscosity but is not resolved in the 2D velocity field.
As a result, once the 2D cell size becomes smaller than the flow depth
this approach can underpredict the viscosity, and therefore can underpredict
momentum coupling from river to flood plain.<br />
</li>
<li>It assumes that the physical length scales of the sub-grid turbulence scale with
the 2D cell size. This is reasonable when the 2D cell size is similar to
the depth of the flow, but becomes incorrect when the 2D cell size
becomes significantly larger than the depth of the flow – the bed
resistance and the finite depth of the flow prevent large scale
turbulence. As a result, once the 2D cell size becomes much larger than
the depth of the flow, the Smagorinsky turbulence model can overpredict the
viscosity, and therefore can overpredict the momentum coupling from river
to flood plain.</li>
</ol>
<p>The result of these two limitations, is that model results display some
sensitivity to the 2D cell size. The Wu formulation (Section <a href="TwoD-Domains-1.html#Wu-4">7.4.2.4</a>)
has proven to be more capable in its ability to provide “out of the box”
calibration and reduced sensitivity of model results to 2D cell size.</p>
<p>Note, if the formulation is changed, the user must also reset the
coefficient using the command
<a href="TCFCommands-1.html#tcfViscosityCoefficient">Viscosity Coefficient</a>. <!--EFC to PAR: Just did a quick test and it looks like TUFLOW automatically updates the coefficients when changing formulation. Can this sentence be deleted. It's a bit confusing--></p>
<p>The Smagorinsky option remains the default when using TUFLOW
Classic. The default viscosity coefficients are a Smagorinsky value of
0.5 plus a constant value of 0.05 m<sup>2</sup>/s. The 0.5 Smagorinsky
coefficient is dimensionless. The viscosity coefficient can be output
using the <a href="TCFCommands-1.html#tcfMapOutputDataTypes">Map Output Data Types</a> command.</p>
<p>The hybrid Smagorinsky formulation used by TUFLOW is:</p>
<p><span class="math display" id="eq:equ-smag">\[\begin{equation}
𝜐 = C_{c} + C_{s}A_{c}\sqrt{\left( \frac{\partial u}{\partial x} \right)^{2} + \left( \frac{\partial v}{\partial y} \right)^{2} + {\frac{1}{2}\left( \frac{|\partial u|}{\partial y} + \frac{|\partial v|}{\partial x} \right)}^{2}}
\tag{7.9}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(u\ and\ v = \ \)</span>Depth averaged velocity components in the X and Y
directions<br />
</li>
<li><span class="math inline">\(x\ and\ y = \ \)</span>Distance in the X and Y direction<br />
</li>
<li><span class="math inline">\(\nu = \ \)</span>Horizontal diffusion of momentum (viscosity) coefficient,
m<sup>2</sup>/s or ft<sup>2</sup>/s<br />
</li>
<li><span class="math inline">\(A_{c} = \ \)</span>Area of Cell<br />
</li>
<li><span class="math inline">\(C_{\ c} = \ \)</span>Constant Coefficient (default = 0.05 m<sup>2</sup>/s)<br />
</li>
<li><span class="math inline">\(C_{s} = \ \)</span>Smagorinsky Coefficient (dimensionless, default = 0.5)</li>
</ul>
</div>
<div id="Wu-4" class="section level4 hasAnchor" number="7.4.2.4">
<h4><span class="header-section-number">7.4.2.4</span> Wu Approach<a href="TwoD-Domains-1.html#Wu-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Wu approach (<tcmd><a href="TCFCommands-1.html#tcfViscosityFormulation">Viscosity Formulation</a> </tcmd><teq>==</teq><tblk> WU</tblk>) is the
default method for TUFLOW HPC from release 2020-01 and onwards. It is not available for
TUFLOW Classic. This eddy viscosity (turbulence) model combines both 2D
and 3D turbulence effects, and is a slightly adapted version of that
described in <span class="citation">W. Wu et al. (<a href="#ref-Wu2005">2005</a>)</span>.</p>
<p>Like the Smagorinsky eddy viscosity model, it is a zero-equation model
whereby the eddy viscosity coefficient can be diagnostically computed
from the mean depth and velocity fields. However, unlike the Smagorinsky
model, where the turbulent length scale is related to cell size, the
length scales used in the Wu model are related to water depth, and hence
the computed eddy viscosity is not related to or dependent on cell size.
This has been shown to significantly improve the cell size convergence
of the results compared to the Smagorinsky model (i.e. the results are
nearly independent of the cell size provided there are enough cells
across the waterways to adequately define the flows).</p>
<p>The computed eddy viscosity is the Pythagorean sum of 3D and 2D
contributions:</p>
<p><span class="math display" id="eq:equ-wu">\[\begin{equation}
\nu_{T} = \sqrt{\nu_{3D}^{2} + \nu_{2D}^{2}} \\

\upsilon_{3D} = C_{3D}U^{*}L_{m} \\

U^{*} = |U|n\frac{\sqrt{g}}{d^{\frac{1}{6}}} \\

\upsilon_{2D} = C_{2D}L_{m}^{2}|\nabla U| \\

|\nabla U| = \sqrt{\left( \frac{\partial u}{\partial x} \right)^{2} + \left( \frac{\partial v}{\partial y} \right)^{2} + \frac{1}{2}\left( \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x} \right)^{2}}
\tag{7.10}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\nu_{T}\ \)</span> is the final total 2D viscosity<br />
</li>
<li><span class="math inline">\(\nu_{3D}\ \)</span>is the vertical 3D viscosity contribution<br />
</li>
<li><span class="math inline">\(\nu_{2D}\ \)</span>is the horizontal 2D viscosity contribution<br />
</li>
<li><span class="math inline">\(C_{3D}\)</span> coefficient for 3D viscosity contribution<br />
</li>
<li><span class="math inline">\(C_{2D}\)</span> coefficient for 2D viscosity contribution<br />
</li>
<li><span class="math inline">\(U^{*}\)</span> is the friction velocity (is <span class="math inline">\(\sqrt{\frac{\tau_{bed}}{\rho}}\)</span>)<br />
</li>
<li><span class="math inline">\(L_{m}\)</span> is the turbulent length scale (is lesser of flow depth or
distance to wet/dry boundary)<br />
</li>
<li><span class="math inline">\(n\)</span> is Manning’s bed friction (see note below on treatment of high
Manning’s n materials)<br />
</li>
<li><span class="math inline">\(g\)</span> is gravity<br />
</li>
<li><span class="math inline">\(d\)</span> is water depth<br />
</li>
<li><span class="math inline">\(|\nabla U|\)</span> is the magnitude of the 2D velocity strain tensor</li>
</ul>
<p>The computed viscosity <span class="math inline">\(\nu_{T}\)</span> can be output using the <a href="TCFCommands-1.html#tcfMapOutputDataTypes">Map
Output Data Types</a> command. In our testing to
date, we have found <span class="math inline">\(C_{3D} = 7\)</span>  and <span class="math inline">\(C_{2D} = 0\)</span> to yield results that
agree well with benchmark tests and that are not significantly
dissimilar from those of the previous Smagorinsky method with its
default coefficients for situations where the depth is not significantly
greater than the cell-size. The values of <span class="math inline">\(C_{3D} = 7\)</span> and <span class="math inline">\(C_{2D} = 0\)</span>
are the default values but can be changed using the
<a href="TCFCommands-1.html#tcfViscosityCoefficient">Viscosity Coefficient</a>
command. This effectively ignores the 2D component in the Wu model.
Alternatively, to use only the 2D component of the model (and ignore the
3D component), we have found <span class="math inline">\(C_{3D} = 0\)</span> and <span class="math inline">\(C_{2D} = 4\)</span> to be a
suitable starting point. As always, calibration remains an essential
step. If quality calibration data is available and all Manning’s values
are within industry standard ranges, then we encourage the user to
adjust the coefficients as necessary to achieve calibration. We
anticipate that calibration should be possible with either <span class="math inline">\(C_{2D}\)</span> or
<span class="math inline">\(C_{3D}\)</span> in the range 1 to 7. If values outside this range are required
then this may indicate other errors (eg. boundary values or
schematisation, poor input data, etc). As always, sensitivity testing of
changes in parameters on the model results should also be performed.</p>
<p>It is a common practice to represent buildings in a model as
roughness (i.e. cells with high Manning’s bed friction),
see discussion on modelling buildings in Section <a href="TwoD-Domains-1.html#urban-areas-3">7.3.10</a>.
As the friction velocity includes the Manning’s value, this results in a very high
viscosity value at those cells. This is not unreasonable, but for TUFLOW
HPC, which handles the viscosity explicitly, this can drive the timestep
down to small values. We have found that limiting the Manning’s values
used in the Wu 3D model to a sensible maximum (for example 0.1) makes
very little difference to the model results but can vastly improve
solution time. This upper limit is included as an optional third value
to the
<a href="TCFCommands-1.html#tcfViscosityCoefficient">Viscosity Coefficient</a> when
using the Wu approach. Note that the original high Manning’s value, as
defined in the materials database, is used in the momentum equation
where its primary influence is effected.</p>
</div>
</div>
<div id="SGS-3" class="section level3 hasAnchor" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> Sub-Grid Sampling (SGS)<a href="TwoD-Domains-1.html#SGS-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--
This section will be quite large and need to include:

- Intro to SGS
- SGS Methodology
- Infiltration considerations
- SGS commands
- SGS commands - Advanced
- Output options
-->
<!-- write as is for Method C, don't include superseded commands (but put in appendix) inc method a, method b. Ask SG if we include Method A-->
<p>Sub-grid sampling (SGS) stores elevation points sampled at a finer
resolution than the 2D cell to more accurately represent the
variations in terrain inside the cell, as shown in Figure <a href="TwoD-Domains-1.html#fig:fig-image68">7.26</a>. SGS functionality is introduced in Section <a href="Fundamentals-1.html#SubGridSamplingSGS-3">3.3.3</a>. Benchmark testing has shown the benefits of using SGS to be substantial, as discussed in Section <a href="Fundamentals-1.html#SGS-benefits-4">3.3.3.1</a>.</p>
<p>SGS translates the high resolution sampled elevation data into cell curve functions for its hydraulic calculations.<br />
- The cell volume is stored as a non-linear function of elevation (i.e. a
curve of cell volume versus elevation based on the wetted surface area
versus depth measured from the lowest sampled elevation within the 2D
cell).
- Across each cell side the flow area and flow width are calculated based on sampled elevations to produce a non-linear function of conveyance versus elevation (i.e. a curve of conveyance versus elevation. For determining the depth and
width averaged velocity across each cell face the flow area is also
retained as a curve of area versus elevation).</p>
<p>The elevation dataset sample resolution can be defined by the user. For example, using a 8m cell size and a 2m <a href="TCFCommands-1.html#tcfSGSSampleTargetDistance">SGS Sample Target Distance</a> the DEM is sampled at 5 points across each face. Shown in Figure <a href="TwoD-Domains-1.html#fig:fig-image68">7.26</a> this translates to 25 elevation
points being used to define the volume vs elevation relationship
within the 2D cell, and 5 points along each cell side for defining the
conveyance-elevation relationship of each face.</p>
<div style="display: flex; justify-content: center; align-items: center;">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image67"></span>
<img src="images/image67.jpeg" alt="Traditional (non-SGS) Approach" width="50%" />
<p class="caption">
Figure 7.25: Traditional (non-SGS) Approach
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image68"></span>
<img src="images/image68.jpeg" alt="SGS Approach" width="50%" />
<p class="caption">
Figure 7.26: SGS Approach
</p>
</div>
</div>
<p>The flow or conveyance of water through 2D cells is determined through a
full 2D solution of the momentum equation (see Section <a href="TwoD-Domains-1.html#Solvers-2">7.2</a>). The bed resistance term (e.g. Manning’s equation) and the determination of the 2D
velocities are controlled by the conveyance properties of each cell
face. If there are considerable variations in bed topography across the cell faces, SGS will provide a significantly more
accurate representation of these variations, compared to a traditional 2D cell with a single elevation value per cell face.</p>
<p>If the resolution of the DEM data layer is coarser or similar to
the 2D cell size, the use of SGS will have little or no benefit. For
example, if the DEM resolution is 2m and the cell size is 2m there is
little benefit in using SGS, although a slight improvement would result
as the slope of the terrain across the cell would be picked up if using
SGS. In contrast, if the cell size is 20m there would be considerable
benefit in using SGS as the variations in terrain across the 2D cell
will be represented. TUFLOW requires an odd number of sample locations across a cell face to ensure the cell mid-face and cell corners are sampled. The number of sample locations across a cell face is referred to as the <a href="TCFCommands-1.html#tcfSGSSampleFrequency">SGS Sample Frequency</a>.</p>
<p>Note, if the elevation input data has a reasonable representation of the channels, <a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> or <a href="TGCCommands-1.html#tgcReadGISZLine">Read GIS Z Line</a> “MIN, GULLY or LOWER” lines are not required, or recommended, when using SGS. Including gully lines can overestimate conveyance in these channels.</p>
<p>The following section will focus on implementing SGS and options regarding SGS outputs.</p>
<div id="SGS-commands-4" class="section level4 hasAnchor" number="7.4.3.1">
<h4><span class="header-section-number">7.4.3.1</span> SGS Methodology and Commands<a href="TwoD-Domains-1.html#SGS-commands-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To implement SGS the only additional command required in the .tcf is “<tcmd><a href="TCFCommands-1.html#tcfSGS">SGS</a></tcmd><teq> == </teq><tblk>ON</tblk>”.</p>
<p>By default, using this command will set:</p>
<ul>
<li>the <a href="TCFCommands-1.html#tcfSGSApproach">SGS Approach</a> to Method C. Prior to 2023 release the default was Method B. The default Method C is the recommended approach and older versions are considered legacy though are still provided for backward compatibility.</li>
<li>the <a href="TCFCommands-1.html#tcfSGSSampleFrequency">SGS Sample Frequency</a> to sample at the minimum grid elevation resolution that can be found from grids read in to the .tgc.</li>
</ul>
<div id="SGS-Distance-5" class="section level5 hasAnchor" number="7.4.3.1.1">
<h5><span class="header-section-number">7.4.3.1.1</span> SGS Sample Distance<a href="TwoD-Domains-1.html#SGS-Distance-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To manually set the SGS distance, the recommended approach is to use the .tcf <a href="TCFCommands-1.html#tcfSGSSampleTargetDistance">SGS Sample Target Distance</a> command. TUFLOW requires an odd number of sample locations across a cell face, the number of sample points is calculated from Equation <a href="TwoD-Domains-1.html#eq:equ-sgs-smp-freq">(7.11)</a></p>
<p><span class="math display" id="eq:equ-sgs-smp-freq">\[\begin{equation}
\text{Sample Frequency} = \frac{\text{TUFLOW Cell Size}}{\text{Target Distance}} + 1
\tag{7.11}
\end{equation}\]</span></p>
<p>For example, using a cell size of 10m and a sample target distance of 1m, TUFLOW will use 11 sample points along the cell face. If the target distance specified gives an even number, TUFLOW will round up to the next odd number. For example, using a cell size of 5m and a sample target distance of 1m, TUFLOW will use 7 sample points instead of 6 points along the cell face. The adopted sampling frequency is reported in the .tlf.</p>
<p>It is also possible to specify the <a href="TCFCommands-1.html#tcfSGSSampleFrequency">SGS Sample Frequency</a> directly instead of the target distance. However, changing the cell size of the model would require a changing to the sample frequency to maintain the same sample distance. When using a target sample distance the same value can be used across all cell sizes.</p>
<p>To obtain the maximum resolution, the sampling frequency can be calculated as the TUFLOW cell size divided by the DEM resolution. If this yields an even number, then it should be rounded up as per Equation <a href="TwoD-Domains-1.html#eq:equ-sgs-smp-freq">(7.11)</a>. Note, there is no benefit to specify an SGS target distance smaller than the DEM resolution.</p>
<p>If neither the <a href="TCFCommands-1.html#tcfSGSSampleTargetDistance">SGS Sample Target Distance</a> or <a href="TCFCommands-1.html#tcfSGSSampleFrequency">SGS Sample Frequency</a> commands are specified, a scan of the Geometry Control File (.tgc) is performed to find the minimum raster grid resolution used in any <a href="TGCCommands-1.html#tgcReadGridZpts">Read Grid Zpt</a> commands, and this is used as the sampling target distance to compute the sampling frequency.
If there are no gridded elevation datasets, a default sampling frequency of 11 is used. In summary, there are four ways for the SGS Sample Frequency to be defined; in decreasing order of priority they are:</p>
<ol style="list-style-type: decimal">
<li>“<tcmd><a href="TCFCommands-1.html#tcfSGSSampleFrequency">SGS Sample Frequency</a> </tcmd><teq>==</teq>” command.</li>
<li>“<tcmd><a href="TCFCommands-1.html#tcfSGSSampleTargetDistance">SGS Sample Target Distance</a></tcmd><teq> ==</teq>” command.</li>
<li>Target distance automatically based on the minimum grid elevation resolution in the .tgc.</li>
<li>Default Sampling Frequency of 11 per face / 121 per cell.</li>
</ol>
<p>Note: the sampling frequency per face is capped at 31 by default to avoid long pre-processing times and high memory usage. In general, a sampling frequency of between 11 and 31 is sufficient for most natural water ways or artificial structures, and users may not benefit from applying a super fine sample distance against the model cell size. However, if required, high sampling resolution is possible and the set upper limit can be increased by using the following tcf command:</p>
<p><tcmd><a href="TCFCommands-1.html#tcfSGSMaxSampleFrequency">SGS Max Sample Frequency</a> </tcmd><teq>==</teq> <span class="math inline">\(\langle\)</span>maximum frequency<span class="math inline">\(\rangle\)</span></p>
<p>Note, a hard limit of 127 per face (16,129 samples per cell) still applies.</p>
</div>
<div id="SGS-Advanced-5" class="section level5 hasAnchor" number="7.4.3.1.2">
<h5><span class="header-section-number">7.4.3.1.2</span> Advanced SGS Commands<a href="TwoD-Domains-1.html#SGS-Advanced-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>As noted above, the only command required to implement SGS is “<tcmd><a href="TCFCommands-1.html#tcfSGS">SGS</a></tcmd><teq> == </teq><tblk>ON</tblk>”. One of the above commands to set the SGS sample distance or frequency is also recommended. The following section lists advanced commands related to SGS.</p>
<hr />
<p><tcmd><a href="TCFCommands-1.html#tcfSGSBreaklineDetectionDelta">SGS Breakline Detection Delta</a></tcmd><teq> == </teq><tblk> [ &lt;maximum_delta_value&gt; ]</p>
<p>When the SGS elevations are being processed, every cell face will store a curve of elevation versus flow width / flow area. Likewise, each cell has a curve defining the relationship of elevation versus cell volume. To make this memory efficient TUFLOW does not store information defining the specific locations within the cell or along the cell face where the low or high points in the topography occur. As a result, without breaklines, SGS will be more likely to allow “leaks” through a levee or embankment compared with running the model without SGS. For example, if a 2D cell straddles a levee, SGS will sample the low elevations on either side of the levee and will flow at a lower level than if SGS was not applied and the 2D cell centre was located on top of the levee, causing the 2D cell to block flow until the levee is overtopped. Therefore, whilst the need to have breaklines is paramount, regardless of whether SGS is used, it is even more important for SGS models to accurately represent hydraulic controls such as levees (artificial or natural), road/rail embankments, fences, etc.</p>
<p><a href="TCFCommands-1.html#tcfSGSBreaklineDetectionDelta">SGS Breakline Detection Delta</a> is designed to identify locations where ridge lines may be required. As noted in Section <a href="TwoD-Domains-1.html#SGS-3">7.4.3</a>, <a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> or <a href="TGCCommands-1.html#tgcReadGISZLine">Read GIS Z Line</a> “MIN, GULLY or LOWER” lines are not recommended for use.</p>
<p>The SGS breakline detection check processes each 2D cell to identify the minimum water surface elevation needed for a continuous wet connection through the cell traversing between left to right and top to bottom. The maximum invert elevation of the left and right faces is subtracted from the left-right minimum water level and reports it as “uDelta”. Similarly, the top to bottom value is reported as “vDelta”. uDelta and vDelta represent the depth of water over the cell face inverts by which a natural ridge (break) line would block any flow. The maximum of uDelta and vDelta is output to the <a href="https://wiki.tuflow.com/Check_Files_2d_grd">_grd_check</a> file in the SGS_Delta_Z attribute. If either uDelta or vDelta exceeds the <maximum delta value> a spatial (GIS) <a href="https://wiki.tuflow.com/TUFLOW_Message_3543">CHECK 3543</a> message is issued at the cell location.</p>
<p>This command can add significant time to the initialisation process, it is recommended to perform this check during model set up only, and to turn it off once the creation of breaklines is complete.</p>
<p>Figure <a href="TwoD-Domains-1.html#fig:fig-SGS-Delta">7.27</a> shows an example of where <a href="https://wiki.tuflow.com/TUFLOW_Message_3543">CHECK 3543</a> indicates where the uDelta or vDelta has exceeded the <maximum delta value> (in this example, a value of 1m).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-SGS-Delta"></span>
<img src="images/SGS-Delta.png" alt="SGS Breakline Detection Delta Output" width="50%" />
<p class="caption">
Figure 7.27: SGS Breakline Detection Delta Output
</p>
</div>
<hr />
<p><tcmd><a href="TCFCommands-1.html#tcfSGSZShapeLineApproach">SGS Z Shape Line Approach</a></tcmd><teq> == </teq><tblk>Method A | {Method B}</tblk></p>
<p>If set to Method A, cell faces modified by <a href="TGCCommands-1.html#tgcReadGISZShape">Read GIS Z Shape</a> line are assumed flat (i.e. SGS is not applied and a rectangular section / flat
cell is used). The default, Method B, applies a gradient along the face based on the cell corners and cell side Zpt values and for thick lines uses the ZC, ZU, ZV and ZH values to apply a sloping cell area
for the cell volume.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-SGS-Z-Line"></span>
<img src="images/SGS-Z-Line.png" alt="Diagram of SGS Z Shape Line Approach Options" width="50%" />
<p class="caption">
Figure 7.28: Diagram of SGS Z Shape Line Approach Options
</p>
</div>
<hr />
<p><tcmd><a href="TCFCommands-1.html#tcfSGSSXZFlagApproach">SGS SX Z Flag Approach</a></tcmd><teq> == </teq><tblk>Method A | {Method B}</tblk></p>
<p>If set to Method A, cells that are lowered by the “Z” flag on 2d_bc SX connections are assumed flat (i.e. as per the approach for no SGS). The default Method B retains the SGS information, but shifts it all to
match the lowered elevation, as per Figure <a href="TwoD-Domains-1.html#fig:fig-sgs-SX-Flag">7.29</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-sgs-SX-Flag"></span>
<img src="images/sgs-SX-Flag.png" alt="Diagram of SGS SX Z Flag Approach Options" width="30%" />
<p class="caption">
Figure 7.29: Diagram of SGS SX Z Flag Approach Options
</p>
</div>
<!-- EFC to PAR: do I also need to link here from the direct rainfall section?-->
<!-- EFC to PAR: I've copied this from the 2020 release notes what is the SGS Negative Rainfall approach? Is it different to the Soil Negative Rainfall approach command?-->
<!-- SGS neg rainfall approach - is regarding surface water, no soils-->
<hr />
<p><tcmd><a href="TCFCommands-1.html#tcfSGSInfiltrationApproach">SGS Infiltration Approach</a></tcmd><teq> == </teq><tblk> {AUTO} | TOTAL AREA | WETTED AREA </tblk></p>
<p>It is possible to control the cell area used when infiltration is applied with SGS, using the <a href="TCFCommands-1.html#tcfSGSInfiltrationApproach">SGS Infiltration Approach</a> command. The three available options are:</p>
<ul>
<li>AUTO (the default): uses total area if there is a rainfall boundary and wetted area if no rainfall boundaries are present.</li>
<li>TOTAL AREA: uses the whole cell area, regardless of the portion of the cell that is wet.</li>
<li>WETTED AREA: uses only the wetted portion of the cell, for direct rainfall boundaries this may under predict the infiltration.</li>
</ul>
<hr />
<p><tcmd><a href="TCFCommands-1.html#tcfSGSNegativeRainfallApproach">SGS Negative Rainfall Approach</a> </tcmd><teq> == </teq><tblk> TOTAL AREA | {WETTED AREA} </tblk></p>
<p>It is also possible to control the cell area used when negative rainfall is applied in conjunction with SGS, using the <a href="TCFCommands-1.html#tcfSGSNegativeRainfallApproach">SGS Negative Rainfall Approach</a> command. The two options available are:</p>
<ul>
<li>TOTAL AREA: uses the whole cell area, regardless of the portion of the cell that is wet.</li>
<li>WETTED AREA (the default): uses only the wetted portion of the cell.</li>
</ul>
<p>With SGS enabled, for cells that are partially wet the treatment of infiltration and direct rainfall is:</p>
<ul>
<li>For positive rainfall (i.e. rainfall on to the 2D cell), the volume source for each cell is the total cell
area times the rainfall irrespective of whether the cell is partially wet or not.</li>
<li>For negative rainfall (evaporation), the volume of evaporation is factored by the wet area fraction
of the cell. That is, if the cell is only 10% wet, only one tenth of the cell’s total area contributes to
the negative source term.</li>
<li>For models with soil infiltration the infiltration rate is proportional to the wet area fraction of the cell.
However, initial infiltration losses are based on the total area of the cell (i.e. infiltration will proceed
at the maximum possible rate until the cumulative infiltration – also based on total cell area - equals
the initial loss value) even if the infiltration occurs with the cell partially wet. This approach is
adopted to conform with that required for direct rainfall, which assumes the rainfall is applied over
the entire cell irrespective of whether the cell is partially wet or not. Likewise, soil capacity is
based on the total cell area (i.e. infiltration will cease once the cumulative infiltration equals soil
capacity), and the cumulative wet time for the Horton model will also increment for cells that are
partially wet.</li>
</ul>
<hr />
</div>
</div>
<div id="SGS-output-4" class="section level4 hasAnchor" number="7.4.3.2">
<h4><span class="header-section-number">7.4.3.2</span> SGS Output Options<a href="TwoD-Domains-1.html#SGS-output-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="SGS-check-5" class="section level5 hasAnchor" number="7.4.3.2.1">
<h5><span class="header-section-number">7.4.3.2.1</span> Check Files<a href="TwoD-Domains-1.html#SGS-check-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>When running a model with SGS enabled there are additional attributes inserted into the <a href="https://wiki.tuflow.com/Check_Files_2d_zpt">_zpt check</a> layer and an additional raster check file, the <a href="https://wiki.tuflow.com/Check_Files_2d_DEM_Zmin">_DEM_Zmin</a>.</p>
<p>If the <a href="https://wiki.tuflow.com/Check_Files_2d_zpt">_zpt check</a> layer is output, with SGS turned on, the following additional attribute information is provided:</p>
<ul>
<li>The “Zmin” attribute for ZC points, previously called “Elevation”, now represents the minimum elevation within the cell. The “Zmin” for ZU/ZV points is the minimum along the cell face. Note, these points are still located at the centre of the cell or cell face, but the minimum value is not necessarily at this location.</li>
<li>“ZExact” is the elevation at the exact location of cell centre, face mid-point, or cell corner.</li>
<li>“ZAvg” is the average (mean) elevation of the sampled values.</li>
<li>“ZMed” is the median elevation of the sampled values.</li>
<li>The “ZMax” attribute is the maximum elevation (i.e. the elevation at which the cell area or cell face flow width is fully wet).</li>
<li>“ZOut” is the elevation used for the <a href="TCFCommands-1.html#tcfSGSDepthOutput">SGS Depth Output</a> (Section <a href="TwoD-Domains-1.html#sgs-output-5">7.4.3.2.2</a>).</li>
</ul>
<p>If the <a href="https://wiki.tuflow.com/Check_Files_2d_DEM_Z">_DEM_Z</a> layer is output, with SGS turned on, an additional raster output is produced, the <a href="https://wiki.tuflow.com/Check_Files_2d_DEM_Zmin">_DEM_Z_min</a>. The _DEM_Zmin contains a raster based on the minimum SGS elevations. When using SGS, the _DEM_Z contains a raster based on the SGS elevations used for the depth output interpolation (based on the <a href="TCFCommands-1.html#tcfSGSDepthOutput">SGS Depth Output</a> command.)</p>
</div>
<div id="sgs-output-5" class="section level5 hasAnchor" number="7.4.3.2.2">
<h5><span class="header-section-number">7.4.3.2.2</span> Map Outputs<a href="TwoD-Domains-1.html#sgs-output-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The following .tcf commands can be used to control the value of depth (d) map output when SGS is used.</p>
<p><tcmd><a href="TCFCommands-1.html#tcfSGSDepthOutput">SGS Depth Output</a></tcmd><teq> == </teq><tblk>EXACT | {CELL AVERAGE} | MEAN | MEDIAN | MINIMUM | PERCENTILE </tblk></p>
<ul>
<li>CELL AVERAGE (default): calculates the depth by dividing the cell volume by cell area.</li>
<li>EXACT: the output depth is the water level minus the exact ZC and ZH elevations (i.e. the elevations that would be sampled exactly at the cell centre (ZC) and cell corner (ZH) locations if SGS was not applied).</li>
<li>MEAN: the output depth is the water level minus the mean elevations of the cells and the cell corners from the SGS sampling. Note the MEAN depth output differs from the CELL AVERAGE depth for partially wet cells. For example, if the water level is smaller than the MEAN cell elevation, the MEAN depth output becomes negative (trimmed as zero), while the CELL AVERAGE depth (water volume / cell area) is still positive.</li>
<li>MEDIAN: the output depth is the water level minus the median (50th percentile) elevation for the cells and the cell corners from the SGS sampling.</li>
<li>MINIMUM: the output depth is the water level minus the minimum elevation for the cells and the cell corners from the SGS sampling (i.e. the map output shows the maximum depth within a cell / around a cell corner).</li>
<li>PERCENTILE: the output depth is water level minus an elevation based on the specified set percentile. This requires a second argument, separated by vertical bar “|”, which is the percentile to use. For example, “<tcmd><a href="TCFCommands-1.html#tcfSGSDepthOutput">SGS Depth Output</a></tcmd><teq> == </teq><tblk>Percentile | 25</tblk>” will use the 25th percentile of the SGS elevations sampled within the cell / around the cell corner.</li>
</ul>
<p>The elevations used for the SGS Depth Output are output in the <a href="https://wiki.tuflow.com/Check_Files_2d_zpt">_zpt_check</a> file as the “ZOut” attribute, see Section <a href="TwoD-Domains-1.html#SGS-check-5">7.4.3.2.1</a>.</p>
<p>Note that the water level (h) output is not affected by this command.</p>
<p>For the EXACT, MEAN, MEDIAN, MINIMUM, PERCENTILE approaches, the depth output is trimmed if the modelled water level is lower than the output elevations. Meanwhile, the water level output is not trimmed even if the output depth is below the output elevations, and this can produce different output extents for the water level and other outputs. For this reason, the CELL AVERAGE option is recommended for the consistency of the output extent. But if using the other options, the default trimming option can be changed using the <a href="TCFCommands-1.html#tcfSGSMapExtent">SGS Map Extent <Trim or Full></a> command.</p>
<p>For the MEAN, MEDIAN, MINIMUM, PERCENTILE approaches, the corner output elevations depend on the size of the SGS sampling area around the cell corners. By default, cell corner elevations are sampled within a square that has the same size as the 2D cell. The size be manually adjusted using the <a href="TCFCommands-1.html#tcfSGSZHSampleRatio">SGS ZH Sample Ratio</a> command.</p>
<p>By default the CELL AVERAGE depth is used to calculate the depth/velocity based map outputs, such as unit flow (q), bed shear stress (BSS), stream power (SP) and hazards, regardless of the <a href="TCFCommands-1.html#tcfSGSDepthOutput">SGS Depth Output</a> setting. However, if desired, the depth used to calculate these map outputs can be changed using the following command:</p>
<p><tcmd><a href="TCFCommands-1.html#tcfSGSVelocityBasedOutputs">SGS Velocity Based Outputs</a></tcmd><teq> == </teq><tblk> {CELL AVERAGE DEPTH} | SGS DEPTH OUTPUT </tblk></p>
<p>If set to the “SGS DEPTH OUTPUT” option, the output depth specified by the <a href="TCFCommands-1.html#tcfSGSDepthOutput">SGS Depth Output</a> command above is used. Note that the velocity (v) output is not affected by these commands.</p>
</div>
<div id="high-resolution-outputs" class="section level5 hasAnchor" number="7.4.3.2.3">
<h5><span class="header-section-number">7.4.3.2.3</span> High-Resolution Outputs<a href="TwoD-Domains-1.html#high-resolution-outputs" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>When using the default sub-grid sampling (SGS) approach the sampled elevations are retained, including topography modifiers such as breaklines, for result post processing. This allows a high-resolution grid to be written (for either depth (d) or water level (h)) and used for high resolution map outputs and also check grids such as the DEM_Z. High-resolution outputs, made available when using SGS Method C, are discussed in Section <a href="Outputs-1.html#HRGrid-4">11.2.2.3</a>.</p>
<p>The following commands can be used to alter the high resolution output and are discussed further in Appendix <a href="TCFCommands-1.html#TCFCommands-1">A</a>.</p>
<ul>
<li><a href="TCFCommands-1.html#tcfHRInterpolationApproach">HR Interpolation Approach</a>: can be used to control how the cell centre / corner data is interpolated across the cell.</li>
<li><a href="TCFCommands-1.html#tcfHRThinZLineOutputAdjustment">HR Thin Z Line Output Adjustment</a>: for models with thin breaklines, the presence of breaklines can be used to alter the High Resolution output interpolation.</li>
</ul>
</div>
</div>
</div>
<div id="HPC-US-Controlled-3" class="section level3 hasAnchor" number="7.4.4">
<h3><span class="header-section-number">7.4.4</span> 2D Upstream Controlled Flow (Weirs and Supercritical Flow)<a href="TwoD-Domains-1.html#HPC-US-Controlled-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The original weir flow approximation in TUFLOW HPC was to adjust the water level gradient where flow in the 2D domain becomes upstream controlled. The 2023-03 release (and onwards) defaults to applying the full weir equation in the 2D domain along thin and thick breaklines based on the advanced weir equation (Section <a href="OneD-Domains-1.html#Adv-Weir-4">5.8.4.3</a>). However, users can revert to the original approach using the command:</p>
<p><tcmd><a href="TCFCommands-1.html#tcfHPCWeirApproach">HPC Weir Approach</a></tcmd><teq> == </teq><tblk>Method A | Method B | {Method B Energy}</tblk></p>
<p>Where:</p>
<ul>
<li>“Method A” is the pre 2023-03 method that applies the water level gradient limiter only.<br />
</li>
<li>“Method B” applies the weir equation and uses the upstream water level above the weir invert as <em>H<sub>u</sub></em>, and downstream water level above the weir invert as <em>H<sub>d</sub></em>.<br />
</li>
<li>“Method B Energy” is the default approach. It applies the weir equation and uses the upstream energy level above the weir invert as <em>H<sub>u</sub></em>, and downstream water level above the weir invert as <em>H<sub>d</sub></em>.</li>
</ul>
<p>The default weir parameters (<em>C<sub>d</sub></em>, <em>Ex</em>, <em>a</em> and <em>b</em>) are
based on the parameters used for a broad crest weir, see Table <a href="OneD-Domains-1.html#tab:tab-WeirFlows">5.15</a> (i.e.
0.577, 1.5, 8.55 and 0.556, respectively). The following .tcf commands
can be used to change the coefficients globally.</p>
<p>For a thin breakline:</p>
<p><tcmd><a href="TCFCommands-1.html#tcfHPCWeirParameters">HPC Thin Weir Parameters</a></tcmd><teq> == </teq><tblk> &lt;Cd&gt;, &lt;Ex&gt;, &lt;a&gt;, &lt;b&gt;</tblk></p>
<p>For a thick breakline:</p>
<p><tcmd><a href="TCFCommands-1.html#tcfHPCWeirParameters">HPC Thick Weir Parameters</a></tcmd><teq> == </teq><tblk>&lt;Cd&gt;, &lt;Ex&gt;, &lt;a&gt;, &lt;b&gt;</tblk></p>
<p>In addition, the weir calibration factor, <em>C<sub>f</sub></em> ,can be
adjusted globally using the using the <a href="TGCCommands-1.html#tgcSetWrF">Set WrF</a> command, or
adjusted locally using the <a href="TGCCommands-1.html#tgcReadGISWrF">Read GIS WrF</a> command. The
default value of <em>C<sub>f</sub></em> is 1.0.</p>
</div>
<div id="HPC-Groundwater-3" class="section level3 hasAnchor" number="7.4.5">
<h3><span class="header-section-number">7.4.5</span> Groundwater Flow<a href="TwoD-Domains-1.html#HPC-Groundwater-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--EFC to PAR: I think we needed to separate CO and horizontal movement (so people know they can use horizontal movement without multiple layers) but I think I've tangled the below. -->
<!-- PAR to EFC i think it was largely ok, but have tried to add some clarity...-->
<p>Infiltration of the surface water into the ground/soil has been
supported in previous releases, however, as discussed in Section <a href="TwoD-Domains-1.html#Infiltration-2">7.3.7</a>, this functionality was limited to vertical movement of water, and one vertical soil layer (the soil type could vary spatially across the model).</p>
<p>The 2023-03 release permits horizontal flow (advection) of water (Section <a href="TwoD-Domains-1.html#hhc-5">7.4.5.0.1</a>) and multiple vertical groundwater layers (Section <a href="TwoD-Domains-1.html#CO-4">7.4.5.0.2</a>) when using TUFLOW HPC. Up to 10 vertical layers are supported, each with horizontal advection within the layer possible, and vertical fluid movement between groundwater soil layers. Movement of water within the ground in the real world is complex. The functionality introduced in the 2023-03 release is not intended to replace detailed groundwater modelling, but provides a functional mechanism by which:</p>
<ul>
<li>Catchment response for 2D direct rainfall (“rain on grid”) models can
be better calibrated to available river flow data.<br />
</li>
<li>Long-term catchment models can be constructed that offer some
prediction of stream-flows long after rainfall events.<br />
</li>
<li>The accuracy of real-time flood forecasts can be improved by taking
into account the drying and draining of catchments that has occurred
since the last rainfall event.<br />
</li>
<li>Groundwater seepage can cause inundation, such as seepage under a
levee bank through a porous layer (e.g., old gravel river course),
resulting in flooding on the protected side of the levee.</li>
</ul>
<p>The basic groundwater modelling approach is conceptualised by dividing the ground into vertical layers, each with
a defined thickness (alternatively a z elevation for the bottom of each
layer), soil type, and cumulative infiltration of water within the
layer. The cumulative infiltration, combined with the porosity defined
by the soil type, allows a theoretical “groundwater elevation” (also
known as a “water table”) to be computed within the layer. Figure <a href="TwoD-Domains-1.html#fig:fig-image108">7.30</a> illustrates the soil layers in adjoining cells with convective and advective fluxes.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image108"></span>
<img src="images/image108.png" alt=" Illustration of soil layers and flows in adjoining cells"  />
<p class="caption">
Figure 7.30:  Illustration of soil layers and flows in adjoining cells
</p>
</div>
<p>The horizontal movement of water, <span class="math inline">\(Q^{h}\)</span>, is governed by the horizontal hydraulic conductivity value set in the tsoilf file (see Table <a href="TwoD-Domains-1.html#tab:tab-tsoilf-hpc">7.21</a>). All groundwater layers allow for horizontal advection of the water within the layer. Horizontal advection is disabled if all horizontal hydraulic conductivities are set to zero (which is the default if they are not specified). An example of a model using horizontal hydraulic conductivity, is provided in the <a href="https://wiki.tuflow.com/TUFLOW_Example_Models#Soil_Options">TUFLOW Example Model Dataset</a>.</p>
<p>The vertical flow of water, <span class="math inline">\(Q^{z}\)</span>, from the surface
water layer into the first (or top) groundwater layer is governed by the soil infiltration model. The infiltration into the top soil can use any of the Green-Ampt (GA), Horton (HO) and Initial/Continuing Loss (IlCL) infiltration methods, as listed in Table <a href="TwoD-Domains-1.html#tab:tab-tsoilf-hpc">7.21</a>. For layers below the top vertical soil layer then the Convective (CO) type must be used, see Section <a href="TwoD-Domains-1.html#CO-4">7.4.5.0.2</a>. An example of a model using two vertical soil layers (i.e. the “CO” type), is provided in the <a href="https://wiki.tuflow.com/TUFLOW_Example_Models#Soil_Options">TUFLOW Example Model Dataset</a>.</p>
<p>The cumulative infiltration data and the vertical movement of water are
stored and computed at cell centres. As such, all soil data and
groundwater layer geometry is sampled from the GIS / Grid layers at cell
centres. Likewise the material “fraction impervious” data is sampled at
cell centres (unlike the mannings values which are sampled at face
centres). For the horizontal advection calculation, which is performed
at cell faces, the horizontal hydraulic conductivity used is the average
of the cell centre values for the adjoining cells.</p>
<div id="hhc-5" class="section level5 hasAnchor" number="7.4.5.0.1">
<h5><span class="header-section-number">7.4.5.0.1</span> Horizontal Advection<a href="TwoD-Domains-1.html#hhc-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>For all layers, the horizontal advection of water from one cell to the
next, <span class="math inline">\(Q^{h}\)</span>, is computed using the horizontal hydraulic conductivity
of the soil and the horizontal gradient of a variable called the
“groundwater pressure level”:</p>
<p><span class="math display" id="eq:equ-Qh">\[\begin{equation}
Q^{h} = - k_{h}hp\frac{de}{dx}dy
\tag{7.12}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(k_{h}\)</span> is the horizontal hydraulic conductivity of the soil (average of the adjoining cells used)<br />
</li>
<li><span class="math inline">\(h\)</span> is the groundwater elevation less the layer bottom elevation<br />
</li>
<li><span class="math inline">\(p\)</span> is the soil porosity<br />
</li>
<li><span class="math inline">\(\frac{de}{dx}\)</span> is the gradient of the “groundwater pressure level”<br />
</li>
<li><span class="math inline">\(dy\)</span> the width of the face.</li>
</ul>
<p>Note, if advection of groundwater is not required, then the
advection calculation may be disabled by setting <span class="math inline">\(k_{h}\)</span> to zero for all
soils. This is the default behaviour if <span class="math inline">\(k_{h}\)</span> is not specified in the
soil parameters.</p>
<p>For cells that are “unsaturated” the “groundwater pressure level” is
exactly the groundwater elevation within that layer. For cells that are
fully saturated, the groundwater pressure level is that of the cell in
the next layer above (or the water surface elevation when considering
the topmost groundwater layer). For cells that are “nearly saturated”
the groundwater pressure level is transitioned between these two
options. The threshold at which the transition begins is called the
“groundwater blending threshold”, <span class="math inline">\(\phi\)</span>.</p>
<p><span class="math display" id="eq:equ-blend">\[\begin{equation}

\xi = \frac{\frac{h_{i}}{dz} - \phi}{(1 - \phi)} \\
e_{i} = (1 - \xi)\left( z_{i} + h_{i} \right) + \xi e_{i - 1} \\
e_{0} = {WSE}_{surface}

\tag{7.13}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(h_{i}\)</span> is the depth of groundwater in the cell<br />
</li>
<li><span class="math inline">\(dz\)</span> the vertical thickness of the layer<br />
</li>
<li><span class="math inline">\(z_{i}\)</span> the layer bottom elevation<br />
</li>
<li><span class="math inline">\(e_{i - 1}\)</span> the groundwater pressure level for the layer above (or surface layer) - <span class="math inline">\(e_{i}\)</span> the resulting groundwater pressure level for this layer.</li>
</ul>
<p>The layer ordering is such that the surface water is layer “0”, the highest
groundwater layer is “1”, and any subsequent groundwater layers range from
2 to N (i.e. from top to bottom).</p>
<p>The groundwater blending threshold, <span class="math inline">\(\phi\)</span>, defaults to a value of 0.9
but can be overridden by the user in the .tcf using the command:</p>
<p><tcmd><a href="TCFCommands-1.html#tcfGroundwaterBlendThreshold">Groundwater Blend Threshold</a></tcmd><teq> == </teq><tblk>&lt;float&gt; | {0.9}</tblk></p>
<p>If the sum of flows into a layer cell causes it to exceed its soil
capacity, the excess is pushed upwards to the next layer. If this happens
for the top-most groundwater layer, the excess is pushed into the
surface water as “return flow”. This is to be expected in the creek beds
but may also happen at the bottom of steep hills where the slope
transitions from steep to shallow.</p>
</div>
<div id="CO-4" class="section level5 hasAnchor" number="7.4.5.0.2">
<h5><span class="header-section-number">7.4.5.0.2</span> Convective Flow Layers (CO)<a href="TwoD-Domains-1.html#CO-4" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>For layers below the top groundwater layer, the vertical flow of water, <span class="math inline">\(Q^{z}\)</span>, is
computed using a “convective” hydraulic conductivity (effectively the
same concept as continuing loss):</p>
<p><span class="math display" id="eq:equ-Qz">\[\begin{equation}
Q^{z} = \  - kdxdy
\tag{7.14}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Q^{z}\)</span> is the convective vertical flux</li>
<li><span class="math inline">\(k\)</span> is the convective hydraulic conductivity<br />
</li>
<li><span class="math inline">\(dxdy\)</span> is the cell area.</li>
</ul>
<p>Note that <span class="math inline">\(Q^{z}\)</span> is limited to the available cumulative infiltration
stored in the groundwater layer above, and also limited to the remaining
capacity of the groundwater layer below.</p>
</div>
<div id="implementation" class="section level4 hasAnchor" number="7.4.5.1">
<h4><span class="header-section-number">7.4.5.1</span> Implementation<a href="TwoD-Domains-1.html#implementation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Although the theory appears complex, the implementation within the
TUFLOW model files is straight forward. The essential steps are:</p>
<ul>
<li>Read a soils (.tsoilf) data file from within the .tcf (see Section <a href="TwoD-Domains-1.html#HPC-tsoilf-5">7.4.5.1.1</a>).</li>
<li>Define the soil types in the .tgc (see Section <a href="TwoD-Domains-1.html#HPC-soil-type-5">7.4.5.1.2</a>).<br />
</li>
<li>Define the soil layer thickness in the .tgc (see Section <a href="TwoD-Domains-1.html#HPC-soil-type-5">7.4.5.1.2</a>).</li>
<li>Specify locations of groundwater boundaries in the .tbc (see Section <a href="Boundaries-InitialConditions-1.html#GT-4">8.5.1.2</a>).<br />
</li>
<li>Specify initial water levels within the soil layers (optional) (see Section <a href="Boundaries-InitialConditions-1.html#IGW-3">8.9.2</a>).</li>
<li>Add any additional output data types in the .tcf. For example the Map Output Data Types: dGW, GWd, GWh, GWm, GWq, GWv in Table <a href="Outputs-1.html#tab:tab-ExcludingHazard">11.4</a>, or Time Series Output Data Types: GWd, GWh, GWm, GWq, GWqa, GWqu, GWqv, GWVol in Table <a href="Outputs-1.html#tab:tab-PODataPLPL">11.9</a>.</li>
</ul>
<div id="HPC-tsoilf-5" class="section level5 hasAnchor" number="7.4.5.1.1">
<h5><span class="header-section-number">7.4.5.1.1</span> HPC Soils File (.tsoilf)<a href="TwoD-Domains-1.html#HPC-tsoilf-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The .tsoilf is the same file mentioned in Section <a href="TwoD-Domains-1.html#tsoilf-4">7.3.7.2</a>. However, when using TUFLOW HPC there are additional parameters available which can be used to enable horizontal advection, and vertical flow through a convective (CO) layer. These additional parameters are bold in Table <a href="TwoD-Domains-1.html#tab:tab-tsoilf-hpc">7.21</a>.</p>
<table>
<caption>
<span id="tab:tab-tsoilf-hpc">Table 7.21: </span><strong>HPC .tsoilf Parameters</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Column No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No Intriltration
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Green-Ampt
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Green-Ampt
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Horton
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Initial/Continuing Loss
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Convective
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Soil ID
</td>
<td style="text-align:left;">
Soil ID
</td>
<td style="text-align:left;">
Soil ID
</td>
<td style="text-align:left;">
Soil ID
</td>
<td style="text-align:left;">
Soil ID
</td>
<td style="text-align:left;">
<strong>Soil ID</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
NONE
</td>
<td style="text-align:left;">
GA
</td>
<td style="text-align:left;">
GA
</td>
<td style="text-align:left;">
HO
</td>
<td style="text-align:left;">
ILCL
</td>
<td style="text-align:left;">
<strong>CO</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
USDA Soil Type (see Table <a href="TwoD-Domains-1.html#tab:tab-GreenAmpt">7.12</a>)
</td>
<td style="text-align:left;">
Suction (mm or inches)
</td>
<td style="text-align:left;">
Initial Loss (mm or inches)
</td>
<td style="text-align:left;">
Initial Loss (mm or inches)
</td>
<td style="text-align:left;">
<strong>Hydraulic Conductivity (mm/h or in/h)</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Initial Moisture (Fraction)
</td>
<td style="text-align:left;">
Hydraulic Conductivity (mm/h or in/h)
</td>
<td style="text-align:left;">
Initial Loss Rate (<span class="math inline">\(f_0\)</span>) (mm/h or in/h)
</td>
<td style="text-align:left;">
Continuing Loss (mm/h or in/h)
</td>
<td style="text-align:left;">
<strong>Porosity (Fraction)</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Max Ponding Depth (m or ft)
</td>
<td style="text-align:left;">
Porosity (Fraction)
</td>
<td style="text-align:left;">
Final Loss Rate (<span class="math inline">\(f_c\)</span>) (mm/h or in/h)
</td>
<td style="text-align:left;">
Porosity (Fraction)
</td>
<td style="text-align:left;">
<strong>Initial Moisture (Fraction)</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<strong>Horizontal Hydraulic Conductivity (mm/h or in/h)</strong>
</td>
<td style="text-align:left;">
Initial Moisture (Fraction)
</td>
<td style="text-align:left;">
Exponential Decay Rate (k) (h-1 )
</td>
<td style="text-align:left;">
Initial Moisture (Fraction)
</td>
<td style="text-align:left;">
<strong>Horizontal Hydraulic Conductivity (mm/h or in/h)</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Max Ponding Depth (m or ft)
</td>
<td style="text-align:left;">
Porosity (Fraction)
</td>
<td style="text-align:left;">
<strong>Horizontal Hydraulic Conductivity (mm/h or in/h)</strong>
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<strong>Horizontal Hydraulic Conductivity (mm/h or in/h)</strong>
</td>
<td style="text-align:left;">
Initial Moisture (Fraction)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<strong>Horizontal Hydraulic Conductivity (mm/h or in/h)</strong>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
</div>
<div id="HPC-soil-type-5" class="section level5 hasAnchor" number="7.4.5.1.2">
<h5><span class="header-section-number">7.4.5.1.2</span> Soil Type<a href="TwoD-Domains-1.html#HPC-soil-type-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Setting the soil type for the groundwater layers activates the given layer. The Green-Ampt, Horton and Initial/Continuing Loss infiltration methods can be used for Layer 1. Any layers beneath Layer 1 (e.g. Layer 2, Layer 3) must be the Convective Type. For example, setting the soil type for layers 1 and 2 will activate 2 vertical groundwater layers:</p>
<p><tcmd><a href="TGCCommands-1.html#tgcSetSoil">Set Soil Layer 1</a></tcmd> <teq>==</teq> <tblk>1</tblk> <tgrn>! soil ID of infiltration layer e.g. GA type</tgrn><br />
<tcmd><a href="TGCCommands-1.html#tgcSetSoil">Set Soil Layer 2</a></tcmd> <teq>==</teq> <tblk>5</tblk> <tgrn>! soil ID of a convective layer e.g. CO type</tgrn></p>
<p>Multiple layers can be set simultaneously (the below will activate 3 interflow layers):</p>
<p><tcmd><a href="TGCCommands-1.html#tgcSetSoil">Set Soil Layer 1</a></tcmd> <teq>==</teq> <tblk>1</tblk><br />
<tcmd><a href="TGCCommands-1.html#tgcSetSoil">Set Soil Layer 2,3</a></tcmd> <teq>==</teq> <tblk>5</tblk> <tgrn>! sets both layers 2 and 3 to Soil ID 5</tgrn></p>
<p>This method also works for read GIS and Grid commands:</p>
<p><tcmd><a href="TGCCommands-1.html#tgcReadGISSoil">Read GIS Soil Layer 1</a></tcmd> <teq>==</teq> <tblk><span class="math inline">\(\langle\)</span> gis_layer <span class="math inline">\(\rangle\)</span></tblk><br />
<tcmd><a href="TGCCommands-1.html#tgcReadGridSoil">Read Grid Soil Layer 2</a></tcmd> <teq>==</teq> <tblk><span class="math inline">\(\langle\)</span> gis_layer <span class="math inline">\(\rangle\)</span></tblk></p>
<p>A maximum of 10 vertical layers is permitted and a soil ID should be assigned for each active layer. For example, if groundwater layer 2 is active, then soil IDs for layer 1 should be assigned. Note, if the layer number is not specified in a .tgc command (e.g. Set Soil), it is assumed to be layer 1.</p>
</div>
<div id="soil-thickness" class="section level5 hasAnchor" number="7.4.5.1.3">
<h5><span class="header-section-number">7.4.5.1.3</span> Soil Thickness<a href="TwoD-Domains-1.html#soil-thickness" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The depth (thickness) of each vertical interflow layer can be set using the following commands:</p>
<p><tcmd>[<a href="TGCCommands-1.html#tgcSetSoilThickness">Set</a> | <a href="TGCCommands-1.html#tgcReadGISSoilThickness">Read GIS</a> | <a href="TGCCommands-1.html#tgcReadGridSoilThickness">Read Grid</a>] Soil Thickness Layer N</tcmd> <teq>==</teq> <tblk>[value | <span class="math inline">\(\langle\)</span> gis_layer <span class="math inline">\(\rangle\)</span>]</tblk><br />
<tcmd>[<a href="#tgcSetSoilBase%20Elevation">Set</a> | <a href="#tgcReadGISSoilBase%20Elevation">Read GIS</a> | <a href="#tgcReadGridSoilBase%20Elevation">Read Grid</a>] Soil Base Elevation Layer N</tcmd> <teq>==</teq> <tblk>[value | <span class="math inline">\(\langle\)</span> gis_layer <span class="math inline">\(\rangle\)</span>]</tblk></p>
<p>If the soil layer thickness or base elevation is not set for a given layer, it is assumed to be infinite. The soil thickness sets the layer depth from the layer above and soil base elevation sets the absolute elevation of the bottom of the layer. If both methods are specified for a given grid cell, the highest of the two will be adopted. The input units should be in metres or feet (if using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd><teq> == </teq><tblk> US Customary</tblk>).</p>
</div>
</div>
<div id="top-gw-drying-4" class="section level4 hasAnchor" number="7.4.5.2">
<h4><span class="header-section-number">7.4.5.2</span> Drying of Top Groundwater Layer<a href="TwoD-Domains-1.html#top-gw-drying-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Evaporation is typically implemented with a global negative rainfall. Prior to the 2023-03 release this would only remove water in
wet cells until they dry. It would not draw from the cumulative
infiltration layer. The 2023-03 release and onwards allows for negative
rainfall to draw from the topmost groundwater layer under surface layer
cells that are dry, thus mimicking evapotranspiration. Currently only
one approach is implemented, called “factor”, which applies the
defined negative rainfall, though at a (globally) factored rate. To select
this approach use the <a href="TCFCommands-1.html#tcfSoilNegativeRainfallApproach">Soil Negative Rainfall Approach</a> .tcf command.</p>
<p>The default approach is to not apply any negative rainfall to the
topmost groundwater layer. If the “factor” method is selected, then the
factor can be set using the <a href="TCFCommands-1.html#tcfSoilNegativeRainfallFactor">Soil Negative Rainfall Factor</a> .tcf command.
The default factor is 1, meaning that the full value of the negative
rainfall is applied. If the topmost groundwater layer is dry, then no
negative rainfall is applied, and the approach does not look any further
than the topmost layer. No water is drawn from subsequent ground water
layers.</p>
</div>
</div>
<div id="NN-3" class="section level3 hasAnchor" number="7.4.6">
<h3><span class="header-section-number">7.4.6</span> Non-Newtonian Flow<a href="TwoD-Domains-1.html#NN-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>TUFLOW HPC supports modelling of non-Newtonian fluids. The non-Newtonian flow theory, and an example of its use in TUFLOW is discussed in the <a href="https://www.youtube.com/watch?v=MeDQ35zTexU&amp;t=2159s">Tsunami and Dam Failure and non-Newtonian Modelling AWS Webinar</a>. This feature was introduced in the 2020-01 release. It is not supported in TUFLOW Classic. High-fidelity modelling of non-Newtonian fluids is complex and 3D in nature. However, with some assumptions, it is possible to model non-Newtonian fluids reasonably well in 2D. The assumptions are:</p>
<ol style="list-style-type: decimal">
<li>The 2D (horizontal) viscosity can be represented as a summation of
laminar (derivative of non-Newtonian shear stress model) and
turbulent (from Wu eddy viscosity model) contributions.<br />
</li>
<li>Acceleration effects are small and the laminar fluid shear stress is
linear with depth.<br />
</li>
<li>The bed shear stress can be represented as a summation of laminar
(from non-Newtonian shear stress model) and turbulent (from Manning’s
equation) contributions.</li>
</ol>
<p>The laminar fluid shear stress (for flow that is shearing), is assumed to
follow the Hershel-Bulkley power law model:</p>
<p><span class="math display" id="eq:equ-powerlaw">\[\begin{equation}
\tau = \tau_{0} + k{\dot{\gamma}}^{n}
\tag{7.15}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\tau_{0}\)</span> = Yield shear stress of the fluid.<br />
</li>
<li><span class="math inline">\(k\)</span> = Viscosity parameter (units Pa.s<sup>n</sup>)<br />
</li>
<li><span class="math inline">\(\dot{\gamma}\)</span> = Shear strain rate of the fluid<br />
</li>
<li><span class="math inline">\(n\)</span> = Power law exponent (1 = Newtonian, &lt;1 is shear thinning, &gt;1 is
shear thickening)</li>
</ul>
<p>For flows where the bed shear stress exceeds the yield stress, a ‘plug
flow’ velocity profile is computed, as shown in Figure <a href="TwoD-Domains-1.html#fig:fig-NN-plug-flow">7.31</a>. For flows where the bed shear stress does not exceed the yield stress, the fluid is considered locked to the bed and does not flow. Within TUFLOW HPC, at the start of each timestep, a bed stress is
calculated for each cell such that the predicted velocity profile (for
the given bed shear stress) has a depth averaged mean velocity that
matches the current model velocity.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-NN-plug-flow"></span>
<img src="images/NN-plug-flow.png" alt="Non-Newtonian Shear Stress and Velocity Profile"  />
<p class="caption">
Figure 7.31: Non-Newtonian Shear Stress and Velocity Profile
</p>
</div>
<p>Note that for fluids with a low viscosity parameter, or for deep and/or
faster flows, the bed friction that would arise through the use of
Manning’s equation (which is based on turbulent water flow) can be equal
to or greater than that from the Hershel-Bulkley equation. In this
situation the mathematics is stating that the non-Newtonian flow is
likely to be turbulent and behaving more like water, and the bed shear
stress as computed by the Hershel-Bulkley powerlaw model is likely to be
lower than what is occurring in reality. To account for this transition
in a simple manner, the actual bed friction used is the sum of both
non-Newtonian and Manning’s contributions (note the <em>n</em> in the final term
on the righthand side of the following equation is Manning’s n, not the
Hershel-Bulkley power law exponent):</p>
<p><span class="math display" id="eq:equ-NN-friction">\[\begin{equation}
\tau = \tau_{0} + k{\dot{\gamma}}^{n} + \frac{\rho gn^{2}|U|^{2}}{d^{\frac{1}{3}}}
\tag{7.16}
\end{equation}\]</span></p>
<p>This provides a very stable and smooth transition from non-Newtonian bed
shear stress to turbulent water-like bed shear stress as and when
needed. The total shear stress is then utilised in the momentum equation
to evolve the flow velocity. The momentum equation also considers the
possibility that the fluid yield stress is sufficient to hold the fluid
against the net momentum flux, in which case the fluid velocity is
zeroed.</p>
<p>For the computation of 2D shear stresses, the yield shear stress is not
used and the fluid is allowed to continue shearing down to low shear
strain rates and correspondingly low shear stresses. The effective
Non-Newtonian 2D viscosity is computed using the derivative of the
Hershel-Bulkley equation:</p>
<p><span class="math display" id="eq:equ-HB-visc">\[\begin{equation}
\mu_{2D} = kn\left| \dot{\gamma} \right|^{n - 1}\\

\left| \dot{\gamma} \right| =
\max\left( \frac{2|U|}{d},\sqrt{\left( \frac{du}{dx} \right)^{2} + \left( \frac{dv}{dy} \right)^{2} + \frac{1}{2}\left( \frac{du}{dy} + \frac{dv}{dx} \right)^{2}} \right)

\tag{7.17}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\left| \dot{\gamma} \right|\)</span> = Magnitude of shear strain rate</li>
</ul>
<p>Since the <span class="math inline">\(n - 1\)</span> exponent can cause the viscosity to diverge to
infinity at low strain rates for shear thinning fluids, it necessary to
bound the resulting viscosity to a user defined upper limit,
<span class="math inline">\(\mu_{high}\)</span>. For completeness a user defined lower limit, <span class="math inline">\(\mu_{low}\)</span>,
is also applied.</p>
<p>Finally, for deeper and high velocity flows it is possible that the
effective 2D viscosity of turbulent water, as computed by the Wu
turbulence model, is greater than the value computed from the
Hershel-Bulkey powerlaw model. Again, in this situation the mathematics
is stating the non-Newtonian flow is likely to be turbulent and behaving
more like water. To account for this transition the
actual 2D viscosity used is the sum of both non-Newtonian and Wu
turbulence model contributions:</p>
<p><span class="math display" id="eq:equ-actual-visc">\[\begin{equation}
\nu_{T} = \frac{\mu_{2D}}{\rho} + 7U^{*}d
\tag{7.18}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(U^{*}\)</span> = Friction velocity = <span class="math inline">\(\frac{\sqrt{g}\ n|U|}{d^{\frac{1}{6}}}\)</span></li>
</ul>
<p>This provides a very stable and smooth transition from non-Newtonian 2D
viscosity to turbulent water-2D viscosity as and when needed. The value
of 7 is the default Wu viscosity parameter and is not user-definable for
the non-Newtonian module.</p>
<div id="Implementation-4" class="section level4 hasAnchor" number="7.4.6.1">
<h4><span class="header-section-number">7.4.6.1</span> Implementation<a href="TwoD-Domains-1.html#Implementation-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The non-Newtonian flow model is invoked with the <a href="TCFCommands-1.html#tcfViscosityFormulation">Viscosity Formulation</a> command in the .tcf. If
invoked there are no default values for the required coefficients (<span class="math inline">\(k\)</span>,
<span class="math inline">\(n\)</span>, <span class="math inline">\(\mu_{low}\)</span>, <span class="math inline">\(\mu_{high}\)</span>, <span class="math inline">\(\tau_{0}\)</span>). These must be supplied with
the <a href="TCFCommands-1.html#tcfViscosityCoefficient">Viscosity Coefficient</a> command, where:</p>
<ul>
<li><span class="math inline">\(k\)</span>: viscosity coefficient (Pa.s^n)</li>
<li><span class="math inline">\(n\)</span>: shear thickening exponent, must be non zero and positive (shear thinning fluids exhibit <span class="math inline">\(n\)</span> &lt; 1, shear thickening <span class="math inline">\(n\)</span> &gt; 1, and Newtonian fluids <span class="math inline">\(n\)</span> = 1)</li>
<li><span class="math inline">\(\mu_{low}\)</span>: lower viscosity limit (Pa.s)</li>
<li><span class="math inline">\(\mu_{high}\)</span>: higher viscosity limit (Pa.s)</li>
<li><span class="math inline">\(\tau_{0}\)</span>: shear yield stress (Pa)</li>
</ul>
<p>A step-by-step example of how to set up a non-Newtonian model is provided in <a href="https://wiki.tuflow.com/Tutorial_M10#Part_5_-_Non-Newtonian">Tutorial 5</a> on the TUFLOW Wiki. Additionally, an example model is provided in the non-Newtonian section of the <a href="https://wiki.tuflow.com/TUFLOW_Example_Models#Solver_Options">TUFLOW Wiki Example Models</a>.</p>
<p><strong>Note</strong>: In TUFLOW HPC the 2D momentum diffusion is handled explicitly and
therefore can drive the model timestep to small values when the
viscosity becomes large. Therefore, for shear thinning models, it is
important to define an upper limit, <span class="math inline">\(\mu_{high}\)</span>, that is only as large
as necessary. We suggest starting with 1,000 Pa.s and adjusting
lower if the model is being strongly controlled by the diffusion control
number (Nd). Sensitivity testing should be done to test whether the upper
viscosity limit is influencing results in the region of interest. The
lower viscosity limit, <span class="math inline">\(\mu_{low}\)</span>, may be set to zero if desired.</p>
</div>
<div id="NN-Mix-4" class="section level4 hasAnchor" number="7.4.6.2">
<h4><span class="header-section-number">7.4.6.2</span> Non-Newtonian Mixing<a href="TwoD-Domains-1.html#NN-Mix-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It is possible to consider mixing of the non-Newtonian fluid with water, for example a tailings dam failure into a flowing river. To implement
this, a passive AD tracer must be included in the model, note that this requires a
licence for the <a href="Introduction-1.html#ADModule-4">Advection-Dispersion (AD) Module</a>. The AD setup is the same as detailed in Chapter <a href="AD-1.html#AD-1">9</a>. More
than one tracer field is permissible, but the non-Newtonian mixing
calculation will assume that the first tracer represents the fraction of
non-Newtonian fluid, in the range 0 to 1. Care must be taken to ensure
that boundary data and initialisation commands strictly adhere to this
range. Where the tracer value is 1, the properties of the fluid will be
exactly the non-Newtonian properties, as specified with <a href="TCFCommands-1.html#tcfViscosityCoefficient">Viscosity Coefficient</a> command, where the tracer value is 0 the fluid will behave as water. For tracer values between 0 and 1, the non-Newtonian properties are blended with those of water using a power-law equation.</p>
<p><span class="math display" id="eq:equ-NN-mixing">\[\begin{equation}
\xi = a^{m} \\

\rho&#39; = (1 - \xi)\rho_{w} + \xi\rho_{NN} \\

K&#39; = (1 - \xi)\mu_{w} + \xi K_{NN} \\

n&#39; = (1 - \xi)1.0 + \xi n_{NN} \\

\tau_{0}&#39; = \xi\tau_{0,NN} \\
\tag{7.19}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(a\)</span> = the tracer value (0~1)<br />
</li>
<li><span class="math inline">\(m\)</span> = the non-Newtonian mixing exponent<br />
</li>
<li><span class="math inline">\(\rho\)</span> = density of fluid (kg/m<sup>3</sup>)<br />
</li>
<li><span class="math inline">\(\mu\)</span> = dynamic viscosity (Pa.s)<br />
</li>
<li><span class="math inline">\(K\)</span> = the Hershel-Bulkley viscosity parameter (Pa s<em><sup>n</sup></em>)<br />
</li>
<li><span class="math inline">\(n\)</span> = the Hershel-Bulkley powerlaw exponent<br />
</li>
<li><span class="math inline">\(\tau_{0}\)</span> = the material yield stress (Pa)<br />
</li>
<li>subscripts <span class="math inline">\(w\)</span> denotes water, <span class="math inline">\(NN\)</span> denotes undiluted non-Newtonian
fluid<br />
</li>
<li>superscript <span class="math inline">\(‘\)</span> denotes blended value to use in the Hershel-Bulkley
powerlaw model</li>
</ul>
<p>The bed friction and 2D viscosity are computed using the non-Newtonian
method with the blended parameters. To turn on the mixing calculation,
the mixing exponent, <span class="math inline">\(m\)</span>, must be specified with the
<a href="TCFCommands-1.html#tcfNon-NewtonianMixingExponent">Non-Newtonian Mixing Exponent</a> command. It is
user’s responsibility to source the non-Newtonian parameters that
represent the undiluted mud, and also to source an appropriate value for
the non-Newtonian mixing exponent, <span class="math inline">\(m\)</span>. This value must be within the
range 1 to 5.</p>
<p>To utilise non-Newtonian mixing in a model, the following is required:</p>
<ol style="list-style-type: decimal">
<li>Select the non-Newtonian viscosity formulation and specify the coefficients for pure non-Newtonian fluid:<br />
<tcmd><a href="TCFCommands-1.html#tcfViscosityFormulation">Viscosity Formulation</a></tcmd> <teq>==</teq> <tblk>Non-Newtonian</tblk><br />
<tcmd><a href="TCFCommands-1.html#tcfViscosityCoefficient">Viscosity Coefficient</a></tcmd> <teq>==</teq> <tblk>k, n, muLow, muHigh, tau0</tblk><br />
</li>
<li>Include a passive tracer as per standard AD setup (Chapter <a href="AD-1.html#AD-1">9</a>), making sure boundary data and initialisation are scaled in range 0 to 1.<br />
</li>
<li>Specify the mixing exponents, <em>m</em>, <em>o</em>, and <em>p</em> to be used:<br />
<tcmd><a href="TCFCommands-1.html#tcfNon-NewtonianMixingExponent">Non-Newtonian Mixing Exponent</a></tcmd> <teq>==</teq> <tblk>&lt;float&gt; | {0} </tblk><tgrn>! used for all three of <em>m</em>, <em>o</em>, <em>p</em> exponents </tgrn> <br>
or <br>
<tcmd><a href="TCFCommands-1.html#tcfNon-NewtonianMixingExponent">Non-Newtonian Mixing Exponent</a></tcmd> <teq>==</teq> <tblk>&lt;float&gt;, &lt;float&gt;, &lt;float&gt; | {0, 0, 0} </tblk><tgrn>! <em>m</em>, <em>o</em>, <em>p</em> exponents</tgrn></li>
</ol>
<p>Note that if the non-Newtonian mixing exponent is not specified it defaults to zero which turns the mixing formulation off, and all fluid in the model will be treated as non-Newtonian regardless of tracer value.</p>
<p>An example non-Newtonian mixing model is provided in the non-Newtonian section of the <a href="https://wiki.tuflow.com/TUFLOW_Example_Models#Solver_Options">TUFLOW Wiki Example Models</a>.</p>
</div>
</div>
<div id="HPC-Unsupported-3" class="section level3 hasAnchor" number="7.4.7">
<h3><span class="header-section-number">7.4.7</span> Unsupported Features in TUFLOW HPC<a href="TwoD-Domains-1.html#HPC-Unsupported-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following features are not supported in TUFLOW HPC:</p>
<ul>
<li>Multiple 2D Domain (Section <a href="TwoD-Domains-1.html#CLA-2D2D-3">7.5.4</a>): This feature has been superseded by the TUFLOW HPC Quadtree functionality (Section <a href="TwoD-Domains-1.html#Quadtree-3">7.4.1</a>).</li>
<li>2D Flow Constrictions (2d_fcsh and 2d_fc) (Section <a href="TwoD-Domains-1.html#CLA-FC-4">7.5.6.1</a>): This feature has been superseded by the 2d Bridge (2d_bg) (Section <a href="TwoD-Domains-1.html#bg-layer-4">7.3.8.2</a>) and Layered Flow Constriction (2d_lfcsh) (Section <a href="TwoD-Domains-1.html#lfcsh-4">7.3.8.3</a>) features.</li>
<li>Coriolis Force (Section <a href="TwoD-Domains-1.html#CLA-Coriolis-3">7.5.5</a>): The inclusion of the Coriolis term in the shallow water equations is possible with TUFLOW Classic only.</li>
<li>Chézy and Fric options: TUFLOW HPC only supports Manning’s n bed resistance values (Section <a href="TwoD-Domains-1.html#CLA-mat-3">7.5.3</a>).</li>
</ul>
</div>
</div>
<div id="tuflow-classic-specific" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> TUFLOW Classic Specific<a href="TwoD-Domains-1.html#tuflow-classic-specific" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section describes functionality unique to TUFLOW Classic.</p>
<div id="CLA-Turbulence-3" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Classic Turbulence<a href="TwoD-Domains-1.html#CLA-Turbulence-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For TUFLOW Classic, two options exist (Constant and Smagorinsky) for specifying eddy viscosity for the 2D domains to approximate the effect of sub-grid-scale turbulence. For TUFLOW Classic, the Smagorinsky approach (Section <a href="TwoD-Domains-1.html#CLA-Smagorinsky-4">7.5.1.2</a>) is the default approach.</p>
<div id="CLA-Constant-4" class="section level4 hasAnchor" number="7.5.1.1">
<h4><span class="header-section-number">7.5.1.1</span> Constant<a href="TwoD-Domains-1.html#CLA-Constant-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Constant approach (<tcmd><a href="TCFCommands-1.html#tcfViscosityFormulation">Viscosity Formulation</a> </tcmd><teq>==</teq><tblk> CONSTANT</tblk>)
applies a constant value throughout the model, irrespective of velocity
gradients and variations. This is generally satisfactory when the bed
resistance is dominant or when modelling large ocean basins (in which
case the recommended coefficient for the constant formulation is 1
m<sup>2</sup>/s), but is not recommended for riverine flow paths.</p>
</div>
<div id="CLA-Smagorinsky-4" class="section level4 hasAnchor" number="7.5.1.2">
<h4><span class="header-section-number">7.5.1.2</span> Smagorinsky<a href="TwoD-Domains-1.html#CLA-Smagorinsky-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>TUFLOW’s Smagorinsky approach (<tcmd><a href="TCFCommands-1.html#tcfViscosityFormulation">Viscosity
Formulation</a> </tcmd><teq>==</teq><tblk> SMAGORINSKY</tblk>) applies a hybrid method that includes elements of both the Constant and Smagorinsky approaches, as given by the equation below. This formulation is better than the CONSTANT option, as the eddy viscosity is
recalculated every timestep at every cell mid-side according to the
change in velocity magnitude and direction. This results in higher
coefficients being applied where there is greater turbulence.</p>
<p>However, this approach has two known limitations:</p>
<ol style="list-style-type: decimal">
<li>It assumes that all turbulent kinetic energy with length scales greater than the
cell size is resolved within the velocity field. This assumption is
reasonable when the 2D cell size is larger then physical depth of the
flow, but becomes incorrect when the 2D cell size becomes smaller than
the depth of the flow – turbulence in the vertical direction contributes
significantly to viscosity but is not resolved in the 2D velocity field.
As a result, once the 2D cell size becomes smaller than the flow depth
this approach can underpredict the viscosity, and therefore can underpredict
momentum coupling from river to flood plain.<br />
</li>
<li>It assumes that the physical length scales of the sub-grid turbulence scale with
the 2D cell size. This is reasonable when the 2D cell size is similar to
the depth of the flow, but becomes incorrect when the 2D cell size
becomes significantly larger than the depth of the flow – the bed
resistance and the finite depth of the flow prevent large scale
turbulence. As a result, once the 2D cell size becomes much larger than
the depth of the flow, the Smagorinsky turbulence model can overpredict the
viscosity, and therefore can overpredict the momentum coupling from river
to flood plain.</li>
</ol>
<p>The result of these two limitations, is that model results display some
sensitivity to the 2D cell size. The Wu formulation (Section <a href="TwoD-Domains-1.html#Wu-4">7.4.2.4</a>)
has proven to be more capable in its ability to provide “out of the box”
calibration and reduced sensitivity of model results to 2D cell size.</p>
<p>Note, if the formulation is changed, the user must also reset the
coefficient using the command
<a href="TCFCommands-1.html#tcfViscosityCoefficient">Viscosity Coefficient</a>. <!--EFC to PAR: Just did a quick test and it looks like TUFLOW automatically updates the coefficients when changing formulation. Can this sentence be deleted. It's a bit confusing--></p>
<p>The Smagorinsky option remains the default when using TUFLOW
Classic. The default viscosity coefficients are a Smagorinsky value of
0.5 plus a constant value of 0.05 m<sup>2</sup>/s. The 0.5 Smagorinsky
coefficient is dimensionless. The viscosity coefficient can be output
using the <a href="TCFCommands-1.html#tcfMapOutputDataTypes">Map Output Data Types</a> command.</p>
<p>The hybrid Smagorinsky formulation used by TUFLOW is:</p>
<p><span class="math display" id="eq:equ-smag">\[\begin{equation}
𝜐 = C_{c} + C_{s}A_{c}\sqrt{\left( \frac{\partial u}{\partial x} \right)^{2} + \left( \frac{\partial v}{\partial y} \right)^{2} + {\frac{1}{2}\left( \frac{|\partial u|}{\partial y} + \frac{|\partial v|}{\partial x} \right)}^{2}}
\tag{7.9}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(u\ and\ v = \ \)</span>Depth averaged velocity components in the X and Y
directions<br />
</li>
<li><span class="math inline">\(x\ and\ y = \ \)</span>Distance in the X and Y direction<br />
</li>
<li><span class="math inline">\(\nu = \ \)</span>Horizontal diffusion of momentum (viscosity) coefficient,
m<sup>2</sup>/s or ft<sup>2</sup>/s<br />
</li>
<li><span class="math inline">\(A_{c} = \ \)</span>Area of Cell<br />
</li>
<li><span class="math inline">\(C_{\ c} = \ \)</span>Constant Coefficient (default = 0.05 m<sup>2</sup>/s)<br />
</li>
<li><span class="math inline">\(C_{s} = \ \)</span>Smagorinsky Coefficient (dimensionless, default = 0.5)</li>
</ul>
</div>
</div>
<div id="CLA-US-Controlled-3" class="section level3 hasAnchor" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> 2D Upstream Controlled Flow (Weirs and Supercritical Flow)<a href="TwoD-Domains-1.html#CLA-US-Controlled-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Where flow in the 2D domain becomes upstream controlled, TUFLOW Classic automatically switches between either weir flow or upstream controlled friction flow.</p>
<p>If <a href="TCFCommands-1.html#tcfSupercritical">Supercritical</a> is set to ON (the default), the following rules apply.</p>
<ul>
<li>Where the bed slope at a ZU or ZV point is in the same direction as
the water surface slope, tests are carried out to determine whether
the flow is upstream controlled or downstream controlled. The adopted
flow regime is determined by comparing the upstream and downstream
controlled regime flows (preference to the lower flow) and whether the
Froude number exceeds 1 (unless changed by <a href="TCFCommands-1.html#tcfFroudeCheck">Froude
Check</a>). The equation used for upstream controlled
flow is the Manning equation, with the water surface slope set to the
bed slope. This check can be disabled for backward compatibility using
<a href="TCFCommands-1.html#tcfFroudeDepthAdjustment">Froude Depth Adjustment</a>.<br />
</li>
<li>Weir flow only occurs if the bed slope is adverse (different
direction) to the water surface slope. Weir flow across 2D cell sides
is modelled by first testing whether the flow is upstream or
downstream controlled. If upstream controlled, the broad-crested weir
flow equation is used to replace the calculations for downstream
controlled (sub-critical) flow conditions. Weir flow can be switched
off using the <a href="TCFCommands-1.html#tcfFreeOverfall">Free Overfall</a> options.</li>
</ul>
<p>Note: the bed slope at ZU and ZV points is determined as the slope from the upstream ZC point to the ZU or ZV point in the direction of positive flow.</p>
<p>TUFLOW produces an increase in water level at transitions from
supercritical flow to subcritical flow, as occurs with a hydraulic jump.
It does not, however, model the complex 3D flow patterns that occur at a
hydraulic jump, as it uses a 2D horizontal plane solution. Results in
areas of transition should be interpreted with caution. It is also
important to be careful presenting results in areas of supercritical
flow, as complex localised flow interactions may occur that would yield higher localised water levels (such as supercritical flow surcharging against a building) – it is good practice to also view the energy levels when providing advice on flood planning levels.</p>
<p>If <a href="TCFCommands-1.html#tcfSupercritical">Supercritical</a> is set to OFF, and <a href="TCFCommands-1.html#tcfFreeOverfall">Free
Overfall</a> is set to ON (the default), weir flow may
occur on both adverse and normal bed slopes.</p>
<p>The weir flow switch may be adjusted globally using the .tcf command
<a href="TCFCommands-1.html#tcfGlobalWeirFactor">Global Weir Factor</a>. It can also be varied
spatially over the grid by setting a weir factor of zero where there is
to be no automatic weir calculations using <a href="TGCCommands-1.html#tgcReadGIS">Read GIS WrF</a>.
The weir factor also allows calibration or adjustment where the
broad-crested weir equation is applied. The weir factor is not the
broad-crested weir coefficient. The broad-crested weir equation is
divided by the weir factor. Therefore, a factor of 1.0 represents no
adjustment, while a factor greater than one will decrease the flow
efficiency. Refer to <span class="citation">Syme (<a href="#ref-Syme2001b">2001b</a>)</span> for further information.</p>
<p><strong>Note, the global weir factor and the spatially varying value are
multiplied together (i.e. one does not replace the other).</strong></p>
<p>The .tcf command <a href="TCFCommands-1.html#tcfHXForceWeirEquation">HX Force Weir Equation</a> can
be used to force the weir flow equation to be applied across all active
HX cell sides when the flow is upstream controlled. Note, the
default approach uses either weir flow or super-critical flow when the
flow is upstream controlled, depending on whether the ground surface
gradient from HX cell centre to cell side is adverse (weir flow) or not
adverse (super-critical flow). When the flow is downstream controlled,
regardless of the ground surface slope, the full 2D equations are
applied, including allowance for momentum across the HX 1D/2D link.</p>
</div>
<div id="CLA-mat-3" class="section level3 hasAnchor" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> Land Use (Materials)<a href="TwoD-Domains-1.html#CLA-mat-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For TUFLOW Classic, bed resistance can be set to Manning’s n, Manning’s M (1/n) or Chezy using the <a href="TCFCommands-1.html#tcfBedResistanceValues">Bed Resistance Values</a> command in the .tcf file. Chezy can be specified as a direct value or by bed ripple heights (using the <a href="TGCCommands-1.html#tgcSetFRIC">Set FRIC</a>, <a href="TGCCommands-1.html#tgcReadGISFRIC">Read GIS FRIC</a>, <a href="#tgcReadGridFRIC">Read Grid FRIC</a> commands). The default and recommended bed resistance formulation is Manning’s n. Manning’s n values can also be varied with depth, the VxD product or varied with depth using the Log Law formula (see Section <a href="TwoD-Domains-1.html#Materials-2">7.3.6</a>).</p>
<p>If using the Chezy formula, a number of commands have been setup to provide backward compatibility. These are <a href="TCFCommands-1.html#tcfDepthRippleHeightFactorLimit">Depth/Ripple Height Factor Limit</a> and <a href="TCFCommands-1.html#tcfRecalculateChezyInterval">Recalculate Chezy Interval</a>.</p>
<!--EFC to PAR: I've pulled the above out of the common section. What additional should be added? Is the 'Fric' option Manning's M?

The Fric option is related to the Chezy option (if set to chezy then can specify the fric commands)-->
</div>
<div id="CLA-2D2D-3" class="section level3 hasAnchor" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> Multiple 2D Domain<a href="TwoD-Domains-1.html#CLA-2D2D-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- PAR to EFC the m2d link QDTorM2DModule-4 didn't work for me, does it work for you?-->
<!--fixed-->
<p>When using TUFLOW Classic with the Multiple 2D Domain Module (see Section <a href="Introduction-1.html#QDTorM2DModule-4">1.1.5.4</a>), any number of 2D domains of different cell size and orientation can be combined to form one model. This TUFLOW Classic feature is discussed in Section <a href="DomainLinking-1.html#TwoD2DLinkingM2D-3">10.7.2</a>.</p>
</div>
<div id="CLA-Coriolis-3" class="section level3 hasAnchor" number="7.5.5">
<h3><span class="header-section-number">7.5.5</span> Coriolis Term<a href="TwoD-Domains-1.html#CLA-Coriolis-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When using TUFLOW Classic, it is possible to include the Coriolis term in the shallow water equations (equations <a href="TwoD-Domains-1.html#eq:equ-x-momentum">(7.2)</a> and <a href="TwoD-Domains-1.html#eq:equ-y-momentum">(7.3)</a>). To enable this functionality, use the <a href="TCFCommands-1.html#tcfLatitude">Latitude</a> command.</p>
</div>
<div id="legacy-structures" class="section level3 hasAnchor" number="7.5.6">
<h3><span class="header-section-number">7.5.6</span> Legacy Structures<a href="TwoD-Domains-1.html#legacy-structures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following features are considered legacy structures and are supported by TUFLOW Classic only. It is recommended, and preferred, to use the layered flow constriction shape (Section <a href="TwoD-Domains-1.html#lfcsh-4">7.3.8.3</a>) instead, which is supported by both TUFLOW Classic and TUFLOW HPC. To convert from the flow constriction (2d_fc or 2d_fcsh) to the layered flow constriction (2d_lfcsh), refer to the discussion published in the <a href="https://wiki.tuflow.com/TUFLOW_2D_Hydraulic_Structures#How_to_best_convert_flow_constriction_data_.282d_fc_or_2d_fcsh.29_into_newer_formats_.282d_lfcsh_or_2d_bg.29.3F">TUFLOW Wiki</a>.</p>
<div id="CLA-FC-4" class="section level4 hasAnchor" number="7.5.6.1">
<h4><span class="header-section-number">7.5.6.1</span> 2D Flow Constrictions (2d_fcsh and 2d_fc)<a href="TwoD-Domains-1.html#CLA-FC-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Flow Constriction (FC) attributes allow the user to constrict the flow
across a 2D cell side as a way to define hydraulic structures, such as bridges and banks of box culverts, within a model. 2D cell sides
can be modified in the following ways:</p>
<ul>
<li>Placing a lid (obvert or soffit) on the cell side.<br />
</li>
<li>Changing the flow width of the cell side.<br />
</li>
<li>Adding additional form (energy) losses.<br />
</li>
<li>Including side wall friction (“BC” FC_Type only).</li>
</ul>
<p>Flow constrictions can be digitised within GIS layers and read into the
.tgc file using the command <a href="TGCCommands-1.html#tgcReadGISFCShape">Read GIS FC Shape</a>. This
command is recommended over the previous (and now outdated) <a href="TCFCommands-1.html#tcfReadGISFC">Read GIS
FC</a>.</p>
<p>Table <a href="TwoD-Domains-1.html#tab:tab-ConstrictionShape">7.22</a> describes the different 2d_fcsh layer attributes as used by
<a href="TGCCommands-1.html#tgcReadGISFCShape">Read GIS FC Shape</a>. If <a href="TCFCommands-1.html#tcfWriteCheckFiles">Write Check
Files</a> is set in the .tcf then the
<a href="http://wiki.tuflow.com/Check_Files_2d_fcsh_uvpt">_fcsh_uvpt_check</a>
file will be created to allow you to cross-check that the changes to the
cell-sides are as intended. The
<a href="http://wiki.tuflow.com/Check_Files_2d_fcsh_uvpt">_fcsh_uvpt_check</a>
file contains information on the cell sides modified by the <a href="TGCCommands-1.html#tgcReadGISFCShape">Read GIS FC
Shape</a> command. Details on the properties at ALL cell
sides can be found in the
<a href="http://wiki.tuflow.com/Check_Files_2d_uvpt">_uvpt_check</a>
file.</p>
<p>Point objects associated with the 2d_fcsh layer can be placed in a
separate layer. In this case, only the first two attributes are
required. This is discussed in Section <a href="TwoD-Domains-1.html#point-only-5">7.3.5.7.1</a>.</p>
<p>The original <a href="TCFCommands-1.html#tcfReadGISFC">Read GIS FC</a> feature continues to be supported and its attributes are documented in Table <a href="TwoD-Domains-1.html#tab:tab-FlowConstriction">7.23</a>. Floating pontoons should always be modelled using 2d_fc layers. If any 2d_fc inputs are included in the model and <a href="TCFCommands-1.html#tcfWriteCheckFiles">Write Check Files</a> is set, then the <a href="http://wiki.tuflow.com/Check_Files_2d_fc">_fc_check</a> file will be created.</p>
<p>Please note, overlapping flow constriction inputs are not supported.</p>
<table>
<caption>
<span id="tab:tab-ConstrictionShape">Table 7.22: </span><strong>Flow Constriction Shape (2d_fcsh) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Invert
</td>
<td style="text-align:left;">
<p>Invert of constriction. Using metric units (default) the value is metres above the elevation datum . Using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd> <teq>==</teq><tblk> US Customary</tblk>, the value is feet above the elevation datum.</p>
To leave the Zpt levels unchanged (i.e. use the existing Zpt elevations), enter a value of 99999.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Obvert_or_BC_Height
</td>
<td style="text-align:left;">
<p>FC_Type:</p>
<ul>
<li>Blank or “BD”: Obvert (soffit) of constriction in m above datum.<br />
</li>
<li>“BC”: Height of box culvert (m).<br />
</li>
<li>“FD”: Floating depth (m) of the deck (i.e. depth below the water line).</li>
</ul>
Enter a sufficiently high value (e.g. 99999) if there is no obvert constriction.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Shape_Width_or_dMax
</td>
<td style="text-align:left;">
<p><b>Point:</b> Not used.</p>
<p><b>Line:</b> See same attribute in Table <a href="TwoD-Domains-1.html#tab:tab-ZShapeAttribute">7.5</a> for 2d_zsh layers.</p>
<b>Polygon:</b> Not used.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Shape_Options
</td>
<td style="text-align:left;">
<p><b>Point:</b> Not used.</p>
<p><b>Line or Polygon:</b></p>
<ul>
<li>MAX, RIDGE or RAISE: Only changes a Zpt (Invert) elevation if the Z Shape elevation at the Zpt is higher.<br />
</li>
<li>MIN, GULLY or LOWER: Only changes a Zpt (Invert) elevation if the Z Shape elevation at the Zpt is lower.</li>
</ul>
<p><b>Line:</b></p>
<ul>
<li>TIN: Indicates the line is to only be used for generation of TINs within polygons (only sections of TIN lines that fall within polygons are used).
</td>
<td style="text-align:left;">
Char(20)
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
FC_Type
</td>
<td style="text-align:left;">
The FC_Type.</li>
</ul>
<p>Where:</p>
<ul>
<li>Blank for general (does not include allowances for any vertical walls or friction from underside of deck).<br />
</li>
<li>“BC” for Box Culverts (BC is only available if Manning’s n option is specified in Bed Resistance Values).<br />
</li>
<li>“BD” for Bridge Deck.<br />
</li>
<li>“FD” for Floating Bridge Deck.
</td>
<td style="text-align:left;">
Char(2)
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
pBlockage
</td>
<td style="text-align:left;">
The percentage blockage of the cells. For example, if 40 is entered (i.e. 40%), the cell sides are reduced in flow width by 40% (i.e. is set to 0.6 times the full flow width).
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
FLC_or_FLCpm_below_Obv
</td>
<td style="text-align:left;">
Form Loss Coefficient (FLC) to be applied below the FC obvert. Used for modelling fine-scale “micro” contraction/expansion losses not picked up by the change in the 2D domain’s velocity patterns (e.g. bridge pier losses, vena-contracta losses, 3rd (vertical) dimension etc.).</li>
</ul>
<p>This parameter should be used as a calibration parameter.</p>
<p><b>Note: So that this attribute is independent of 2D cell size it has different treatment depending on the object it is attached to as follows:</b></p>
<ul>
<li><b>Line:</b> For thin lines, the FLC value is applied to the cell sides unchanged. For thick (whole cell) lines, the FLC value is divided by two (two cell sides in the direction of flow). For wide lines the FLC value is divided by the number of cells across the line (i.e. the line’s width divided by the cell size) and applied to all cell-sides.<br />
</li>
<li><b>Polygon:</b> FLC is the form loss per metre length (in the predominant direction of flow). FLC values are not dependent on the flow width, but are on the length of travel in the direction of flow.</li>
</ul>
<p><b>However, if a negative FLC value is specified, the absolute value is taken and applied unadjusted to all cell-sides affected by the shape. Note, this is not cell size independent, therefore if the 2D cell size is changed, this attribute also needs to be changed.</b></p>
<p>The form loss coefficient is applied as an energy loss based on the dynamic head equation below where <span class="math inline">\(\displaystyle \zeta_{a}\)</span> is the FLC value.</p>
<span class="math display">\[\Delta h = \zeta_{a}\:\frac{V^2}{2g}\]</span>
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
FLC_or_FLCpm_above_Obv
</td>
<td style="text-align:left;">
Form Loss Coefficient (FLC) to be applied above the FC obvert. See FLC_below_Obvert attribute above for more information.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
Mannings_n
</td>
<td style="text-align:left;">
<p>For box culverts (BC), the Manning’s n of the culverts (typically 0.011 to 0.015) should be specified. This value prevails over any other bed resistance values irrespective of where in the .tgc file they occur (the exception is if another FC BC object overrides this one). If set to less than 0.001, a default value of 0.013 is used.</p>
<p>For bridge decks (BD), can be used to introduce additional flow resistance once the upstream water level reaches the bridge deck obvert (or soffit).</p>
<p>For floating decks (FD) this is always the case as the deck soffit is permanently submerged. The additional flow resistance is modelled as an increase in bed resistance by increasing the wetted perimeter at the cell mid-side by a factor equal to (2.*Bed_n)/FC_n. For example, if the FC Manning’s n and the bed Manning’s n values are the same, the wetted perimeter is doubled, thereby reducing the conveyance and increasing the resistance to flow. This parameter can be used as a calibration parameter to fine-tune the energy losses across a bridge or floating structure.</p>
Ignored for blank FC_Type.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
BC_Width
</td>
<td style="text-align:left;">
<p>The width of one BC culvert barrel in metres. For example, if there are 10 x 1.8metre wide culverts in a bank, enter a value of 1.8. Using metric units (default) the value is in metres. Using <tcmd><a href="TCFCommands-1.html#tcfUnits">Units</a></tcmd> <teq>==</teq><tblk> US Customary</tblk>, the value is in feet.</p>
Applicable to BC FC_Type only. Not used by other types of FCs.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:tab-FlowConstriction">Table 7.23: </span><strong>Flow Constriction (2d_fc) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Type
</td>
<td style="text-align:left;">
<p>Secondary flag identifier where:</p>
<ul>
<li>Blank for general (does not include allowances for any vertical walls or friction from underside of deck).<br />
</li>
<li>“BC” for Box Culverts (BC is only available if Manning’s n option is specified in Bed Resistance Values).<br />
</li>
<li>“BD” for Bridge Deck.<br />
</li>
<li>“FD” for Floating Bridge Deck.
</td>
<td style="text-align:left;">
Char(2)
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Invert
</td>
<td style="text-align:left;">
Invert of constriction (m above datum).</li>
</ul>
<p>Mandatory for box culverts (type = “BC”).</p>
If not a box culvert, and you wish to leave the Zpt levels unchanged (i.e. use the existing Zpt elevations), enter a value greater than the obvert level (see next attribute).
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Obvert_or_BC_height
</td>
<td style="text-align:left;">
<p>Type:</p>
<ul>
<li>Blank or “BD”: Obvert of constriction (m above datum)<br />
</li>
<li>“BC”: Height of box culvert (m). Values less than 0.01 are set to 0.01.<br />
</li>
<li>“FD”: Floating depth (m) of the deck (i.e. depth below the water line).</li>
</ul>
<p>Enter a sufficiently high value (e.g. 99999) if there is no obvert constriction.</p>
If using <a href="TCFCommands-1.html#tcfUnits">Units</a> <teq>==</teq><tblk> US Customary</tblk>, the height unit is in feet.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
u_width_factor
</td>
<td style="text-align:left;">
Flow width constriction factor in the X-direction (i.e. the flow width perpendicular to the X-direction). For example, a value of 0.6 sets the flow width at the left hand and right-hand sides of the cell to 60% of the cell width. Values less than 0.001 are set to 1. Use a value of 1.0 to leave the flow width unchanged. Values greater than 1 can be specified.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
v_width_factor
</td>
<td style="text-align:left;">
Width constriction factor in the Y-direction. See description above for u_width_factor.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
Add_form_loss
</td>
<td style="text-align:left;">
<p>Form loss coefficient. Used for modelling fine-scale “micro” contraction/expansion losses not picked up by the change in the 2D domain’s velocity patterns (e.g. bridge pier losses, vena-contracta losses, 3<sup>rd</sup> (vertical) dimension etc.).</p>
<p>Can be used as a calibration parameter.</p>
<p>The form loss coefficient is applied as an energy loss based on the dynamic head equation below where <span class="math inline">\(\displaystyle \zeta_{a}\)</span> is the add_form_loss value. The form loss coefficient is applied 50/50 to the right and left sides (u-points) of the cell, and similarly to the v-points.</p>
<span class="math display">\[\Delta h = \zeta_{a}\:\frac{V^2}{2g}\]</span>
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
Mannings_n
</td>
<td style="text-align:left;">
<p>For box culverts (BC), the Manning’s n of the culverts (typically 0.011 to 0.015) should be specified. This overwrites any previously specified Manning’s n values at the cell’s mid-sides. If set to less than 0.001, a default value of 0.013 is used.</p>
<p>For bridge decks (BD), can be used to introduce additional flow resistance once the upstream water level reaches the bridge deck obvert or soffit. For floating decks (FD) this is always the case as the deck soffit is permanently submerged. The additional flow resistance is modelled as an increase in bed resistance by increasing the wetted perimeter at the cell’s mid-sides by a factor equal to (2.*Bed_n)/FC_n. For example, if the FC Manning’s n and the bed Manning’s n values are the same, the wetted perimeter is doubled, thereby reducing the conveyance and increasing the resistance to flow. To be used as a calibration parameter to fine-tune the energy losses across a bridge or floating structure.</p>
Ignored for “Blank” type FC.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
No_walls_or_neg_width
</td>
<td style="text-align:left;">
<p>Number of vertical walls per grid cell. If set to zero (between 0.001 and 0.001) one vertical wall per cell is used. A non-integer value can be specified.</p>
<p>Alternatively, and more easily, specify the width of one culvert in metres by using a negative value. For example, if the culverts are 1.8m wide, enter a value of 1.8 and the number of vertical walls per cell is automatically calculated.</p>
Applicable to Box Culverts only. Not used by other types of FCs.
</td>
<td style="text-align:left;">
Float
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
Blocked_sides
</td>
<td style="text-align:left;">
<p>Indicates whether any of the walls of the constricted cell(s) are blocked off (i.e. no flow across/through the side wall). Specify one or more of the following letters in any order with in the field to indicated which wall(s) are blocked:</p>
<ul>
<li>“R” – block right hand side wall</li>
<li>“L” – block left hand side wall</li>
<li>“T” – block top side wall</li>
<li>“B” – block bottom side wall</li>
</ul>
Note: the quotes should be omitted.
</td>
<td style="text-align:left;">
Char(10)
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
Invert_2
</td>
<td style="text-align:left;">
leave blank (not used as yet)
</td>
<td style="text-align:left;">
Char(10)
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
Obvert_2
</td>
<td style="text-align:left;">
leave blank (not used as yet)
</td>
<td style="text-align:left;">
Char(10)
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
Comment
</td>
<td style="text-align:left;">
Optional field for entering comments. Not used.
</td>
<td style="text-align:left;">
Char(250)
</td>
</tr>
</tbody>
</table>
</div>
<div id="applying-form-energy-loss-in-2d-fc-and-fcsh-layers" class="section level4 hasAnchor" number="7.5.6.2">
<h4><span class="header-section-number">7.5.6.2</span> Applying Form (Energy) Loss in 2D FC and FCSH Layers<a href="TwoD-Domains-1.html#applying-form-energy-loss-in-2d-fc-and-fcsh-layers" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The following should be noted when adapting structure loss coefficients
from a 1D model or from coefficients that apply across the entire
waterway, for example, from “Hydraulics of Bridge Waterways” <span class="citation">(<a href="#ref-Bradley1978">Bradley, 1978</a>)</span> or “Guide to Bridge Technology Part 8, Hydraulic Design of
Waterway Structures” <span class="citation">(<a href="#ref-Austroads2018">Austroads, 2018</a>)</span>:</p>
<ul>
<li>The TUFLOW 2D solution automatically predicts the majority of “macro”
losses due to the expansion and contraction of water through a
constriction, or around a bend, provided the resolution of the grid is
sufficiently fine <span class="citation">(<a href="#ref-Barton2001">Barton, 2001</a>; <a href="#ref-Syme2001b">Syme, 2001b</a>)</span>.<br />
</li>
<li>Where the 2D model is not of fine enough resolution to simulate the
“micro” losses (e.g. from bridge piers, vena contracta, losses in the
vertical (3<sup>rd</sup>) dimension), additional form loss
coefficients and/or modifications to the cells widths and flow height
need to be added. This can be done by using flow constrictions (FC
cells). Additional form loss can also be added using <a href="TGCCommands-1.html#tgcReadGIS">Read GIS
FLC</a> or the command <a href="TGCCommands-1.html#tgcReadGridFLC">Read Grid FLC</a>.<br />
</li>
<li>The additional or “micro” losses, which may be derived from
information in publications, such as Hydraulics of Bridge Waterways,
need to be either:
<ul>
<li>Distributed evenly over the FC cells across the waterway by dividing
the overall additional loss coefficient by the number of cells (in
the direction of flow); or<br />
</li>
<li>Assigned unevenly (e.g. more at the cells with the bridge piers),
however, the total of the loss coefficients should be equivalent to
the required overall additional loss coefficient.<br />
</li>
</ul></li>
<li>The head loss across key structures should be reviewed, and if
necessary, benchmarked against other methods. Note that a well-designed 2D model
will be more accurate than a 1D model, provided that any “micro”
losses are incorporated.<br />
</li>
<li>Ultimately the best approach is to calibrate the structure through
adjustment of the additional “micro” losses – but this, of course,
requires good calibration data!</li>
</ul>
<p>An example of how to apply 2D FCs and a 2D FCSH to a bridge structure is
shown in Figure <a href="TwoD-Domains-1.html#fig:fig-image118">7.32</a> and Figure <a href="TwoD-Domains-1.html#fig:fig-image119">7.33</a>. <strong>The loss coefficient quoted in the figure is an example. Every structure is invariably different, and as such require structure specific parameters!</strong></p>
<p>When applying FCs, the best approach is to view the structure as a
collection of 2D cells representing the whole structure, rather than
being too specific about the representation of each individual cell. A
good approach is to use a 2d_po layer to extract time histories of the
water levels upstream and downstream of the structure and of the flow
and flow area upstream, downstream and through the structure (see
Section <a href="Outputs-1.html#TwoDTS-3">11.3.2</a>).</p>
<p>Of particular importance is to check that the correct flow area through
the structure is being modelled. Digitise a 2d_po QA line through the
structure from bank to bank and use this output to cross-check the flow
area of the 2D FC cells is appropriate (the QA line will take into
account any adjustments to the 2D cells due to FC obverts and changes to
the cell side flow widths). If the overall structure flow area is not
correct, then the velocities within the structure will not be correct
and therefore the energy losses due to the changes in velocity direction
and magnitude and additional form losses will not be well modelled.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image118"></span>
<img src="images/image118.png" alt="Setting FC Parameters for a Bridge Structure"  />
<p class="caption">
Figure 7.32: Setting FC Parameters for a Bridge Structure
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-image119"></span>
<img src="images/image119.png" alt="Setting FCSH Parameters for a Bridge Structure" width="80%" />
<p class="caption">
Figure 7.33: Setting FCSH Parameters for a Bridge Structure
</p>
</div>
</div>
</div>
<div id="CLA-Unsupported-3" class="section level3 hasAnchor" number="7.5.7">
<h3><span class="header-section-number">7.5.7</span> Unsupported Features in TUFLOW Classic<a href="TwoD-Domains-1.html#CLA-Unsupported-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following features are not supported in TUFLOW Classic. TUFLOW HPC is required to access these features:</p>
<ul>
<li>Parallelisation / utilising GPU Hardware (Section <a href="Introduction-1.html#GPUHardware-4">1.1.5.3</a>)</li>
<li>Wu turbulence approach (Section <a href="TwoD-Domains-1.html#Wu-4">7.4.2.4</a>)</li>
<li>Topography Sub-grid Sampling (Section <a href="TwoD-Domains-1.html#SGS-3">7.4.3</a>)</li>
<li>Quadtree grid refinement (Section <a href="TwoD-Domains-1.html#Quadtree-3">7.4.1</a>)</li>
<li>Groundwater with multiple sub-surface layers and horizontal hydraulic conductivity (Section <a href="TwoD-Domains-1.html#HPC-Groundwater-3">7.4.5</a>)</li>
<li>Non-Newtonian Flow (Section <a href="TwoD-Domains-1.html#NN-3">7.4.6</a>)</li>
</ul>
<p><img src="images/WQFooter.jpg" width="100%" /></p>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="1" line-spacing="2">
<div id="ref-Austroads2018" class="csl-entry">
Austroads. (2018). <em>Guide to Bridge Technology Part 8, Hydraulic Design of Waterway Structures</em>. <a href="https://austroads.com.au/">https://austroads.com.au/</a>
</div>
<div id="ref-Barton2001" class="csl-entry">
Barton, C. (2001). <em>Flow Through an Abrupt Constriction – 2D Hydrodynamic Model Performance and Influence of Spatial Resolution</em> (C. Barton, Ed.) [M.Eng.Sc Master Thesis]. <a href="https://tuflow.com/media/4983/2001-flow-through-an-abrupt-constriction-2d-hydrodynamic-performance-and-influence-of-spatial-resolution-barton-thesis.pdf">https://tuflow.com/media/4983/2001-flow-through-an-abrupt-constriction-2d-hydrodynamic-performance-and-influence-of-spatial-resolution-barton-thesis.pdf</a>
</div>
<div id="ref-Boyte2014" class="csl-entry">
Boyte, C. (2014). <em>The Application of Direct Rainfall Models as Hydrologic Models Incorporating Hydraulic Resistance at Shallow Depths</em> [B.Eng Thesis]. <a href="https://tuflow.com/media/5009/2014-the-application-of-direct-rainfall-models-as-hydrologic-models-incorporating-hydraulic-resistance-at-shallow-depths-boyte-thesis.pdf">https://tuflow.com/media/5009/2014-the-application-of-direct-rainfall-models-as-hydrologic-models-incorporating-hydraulic-resistance-at-shallow-depths-boyte-thesis.pdf</a>
</div>
<div id="ref-Bradley1978" class="csl-entry">
Bradley, J. (1978). <em>Hydraulics of Bridge Waterways</em> (HDS 1, FIWA). Bridge Division. <a href="https://www.fhwa.dot.gov/engineering/hydraulics/pubs/hds1.pdf">https://www.fhwa.dot.gov/engineering/hydraulics/pubs/hds1.pdf</a>
</div>
<div id="ref-BridgeDeckAfflux" class="csl-entry">
Collecutt, G., Baeumer, U., Gao, S., &amp; Syme, W. (2022). Bridge Deck Afflux Modelling – Benchmarking of CFD and SWE Codes to Real-World Data. <em>Hydrology &amp; Water Resources Symposium</em>. <a href="https://tuflow.com/media/7554/2022-bridge-deck-afflux-modelling-benchmarking-of-cfd-and-swe-codes-to-real-world-data-collecutt-et-al-hwrs.pdf">https://tuflow.com/media/7554/2022-bridge-deck-afflux-modelling-benchmarking-of-cfd-and-swe-codes-to-real-world-data-collecutt-et-al-hwrs.pdf</a>
</div>
<div id="ref-Collecutt2020" class="csl-entry">
Collecutt, G., Gao, S., &amp; Syme, W. (2020). Mesh-Size Insensitive Turbulence Modelling for the 2D Shallow Water Equations. <em>River Flow 2020</em>, pp. 1–9. <a href="https://tuflow.com/media/5023/2020-mesh-size-insensitive-turbulence-modelling-for-the-2d-shallow-water-equations-collecutt-et-al-iahr-river-flow-delft.pdf">https://tuflow.com/media/5023/2020-mesh-size-insensitive-turbulence-modelling-for-the-2d-shallow-water-equations-collecutt-et-al-iahr-river-flow-delft.pdf</a>
</div>
<div id="ref-CollecuttSyme2017" class="csl-entry">
Collecutt, G., &amp; Syme, B. (2017). Experimental Benchmarking of Mesh Size and Time-Step Convergence for a 1st and 2nd Order SWE Finite Volume Scheme. <em>Proceedings of the 37th IAHR World Congress</em>.<a href="
https://www.tuflow.com/Download/Publications/07-31-1369.pdf">
<div id="ref-Stelling1984" class="csl-entry">
Stelling, G. (1984). <em>On the Construction of Computational Methods for Shallow Water Flow Problems</em>. Rijkswaterstaat Communications.
</div>
<div id="ref-Syme2001b" class="csl-entry">
Syme, W. (2001b). TUFLOW – Two &amp; One-Dimensional Unsteady FLOW Software for Rivers, Estuaries and Coastal Waters. <em>The Institution of Engineers, Australia 2D Seminar</em>. <a href="https://tuflow.com/media/4985/2001-tuflow-two-and-one-dimensional-unsteady-flow-software-for-rivers-estuaries-and-coastal-waters-syme.pdf">https://tuflow.com/media/4985/2001-tuflow-two-and-one-dimensional-unsteady-flow-software-for-rivers-estuaries-and-coastal-waters-syme.pdf</a>
</div>
<div id="ref-Syme2008" class="csl-entry">
Syme, W. (2008). Flooding in Urban Areas - 2D Modelling Approaches for Buildings and Fences. <em>Engineers Australia, 9th National COnference on Hydraulics in Water Enginnering</em>. <a href="https://tuflow.com/media/4997/2008-flooding-in-urban-areas-2d-modelling-approaches-for-buildings-and-fences-syme-hwe-aus.pdf">https://tuflow.com/media/4997/2008-flooding-in-urban-areas-2d-modelling-approaches-for-buildings-and-fences-syme-hwe-aus.pdf</a>
</div>
<div id="ref-Wu2005" class="csl-entry">
Wu, W., Shields Jr., F. D., Bennett, S. J., &amp; Wang, S. S. Y. (2005). A Depth-Averaged Two-Dimensional Model for Flow, Sediment Transport, and Bed Topography in Curved Channels with Riparian Vegetation. <em>Water Resources Research</em>, <em>41</em>(3). https://doi.org/<a href="https://doi.org/10.1029/2004WR003730">https://doi.org/10.1029/2004WR003730</a>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>Figure courtesy of University of Texas <a href="https://www.caee.utexas.edu/prof/mckinney/ce374k/Overheads/10-Infiltration.pdf#page=20" class="uri">https://www.caee.utexas.edu/prof/mckinney/ce374k/Overheads/10-Infiltration.pdf#page=20</a><a href="TwoD-Domains-1.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="OneD-SWMM-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Boundaries-InitialConditions-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": false,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
