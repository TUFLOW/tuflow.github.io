<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 1 Introduction | TUFLOW SWMM User Guide</title>
  <meta name="description" content="Section 1 Introduction | TUFLOW SWMM User Guide" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 1 Introduction | TUFLOW SWMM User Guide" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/TUFLOW.jpg" />
  <meta property="og:description" content="Section 1 Introduction | TUFLOW SWMM User Guide" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 1 Introduction | TUFLOW SWMM User Guide" />
  
  <meta name="twitter:description" content="Section 1 Introduction | TUFLOW SWMM User Guide" />
  <meta name="twitter:image" content="/images/TUFLOW.jpg" />

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/TUFLOW.ico" type="image/x-icon" />
<link rel="prev" href="index.html"/>
<link rel="next" href="TUFLOWCommands-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
<link rel="stylesheet" href="css\toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://www.tuflow.com"><img src="images/tuflow_swmm.jpg" style="width:246px;height:68px;"></a></li>

<li class="divider"></li>
<li><a href="index.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="1" data-path="Introduction-1.html"><a href="Introduction-1.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="Introduction-1.html"><a href="Introduction-1.html#Capabilities-2"><i class="fa fa-check"></i><b>1.1</b> Capabilities</a></li>
<li class="chapter" data-level="1.2" data-path="Introduction-1.html"><a href="Introduction-1.html#ModelSetup-2"><i class="fa fa-check"></i><b>1.2</b> Model Setup</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="Introduction-1.html"><a href="Introduction-1.html#Simulations-3"><i class="fa fa-check"></i><b>1.2.1</b> Simulations</a></li>
<li class="chapter" data-level="1.2.2" data-path="Introduction-1.html"><a href="Introduction-1.html#SCF-3"><i class="fa fa-check"></i><b>1.2.2</b> SWMM Control File (*.scf)</a></li>
<li class="chapter" data-level="1.2.3" data-path="Introduction-1.html"><a href="Introduction-1.html#id_1D2DDomainLinking-3"><i class="fa fa-check"></i><b>1.2.3</b> 1D/2D Domain Linking</a></li>
<li class="chapter" data-level="1.2.4" data-path="Introduction-1.html"><a href="Introduction-1.html#ESTRYSWMMLinking-3"><i class="fa fa-check"></i><b>1.2.4</b> ESTRY/SWMM Linking</a></li>
<li class="chapter" data-level="1.2.5" data-path="Introduction-1.html"><a href="Introduction-1.html#SWMMSettings-3"><i class="fa fa-check"></i><b>1.2.5</b> SWMM Settings</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="Introduction-1.html"><a href="Introduction-1.html#SWMMGISTools-2"><i class="fa fa-check"></i><b>1.3</b> SWMM GIS Tools</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="Introduction-1.html"><a href="Introduction-1.html#GISTools-3"><i class="fa fa-check"></i><b>1.3.1</b> GIS Tools</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="Introduction-1.html"><a href="Introduction-1.html#SWMMOutputs-2"><i class="fa fa-check"></i><b>1.4</b> SWMM Outputs</a></li>
<li class="chapter" data-level="1.5" data-path="Introduction-1.html"><a href="Introduction-1.html#SWMMInclusionTUFLOW-2"><i class="fa fa-check"></i><b>1.5</b> SWMM Inclusion in TUFLOW</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="Introduction-1.html"><a href="Introduction-1.html#SWMMLibraryVersion-3"><i class="fa fa-check"></i><b>1.5.1</b> SWMM Library Version</a></li>
<li class="chapter" data-level="1.5.2" data-path="Introduction-1.html"><a href="Introduction-1.html#SWMMCode-in-TUFLOW-3"><i class="fa fa-check"></i><b>1.5.2</b> Embedded SWMM Code in TUFLOW</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="TUFLOWCommands-1.html"><a href="TUFLOWCommands-1.html"><i class="fa fa-check"></i><b>2</b> TUFLOW Commands</a>
<ul>
<li class="chapter" data-level="2.1" data-path="TUFLOWCommands-1.html"><a href="TUFLOWCommands-1.html#TCFCommands-2"><i class="fa fa-check"></i><b>2.1</b> TUFLOW Control File Commands (TCF)</a></li>
<li class="chapter" data-level="2.2" data-path="TUFLOWCommands-1.html"><a href="TUFLOWCommands-1.html#SCFCommands-2"><i class="fa fa-check"></i><b>2.2</b> SWMM Control File Commands (SCF)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://www.tuflow.com"><img src="images/WQFooter.jpg" style="width:246px;height:10px;"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><h0 style="color:rgb(0,85,129);">TUFLOW SWMM User Guide</h0></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Introduction-1" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Section 1</span> Introduction<a href="Introduction-1.html#Introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>TUFLOW has supported 1D/2D dynamic coupling since its initial 2D solver development in 1989. Traditionally, 1D (1 Dimensional) linking and associated modelling has been applied using the ESTRY 1D solver. New in 2023, TUFLOW’s 1D linking and solver options have been expanded to support EPA Storm Water Management Model (SWMM). As such, 1D pipe networks or 1D open channels can now be modeled using either the ESTRY, EPA SWMM, or a combination of the 1D solvers.</p>
<p>EPA SWMM is a widely used software program for simulating urban and non-urban watersheds’ hydrologic and hydraulic behavior. Developed in the early 1970s by the Environmental Protection Agency (EPA), the model has since undergone numerous updates and enhancements to become one of the most used 1D stormwater runoff and water quality analysis tools globally, particularly in North America.</p>
<p>The primary uses of EPA SWMM include designing and evaluating stormwater management practices, planning, and assessing low-impact development techniques, and developing models for floodplain mapping and emergency response planning. The software allows users to simulate a wide range of storm events and analyze the impact of a range of factors, such as land use changes, climate variability, and water quality control measures, on the performance of stormwater management systems.</p>
<p>This document provides background and instructions for using TUFLOW and SWMM together with limited documentation for each individually. Refer to the model documentation and tutorials to learn how to set up and use each separately. Information on getting started with TUFLOW can be found on the <a href="https://wiki.tuflow.com/New_User_Guide_Free_Demo_Version">TUFLOW Wiki</a>. Information about EPA SWMM can be found <a href="https://www.epa.gov/water-research/storm-water-management-model-swmm">here</a>.</p>
<div id="Capabilities-2" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Capabilities<a href="Introduction-1.html#Capabilities-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>TUFLOW (2D) and SWMM (1D) models can use TUFLOW using rain-on-grid or source flows over the domain with flows captured at inlets to convey discharges into the SWMM 1D network. Otherwise, SWMM 1D sub-catchments can be used to convey the flow to the urban drainage network allowing inlet-limited overflow (sub-catchment discharge not able to enter the
storm drain network) or flooding (leaving the drainage network) handled in 2D. When SWMM sub-catchments are used, they utilize the routing, infiltration, and LID (Low Impact Development) functionalities that correspond to them. SWMM 1D networks can also be connected to 2D domains for standalone culverts.</p>
<p>Currently TUFLOW does not connect the AD (advection-diffusion) module or the interflow capability to the SWMM network. If these or other functionalities would be useful to you, please let us know at <a href="mailto:support@tuflow.com">support@tuflow.com.</a></p>
</div>
<div id="ModelSetup-2" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Model Setup<a href="Introduction-1.html#ModelSetup-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="Simulations-3" class="section level3 hasAnchor" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Simulations<a href="Introduction-1.html#Simulations-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When running a TUFLOW / SWMM model, TUFLOW controls the execution of the simulation. SWMM input commands are specified within a SWMM control file (*.scf). The SWMM control file is referenced in the TUFLOW Control File (*.tcf) using
the</p>
<p><tcmd>SWMM Control File </tcmd><teq> == </teq><tblk> &lt;.scf file&gt;</tblk></p>
</div>
<div id="SCF-3" class="section level3 hasAnchor" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> SWMM Control File (*.scf)<a href="Introduction-1.html#SCF-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Within the SWMM control file, SWMM input files are read using the command:</p>
<p><tcmd>Read SWMM</tcmd><teq> == </teq><tblk>&lt;gislayer&gt;</tblk></p>
<p>Multiple input files can be read to support model scenarios. If multiple input files are provided, TUFLOW combines them to form a single SWMM input file, with later entries overwriting or appending to earlier entries.</p>
<p>Other available commands include:</p>
<p><tcmd>Read GIS SWMM Inlet Usage</tcmd><teq> == </teq><tblk>&lt;swmm_inlet_usage_filename&gt;</tblk></p>
<p><tcmd>SWMM Iterations </tcmd><teq> == </teq><tblk>[1]</tblk></p>
<p>A description of their usage is outlined in Section <a href="TUFLOWCommands-1.html#TUFLOWCommands-1">2</a>.</p>
<p>After the input files are merged and settings modified as needed, the final SWMM model will be placed in the TUFLOW output folder and will be executed from there. The report and output files will also be placed inthe TUFLOW output
folder.</p>
</div>
<div id="id_1D2DDomainLinking-3" class="section level3 hasAnchor" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> 1D/2D Domain Linking<a href="Introduction-1.html#id_1D2DDomainLinking-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are two available methods to define 1D/2D connections between the TUFLOW 2D domain and SWMM 1D network:</p>
<ol>
<li>
<p>Connection using TUFLOW 2D HX or SX boundaries, snapped to SWMM 1D nodes. 1D/2D linkage boundary connections can be specified in the 2D BC (Boundary Condition) Control File within “2d_bc” gis layers, in the same way connections are established between TUFLOW and ESTRY.</p>
<p>SWMM nodes include junctions and outfalls.</p>
<ul>
<li>SX connections are required if connecting to outfalls and junctions with a storm drain inlet.</li>
<li>HX connections are used for junctions without a storm drain inlet such as culverts under an embankment.</li>
</ul>
<br>
<li>
Alternatively, Storm drain inlets can be connected to the TUFLOW 2D domain using a “SWMM Inlet Usage” layer,
described in the next section.
</ol>
<div id="InletHandling-3" class="section level4 hasAnchor" number="1.2.3.1">
<h4><span class="header-section-number">1.2.3.1</span> Inlet Handling<a href="Introduction-1.html#InletHandling-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>1D inlet configurations, including geometry, are defined in SWMM project (inp) files. The locations of individual inlets and location-specific attributes may be defined in the SWMM project file or in a separate Geographical Information System (GIS) layer. In a pure SWMM model, inlets require the following tables (some are not required if inlet usage is defined separately):</p>
<ul>
<li>Streets: SWMM uses the street cross-section information in this table to help compute storm drain inlet discharges, particularly for on-grade inlets.</li>
<li>Conduits (Streets): This table is used to define streets for overland runoff and the slope is used in the storm drain inlet discharges. This table is not used directly when running a TUFLOW-SWMM model because the overland flows are calculated within TUFLOW. However, some of the information is extracted.</li>
<li>Inlets: This table defines inlet configurations that describe how to determine inlet discharges. Inlets
can be defined based on type and shape such as grates, curbs, and combination, or through curves that describe the relationship between depth and inlet discharge or approach flow and inlet discharge. This table defines these parameters. The same inlet configuration can be used in multiple places within the model.</li>
<li>Inlet Usage: This identifies the placement of inlets including the street conduit, inlet (configuration), the node receiving the flow, and local parameters including blockage, size of local gutter depressions, and on-grade, on-sag placement, or automatic placement.</li>
</ul>
<p>For a TUFLOW-SWMM model, inlets can be defined, either:</p>
<ol style="list-style-type: decimal">
<li>Completely using the SWMM input (inp) file format. In this form, all table items listed above (Streets, Conduits, Inlets, and Inlet Usage) are required. In addition, a “2d_bc” layer is required to connect the inlets to the 2D domain.</li>
<li>A mix between the SWMM input file format and a “swmm_inlet_usage” GIS layer. Table <a href="Introduction-1.html#tab:tab-SWMMinletusage">1.1</a> lists the attributes associated with this GIS layer. In this form, the data entry requirement is reduced. SWMM “Inlet Usage” tables are not used, and streets are not required in the “conduits” table (the conduits table will still define
the pipe network). Also, automatic inlet connections between the 1D network and 2D domain can be implemented via the “Conn1D_2D” attribute field (instead of manual specification of SX connection cells within a “2d_bc” GIS layer). The Streets and Inlet tables must still be defined in the SWMM input (inp) file.</li>
</ol>
<p>Whether inlet usage is defined in SWMM or in a separate GIS layer, the inlet discharges are computed within TUFLOW
using modified EPA SWMM 5.2 code before being passed to the SWMM engine for the 1D solution computations. This approach has been selected due to its ability to leverage TUFLOW 2D model results, such as velocities.</p>
<table>
<caption>
<span id="tab:tab-SWMMinletusage">Table 1.1: </span><strong>SWMM inlet usage (swmm_inlet_usage) Attribute Descriptions</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
No. 
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Default GIS Attribute Name
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: #1ABDC9 !important;">
Type
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;width: 5%; ">
1
</td>
<td style="text-align:left;width: 10%; ">
Inlet
</td>
<td style="text-align:left;width: 30%; ">
The name of the inlet defined in the SWMM inp file “INLETS” section
</td>
<td style="text-align:left;width: 10%; ">
Char (100)
</td>
</tr>
<tr>
<td style="text-align:right;width: 5%; ">
2
</td>
<td style="text-align:left;width: 10%; ">
StreetXSEC
</td>
<td style="text-align:left;width: 30%; ">
The name of the street cross-section that must be included in the SWMM SWMM inp file “Streets” section.
</td>
<td style="text-align:left;width: 10%; ">
Char (100)
</td>
</tr>
<tr>
<td style="text-align:right;width: 5%; ">
3
</td>
<td style="text-align:left;width: 10%; ">
Elevation
</td>
<td style="text-align:left;width: 30%; ">
The elevation of the inlet. If a value of –99999 is entered, the elevation will be based on the 2D cell’s elevation.  
</td>
<td style="text-align:left;width: 10%; ">
Float
</td>
</tr>
<tr>
<td style="text-align:right;width: 5%; ">
4
</td>
<td style="text-align:left;width: 10%; ">
SlopePct_Long
</td>
<td style="text-align:left;width: 30%; ">
The longitudinal slope of the street near the inlet.
</td>
<td style="text-align:left;width: 10%; ">
Float
</td>
</tr>
<tr>
<td style="text-align:right;width: 5%; ">
5
</td>
<td style="text-align:left;width: 10%; ">
Number
</td>
<td style="text-align:left;width: 30%; ">
The number of inlets in series at the location (generally 1)
</td>
<td style="text-align:left;width: 10%; ">
Integer
</td>
</tr>
<tr>
<td style="text-align:right;width: 5%; ">
6
</td>
<td style="text-align:left;width: 10%; ">
CloggedPct
</td>
<td style="text-align:left;width: 30%; ">
The percentage that the inlet is blocked (defaults to 0.0).
</td>
<td style="text-align:left;width: 10%; ">
Float
</td>
</tr>
<tr>
<td style="text-align:right;width: 5%; ">
7
</td>
<td style="text-align:left;width: 10%; ">
Qmax
</td>
<td style="text-align:left;width: 30%; ">
The maximum discharge through the inlet (default is 0 which does not enforce a maximum).
</td>
<td style="text-align:left;width: 10%; ">
Float
</td>
</tr>
<tr>
<td style="text-align:right;width: 5%; ">
8
</td>
<td style="text-align:left;width: 10%; ">
aLocal
</td>
<td style="text-align:left;width: 30%; ">
The depth of a local depression at the inlet (default 0.0)
</td>
<td style="text-align:left;width: 10%; ">
Float
</td>
</tr>
<tr>
<td style="text-align:right;width: 5%; ">
9
</td>
<td style="text-align:left;width: 10%; ">
wLocal
</td>
<td style="text-align:left;width: 30%; ">
The width of a local depression at the inlet (default 0.0)
</td>
<td style="text-align:left;width: 10%; ">
Float
</td>
</tr>
<tr>
<td style="text-align:right;width: 5%; ">
10
</td>
<td style="text-align:left;width: 10%; ">
Placement
</td>
<td style="text-align:left;width: 30%; ">
Specifies whether the inlet should be treated as at a sag or on a grade. Options are ON_GRADE, ON_SAG, or AUTOMATIC. AUTOMATIC is the default and will switch between ON_GRADE and ON_SAG depending upon the flow conditions at the inlet.
</td>
<td style="text-align:left;width: 10%; ">
Char(10)
</td>
</tr>
<tr>
<td style="text-align:right;width: 5%; ">
11
</td>
<td style="text-align:left;width: 10%; ">
Conn1D_2D
</td>
<td style="text-align:left;width: 30%; ">
<p>Used to specify a “SX” connection and any additional flags such as “SXZ” or “SXG” that automatically creates a 2D SX cell and connection at the 2D cell within which the SWMM node occurs. This negates the need to create SX objects in a 2d_bc layer.</p>
<p>Flags:</p>
<ul>
<li>“L” – sets the ZU and ZV elevations to be the same as the ZC value only if they are lower. This can improve instabilities where the ZU and ZV values are significantly lower in elevation and can cause a sudden increase in transfer of water to/from the cell when the cell wets.</li>
<li>“Z” – Adjust the ZC elevation at each cell at/along/within the 2D SX object to below the 1D node bed elevation where ZC is higher. The ZC elevation is set to the Cell Wet/Dry Depth below the 1D node bed. An error occurs if the minimum ZC elevation plus the Cell Wet/Dry Depth at/along a SX object is not below the connected 1D node bed. Also see SX ZC Check permits the user to define a maximum change in ZC elevation. It is not recommended to use the Z flag without first checking that the reason for the discrepancy in elevations between 1D and 2D domains is appropriate</li>
</ul>
By default, if more than one 2D cell is automatically connected, nodes are assumed to be connected using the Sag (S) approach. To override the default approach, specify “SXG” for an on-grade connection.
</td>
<td style="text-align:left;width: 10%; ">
Char (10)
</td>
</tr>
<tr>
<td style="text-align:right;width: 5%; ">
12
</td>
<td style="text-align:left;width: 10%; ">
Conn_Width
</td>
<td style="text-align:left;width: 30%; ">
<p>If “SX” is specified for Conn1D_2D, this field controls the number of 2D cells connected as follows. Note this approach is slightly different than is used by TUFLOW-ESTRY models.</p>
<ul>
<li>A positive value indicates the flow width that should be used to compute the number of 2D cells to connect to. TUFLOW will choose the nearest cells that are collectively as wide or wider than the specified flow width.</li>
<li>If negative, the number of cells selected is the absolute value of the number specified. For example, a value of –1 would connect the inlet to a single 2D cell.
</td>
<td style="text-align:left;width: 10%; ">
Float
</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
</div>
<div id="ESTRYSWMMLinking-3" class="section level3 hasAnchor" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> ESTRY/SWMM Linking<a href="Introduction-1.html#ESTRYSWMMLinking-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>SWMM can be linked to TUFLOW 2D (HPC) as well as ESTRY 1D Networks. The approach is described in Section 8.3 of the <a href="https://downloads.tuflow.com/_archive/TUFLOW/Releases/2018-03/TUFLOW%20Manual.2018-03.pdf">2018 TUFLOW Manual</a> where SWMM is considered an “External 1D Domain.” For SWMM linking, X1DQ connections must be used at SWMM junctions and X1DH connections are used at SWMM outfalls.</p>
</div>
<div id="SWMMSettings-3" class="section level3 hasAnchor" number="1.2.5">
<h3><span class="header-section-number">1.2.5</span> SWMM Settings<a href="Introduction-1.html#SWMMSettings-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Some SWMM option settings are automatically set by TUFLOW:</p>
<ul>
<li><strong>END_DATE/END_TIME:</strong> Set based upon the SWMM START_DATE/START_TIME and the TUFLOW simulation duration.</li>
<li><strong>FLOW_UNITS:</strong> the flow units are set to match the TUFLOW simulation, either to CFS for US Customary units or CMS
for metric units.</li>
<li><strong>FLOW_ROUTING:</strong> Flow routing is set to DYNWAVE.</li>
<li><strong>ALLOW_PONDING:</strong> Allow ponding is set to YES. Ponding can be prevented by setting a high value for “YSur” or by setting the junction attribute Apond to 0.0. Only junctions with HX or SX boundaries should have Apond set to 0.0, which will create flooding in the 2D domain when the junction is surcharged.</li>
<li><strong>END_DATE/END_TIME:</strong> These are set based on the TUFLOW end time and the SWMM start time (simulation duration + start
date/time = specified end date/time).</li>
<li><strong>VARIABLE_STEP:</strong> This is turned off (0). TUFLOW will control the timestep based on the HPC (Heavily Parallelised Compute) timestep and the SWMM Iterations command.</li>
</ul>
<p>The treatment of ponding by SWMM is particularly important. TUFLOW requires ponding, so junctions can pond if the ponding area (Apond) is greater than 0.0. SWMM tracks the volumes stored as ponded water and will reintroduce the water back into the network when there is capacity available. Ponded water at a node connected to an HX boundary or a depth
vs discharge inlet will transfer flow to the 2D domain if the ponded water level exceeds the 2d cell water levels.</p>
<p>If the ponding area is 0.0, water will not pond at a node, but the water can surcharge (flood) if the water level in a node exceeds Ymax + Ysur (maximum depth + surcharge water depth). Flooded water is lost through “flooding” and no longer tracked within SWMM. Unless the flooded water for a junction is outside of the 2D domain and not of interest, nodes that may exhibit flooding should be connected to the 2D domain with or without an inlet.</p>
<p>Recommended attribute settings for junction nodes are:</p>
<ul>
<li>Junction nodes without inlets (2d_bc HX boundary)
<ul>
<li>Set the SWMM Ymax value to the highest soffit of the connected culvert (SWMM will default to this value if Ymax is set to 0). Set Apond to approximately the area of the connected cells. Water will flow into the 2D domain if the water surface elevation in the pipe exceeds the water surface elevation in the 2D domain.</li>
</ul></li>
<li>Junctions with Inlets (2d_bc SX boundary)
<ul>
<li>Custom inlet with depth vs discharge rating curve: Set the SWMM Ymax value to the inlet elevation and Apond to approximately the area of the connected cells (often a single cell).</li>
<li>All other inlets – Set SWMM Ymax value to the inlet elevation and Apond to 0.0. SWMM will report “flooding” at the node, transferring flow to the 2D domain.</li>
</ul></li>
<li>Junctions without 2d_bc HX or SX boundaries
<ul>
<li>Since these junctions do not have connections to the 2D domain, any water lost to “flooding” will be lost from the model. A junction can be prevented from “flooding” by setting the SWMM junction surcharge elevation (Ysur) to a value well above the expected water surface elevation to prevent this from occurring.</li>
</ul></li>
<li>The recommendations above assume that the SWMM 1D network is within the extents of an active 2D domain. Portions of the SWMM network may extend beyond these boundaries. In these situations, use the SWMM documentation to determine the most appropriate parameter specification.</li>
</ul>
</div>
</div>
<div id="SWMMGISTools-2" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> SWMM GIS Tools<a href="Introduction-1.html#SWMMGISTools-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A suite of Python tools has been developed to support TUFLOW/SWMM modelling. These tools are available to run as processing scripts in
QGIS, via the TUFLOW Plugin. For instructions how to install the Plugin, please refer to the <a href="https://wiki.tuflow.com/TUFLOW_QGIS_Plugin">TUFLOW Wiki</a>.</p>
<p>These tools use a GeoPackage format for working with the data in GIS using a schema that has been developed to store the data held within an
SWMM input file. The GeoPackage representation is mostly a simple conversion of the table oriented SWMM input file (inp). Some GeoPackage
tables are modified versions of the SWMM input file. Some of the GeoPackage tables have spatial components (points, lines, and polygons)
and others are tables of data with no geometry attributes.</p>
<p>Generally, modified tables are a “wide” form of the tables to represent distinct categories of options without using the same column for
multiple input parameters. For example, the “XSECTIONS” table has a variety of inputs depending upon whether the shape is from a list of
shapes, a custom shape (a closed shape with a Height vs Width table), irregular shape (cross-section-based open channel), or a street
cross-section. In the SWMM input file, attributes from multiple types use the same columns while the GeoPackage representation creates a
column for each input field. There are separate columns for specified shapes and irregular culvert curves. Depending upon the option selected,
many of the fields will not be used.</p>
<p>To make things simpler, the subcatchment and subarea SWMM table columns are combined into the subcatchment table. The subarea columns use the
prefix “subarea_” and are written to a separate table when exported to SWMM inp.</p>
<div id="GISTools-3" class="section level3 hasAnchor" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> GIS Tools<a href="Introduction-1.html#GISTools-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Most of the SWMM functionality currently in the TUFLOW plugin are processing tools accessed from the processing tools panel. The 1D integrity tools are also supported.</p>
<p>The Geo-Processing tools include a description of the tool, inputs, and outputs when accessed in QGIS. The list of available Geo-Processing
Algorithms includes:</p>
<ul>
<li>Convert ESTRY layers to SWMM: This tool converts individual ESTRY input layers into SWMM format. Supported layers include 1D network layers
(lines or points), 1D node layers, 1D pit layers, and 1D table link layers (cross-sections). Pit inlet database/depth discharge database can
be specified for use. Options and reporting tables can optionally be created to make a more complete SWMM input file.</li>
<li>GeoPackage - Add Sections: This tool adds tables (spatial or otherwise) representing SWMM sections to a new or existing GeoPackage.</li>
<li>GeoPackage - Create from SWMM inp: This tool converts a SWMM input file to a GeoPackage representation. Even if not necessary, this conversion is often useful because it provides a format supporting GIS objects for visualization and editing. For example, it provides a GIS object that 2d_bc HX and SX boundaries can be snapped to.</li>
<li>GeoPackage - Write to SWMM inp: This tool converts a GeoPackage to a SWMM input file. This step is required to use the model with TUFLOW because TUFLOW does not directly read the GeoPackage format.</li>
<li>Integrity - Assign snapped nodes to conduits: SWMM links (conduits, pumps, weirs, etc) include the name of starting and ending nodes in the table ignoring location. This tool will assign the table nodes the names of the nodes snapped to the endpoints.</li>
<li>Integrity - Make node names unique: SWMM requires unique names for nodes (junctions and outfalls). If multiple nodes are encountered with the same name, this tool will add an incremental number (node_2, node_3, node_4, etc.) to force unique names.</li>
</ul>
<p>Most of the 1D integrity tools now work with SWMM networks. Refer to the documentation for the tools to understand their use: <a href="https://wiki.tuflow.com/1D_Integrity_Tool">1D Integrity Tools</a>. Add the “Links–Conduits” to the “1D Network Line Layers” and “Nodes–Junctions” and “Nodes–Outfalls” to the “1D Point Layers” sections of the panel. The other Links types are not currently supported but will be added. The “Auto Snap” option in the Snapping tool is not currently supported for SWMM networks.</p>
</div>
</div>
<div id="SWMMOutputs-2" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> SWMM Outputs<a href="Introduction-1.html#SWMMOutputs-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Model outputs are written by both SWMM and TUFLOW, which can be used to visualize model results. SWMM
writes a report file (rpt) and an output file (out) in the TUFLOW results folder with the simulation prefix followed by “_swmm.” The report file can be viewed with a text editor and the output file can be viewed in EPA SWMM or 3<sup>rd</sup> party tools that support this format such as <a href="www.pyswmm.org">PySWMM</a>.</p>
<p>Currently, TUFLOW will also write a file ending “_swmm_ugrid.nc,” which is a <a href="http://ugrid-conventions.github.io/ugrid-conventions/">UGRID file written in a NetCDF format</a> that contains the 1D results. The UGRID file can be viewed in QGIS. The results (depth, flow, water level, etc.) can be colored for specific timesteps using the “Layer Styling” options. The temporal controller or
TUFLOW viewer can switch between timesteps. Time series and profile plots can be generated using the <a href="https://www.lutraconsulting.co.uk/blog/2020/06/17/crayfish-3-4-4/">Crayfish Plugin</a>.</p>
<p>During the beta period, we are investigating a new time-series format based on GeoPackages. It is anticipated that this format will replace the UGRID format before the full release of the TUFLOW with SWMM.</p>
</div>
<div id="SWMMInclusionTUFLOW-2" class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> SWMM Inclusion in TUFLOW<a href="Introduction-1.html#SWMMInclusionTUFLOW-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="SWMMLibraryVersion-3" class="section level3 hasAnchor" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> SWMM Library Version<a href="Introduction-1.html#SWMMLibraryVersion-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>TUFLOW runs SWMM as a library passing data between SWMM and the 2D domains. The SWMM version used for the hydraulic calculation was created by Open Water Analytics <span class="citation">(<a href="#ref-mcdonnell_bryant_2021_5484299">McDonnell et al. 2021</a>)</span>, which is a modified version of the EPA SWMM code.</p>
</div>
<div id="SWMMCode-in-TUFLOW-3" class="section level3 hasAnchor" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Embedded SWMM Code in TUFLOW<a href="Introduction-1.html#SWMMCode-in-TUFLOW-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>TUFLOW has modified EPA SWMM code (not from Open Water Analytics) embedded primarily to compute pit (inlet) discharges. The code was modified for easy inclusion and to allow the discharges to be calculated outside of the SWMM library based on 2D model results. Some minor changes were made to the embedded code which are described in this section.</p>
<p>Changes were made to how inlets are handled to better correspond to how “rating curve” based pits are treated in ESTRY and provide better handling when the water level is above the inlet invert. Pit rating
curves use a depth vs discharge relationship to determine the volume of flow that passes from the 2D domain into the 1D domain. If the pipe water level is above the inlet invert, but the 2D water level is higher
the discharge will be based on the 2D water level minus the 1D water level in the pipe. If the 1D pipe water level is higher, a surcharging discharge is computed using the same curve based on the 1D pipe water
level minus the 2D water level. This matches the ESTRY implementation and ensures a smooth transition between inflow and surcharging.</p>
<p>The discharge for on-grade grate inlets was modified to use a velocity passed from the 2D domain rather than calculating a velocity based on the street cross-section and slope at the inlet.</p>
<p>The methodology for assigning On-Grade or On-Sag handling of pits (inlets) was modified in the embedded code. In SWMM pit (inlet) placement of “AUTOMATIC” determines whether a pit should be On-Sag or On-Grade based upon the topography of the street layout. However, in a combined TUFLOW and SWMM model streets may not be fully described because only the cross-section information at inlets is required because 2D flows are modeled in TUFLOW. When running SWMM inside of TUFLOW, whether to treat an automatic placement as On-Sag or On-Grade is
determined dynamically based on the inflows to the connected 2D cells. The 2D model provides approach discharge (along the street) and total discharge for the connected cells. If the approach discharge is over 85%
of the total discharge, the pit is modeled as an On-Grade inlet. Otherwise, it is modeled as On-Sag. <strong>This approach is currently being tested and may not appropriately assign On-Grade and On-Sag inlets. It
is recommended that users assign On-Grade or On-Sag to each of their inlets until the automatic approach has been proven.</strong></p>
<p><img src="images/WQFooter.jpg" width="100%" /></p>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-mcdonnell_bryant_2021_5484299" class="csl-entry">
McDonnell, Bryant, Jia Xin Wu, Katherine Ratliff, Abhiram Mullapudi, and Michael Tryby. 2021. <span>“Open Water Analytics Stormwater Management Model.”</span> Zenodo. <a href="https://doi.org/10.5281/zenodo.5484299">https://doi.org/10.5281/zenodo.5484299</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="TUFLOWCommands-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": false,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
