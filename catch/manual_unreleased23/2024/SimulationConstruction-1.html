<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 4 Simulation Construction | TUFLOW CATCH User Manual</title>
  <meta name="description" content="Section 4 Simulation Construction | TUFLOW CATCH User Manual" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 4 Simulation Construction | TUFLOW CATCH User Manual" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/1024in300px_Blue-01.svg" />
  <meta property="og:description" content="Section 4 Simulation Construction | TUFLOW CATCH User Manual" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 4 Simulation Construction | TUFLOW CATCH User Manual" />
  
  <meta name="twitter:description" content="Section 4 Simulation Construction | TUFLOW CATCH User Manual" />
  <meta name="twitter:image" content="/images/1024in300px_Blue-01.svg" />

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/TUFLOW.ico" type="image/x-icon" />
<link rel="prev" href="ProcessDescriptions-1.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://www.tuflow.com"><img src="images/1024in300px_Blue-01.svg" style="width:246px;height:68px;"></a></li>

<li class="divider"></li>
<li><a href="index.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#about-this-manual"><i class="fa fa-check"></i>About this manual</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#how-to-use-this-manual"><i class="fa fa-check"></i>How to use this manual</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#navigation"><i class="fa fa-check"></i>Navigation</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#searching"><i class="fa fa-check"></i>Searching</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#tables"><i class="fa fa-check"></i>Tables</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#commands"><i class="fa fa-check"></i>Commands</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#parameter-notation"><i class="fa fa-check"></i>Parameter notation</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#feedback"><i class="fa fa-check"></i>Feedback</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="Overview-1.html"><a href="Overview-1.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="Overview-1.html"><a href="Overview-1.html#OverviewContext-2"><i class="fa fa-check"></i><b>1.1</b> Context</a></li>
<li class="chapter" data-level="1.2" data-path="Overview-1.html"><a href="Overview-1.html#Features-2"><i class="fa fa-check"></i><b>1.2</b> Features</a></li>
<li class="chapter" data-level="1.3" data-path="Overview-1.html"><a href="Overview-1.html#Configs-2"><i class="fa fa-check"></i><b>1.3</b> Configurations</a></li>
<li class="chapter" data-level="1.4" data-path="Overview-1.html"><a href="Overview-1.html#Science-2"><i class="fa fa-check"></i><b>1.4</b> Science</a></li>
<li class="chapter" data-level="1.5" data-path="Overview-1.html"><a href="Overview-1.html#Support-2"><i class="fa fa-check"></i><b>1.5</b> Support</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Architecture-1.html"><a href="Architecture-1.html"><i class="fa fa-check"></i><b>2</b> Architecture</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Architecture-1.html"><a href="Architecture-1.html#ArchitectureContext-2"><i class="fa fa-check"></i><b>2.1</b> Context</a></li>
<li class="chapter" data-level="2.2" data-path="Architecture-1.html"><a href="Architecture-1.html#CA-2"><i class="fa fa-check"></i><b>2.2</b> Core Architecture</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="Architecture-1.html"><a href="Architecture-1.html#ExCoord-3"><i class="fa fa-check"></i><b>2.2.1</b> Execution Coordination</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html"><i class="fa fa-check"></i><b>3</b> Process Descriptions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ProcessDescriptionsGeo-2"><i class="fa fa-check"></i><b>3.1</b> Geolocation</a></li>
<li class="chapter" data-level="3.2" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ProcessDescriptionsPollExp-2"><i class="fa fa-check"></i><b>3.2</b> Pollutant Export</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ProcessDescriptionsConst-3"><i class="fa fa-check"></i><b>3.2.1</b> Constant</a></li>
<li class="chapter" data-level="3.2.2" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ProcessDescriptionsTS-3"><i class="fa fa-check"></i><b>3.2.2</b> Timeseries</a></li>
<li class="chapter" data-level="3.2.3" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ProcessDescriptionsAccWO-3"><i class="fa fa-check"></i><b>3.2.3</b> Accumulation and washoff</a></li>
<li class="chapter" data-level="3.2.4" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ProcessDescriptionsSS-3"><i class="fa fa-check"></i><b>3.2.4</b> Shear Stress</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html"><i class="fa fa-check"></i><b>4</b> Simulation Construction</a>
<ul>
<li class="chapter" data-level="4.1" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimulationConstructionContext-2"><i class="fa fa-check"></i><b>4.1</b> Context</a></li>
<li class="chapter" data-level="4.2" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SCIntent-2"><i class="fa fa-check"></i><b>4.2</b> Usage intent</a></li>
<li class="chapter" data-level="4.3" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimulationConstructionInit-2"><i class="fa fa-check"></i><b>4.3</b> Initialisation</a></li>
<li class="chapter" data-level="4.4" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SCGeneral-2"><i class="fa fa-check"></i><b>4.4</b> General arrangement</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SCGeneralFS-3"><i class="fa fa-check"></i><b>4.4.1</b> Folder structure</a></li>
<li class="chapter" data-level="4.4.2" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SCGeneralWF-3"><i class="fa fa-check"></i><b>4.4.2</b> Intended workflow</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SCTCC-2"><i class="fa fa-check"></i><b>4.5</b> TUFLOW CATCH control file</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SCTCCGlobal-3"><i class="fa fa-check"></i><b>4.5.1</b> Global commands</a></li>
<li class="chapter" data-level="4.5.2" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SCTCCHPC-3"><i class="fa fa-check"></i><b>4.5.2</b> Catchment hydraulic model (TUFLOW HPC) commands</a></li>
<li class="chapter" data-level="4.5.3" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SCTCCPollExp-3"><i class="fa fa-check"></i><b>4.5.3</b> Pollutant export model commands</a></li>
<li class="chapter" data-level="4.5.4" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SCTCCFV-3"><i class="fa fa-check"></i><b>4.5.4</b> Receiving model (TUFLOW FV) commands</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.tuflow.com"><img src="images/1024in300px_Blue-01.svg" style="width:246px;height:68px;"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><h0 style="color:rgb(0,85,129);">TUFLOW CATCH User Manual</h0></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="SimulationConstruction-1" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Section 4</span> Simulation Construction<a href="SimulationConstruction-1.html#SimulationConstruction-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="SimulationConstructionContext-2" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Context<a href="SimulationConstruction-1.html#SimulationConstructionContext-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Previous sections have presented the architecture and processes available within TUFLOW CATCH. This section describes the usage intent and construction of a TUFLOW CATCH simulation. This includes the use of the TUFLOW CATCH QGIS plugin, descriptions of all commands, with hyperlinks to the Appendices where commands and explanations are listed in a searchable and sortable table for ease of access.
<span class="math inline">\(\newcommand{\blockindent}{\hspace{0.5cm}}\)</span></p>
</div>
<div id="SCIntent-2" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Usage intent<a href="SimulationConstruction-1.html#SCIntent-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>TUFLOW CATCH coordinates and executes TUFLOW HPC, a pollutant export model and TUFLOW FV, all automatically and with no direct user input required to affect this linkage. This does not mean that TUFLOW CATCH cannot be run until all models (TUFLOW HPC, pollutant export and TUFLOW FV) are fully constructed. To the contrary, the intention is that for application to integrated catchment studies that will at some stage need to draw on the power of TUFLOW CATCH, the single TUFLOW CATCH control file is used as the common control file for all model construction from project inception, even where this construction is undertaken in parallel by multiple users.</p>
<p>The reason for this approach is that, for example, the TUFLOW HPC block of the TUFLOW CATCH control file is nothing other than a standard TUFLOW HPC *.tcf control file, with a small number of additional TUFLOW CATCH commands. This is intentional, and means that an experienced (or beginner) TUFLOW HPC modeller can follow normal model set up processes and procedures to construct the TUFLOW HPC component of TUFLOW CATCH model, unhindered, but via the TUFLOW CATCH control file arrangement. The same logic applies to users constructing the TUFLOW FV sections of a TUFLOW CATCH model - the TUFLOW HPC sections of the TUFLOW CATCH control file can be turned off and TUFLOW FV model construction commenced as usual through the *.tcc rather than *.fvc control file. Users in teams that adopt this approach may want to consider using versioning control software to manage concurrent multiple user contributions.</p>
<p>It is understood that in some legacy cases, existing TUFLOW HPC or TUFLOW FV models (that were originally built outside TUFLOW CATCH) will need to be brought into a block of a TUFLOW CATCH control file. If this is the case, then the process is a matter of copying and pasting the original control files into the relevant TUFLOW CATCH control file block and populating the supporting folder structures with model data (see following sections). The key change that will be required on pasting into a *.tcc block will be to ensure file path references are correct (see following sections). This is only required from the *.tcc as it points to immediately called files, and no further.</p>
</div>
<div id="SimulationConstructionInit-2" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Initialisation<a href="SimulationConstruction-1.html#SimulationConstructionInit-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>TUFLOW CATCH requires construction of a suite of folder substructures to support simulations. Ideally, these should be all co-located at the same folder level underneath a single directory that sits within an overall project directory. These substructures correspond to each of the three products potentially used in a TUFLOW CATCH simulation, and should be names as follows:</p>
<ul>
<li>TUFLOWCATCH</li>
<li>TUFLOW (TUFLOW HPC)</li>
<li>TUFLOWFV</li>
</ul>
<p>Each of these substructures has its own subfolder arrangement, consistent with those suggested for each for standalone TUFLOW HPC and TUFLOW FV modelling studies. For consistency, the suggested TUFLOWCATCH subfolder arrangement is also similar.</p>
<p>To assist with this set up, and indeed more broadly with the initialisation, execution and results interrogation of a TUFLOW CATCH simulation, a freely available TUFLOW CATCH QGIS plugin has been developed. TUFLOW eLearning resources (also free of charge) have been prepared to support deployment and use of this TUFLOW CATCH plugin, and as such the content of that resource is not repeated here. Users are however encouraged to access this resource before initialising their first TUFLOW CATCH simulation: using this plugin is seen as a core component of the set up of a TUFLOW CATCH simulation. Doing so manually is discouraged. The eLearning materials can be accessed by:</p>
<ul>
<li>Registering for TUFLOW eLearning <a href = "https://elearning.tuflow.com/login/index.php">here</a> if not already registered</li>
<li>Emailing <a href="mailto:support@tuflow.com" class="email">support@tuflow.com</a> noting the registered username and with a request access to the TUFLOW CATCH plugin eLearning course</li>
<li>Following instructions subsequently provided to access the course</li>
<li>Complete the course</li>
</ul>
<p>On completion of the course, users will be able to initialise a TUFLOW CATCH simulation in the desired geographical projection system, complete with automatically populated templates for all control files. The sections presented below assume that this QGIS initialisation process has occurred and describe the resulting general arrangements and subsequent construction of a TUFLOW CATCH simulation.</p>
</div>
<div id="SCGeneral-2" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> General arrangement<a href="SimulationConstruction-1.html#SCGeneral-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="SCGeneralFS-3" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Folder structure<a href="SimulationConstruction-1.html#SCGeneralFS-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
The overarching TUFLOW CATCH folder structure created using the QGIS plugin will appear (at the first tier) as per Figure <a href="SimulationConstruction-1.html#fig:fig-fs">4.1</a> (with the top level folder named ‘Modelling’ selected by the user during initialisation).
<br>
<center>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-fs"></span>
<img src="images/FS.png" alt="**TUFLOW CATCH folder structure**" width="25%" />
<p class="caption">
Figure 4.1: <strong>TUFLOW CATCH folder structure</strong>
</p>
</div>
</center>
</div>
<div id="SCGeneralWF-3" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Intended workflow<a href="SimulationConstruction-1.html#SCGeneralWF-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The above folder structure supports the overall intended TUFLOW CATCH simulation workflow, such that:</p>
<ul>
<li>The TUFLOW CATCH folder (and control file, see below) is the single point of contact for execution of TUFLOW CATCH simulations, regardless of the combination of TUFLOW HPC or TUFLOW FV models being called</li>
<li>All simulation results (again, regardless of what subsidiary TUFLOW products are called) are written to the TUFLOWCATCH/output subfolder: users should never need to navigate to TUFLOW HPC or TUFLOWFV folder structures to examine results from TUFLOW CATCH simulations</li>
<li>Users do not need to (and should not) set up their own *.tcf (TUFLOW HPC) or *.(TUFLOW FV) top level control files in the respective TUFLOW and TUFLOWFV runs directories: TUFLOW CATCH does this automatically based on information provided in the overarching TUFLOW CATCH control file<br />
</li>
<li>Calls to subsidiary first level control files from the overarching TUFLOW CATCH control file for both TUFLOW HPC and TUFLOW FV (such as *.tgc, bc_dbase etc. (TUFLOW HPC) or *.fvsed etc. (TUFLOW FV)) need to be provided as relative paths to locations that sit within the respective TUFLOW or TUFLOWFV subfolder arrangements</li>
<li>These first level control files then should be constructed to make the usual calls to all other files and data with respective TUFLOW and/or TUFLOWFV subfolder arrangements</li>
<li>All model data (e.g. grids, GIS, boundaries etc.) should be located within respective subfolder arrangements for TUFLOW and TUFLOW FV</li>
</ul>
<p>In short, it is intended that the:</p>
<ul>
<li>TUFLOW CATCH control file is the primary point of construction and execution contact</li>
<li>TUFLOW and TUFLOWFV folder substructures contain input model data</li>
<li>TUFLOWCATCH folder substructure contains model outputs</li>
</ul>
<p>Subsequent sections describe the TUFLOW CATCH control file set up and model execution.</p>
</div>
</div>
<div id="SCTCC-2" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> TUFLOW CATCH control file<a href="SimulationConstruction-1.html#SCTCC-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A TUFLOW CATCH simulation is set up and executed by constructing a TUFLOW CATCH control file, extension *.tcc. THis file should reside in the TUFLOWCATCH\runs directory set up with the TUFLOW CATCH QGIS plugin. The user is not required to (and should not) construct separate *.tcf or *.fvc control files. This TUFLOW CATCH control file has four separate but linked blocks:</p>
<ol>
<li>Global commands</li>
<li>Catchment Hydraulic Model (TUFLOW HPC) commands</li>
<li>Catchment Pollutant Export Model</li>
<li>Receiving Model (TUFLOW FV) commands</li>
</ol>
<p>All blocks must be included in the above order, but can be optionally switched on and off with a single command (rather than extensive line commenting) to suit modelling needs. For example, a user working only on TUFLOW HPC model build tasks can turn off the pollutant export and TUFLOW FV sections and continue building a TUFLOW HPC model as per normal, without the need to always execute all components of TUFLOW CATCH.</p>
<p>Construction of each of the TUFLOW CATCH control file blocks is described in the following sections.</p>
<div id="SCTCCGlobal-3" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Global commands<a href="SimulationConstruction-1.html#SCTCCGlobal-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This block of the TUFLOW CATCH control file contains information that is applied equally to both TUFLOW HPC and TUFLOW FV. It does not need to be declared as a block (as all subsequent blocks do). These global commands are presented following, with command argument options also shown. All commands are mandatory.</p>
<p>Set the hardware to be used, with command arguments as either CPU or GPU:</p>
<blockquote>
<p><a href="#TCHardware">Hardware ==</a></p>
</blockquote>
<p>Set the GIS format to be used, with command arguments as either SHP, GPKG or MI:</p>
<blockquote>
<p><a href="#TCGISFmt">GIS Format ==</a></p>
</blockquote>
<p>Set projection to be used, as a path to a shape file. This will have been prepared by the TUFLOW CATCH plugin:</p>
<blockquote>
<p><a href="#TCSHPProj">SHP Projection ==</a></p>
</blockquote>
<p>Set the date format, with command arguments as either ISODATE (dd/mm/yyy hh:mm:ss) or hours (a single float). It is strongly recommended that ISODATE be used for longer simulations, where interpreting hour output timestamps can be difficult:</p>
<blockquote>
<p><a href="#TCTimeFmt">Date Format ==</a></p>
</blockquote>
<p>Set the start and end dates in the format declared above:</p>
<blockquote>
<p><a href="#TCStrtDte">Start Date ==</a></p>
</blockquote>
<blockquote>
<p><a href="#TCEndDte">End Date ==</a></p>
</blockquote>
<p>Set the directory for simulation outputs (e.g. xmdf and netcdf results files). This can be set to any location as either a full path (e.g. X:), or as a path relative to the location of the TUFLOW CATCH control file (e.g. ..):</p>
<blockquote>
<p><a href="#TCOutDir">Output Directory ==</a></p>
</blockquote>
<p>Set the directory for writing simulation check files (e.g. .shp files). This can be set to any location as either a full path (e.g. X:), or as a path relative to the location of the TUFLOW CATCH control file (e.g. ..):</p>
<blockquote>
<p><a href="#TCChkDir">Write Check Files ==</a></p>
</blockquote>
<p>Set the directory for writing simulation log files. TUFLOW HPC and TUFLOW FV engine log files will be written to this location, as well as module log files (such as the water quality module of TUFLOW FV). This can be set to any location as either a full path (e.g. X:), or as a path relative to the location of the TUFLOW CATCH control file (e.g. ..):</p>
<blockquote>
<p><a href="#TCLogDir">Log Folder ==</a></p>
</blockquote>
<p>In order to collect all log files without name conflictions, TUFLOW CATCH renames the various log files before it writes them to the user nominated directory. The renaming convention is as follows:</p>
<ul>
<li>TUFLOW HPC related log files:
<ul>
<li>&lt;<em>TUFLOW CATCH tcc filename root</em>&gt;_catchment_hydraulic_***.t*f</li>
</ul></li>
<li>TUFLOW FV related log files:
<ul>
<li>&lt;<em>TUFLOW CATCH tcc filename root</em>&gt;_receiving_***.*log</li>
</ul></li>
</ul>
<p>where *** indicates a usual extension expected in a log file such as “messages” (for TUFLOW HPC) or “ext_cfl_dt” (for TUFLOW FV) etc. For example, for a TUFLOW CATCH control file called SysModel_001.tcc, the following log files might be produced (depending on simulation options)</p>
<ul>
<li>TUFLOW HPC related log files:
<ul>
<li>SysModel_001_catchment_hydraulic.hpc.tlf</li>
<li>SysModel_001_catchment_hydraulic.tlf</li>
<li>SysModel_001_catchment_hydraulic.tsf</li>
</ul></li>
<li>TUFLOW FV related log files:
<ul>
<li>SysModel_001_receiving_ext_cfl_dt.log</li>
<li>SysModel_001_receiving.log</li>
<li>SysModel_001_receiving.fvwqlog</li>
</ul></li>
</ul>
<p>Set the directory for writing the TUFLOW FV boundary condition files prepared by TUFLOW CATCH from TUFLOW HPC simulation, including boundary condition blocks and underlying data (timeseries) files. This command is required even if TUFLOW FV is not used in a TUFLOW CATCH simulation, in which case template TUFLOW FV files will be written to this location. TUFLOW CATCH also writes TUFLOW HPC diagnostic information to this location (regardless of whether TUFLOW FV is simulated), including timeseries files of predicted catchment-wide summed cumulative volumes and/or masses. These files can be useful for providing system understanding, even when TUFLOW FV is not activated. This directory should be always set as the bc_dbase folder within the TUFLOW CATCH folder substructure (as generated by the TUFLOW CATCH QGIS plugin), as a path relative to the location of the TUFLOW CATCH control file (i.e. ..\bc_dbase):</p>
<blockquote>
<p><a href="#TCChkDir">Catch Ouput Folder ==</a> ..\bc_dbase</p>
</blockquote>
<p>Set the timestep (in simulation time seconds) at which lines within a boundary condition file for TUFLOW FV (created from TUFLOW HPC predictions) are separated. TUFLOW CATCH offers the user the option to set this timestep differently for different types of TUFLOW FV boundaries: nodestrings (Q boundaries that deliver momentum to TUFLOW FV) and lateral inflows (QC boundaries that do not deliver momentum to TUFLOW FV). It would be typical that nodestring boundaries are written at a shorter timestep to lateral boundaries, but this is not mandated, and the user is able to decide how this timestep relates to simulation time and file size constraints:</p>
<blockquote>
<p><a href="#TCNSOutDt">Catch Output Interval Nodestring ==</a> &lt;float in seconds&gt;</p>
</blockquote>
<blockquote>
<p><a href="#TCLatOutDt">Catch Output Interval Lateral ==</a> &lt;float in seconds&gt;</p>
</blockquote>
<p>Set the frequency at which TUFLOW CATCH pauses to write out TUFLOW FV boundary condition files, in units of days (simulation time). Setting a value of 1 means that TUFLOW CATCH will hold all boundary information in memory for a day of simulation time, and then update TUFLOW FV boundary files with this held memory on a daily basis. For example, if outputs were set to be hourly via hourly via either of the above interval commands, then 24 lines would be added to each boundary file at time of writing:</p>
<blockquote>
<p><a href="#TCCSVwrite">CSV Write Frequency Day ==</a> &lt;float in days&gt;</p>
</blockquote>
<p>An example block of these global commands that together configure a TUFLOW CATCH simulation (with clarifying section headers as comments) is:</p>
<pre><code>!________________________________________________________
! GLOBAL COMMANDS

! Hardware
Hardware == GPU

! GIS
GIS Format == SHP
SHP Projection == ..\..\TUFLOW\model\gis\projection.prj

! Simulation settings
Date Format == ISODATE
Start Date == 01/01/2021 00:00:00
End Date == 01/02/2021 00:00:00

! Output folders
Output Directory == X:\Project\Output
Write Check Files == ..\check
Log Folder == ..\log

! Boundary condition configuration
Catch Output Folder == ..\bc_dbase
Catch Output Interval Nodestring == 900
Catch Output Interval Lateral == 10800
CSV Write Frequency Day == 1
</code></pre>
</div>
<div id="SCTCCHPC-3" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Catchment hydraulic model (TUFLOW HPC) commands<a href="SimulationConstruction-1.html#SCTCCHPC-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This block of the TUFLOW CATCH control file contains commands that construct a TUFLOW HPC simulation. These commands are almost entirely those that would be used in setting up a standalone TUFLOW HPC control file (*.tcf), with a small number of additional commands that relate to TUFLOW CATCH.</p>
<p>The catchment hydraulic model definition must be declared as a block that encloses all TUFLOW CATCH and TUFLOW HPC commands. This is different to the global commands section at the top of the TUFLOW CATCH control file, which does not need this encompassing structure.
Set the beginning of the block, with command arguments as either HPC or none, and the end of the block (with no command arguments):</p>
<blockquote>
<p><a href="#TCCHMS">Catchment Hydraulic Model ==</a></p>
</blockquote>
<p><span class="math inline">\(\blockindent\)</span> …catchment hydraulic model commands… <br>
<span class="math inline">\(\blockindent\)</span> …catchment hydraulic model commands… <br>
<span class="math inline">\(\blockindent\)</span> …catchment hydraulic model commands… <br></p>
<blockquote>
<p><a href="#TCCHME">End Catchment Hydraulic Model</a></p>
</blockquote>
<p>If the <a href="#TCCHMS">Catchment Hydraulic Model</a> command is set to none, then catchment simulation is not executed, and TUFLOW FV will read blank (interim) boundary condition files prepared by TUFLOW CATCH. This approach might be adopted for the initial stages of a TUFLOW FV model build, or dry period tidal / thermal stratification calibration of a receiving water, for example. The TUFLOW CATCH commands contained within this Catchment Hydraulic Model block are described following, and all are mandatory unless noted otherwise.</p>
<p>Set the directory from which TUFLOW CATCH controls TUFLOW HPC. Unless there is a need to the contrary, this should be set as a relative path to the TUFLOWdirectory set up by the TUFLOW CATCH QGIS plugin, i.e. ..\..\TUFLOW\runs. Setting this to any other directory is not recommended:</p>
<blockquote>
<p><a href="#TCRunDir">Runs Directory ==</a></p>
</blockquote>
<p>Set the full or relative path to the location of the the TUFLOW HPC executable (including the name of the executable itself, with .exe extension) to be called by TUFLOW CATCH:</p>
<blockquote>
<p><a href="#TCHPCEXE">EXE ==</a></p>
</blockquote>
<p>Set the time format for output results. Given that the intention of TUFLOW CATCH is that it support addressing of longer term environmental investigations (i.e. not short term detailed ‘traditional’ flood studies), results written in hours format can be difficult to interpret in terms of seasonality, for example. As such, TUFLOW HPC can be instructed to write results in the date format adopted by TUFLOW FV. Doing so is strongly recommended, especially if TUFLOW FV is using the ISODATE format rather than hours:</p>
<blockquote>
<p><a href="#TCHPCTF">Time Format ==</a> TUFLOWFV</p>
</blockquote>
<p>Set the relationship between hours and dates. TUFLOW HPC reads boundary condition files and executes its internal computations using an hours (rather than date) timestamp, although this is being upgraded in the mid term. In order to coordinate simulation with TUFLOW FV, and to output results in date format, TUFLOW CATCH requires specification of the date that corresponds to zero hours in TUFLOW HPC boundary (and other) files. This command specifies that date at which boundary and other files refer to zero hours. Note the date time format expected, and that seconds is not a required field:</p>
<blockquote>
<p><a href="#TCHPCZDate">Zero Date ==</a> &lt;dd/mm/yyyy hh:mm&gt;</p>
</blockquote>
<p>Set TUFLOW HPC to write TUFLOW CATCH related map outputs (e.g. pollutant and other hydraulic xmdf outputs, see Section <font color="red">XXXX</font>). This catch command argument can be comma delimited with other outputs if required:</p>
<blockquote>
<p><a href="#TCHPCMapOut">Output Map Data Types ==</a> catch</p>
</blockquote>
<p>If TUFLOW CATCH is to be deployed in the pollutant export configuration (i.e. with no immediate intention to deploy TUFLOW FV, see Section <a href="Overview-1.html#Configs-2">1.3</a>), then the following must be set:</p>
<ul>
<li>The use of TUFLOW FV as a receiving model must be switched off. This is achieved by setting the receiving model block command as follows (see Section <a href="SimulationConstruction-1.html#SCTCCFV-3">4.5.4</a>):</li>
</ul>
<blockquote>
<p>Receiving Model == none</p>
</blockquote>
<p>AND</p>
<ul>
<li>A single polygon (either as a standalone file or as part of a previously specified geopackage) that covers the downstream receiving waters must be specified within the Catchment Hydraulic Model block. This polygon does not need any specific attributes. The TUFLOW HPC cells within this polygon will be removed from the TUFLOW HPC simulation. TUFLOW CATCH will not write any TUFLOW FV boundary condition blocks, but will write:
<ul>
<li>A single flow and concentration timeseries file (that would have been read by a TUFLOW FV boundary condition block if TUFLOW FV was deployed)</li>
<li>Summary timeseries files that describe total water and pollutant mass fluxes entering the defined polygon. These outputs can be useful for scenario to scenario comparisons, for example</li>
</ul></li>
</ul>
<blockquote>
<p>Receiving polygon == &lt;path to polygon or geopackage reference&gt;</p>
</blockquote>
<p>AND</p>
<ul>
<li>A list of pollutant names that are to be simulated by TUFLOW CATCH and the pollutant export model. These do not need to be TUFLOW FV keywords, and can be completely user defined</li>
</ul>
<blockquote>
<p>Pollutants == &lt;name1,name2,name3…&gt;</p>
</blockquote>
<p>TUFLOW CATCH will error if the above are not all specified correctly. Once specified, TUFLOW CATCH will check to ensure that all pollutants have been specified across material blocks (see Section <a href="SimulationConstruction-1.html#SCTCCPollExpPE-4">4.5.3.3</a>).</p>
<p>Following the issuing of these specific TUFLOW CATCH commands, a TUFLOW HPC model can be constructed in the same manner as a standalone model. In this regard:</p>
<ul>
<li>All TUFLOW HPC commands are recognised by TUFLOW CATCH and can be issued unchanged from the usage described in TUFLOW HPC’s manual and/or relevant release notes</li>
<li>TUFLOW HPC commands that reference other subsidiary control files (such as geometry control files, *.tgc etc.) need to use relative paths, and point to the locations with the TUFLOW directory created by the TUFLOW CATCH QGIS plugin, e.g.:</li>
</ul>
<blockquote>
<p>BC Database == ..\..\TUFLOW\bc_dbase\bc_dbase_001.csv</p>
</blockquote>
<ul>
<li>These subsidiary control files can then in turn use path references are per standalone TUFLOW HPC model construction (and point to locations within the same TUFLOW directory structure)</li>
<li>Variables can be set within the TUFLOW CATCH Catchment Hydraulic Model block for reference in any other subsidiary TUFLOW HPC files as per normal, e.g.:</li>
</ul>
<blockquote>
<p>Set Variable 2D_CELL_SIZE == 25</p>
</blockquote>
<ul>
<li>Scenarios and events can be set within the TUFLOW CATCH Catchment Hydraulic Model block for reference in any other subsidiary TUFLOW HPC file IF statements as per normal, e.g.:</li>
</ul>
<blockquote>
<p>Event == wet_year</p>
</blockquote>
<ul>
<li>Some commands issued in the Global Commands section of the TUFLOW CATCH control file can be overwritten in the Catchment Hydraulic Model block to tailor the TUFLOW HPC simulation, including:</li>
</ul>
<blockquote>
<p>GIS Format == GPKG <font color="green">! Use geopackage format for TUFLOW HPC but not TUFLOW FV </font><br>
GPKG Projection == ..\..\TUFLOW\model\gis\Projection.gpkg <font color="green">! Use a projection geopackage within the TUFLOW folder structure </font></p>
</blockquote>
<p>Current limitations of the TUFLOW CATCH with regard to setting up TUFLOW HPC simulations include:</p>
<ul>
<li>Whilst events and scenarios can be manually defined and referenced (see above), dynamic assignment of same (using tilda notation in filenames etc.) is not yet supported. Each event or scenario will need a new TUFLOW CATCH control file</li>
</ul>
<p>An example block of these Catchment Hydraulic Model block commands that together configure a TUFLOW HPC simulation within TUFLOW CATCH (with clarifying section headers as comments) is:</p>
<pre><code>!_________________________________________________________________
! CATCHMENT HYDRAULICS
Catchment Hydraulic Model == HPC

    ! Base runs directory and executable
    Runs Directory == ..\..\TUFLOW\runs
    EXE == C:\EXE\TUFLOW_iSP_w64.exe
    Time Format == TUFLOWFV
    Zero Date == 01/01/2021 00:00

    ! GIS
    GIS Format == GPKG
    GPKG Projection == ..\..\TUFLOW\model\gis\Projection.gpkg

    ! Solver
    HPC DP Check == OFF
    Solution scheme == HPC
    Timestep == 1                                    
    Timestep Maximum == 20     
    
    ! SGS Settings
    SGS == ON
    SGS Sample Target Distance == 1.    
    GRID Format == TIF
    
    ! Gridding
    Set Variable 2D_CELL_SIZE == 10
    
    ! Boundaries
    BC Database == ..\..\TUFLOW\bc_dbase\bc_dbase_001.csv
  
    ! Control files
    Geometry Control File == ..\..\TUFLOW\model\Demo.tgc
    BC Control File == ..\..\TUFLOW\model\Demo_001.tbc
    Read Materials File == ..\..\TUFLOW\model\materials.tmf 
    Read Soils File == ..\..\TUFLOW\model\Demo.tsoilf
    Soil Negative Rainfall Approach == FACTOR
    Set Variable HC == 10000
    Soil Negative Rainfall Factor == 0.2
    
    ! Ouput map configuration 
    Map Output Format == XMDF TIF 
    Map Output Data Types == catch 
    Map Output Interval == 300    
    TIF Map Output Interval == 0       
    TIF Map Output Data Types == h d dt   
    Grid Output Cell Size == &lt;&lt;2D_CELL_SIZE&gt;&gt;

    SGS Map Extent Trim == All
    SGS Depth Output == Cell Average
    Map Cutoff Depth == 0.01

End Catchment Hydraulic Model</code></pre>
</div>
<div id="SCTCCPollExp-3" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Pollutant export model commands<a href="SimulationConstruction-1.html#SCTCCPollExp-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This block of the TUFLOW CATCH control file contains commands that control pollutant export (and other constituent) simulation.</p>
<p>The pollutant model definition must be declared as a block that encloses all commands. This is analogous to the declaration of a catchment hydraulic model.</p>
<p>Set the beginning of the block, with command arguments as either mass accumulation release or none, and the end of the block (with no command arguments). The key phrase <em>mass accumulation release</em> activates all available pollutant export submodels. The keyword none turns off pollutant export simulation:</p>
<blockquote>
<p><a href="#TCCPEMS">Pollutant Export Model ==</a></p>
</blockquote>
<p><span class="math inline">\(\blockindent\)</span> …pollutant export model commands… <br>
<span class="math inline">\(\blockindent\)</span> …pollutant export model commands… <br>
<span class="math inline">\(\blockindent\)</span> …pollutant export model commands… <br></p>
<blockquote>
<p><a href="#TCCPEME">End Pollutant Export Model</a></p>
</blockquote>
<p>If pollutant export is simulated, then all pollutants (and constituents) declared in the receiving model (TUFLOW FV, and including all called modules such as Sediment Transport and Water Quality) must be accounted for with the correct name in the pollutant export block. Each must be assigned either:</p>
<ul>
<li>A constant value/concentration for application to receiving model boundary condition, or</li>
<li>A timeseries value/concentration for application to receiving model boundary conditions, or</li>
<li>A pollutant export model, with supporting parameters, for TUFLOW CATCH pollutant export simulation</li>
</ul>
<div id="SCTCCPollExpConst-4" class="section level4 hasAnchor" number="4.5.3.1">
<h4><span class="header-section-number">4.5.3.1</span> Constant<a href="SimulationConstruction-1.html#SCTCCPollExpConst-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Constant value/concentrations can be assigned when dynamic simulation is not required, such as for salinity or dissolved oxygen, for example. This specification is applied globally.</p>
<p>Set a constant value/concentration that is applied to downstream receiving model boundary condition files by TUFLOW CATCH. In doing so:</p>
<ul>
<li>The name needs to exactly match that configured by the receiving model, and</li>
<li>The concentration needs to be in the same units produced by the receiving model</li>
</ul>
<blockquote>
<p><a href="#TCPECons">Constant &lt;name&gt; ==</a> &lt;concentration to be applied&gt;</p>
</blockquote>
</div>
<div id="SCTCCPollExpTS-4" class="section level4 hasAnchor" number="4.5.3.2">
<h4><span class="header-section-number">4.5.3.2</span> Timeseries<a href="SimulationConstruction-1.html#SCTCCPollExpTS-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Timeseries values/concentrations can be assigned for which dynamic simulation is not required, but which values/concentrations likely vary in time. This might include water temperature specification, for example. This specification is applied globally.</p>
<p>Set a timeseries that is applied to downstream receiving model boundary condition files by TUFLOW CATCH. In doing so:</p>
<ul>
<li>The name needs to exactly match that of variable configured by the receiving model, and</li>
<li>The concentration needs to be in the same units produced by the receiving model</li>
</ul>
<blockquote>
<p><a href="#TCPETS">Time-series &lt;name&gt; ==</a> &lt;bc name&gt;</p>
</blockquote>
<p>The &lt;bc name&gt; field refers to a name declared in the TUFLOW HPC boundary condition database. For example, ‘temperature_davg’, with the corresponding database entry being (in a database simplified for this example):</p>
<pre><code>Name,Source,Column 1,Column 2,Add Col 1,Mult Col 2,Add Col 2,Column 3,Column 4
temperature_davg,temperature_2021.csv,TUFLOW_Time,Airtemp,,,,,</code></pre>
</div>
<div id="SCTCCPollExpPE-4" class="section level4 hasAnchor" number="4.5.3.3">
<h4><span class="header-section-number">4.5.3.3</span> Pollutant export<a href="SimulationConstruction-1.html#SCTCCPollExpPE-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pollutant export models can be configured within TUFLOW CATCH to simulate the release of pollutants from the ground surface across the TUFLOW HPC model domain. This export is a core intention and capability of TUFLOW CATCH and can be configured as uniform or spatially varied across the TUFLOW HPC domain. Any nonuniform spatial definition uses the material numbers (and corresponding spatial distributions) already configured in the TUFLOW HPC model (i.e. the catchment hydraulic model block described above) and affects this through specification of material blocks in this part of the TUFLOW CATCH control file. These blocks are similar to those deployed by TUFLOW FV.</p>
<p>Configure default (or spatially uniform) pollutant export:</p>
<blockquote>
<p><a href="#TCCPEAllMatS">Material ==</a> all</p>
</blockquote>
<p><span class="math inline">\(\blockindent\)</span> …commands… <br>
<span class="math inline">\(\blockindent\)</span> …commands… <br>
<span class="math inline">\(\blockindent\)</span> …commands… <br></p>
<blockquote>
<p><a href="#TCCPEAllMatE">End Material</a></p>
</blockquote>
<p>Once these uniform conditions have been set, progressive specifications of material by material pollutant behaviour can be set. These specifications overwrite previous settings on a spatial basis. This stamping-style approach is akin to the way in which digital elevation model inputs can be progressively updated within TUFLOW HPC and TUFLOW FV by specifying a suite of elevation data that overwite each other on a sptail basis. In the case of pollutant export properties, this stamping is affected by specifying subsequent material blocks that relate to individual or multiple materials. Up to ten comma separated materials can be specified in one material block:</p>
<blockquote>
<p><a href="#TCCPEStmpMatS">Material ==</a> MatID1, MatID2, MatID3…, MatID10</p>
</blockquote>
<p><span class="math inline">\(\blockindent\)</span> …commands… <br>
<span class="math inline">\(\blockindent\)</span> …commands… <br>
<span class="math inline">\(\blockindent\)</span> …commands… <br></p>
<blockquote>
<p><a href="#TCCPEStmpMatE">End Material</a></p>
</blockquote>
<p>Once all material specifications have been processed, TUFLOW CATCH will check that all pollutants have had all export properties specified for the entire TUFLOW HPC domain (i.e. every computational grid cell). This includes accounting for constant and timeseries specifications (which are global and do not need to be applied within material blocks). Using the ‘all’ command argument in the first material block specified and providing information for every pollutant required within that block (and then progressively spatially refining) ensures this will be true. Once the initial uniform material specification has been made, not every pollutant needs to be specified in every subsequent material block - only alterations to the uniform conditions need be made.</p>
<p>Each line within a material block contains a suite of arguments (in the form command==argument, command==argument… etc.), the first of which is always a keyword flagging the model to be used. Although there are some commonalities in subsequent inline commands, these differ according to the pollutant export model specified, as follows. Different pollutant export models can be specified for different pollutants within the same material block if required.</p>
<div id="SCTCCPollExpAW-5" class="section level5 hasAnchor" number="4.5.3.3.1">
<h5><span class="header-section-number">4.5.3.3.1</span> Accumulation and washoff<a href="SimulationConstruction-1.html#SCTCCPollExpAW-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Set the model and parameters for the pollutant accumulation and washoff model (see Section <a href="ProcessDescriptions-1.html#ProcessDescriptionsAccWO-3">3.2.3</a>). All parameters are mandatory:</p>
<blockquote>
<p>&lt;name&gt;, method==rate, rate==&lt;float&gt;, limit==&lt;float&gt;, timeConstant==&lt;float&gt;, rainThreshold==&lt;float&gt;, depthThreshold==&lt;float&gt;</p>
</blockquote>
<p>The &lt;name&gt; field must correspond to a name designated by TUFLOW FV. The parameters are:</p>
<ul>
<li>method: keyword ‘rate’ that activates the accumulation washoff model</li>
<li>rate: the areal rate at which the pollutant accumulates (kg/ha/year)</li>
<li>limit: the maximum areal mass that can accumulate in the dry store (kg/ha)</li>
<li>timeConstant: a time parameter controlling the pollutant dry store release rate, according to Equation <a href="ProcessDescriptions-1.html#eq:equ-wo">(3.1)</a> (s)</li>
<li>rainThreshold: the minimum rain rate required to activate release from the dry store (mm/hr)</li>
<li>depthThreshold: the minimum water depth in a cell required to activate release from the dry store (m)</li>
</ul>
<p>An example for dissolved organic carbon might be:</p>
<pre><code>WQ_DOC_MG_L, method==rate, rate==21.446, limit==21.446, timeConstant==3600, rainThreshold==1.0,  depthThreshold==0.020</code></pre>
</div>
<div id="SCTCCPollExpSS-5" class="section level5 hasAnchor" number="4.5.3.3.2">
<h5><span class="header-section-number">4.5.3.3.2</span> Shear Stress<a href="SimulationConstruction-1.html#SCTCCPollExpSS-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Set the model and parameters for the shear stress model (see Section <a href="ProcessDescriptions-1.html#ProcessDescriptionsSS-3">3.2.4</a>). All parameters are mandatory:</p>
<blockquote>
<p>&lt;name&gt;, method==sed1, rate==&lt;not used&gt;, limit==&lt;float&gt;, depositionStress==&lt;float&gt;, erosionStress==&lt;float&gt;, depthThreshold==&lt;float&gt;, depositionVelocity==&lt;float&gt;, erosionRate==&lt;float&gt;</p>
</blockquote>
<p>The &lt;name&gt; field must correspond to a name designated by TUFLOW FV. The parameters are:</p>
<ul>
<li>method: keyword ‘sed1’ that activates the shear stress model</li>
<li>rate: not used, but listed for consistency</li>
<li>limit: the maximum erosion or deposition that can occur in a cell. Always a positive number (kg/ha)</li>
<li>depositionStress: the maximum shear stress for which deposition can occur. Shear stresses below this limit will allow for deposition to occur, according to Equation <a href="ProcessDescriptions-1.html#eq:equ-krone-dp">(3.3)</a>. Should always be less than the specified erosionStress (N/m<span class="math inline">\(^2\)</span>)</li>
<li>erosionStress: the minimum shear stress for which erosion can occur. Shear stresses above this limit will allow for erosion to occur, according to Equation <a href="ProcessDescriptions-1.html#eq:equ-mehta-er">(3.2)</a>. Should always be greater than the specified depositionStress (N/m<span class="math inline">\(^2\)</span>)</li>
<li>depthThreshold: the minimum water depth in a cell required to activate release from the dry store (m)</li>
<li>depositionVelocity: the velocity at which pollutant in the wet store settles. Used to calculate the mass of pollutant transferred back from the wet to dry store in a model timestep, according to Equation <a href="ProcessDescriptions-1.html#eq:equ-krone-dp">(3.3)</a> (m/s)</li>
<li>erosionRate: The maximum rate of erosion of pollutant from the dry store, if erosion conditions are met, according to Equation <a href="ProcessDescriptions-1.html#eq:equ-mehta-er">(3.2)</a> (N/m<span class="math inline">\(^2\)</span>)</li>
</ul>
<p>An example for suspended sediment might be:</p>
<pre><code>SED_TSS, method==sed1, rate==0.0, limit==1000.0, depthThreshold==0.02, depositionstress==0.01, erosionstress==0.5, depositionvelocity==1.2e-05, erosionrate==0.002
</code></pre>
<p>An example for a complete material block might be:</p>
<pre><code>Material == 1,4
    SED_TSS, method==sed1, rate==0.0, limit==1000.0, depthThreshold==0.02, depositionstress==0.01, erosionstress==0.5, depositionvelocity==1.2e-05, erosionrate==0.001
    WQ_DOC_MG_L, method==rate, rate==21.446, limit==21.446, timeConstant==3600, rainThreshold==1.0,  depthThreshold==0.020
End Material</code></pre>
</div>
</div>
<div id="SCTCCPollExpPT-4" class="section level4 hasAnchor" number="4.5.3.4">
<h4><span class="header-section-number">4.5.3.4</span> Pollutant transport<a href="SimulationConstruction-1.html#SCTCCPollExpPT-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Once released, pollutants are transported in the surface using TUFLOW’s advection dispersion module. Pollutants are treated as passive tracers and do not undergo non-conservative transformation, other than that allowed by the pollutant export models described above.</p>
<p>If soils have been included in the TUFLOW HPC simulation and infiltration of water occurs, then this water takes with it any previously released pollutants and continues to advect these in the subsurface as it does water. Similarly, if TUFLOW HPC predicts that water travelling in soil layers intersects the ground surface, then any included pollutants are returned to the surface wet store and advected and dispersed as normal. If a particular pollutant is not required to infiltrate from the surface to subsurface, then this infiltration can be turned off (default is on). This is intended to be set as off for particulate pollutants, although is user definable:</p>
<blockquote>
<p><a href="#TCHPCInfil">Infiltration &lt;name&gt; ==</a> off</p>
</blockquote>
<p>An example block of these Pollutant Export Model block commands within TUFLOW CATCH (with clarifying section headers as comments) is:</p>
<pre><code>! _________________________________________________________________
! POLLUTANT EXPORT
Catchment Pollutant Export Model == mass accumulation release

    ! Constant concentrations
    Constant Salinity == 0.0
    Constant WQ_DISS_OXYGEN_MG_L == 8.0
  
    ! Timeseries
    Time-series Temperature == temperature
  
    ! Prohibited infiltrations
    Infiltration SED_TSS == Off
    Infiltration WQ_POC_MG_L == Off
    Infiltration WQ_PON_MG_L == Off
    Infiltration WQ_POP_MG_L == Off
    
    Material == all  
        SED_TSS,          method==sed1, rate==0.0,    limit==1000.0,    depthThreshold==0.02, depositionstress==0.01, erosionstress==0.5, depositionvelocity==1.2e-05, erosionrate==0.001
        WQ_AMMONIUM_MG_L, method==rate, rate==0.273,  limit==0.273,  timeConstant==3600, rainThreshold==1.0,  depthThreshold==0.020
        WQ_NITRATE_MG_L,  method==rate, rate==0.662,  limit==0.662,  timeConstant==3600, rainThreshold==1.0,  depthThreshold==0.020
        WQ_FRP_MG_L,      method==rate, rate==0.010,  limit==0.010,  timeConstant==3600, rainThreshold==1.0,  depthThreshold==0.020
        WQ_DOC_MG_L,      method==rate, rate==21.446, limit==21.446, timeConstant==3600, rainThreshold==1.0,  depthThreshold==0.020
        WQ_DON_MG_L,      method==rate, rate==1.021,  limit==1.021,  timeConstant==3600, rainThreshold==1.0,  depthThreshold==0.020
        WQ_DOP_MG_L,      method==rate, rate==0.005,  limit==0.005,  timeConstant==3600, rainThreshold==1.0,  depthThreshold==0.020
        WQ_POC_MG_L,      method==rate, rate==12.154, limit==12.154, timeConstant==3600, rainThreshold==1.0,  depthThreshold==0.020
        WQ_PON_MG_L,      method==rate, rate==1.044,  limit==1.044,  timeConstant==3600, rainThreshold==1.0,  depthThreshold==0.020
        WQ_POP_MG_L,      method==rate, rate==0.061,  limit==0.061,  timeConstant==3600, rainThreshold==1.0,  depthThreshold==0.020
    End Material

    Material == 2       
        SED_TSS,          method==sed1, rate==0.0,    limit==2000.0,    depthThreshold==0.002, depositionstress==0.001, erosionstress==0.05, depositionvelocity==1.2e-05, erosionrate==0.1
        WQ_AMMONIUM_MG_L, method==rate, rate==2.0,  limit==20.0,  timeConstant==30, rainThreshold==0.1,  depthThreshold==0.002
        WQ_NITRATE_MG_L,  method==rate, rate==5.0,  limit==50.0,  timeConstant==60, rainThreshold==0.1,  depthThreshold==0.002
    End Material

    Material == 3,5      
        WQ_DOP_MG_L,      method==rate, rate==0.5,  limit==0.5,  timeConstant==300, rainThreshold==10.0,  depthThreshold==0.120
    End Material

End Catchment Pollutant Export Model
</code></pre>
</div>
</div>
<div id="SCTCCFV-3" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Receiving model (TUFLOW FV) commands<a href="SimulationConstruction-1.html#SCTCCFV-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This block of the TUFLOW CATCH control file contains commands that construct a TUFLOW FV simulation. These commands are almost entirely those that would be used in setting up a standalone TUFLOW FV control file (*.fvc), with a small number of additional commands that relate to TUFLOW CATCH.</p>
<p>The receiving model definition must be declared as a block that encloses all TUFLOW CATCH and TUFLOW FV commands.</p>
<p>Set the beginning of the block, with command arguments as either TUFLOWFV or none, and the end of the block (with no command arguments):</p>
<blockquote>
<p><a href="#TCRS">Receiving Model ==</a></p>
</blockquote>
<p><span class="math inline">\(\blockindent\)</span> …receiving model commands… <br>
<span class="math inline">\(\blockindent\)</span> …receiving model commands… <br>
<span class="math inline">\(\blockindent\)</span> …receiving model commands… <br></p>
<blockquote>
<p><a href="#TCRME">End Receiving Model</a></p>
</blockquote>
<p>If the <a href="#TCRMS">Receiving Model</a> command is set to none, then receiving simulation is not executed. This approach might be adopted for the initial stages of a TUFLOW FV model build, for example. The TUFLOW CATCH commands contained within this Receiving Model block are described following, and all are mandatory.</p>
<p>Set the directory from which TUFLOW CATCH controls TUFLOW FV. Unless there is a need to the contrary, this should be set as a relative path to the TUFLOWFVdirectory set up by the TUFLOW CATCH QGIS plugin, i.e. ..\..\TUFLOWFV\runs. Setting this to any other directory is not recommended:</p>
<blockquote>
<p><a href="#TCFVRunDir">Runs Directory ==</a></p>
</blockquote>
<p>Set the full or relative path to the location of the the TUFLOW FV executable (including the name of the executable itself, with .exe extension) to be called by TUFLOW CATCH:</p>
<blockquote>
<p><a href="#TCFVEXE">EXE ==</a></p>
</blockquote>
<p>All TUFLOW FV boundary condition files generated by TUFLOW CATCH are QC type (cell inflow, ‘lateral’, and do not transfer momentum to TUFLOW FV) unless specified otherwise as nodestring (Q type, and do transfer momentum to TUFLOW FV) inflows. All such nodestring inflows need to be drawn as line type objects in a single GIS file and this file declared in the receiving model block as:</p>
<blockquote>
<p><a href="#TCFVnstring">Catchment BC Nodestring ==</a> &lt;path to GIS nodestring file&gt;</p>
</blockquote>
<p>Following the issuing of these specific TUFLOW CATCH commands, a TUFLOW FV model can be constructed in the same manner as a standalone model. In this regard:</p>
<ul>
<li>All TUFLOW FV commands are recognised by TUFLOW CATCH and can be issued unchanged from the usage described in TUFLOW FV’s manual and/or relevant release notes</li>
<li>TUFLOW FV commands that reference other subsidiary control files (such as geometry control files, *.tgc etc.) or GIS files need to use relative paths, and point to the locations with the TUFLOWFV directory created by the TUFLOW CATCH QGIS plugin, e.g.:</li>
</ul>
<blockquote>
<p>Sediment control file == ..\..\TUFLOWFV\stm\Demo.fvsed</p>
</blockquote>
<ul>
<li>These subsidiary control files can then in turn use path references are per standalone TUFLOW FV model construction (and point to locations within the same TUFLOWFV directory structure)</li>
<li>Include command calls are supported, as relative references to the TUFLOWFV folder should be used</li>
</ul>
<p><img src="images/WQFooter.jpg" width="100%" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ProcessDescriptions-1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": false,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
