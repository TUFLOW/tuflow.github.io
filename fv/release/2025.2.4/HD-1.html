<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 2 Hydrodynamic Engine Updates and Enhancements | TUFLOW FV 2025.2.4 Release Notes</title>
  <meta name="description" content="TUFLOW FV 2025.2.0 Release Notes" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 2 Hydrodynamic Engine Updates and Enhancements | TUFLOW FV 2025.2.4 Release Notes" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/1024in300px_Blue-01.svg" />
  <meta property="og:description" content="TUFLOW FV 2025.2.0 Release Notes" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 2 Hydrodynamic Engine Updates and Enhancements | TUFLOW FV 2025.2.4 Release Notes" />
  
  <meta name="twitter:description" content="TUFLOW FV 2025.2.0 Release Notes" />
  <meta name="twitter:image" content="/images/1024in300px_Blue-01.svg" />

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/TUFLOW.ico" type="image/x-icon" />
<link rel="prev" href="SimManagment-1.html"/>
<link rel="next" href="VMM-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://www.tuflow.com"><img src="images/1024in300px_Blue-01.svg" style="width:246px;height:68px;"></a></li>

<li class="divider"></li>
<li><a href="index.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#document-updates-and-important-notices"><i class="fa fa-check"></i>Document Updates and Important Notices</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#summary"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#using-the-release-notes-and-user-manuals"><i class="fa fa-check"></i>Using the Release Notes and User Manuals</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#changes-to-tuflow-fv-version-numbering"><i class="fa fa-check"></i>Changes to TUFLOW FV Version Numbering</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="SimManagment-1.html"><a href="SimManagment-1.html"><i class="fa fa-check"></i><b>1</b> Simulation Management</a>
<ul>
<li class="chapter" data-level="1.1" data-path="SimManagment-1.html"><a href="SimManagment-1.html#SimManagmentFeatures-2"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="SimManagment-1.html"><a href="SimManagment-1.html#SimManagmentNomenclature-2"><i class="fa fa-check"></i><b>1.2</b> Nomenclature</a></li>
<li class="chapter" data-level="1.3" data-path="SimManagment-1.html"><a href="SimManagment-1.html#SimManagmentEvents-2"><i class="fa fa-check"></i><b>1.3</b> Events</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="SimManagment-1.html"><a href="SimManagment-1.html#SimManagmentTEF-3"><i class="fa fa-check"></i><b>1.3.1</b> TUFLOW Event File</a></li>
<li class="chapter" data-level="1.3.2" data-path="SimManagment-1.html"><a href="SimManagment-1.html#SimManagmentRunningEvents-3"><i class="fa fa-check"></i><b>1.3.2</b> Running Events</a></li>
<li class="chapter" data-level="1.3.3" data-path="SimManagment-1.html"><a href="SimManagment-1.html#SimManagmentEventExamples-3"><i class="fa fa-check"></i><b>1.3.3</b> Event Examples</a></li>
<li class="chapter" data-level="1.3.4" data-path="SimManagment-1.html"><a href="SimManagment-1.html#additional-functionality"><i class="fa fa-check"></i><b>1.3.4</b> Additional Functionality</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="SimManagment-1.html"><a href="SimManagment-1.html#SimManagmentScenarios-2"><i class="fa fa-check"></i><b>1.4</b> Scenarios</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="SimManagment-1.html"><a href="SimManagment-1.html#SimManagmentRunningScenarios-3"><i class="fa fa-check"></i><b>1.4.1</b> Running Scenarios</a></li>
<li class="chapter" data-level="1.4.2" data-path="SimManagment-1.html"><a href="SimManagment-1.html#SimManagmentScenarioExamples-3"><i class="fa fa-check"></i><b>1.4.2</b> Scenario Examples</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="SimManagment-1.html"><a href="SimManagment-1.html#SimManagmentVariables-2"><i class="fa fa-check"></i><b>1.5</b> Variables</a></li>
<li class="chapter" data-level="1.6" data-path="SimManagment-1.html"><a href="SimManagment-1.html#SimManagmentExamples-2"><i class="fa fa-check"></i><b>1.6</b> Simulation Management Example Models</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="HD-1.html"><a href="HD-1.html"><i class="fa fa-check"></i><b>2</b> Hydrodynamic Engine Updates and Enhancements</a>
<ul>
<li class="chapter" data-level="2.1" data-path="HD-1.html"><a href="HD-1.html#HDBCHeaders-2"><i class="fa fa-check"></i><b>2.1</b> BC Headers</a></li>
<li class="chapter" data-level="2.2" data-path="HD-1.html"><a href="HD-1.html#HDGIS-2"><i class="fa fa-check"></i><b>2.2</b> GIS Integration Enhancements</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="HD-1.html"><a href="HD-1.html#HDGISTIN-3"><i class="fa fa-check"></i><b>2.2.1</b> TIN Bathymetry Assignment</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="HD-1.html"><a href="HD-1.html#HDStructures-2"><i class="fa fa-check"></i><b>2.3</b> Hydraulic Structure Updates</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="HD-1.html"><a href="HD-1.html#HDCulvertHeighWidthContraction-3"><i class="fa fa-check"></i><b>2.3.1</b> Default Culvert Height And Width Contraction Coefficients</a></li>
<li class="chapter" data-level="2.3.2" data-path="HD-1.html"><a href="HD-1.html#HDCulvertEntExLoss-3"><i class="fa fa-check"></i><b>2.3.2</b> Default Culvert Entry and Exit Loss Coefficients</a></li>
<li class="chapter" data-level="2.3.3" data-path="HD-1.html"><a href="HD-1.html#HDCulvertInvertChecking-3"><i class="fa fa-check"></i><b>2.3.3</b> Improved Culvert Invert Checking</a></li>
<li class="chapter" data-level="2.3.7" data-path="HD-1.html"><a href="HD-1.html#HDTriggerRule-3"><i class="fa fa-check"></i><b>2.3.7</b> Control Block Trigger Rule Fix</a></li>
<li class="chapter" data-level="2.3.8" data-path="HD-1.html"><a href="HD-1.html#HDPSLSF-3"><i class="fa fa-check"></i><b>2.3.8</b> Porous Structure Linked Structure Fixes</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="HD-1.html"><a href="HD-1.html#HDMassBalance-2"><i class="fa fa-check"></i><b>2.4</b> Mass Balance</a></li>
<li class="chapter" data-level="2.4.1" data-path="HD-1.html"><a href="HD-1.html#HDMassBalance-WL_CURT-3"><i class="fa fa-check"></i><b>2.4.1</b> Mass Balance WL_CURT Support</a></li>
<li class="chapter" data-level="2.5" data-path="HD-1.html"><a href="HD-1.html#HDMinorEnhancements-2"><i class="fa fa-check"></i><b>2.5</b> Minor Enhancements and Fixes</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="HD-1.html"><a href="HD-1.html#HDExTurbScaling-3"><i class="fa fa-check"></i><b>2.5.1</b> External Turbulence Scaling</a></li>
<li class="chapter" data-level="2.5.2" data-path="HD-1.html"><a href="HD-1.html#HDDVProduct-3"><i class="fa fa-check"></i><b>2.5.2</b> Depth Velocity Product Output Parameter</a></li>
<li class="chapter" data-level="2.5.3" data-path="HD-1.html"><a href="HD-1.html#HDPointOutputParameters-3"><i class="fa fa-check"></i><b>2.5.3</b> Additional Point Output Parameters Supported</a></li>
<li class="chapter" data-level="2.5.4" data-path="HD-1.html"><a href="HD-1.html#HDBCOverlap-3"><i class="fa fa-check"></i><b>2.5.4</b> Improved Boundary Nodestring Overlap Checking</a></li>
<li class="chapter" data-level="2.5.5" data-path="HD-1.html"><a href="HD-1.html#HDGPUErrorFix-3"><i class="fa fa-check"></i><b>2.5.5</b> GPU 3D Drying Z Layer Message Fix</a></li>
<li class="chapter" data-level="2.5.6" data-path="HD-1.html"><a href="HD-1.html#HDDuplicateFluxFile-3"><i class="fa fa-check"></i><b>2.5.6</b> Duplicate Flux File Fix</a></li>
<li class="chapter" data-level="2.5.7" data-path="HD-1.html"><a href="HD-1.html#HDDepthAverageTURBZ-3"><i class="fa fa-check"></i><b>2.5.7</b> Turbulence Map Output Fix</a></li>
<li class="chapter" data-level="2.5.8" data-path="HD-1.html"><a href="HD-1.html#HDFluxOutputHeader-3"><i class="fa fa-check"></i><b>2.5.8</b> Flux Output Header Fix</a></li>
<li class="chapter" data-level="2.5.9" data-path="HD-1.html"><a href="HD-1.html#HD2dmOutputFix-3"><i class="fa fa-check"></i><b>2.5.9</b> Structured Mesh Check File Fix</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="VMM-1.html"><a href="VMM-1.html"><i class="fa fa-check"></i><b>3</b> Internal Vertical Mixing Model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="VMM-1.html"><a href="VMM-1.html#VMM-Intr-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="VMM-1.html"><a href="VMM-1.html#VMM-KEVMM-2"><i class="fa fa-check"></i><b>3.2</b> <em>k-ε</em> Vertical Mixing Model</a></li>
<li class="chapter" data-level="3.3" data-path="VMM-1.html"><a href="VMM-1.html#VMM-KOVMM-2"><i class="fa fa-check"></i><b>3.3</b> <em>k-ω</em> Vertical Mixing Model</a></li>
<li class="chapter" data-level="3.4" data-path="VMM-1.html"><a href="VMM-1.html#VMM-UVSFF-2"><i class="fa fa-check"></i><b>3.4</b> Unstratified vs. Stratified Flow Fields</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="VMM-1.html"><a href="VMM-1.html#VMM-UVSFF-SOM-3"><i class="fa fa-check"></i><b>3.4.1</b> Second Order Model</a></li>
<li class="chapter" data-level="3.4.2" data-path="VMM-1.html"><a href="VMM-1.html#VMM-UVSFF-LL-3"><i class="fa fa-check"></i><b>3.4.2</b> Lengthscale Limiter</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="VMM-1.html"><a href="VMM-1.html#VMM-IWMM-2"><i class="fa fa-check"></i><b>3.5</b> Internal Wave Mixing Model</a></li>
<li class="chapter" data-level="3.6" data-path="VMM-1.html"><a href="VMM-1.html#VMM-Refe-2"><i class="fa fa-check"></i><b>3.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="AD-1.html"><a href="AD-1.html"><i class="fa fa-check"></i><b>4</b> Advection Dispersion Module</a>
<ul>
<li class="chapter" data-level="4.1" data-path="AD-1.html"><a href="AD-1.html#ADMinorEnhancements-2"><i class="fa fa-check"></i><b>4.1</b> Minor Enhancements and Fixes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="AD-1.html"><a href="AD-1.html#ADOBCF-2"><i class="fa fa-check"></i><b>4.1.1</b> Fully Specified Grid Boundary Fix</a></li>
</ul></li>
<li class="chapter" data-level="4.1.2" data-path="AD-1.html"><a href="AD-1.html#HDDUSTF-3"><i class="fa fa-check"></i><b>4.1.2</b> Destratification Unit Scalar Transport Fix</a></li>
<li class="chapter" data-level="4.2" data-path="AD-1.html"><a href="AD-1.html#ADMassBalance-2"><i class="fa fa-check"></i><b>4.2</b> Mass Balance</a></li>
<li class="chapter" data-level="4.2.1" data-path="AD-1.html"><a href="AD-1.html#ADMassBalance-WL_CURT-3"><i class="fa fa-check"></i><b>4.2.1</b> Mass Balance WL_CURT Support</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ST-1.html"><a href="ST-1.html"><i class="fa fa-check"></i><b>5</b> Sediment Transport Module</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ST-1.html"><a href="ST-1.html#STMassBalance-2"><i class="fa fa-check"></i><b>5.1</b> Mass Balance</a></li>
<li class="chapter" data-level="5.2" data-path="ST-1.html"><a href="ST-1.html#STMassBalance-WL_CURT-3"><i class="fa fa-check"></i><b>5.2</b> Mass Balance WL_CURT Support</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="WQ-1.html"><a href="WQ-1.html"><i class="fa fa-check"></i><b>6</b> Water Quality Module</a>
<ul>
<li class="chapter" data-level="6.1" data-path="WQ-1.html"><a href="WQ-1.html#WQMassBalance-2"><i class="fa fa-check"></i><b>6.1</b> Mass Balance</a></li>
<li class="chapter" data-level="6.1.1" data-path="WQ-1.html"><a href="WQ-1.html#WQMassBalance-WL_CURT-3"><i class="fa fa-check"></i><b>6.1.1</b> Mass Balance WL_CURT Support</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="PT-1.html"><a href="PT-1.html"><i class="fa fa-check"></i><b>7</b> Particle Tracking Module</a>
<ul>
<li class="chapter" data-level="7.1" data-path="PT-1.html"><a href="PT-1.html#PTMinorEnhancements-2"><i class="fa fa-check"></i><b>7.1</b> Minor Enhancements and Fixes</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="PT-1.html"><a href="PT-1.html#PTMultipleGroupFix-3"><i class="fa fa-check"></i><b>7.1.1</b> Multiple Particle Groups Fix</a></li>
<li class="chapter" data-level="7.1.2" data-path="PT-1.html"><a href="PT-1.html#PTSCPPF-3"><i class="fa fa-check"></i><b>7.1.2</b> Spherical Coordinate Particle Position Fix</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Tools-1.html"><a href="Tools-1.html"><i class="fa fa-check"></i><b>8</b> Visualisation and Model Development Tools</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Tools-1.html"><a href="Tools-1.html#xmdf-and-netcdf-file-locking-hdf5-compatibility-issues"><i class="fa fa-check"></i><b>8.1</b> XMDF and NetCDF File Locking (HDF5 Compatibility Issues)</a></li>
<li class="chapter" data-level="8.2" data-path="Tools-1.html"><a href="Tools-1.html#ToolsGetTools-2"><i class="fa fa-check"></i><b>8.2</b> TUFLOW FV Boundary Condition Tools</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Support-1.html"><a href="Support-1.html"><i class="fa fa-check"></i><b>9</b> User Manuals, Tutorials and Supporting Materials</a>
<ul>
<li class="chapter" data-level="9.1" data-path="Support-1.html"><a href="Support-1.html#SupportTutorialModels-2"><i class="fa fa-check"></i><b>9.1</b> Updated Tutorial Models</a></li>
<li class="chapter" data-level="9.2" data-path="Support-1.html"><a href="Support-1.html#SupportExampleModels-2"><i class="fa fa-check"></i><b>9.2</b> New Example Models</a></li>
<li class="chapter" data-level="9.3" data-path="Support-1.html"><a href="Support-1.html#SupportTUFLOWFVWiki-2"><i class="fa fa-check"></i><b>9.3</b> TUFLOW FV Wiki Updates</a></li>
<li class="chapter" data-level="9.4" data-path="Support-1.html"><a href="Support-1.html#SupportUserManuals-2"><i class="fa fa-check"></i><b>9.4</b> User Manuals</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="LicensingInstallation-1.html"><a href="LicensingInstallation-1.html"><i class="fa fa-check"></i><b>10</b> Licensing</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="App-VMMS-1.html"><a href="App-VMMS-1.html"><i class="fa fa-check"></i><b>A</b> Vertical Mixing Model Science</a>
<ul>
<li class="chapter" data-level="A.1" data-path="App-VMMS-1.html"><a href="App-VMMS-1.html#App-VMMS-KEMS-2"><i class="fa fa-check"></i><b>A.1</b> K-Epsilon Model Science</a></li>
<li class="chapter" data-level="A.2" data-path="App-VMMS-1.html"><a href="App-VMMS-1.html#App-VMMS-KOMS-2"><i class="fa fa-check"></i><b>A.2</b> K-Omega Model Science</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="App-VMMS-1.html"><a href="App-VMMS-1.html#tab-C3ModelParameters"><i class="fa fa-check"></i><b>A.2.1</b> Table: Model Parameters C<sub>3</sub> for <em>k</em>-ε and <em>k</em>-ω Models</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="App-VMMS-1.html"><a href="App-VMMS-1.html#App-VMMS-SOMS-2"><i class="fa fa-check"></i><b>A.3</b> Second Order Model Science</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="App-VMMS-1.html"><a href="App-VMMS-1.html#tab-SOParameterGroups"><i class="fa fa-check"></i><b>A.3.1</b> Table: Empirical Parameters Group in Second-Order Turbulence Model</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="App-VMMS-1.html"><a href="App-VMMS-1.html#App-VMMS-Refe-2"><i class="fa fa-check"></i><b>A.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="App-VMMB-1.html"><a href="App-VMMB-1.html"><i class="fa fa-check"></i><b>B</b> Vertical Mixing Model Benchmarking</a>
<ul>
<li class="chapter" data-level="B.1" data-path="App-VMMB-1.html"><a href="App-VMMB-1.html#App-VMMB-Over-2"><i class="fa fa-check"></i><b>B.1</b> Overview</a></li>
<li class="chapter" data-level="B.2" data-path="App-VMMB-1.html"><a href="App-VMMB-1.html#App-VMMB-OCF-2"><i class="fa fa-check"></i><b>B.2</b> Open Channel Flow</a></li>
<li class="chapter" data-level="B.3" data-path="App-VMMB-1.html"><a href="App-VMMB-1.html#App-VMMB-WC-2"><i class="fa fa-check"></i><b>B.3</b> Wind Circulation</a></li>
<li class="chapter" data-level="B.4" data-path="App-VMMB-1.html"><a href="App-VMMB-1.html#App-VMMB-EOWML-2"><i class="fa fa-check"></i><b>B.4</b> Entrainment Of Wind Mixed Layer</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="App-VMMB-1.html"><a href="App-VMMB-1.html#wind-entrainment-with-coriolis-forcing"><i class="fa fa-check"></i><b>B.4.1</b> Wind Entrainment With Coriolis Forcing</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="App-VMMB-1.html"><a href="App-VMMB-1.html#App-VMMB-Refe-2"><i class="fa fa-check"></i><b>B.5</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.tuflow.com"><img src="images/1024in300px_Blue-01.svg" style="width:246px;height:68px;"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><h0 style="color:rgb(0,85,129);">TUFLOW FV 2025.2.4 Release Notes</h0></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="HD-1" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Section 2</span> Hydrodynamic Engine Updates and Enhancements<a href="HD-1.html#HD-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p class="wmark before">
</p>
<div id="HDBCHeaders-2" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> BC Headers<a href="HD-1.html#HDBCHeaders-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Within a BC block users can now specify boundary condition headers, scale and offset commands independently for hydrodynamics, sediment, tracers and water quality. This decouples the previous single line ordering required for specification of these quantities across modules. This effective subdivision of a previous single BC block’s commands is:</p>
<ul>
<li>Hydrodynamics
<ul>
<li><tcmd>BC Header</tcmd><teq> ==</teq></li>
<li><tcmd>BC Scale</tcmd><teq> ==</teq></li>
<li><tcmd>BC Offset</tcmd><teq> ==</teq></li>
<li><tcmd>BC Default</tcmd><teq> ==</teq></li>
</ul></li>
<li>Sediment
<ul>
<li><tcmd>Sed Header</tcmd><teq> ==</teq></li>
<li><tcmd>Sed Scale</tcmd><teq> ==</teq></li>
<li><tcmd>Sed Offset</tcmd><teq> ==</teq></li>
<li><tcmd>Sed Default</tcmd><teq> ==</teq></li>
</ul></li>
<li>Tracer
<ul>
<li><tcmd>Trace Header</tcmd><teq> ==</teq></li>
<li><tcmd>Trace Scale</tcmd><teq> ==</teq></li>
<li><tcmd>Trace Offset</tcmd><teq> ==</teq></li>
<li><tcmd>Trace Default</tcmd><teq> ==</teq></li>
</ul></li>
<li>Water Quality
<ul>
<li><tcmd>WQ Header</tcmd><teq> ==</teq></li>
<li><tcmd>WQ Scale</tcmd><teq> ==</teq></li>
<li><tcmd>WQ Offset</tcmd><teq> ==</teq></li>
<li><tcmd>WQ Default</tcmd><teq> ==</teq></li>
</ul></li>
</ul>
<p>For example, if a model uses the QC boundary condition type, with salinity, temperature, one sediment fraction, one tracer, and one water quality constituent included, the legacy BC block would be written as shown in the below example.</p>
<p><tcmd>BC</tcmd><teq> == </teq><tblk>QC, STP_Outfall, ..\bc_dbase_MGL_HIGH_FLOW.csv</tblk><br />
<tgrn>! Headers: Q, Salinity, Temperature, Sediment, Tracer, WQ</tgrn><br>
    <tcmd>BC Header</tcmd><teq> == </teq><tblk>Time,STP_HIGH_FLOW,S,T,CLAY,Tracer_1,HIGH_DO</tblk><br>
    <tcmd>BC Scale</tcmd><teq> == </teq><tblk>1.1,1.2,1.2,1.2,1.2,1.2</tblk><br>
    <tcmd>BC Offset</tcmd><teq> == </teq><tblk>0.1,0.1,2.0,1.5,1.5,1.5</tblk><br>
    <tcmd>BC Default</tcmd><teq> == </teq><tblk>0.0,0.0,22.0,15.0,50.0,10.0</tblk><br>
<tcmd>End BC</tcmd></p>
<p>As of TUFLOW FV 2025.0.0, this can be rewritten as follows.</p>
<p><tcmd>BC</tcmd><teq> == </teq><tblk>QC, STP_Outfall, ..\bc_dbase_MGL_HIGH_FLOW.csv</tblk><br />
<tgrn>! Headers: Q, Salinity, Temperature</tgrn><br>
    <tcmd>BC Header</tcmd><teq> == </teq><tblk>Time,STP_HIGH_FLOW,S,T</tblk><br>
    <tcmd>BC Scale</tcmd><teq> == </teq><tblk>1.1,1.2,1.2</tblk><br>
    <tcmd>BC Offset</tcmd><teq> == </teq><tblk>0.1,0.1,2.0</tblk><br>
    <tcmd>BC Default</tcmd><teq> == </teq><tblk>0.0,0.0,22.0</tblk><br>
<tgrn>! Sediment header/scale/offset</tgrn><br>
    <tcmd>Sed Header</tcmd><teq> == </teq><tblk>CLAY</tblk><br>
    <tcmd>Sed Scale</tcmd><teq> == </teq><tblk>1.2</tblk><br>
    <tcmd>Sed Offset</tcmd><teq> == </teq><tblk>1.5</tblk><br>
    <tcmd>Sed Default</tcmd><teq> == </teq><tblk>15.0</tblk><br>
<tgrn>! Tracer header/scale/offset</tgrn><br>
    <tcmd>Trace Header</tcmd><teq> == </teq><tblk>Tracer_1</tblk><br>
    <tcmd>Trace Scale</tcmd><teq> == </teq><tblk>1.2</tblk><br>
    <tcmd>Trace Offset</tcmd><teq> == </teq><tblk>1.5</tblk><br>
    <tcmd>Trace Default</tcmd><teq> == </teq><tblk>50.0</tblk><br>
<tgrn>! WQ header/scale/offset</tgrn><br>
    <tcmd>WQ Header</tcmd><teq> == </teq><tblk>HIGH_DO</tblk><br>
    <tcmd>WQ Scale</tcmd><teq> == </teq><tblk>1.2</tblk><br>
    <tcmd>WQ Offset</tcmd><teq> == </teq><tblk>1.5</tblk><br>
    <tcmd>WQ Default</tcmd><teq> == </teq><tblk>10.0</tblk><br>
<tcmd>End BC</tcmd></p>
<p>This new approach means that, for example, an additional sediment fraction can be added to the simulation and added to the QC BC block without impacting the subsequent tracer or water quality BC commands.</p>
<p>Notes:</p>
<ul>
<li>If users specify headers/scale/offset/default in both the <tcmd>BC Header</tcmd><teq> == </teq>, <tcmd>BC Scale</tcmd><teq> == </teq>, <tcmd>BC Offset</tcmd><teq> == </teq>, and <tcmd>BC Default</tcmd><teq> == </teq> commands and any of the subsequent sediment, tracer, or WQ BC commands within a BC block, the values defined in the subsequent sediment/tracer/WQ specification commands will overwrite the <tcmd>BC Header</tcmd><teq> == </teq>, <tcmd>BC Scale</tcmd><teq> == </teq>, <tcmd>BC Offset</tcmd><teq> == </teq>, and <tcmd>BC Default</tcmd><teq> == </teq> commands</li>
<li>It is recommended to use the BC header/scale/offset/default commands for hydrodynamic, salinity, and temperature headers/scale/offset/default only, while using the sediment, tracer, and WQ-specific commands for their respective variables</li>
<li>Reference to the boundary condition time variable should only be specified by the <tcmd>BC Header</tcmd><teq> == </teq> command. Time should not be repeated for any of the <tcmd>Sed Header</tcmd><teq> == </teq>, <tcmd>Trace Header</tcmd><teq> == </teq>, or <tcmd>WQ Header</tcmd><teq> == </teq> commands</li>
<li>When salinity or temperature functionality is disabled (e.g., <tcmd>Include Salinity</tcmd><teq> == </teq><tblk>0, 0</tblk>), the <tcmd>BC Header</tcmd><teq> == </teq> line should be updated accordingly to remove salinity. If this is not undertaken then the undeleted salinity entries will be interpreted as temperature entries</li>
<li>Users should always check the log file to verify that the BC variable names match the expected headers in the BC file</li>
</ul>
</div>
<div id="HDGIS-2" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> GIS Integration Enhancements<a href="HD-1.html#HDGIS-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="HDGISTIN-3" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> TIN Bathymetry Assignment<a href="HD-1.html#HDGISTIN-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cell centre elevations can now be set using a triangulated irregular network (TIN) using the <tcmd>Read TIN Zpts</tcmd> command. Currently the command supports <a href="https://xmswiki.com/wiki/TIN_Files">Aquaveo SMS .tin</a> format to set cell centre elevations within the TIN extent.</p>
<p><tcmd>Read TIN Zpts</tcmd> adopts TUFLOW FV’s layering approach and can be used in combination with the following common elevation commands:</p>
<ul>
<li><tcmd>Set Zpts</tcmd><teq> == </teq></li>
<li><tcmd>Read GRID Zpts</tcmd> <teq> == </teq></li>
<li><tcmd>Read GIS Z Line</tcmd><teq> == </teq></li>
<li><tcmd>Cell Elevation File</tcmd><teq> == </teq></li>
</ul>
<p>The below example shows the use of <tcmd>Read TIN Zpts</tcmd> to update mesh elevations for a proposed development. The SMS .tin file is shown in Figures <a href="HD-1.html#fig:fig-SMS-TIN-Example-Plan">2.1</a> and <a href="HD-1.html#fig:fig-SMS-TIN-Example-Oblique-Dev-wTIN">2.2</a>.</p>
<center>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-SMS-TIN-Example-Plan"></span>
<img src="images/SMS_TIN_Example_Plan.PNG" alt="Design TIN Layout" width="80%" />
<p class="caption">
Figure 2.1: Design TIN Layout
</p>
</div>
</center>
<center>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-SMS-TIN-Example-Oblique-Dev-wTIN"></span>
<img src="images/SMS_TIN_Example_Oblique_Dev_wTIN.PNG" alt="Oblique View of Design Mesh Topoography" width="80%" />
<p class="caption">
Figure 2.2: Oblique View of Design Mesh Topoography
</p>
</div>
</center>
<p>To ‘stamp’ the development elevations onto the mesh, the TIN is specified at a position in the .fvc below the assignment of the existing topography as follows.</p>
<p><tgrn>!_________________________________________________________________<br>
! GEOMETRY<br></tgrn>
<tcmd>Geometry 2D </ttcmd><teq>==</teq><tblk> ..\model\geo\Floodplain_001.2dm<br></tblk></p>
<p><tgrn>! Topography<br></tgrn>
<tcmd>Set Zpts </tcmd><teq>==</teq><tblk> 90.<br></tblk>
<tcmd>Read Grid Zpts </tcmd><teq>==</teq><tblk> ..\model\geo\dem_m01.asc<br></tblk>
<tcmd>Read GIS Z Line </tcmd><teq>==</teq><tblk> ..\model\gis\2d_zln_M03_thalweg_001_L.shp | ..\model\gis\2d_zln_M03_thalweg_001_P.shp<br></tblk>
<tcmd>Read GIS Z Line </tcmd><teq>==</teq><tblk> ..\model\gis\2d_zln_M03_Rd_Crest_001_L.shp | ..\model\gis\2d_zln_M03_Rd_Crest_001_P.shp<br></tblk>
<tcmd>Read GIS Z Line </tcmd><teq>==</teq><tblk> ..\model\gis\2d_zln_Invert_Correction_001_R.shp </tblk><tgrn>! Enforce mesh Zb to surveyed culvert invert levels<br></tgrn></p>
<p><tgrn>! New Development Design Earthworks<br></tgrn>
<tcmd>Read TIN Zpts </tcmd><teq>==</teq><tblk> ..\model\geo\Development_Design.tin<br></tblk></p>
<p>If the <tcmd>Write Check Files</tcmd> command is enabled, the resulting model elevations can be reviewed within the mesh check file.</p>
</div>
</div>
<div id="HDStructures-2" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Hydraulic Structure Updates<a href="HD-1.html#HDStructures-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="HDCulvertHeighWidthContraction-3" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Default Culvert Height And Width Contraction Coefficients<a href="HD-1.html#HDCulvertHeighWidthContraction-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Culvert width contraction (Width_Cont) and height contraction (Height_Cont) coefficients have been updated to default to 1.0. Previously if the Width_Cont and Height_Cont were not explicitly set in the culvert database file, TUFLOW FV would default to 0.0 resulting in no flow through the structure.</p>
<p>Note:</p>
<ul>
<li><p>The height contraction coefficient Height_Cont for box culverts is usually 0.6 for square edged entrances to 0.8 for rounded edges. This factor is not used and is ignored for circular culverts</p></li>
<li><p>The width contraction coefficient Width_Cont for box culverts typically varies from 0.9 for sharp edges to 1.0 for rounded edges. This factor is normally set to 1.0 for circular culverts.</p></li>
</ul>
</div>
<div id="HDCulvertEntExLoss-3" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Default Culvert Entry and Exit Loss Coefficients<a href="HD-1.html#HDCulvertEntExLoss-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Culvert entry loss (Entry_Loss) and exit loss (Exit_Loss) coefficients have been updated to default to 0.5 and 1.0, respectively. Previously if these parameters were set to zero in the culvert database file, TUFLOW FV would default both to 0.0. Setting these to zero now results in these new defaults being applied.</p>
<p>Note:</p>
<ul>
<li>If 0.0 is required for either of these coefficients then this can be effectively achieved by setting very small numbers in the culvert database file. Any number greater than 10<span class="math inline">\(^{-6}\)</span> will serve this purpose.</li>
</ul>
</div>
<div id="HDCulvertInvertChecking-3" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Improved Culvert Invert Checking<a href="HD-1.html#HDCulvertInvertChecking-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An error message is now output if 1D culvert inverts are specified below the minimum ground elevation of connected nodestrings or zones. The default error behaviour can be set to a warning using the global .fvc command <tcmd>Culvert Invert Check</tcmd> <teq> == </teq> <tblk>WARNING</tblk>.</p>
<p>The error/warning message is output to the TUFLOW FV log file (.log) and the GIS messages layer (located within the log directory) if GIS integration is enabled.</p>
<p>An example of the error message is provided below.</p>
<pre><code>Downstream culvert invert elevation is 36.50000
Downstream ground elevation (minimum) is 37.50000

ERROR: Culvert downstream invert is less than ground elevation, ID 1</code></pre>
<p>This warning message is provided to highlight areas where the 1D/2D connection may need improvement, or mesh elevations at the inlet or outlet of a culvert structure may need to be amended to reflect surveyed culvert invert levels.</p>
</div>
<div class="newbox1">
<div id="HDWSUDW3" class="section level3 hasAnchor" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Weir Structure User Defined Width<a href="HD-1.html#HDWSUDW3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An additional user-defined weir flow width property has been added for the WEIR flux function. This argument, denoted ‘B’ is the seventh argument of the structure block <tcmd>Properties</tcmd> command.</p>
<p>For example:</p>
<p><tcmd>Stucture</tcmd> <teq>==</teq> <tblk>Linked Nodestrings, Road_US, Road_DS</tblk><br>
    <tcmd>Flux Function</tcmd> <teq>==</teq> <tblk>Weir</tblk><br>
    <tcmd>Properties </tcmd> <teq>==</teq> <tblk>2.5, 1.705, 1.5, 8.55, 0.556, 0.7, 12.6 </tblk><br>
    <tgrn>! H, C, Ex, a, b, Csf_min, B (set the weir available flow width to 12.6 meters)</tgrn><br>
<tcmd>End Structure</tcmd></p>
<p>User-defined flow width is supported for linked nodestring and linked zones structure types. It is not supported for single nodestring structure types.</p>
<p>If the user-defined width ‘B’ is not specified, the weir width is set either via:</p>
<ul>
<li>The Max Open Width command for linked zones structure types</li>
<li>The average of the upstream and downstream nodestring lengths for linked nodestrings structure types</li>
<li>The nodestring length for nodestring structure types</li>
</ul>
</div>
<div id="HDWAMAF3" class="section level3 hasAnchor" number="2.3.5">
<h3><span class="header-section-number">2.3.5</span> Weir Adjust Memory Allocation Fix<a href="HD-1.html#HDWAMAF3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A fix has been included that addresses a memory allocation issue when using the WEIR_ADJUST, and WEIR_DZ_ADJUST flux function types.</p>
</div>
<div id="HDTargetRule-3" class="section level3 hasAnchor" number="2.3.6">
<h3><span class="header-section-number">2.3.6</span> Target Rule Structure Control Fix<a href="HD-1.html#HDTargetRule-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A fix has been implemented for structures using the Target Rule control type. The value being returned by the control block sample parameter was being incorrectly set to a NaN resulting in zero structure flow.</p>
</div>
</div>
<div id="HDTriggerRule-3" class="section level3 hasAnchor newbox2" number="2.3.7">
<h3><span class="header-section-number">2.3.7</span> Control Block Trigger Rule Fix<a href="HD-1.html#HDTriggerRule-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An issue has been resolved with parameter sampling when using the trigger control type. In some models, this caused out-of-bounds memory access, leading to memory corruption and premature model termination.</p>
</div>
<div id="HDPSLSF-3" class="section level3 hasAnchor newbox3" number="2.3.8">
<h3><span class="header-section-number">2.3.8</span> Porous Structure Linked Structure Fixes<a href="HD-1.html#HDPSLSF-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following improvements have been made to the porous flux function for models using linked nodestring or linked zone structure types.</p>
<ol style="list-style-type: decimal">
<li>A memory allocation issue affecting linked zones has been resolved.</li>
<li>The assignment of upstream and downstream water levels for head differential calculation for both linked nodestrings and linked zones has been corrected.</li>
</ol>
<p>Single nodestring structures were not affected.</p>
</div>
</div>
<div id="HDMassBalance-2" class="section level2 hasAnchor newbox3" number="2.4">
<h2><span class="header-section-number">2.4</span> Mass Balance<a href="HD-1.html#HDMassBalance-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Users can now specify an additional output type <tblk>massbalance</tblk> that generates a suite of csv files that report timeseries of all time-accumulated volume and mass fluxes within a model domain, as related to all simulated quantities, other than temperature. One csv file is generated for each simulated quantity’s volume or mass balance, and so is intentionally self contained. This allows users to complete their own mass balance analyses on a per-simulated-quantity basis, without additional post processing or reference to any other output files.</p>
<p>Each output csv file is named <tblk>&lt;fvc_name&gt;_MASSBALANCE_&lt;quantity_name&gt;.csv</tblk>. For example the csv file for the salinity mass balance of simulation River_001.fvc would be named <tblk>River_001_MASSBALANCE_SALINITY.csv</tblk>, and written to the nominated results folder. Each csv file has several columns, each reporting a timeseries of mass or accumulated flux, and these columns vary between simulated quantities. The following columns are reported as the first five columns for all simulated quantities:</p>
<ol style="list-style-type: decimal">
<li>Time</li>
<li>Total instantaneous volume or mass of quantity, as computed from TUFLOW FV state variables (which is the same as the <tblk>mass</tblk> output)</li>
<li>Accumulated fluxes across all QC and QC_POLY boundaries, summed to a single timeseries</li>
<li>Accumulated fluxes across all Q boundaries, summed to a single timeseries. This does not include internal nodestring fluxes</li>
<li>Accumulated fluxes across all WL, QN and WLS boundaries, summed to a single timeseries. This does not include internal nodestring fluxes</li>
</ol>
<p>Following these columns, a series of bespoke accumulated fluxes are reported, and these depend on the quantity reported. After these bespoke accumulated fluxes, the following four columns are reported for all simulated quantities:</p>
<ul>
<li>Summed accumulated fluxes for the reported quantity, including boundary (columns 3 - 5 above) and all bespoke fluxes, with sign (direction) preserved</li>
<li>Instantaneous flux-based volume or mass at time <span class="math inline">\(t\)</span>, as computed from summing the volume or mass at time <span class="math inline">\(t-1\)</span> and time <span class="math inline">\(t\)</span> fluxes. This provides an alternative estimate of instantaneous volume or mass that is then compared with the volume or mass reported in column 2. This comparison is reported in the next column</li>
<li>Percentage error between the instantaneous volume or mass reported in column 2 and the corresponding flux-based estimate reported in the previous column. For further information on the percentage error calculation refer to the <a href="https://docs.tuflow.com/fv/wqm/manual/2025.2/AppMBalCalcs.html#AppMBalCalcs">TUFLOW FV Water Quality User Manual</a> mass balance model appendix</li>
<li>The number of times the quantity reported has been ‘turned over’ since the beginning of the simulation. This is computed by summing the accumulated absolute values of all fluxes and dividing that sum by the original volume or mass. It is not intended to be an exact quantity to be used for flushing or similar analyses, but rather, to be interpreted as a quantity that provides an indication of the rapidity at which a quantity is cycled through the model domain. For example, a turnover value of 300 for VOLUME at the end of a one month simulation indicates that the modelled domain is dynamic and that water is cycled relatively quickly through the system. Conversely, a turnover value of 0.3 indicates the reverse - the simulated quantity is relatively stable and potentially stagnant.</li>
</ul>
<p>Column headers in each csv file for hydrodynamic simulated quantities are presented in Table <a href="HD-1.html#tab:tab-HDHeaders">2.1</a>. Acronyms within column headers include:</p>
<ul>
<li>V = Volumetric quantity</li>
<li>A = Areal quantity</li>
<li>MF = Mass flux</li>
<li>FV = TUFLOW FV output or computed from same</li>
<li>NS = Nodestring, encompassing WL, WLS and QN boundary types</li>
<li>WQ = Water Quality output or computed from same</li>
<li>Q = Q boundary type</li>
<li>QC = QC or QC_POLY boundary types</li>
<li>PCT = Percent</li>
</ul>
<table>
<caption>
<span id="tab:tab-HDHeaders">Table 2.1: </span><strong>Volume and Mass Flux Headers</strong>
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: rgba(26, 189, 201, 255) !important;">
Column Header
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: rgba(26, 189, 201, 255) !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: rgba(26, 189, 201, 255) !important;">
Units
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;color: WHITE !important;background-color: rgba(26, 189, 201, 255) !important;width: 10%; ">
Volume
</td>
<td style="text-align:left;font-weight: bold;color: WHITE !important;background-color: rgba(26, 189, 201, 255) !important;width: 80%; ">
<b>&lt;fvc_name&gt;_MASSBALANCE_VOLUME.csv</fvc_name></b>
</td>
<td style="text-align:left;font-weight: bold;color: WHITE !important;background-color: rgba(26, 189, 201, 255) !important;width: 10%; ">
<nbsp> </nbsp>
</td>
</tr>
<tr>
<td style="text-align:left;width: 10%; ">
<b>TIME</b>
</td>
<td style="text-align:left;width: 80%; ">
ISODATE Time
</td>
<td style="text-align:left;width: 10%; ">
<nbsp> </nbsp>
</td>
</tr>
<tr>
<td style="text-align:left;width: 10%; ">
<b>FV_VOL</b>
</td>
<td style="text-align:left;width: 80%; ">
Instantaneous volume computed from TUFLOW FV state variables. Always a positive quantity.
</td>
<td style="text-align:left;width: 10%; ">
m<span class="math inline">\(^3\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 10%; ">
<b>FV_MF_QC</b>
</td>
<td style="text-align:left;width: 80%; ">
Accumulated volume fluxes across all QC and QC_POLY boundaries, summed to a single timeseries. Can be a positive or negative quantity.
</td>
<td style="text-align:left;width: 10%; ">
m<span class="math inline">\(^3\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 10%; ">
<b>FV_MF_Q</b>
</td>
<td style="text-align:left;width: 80%; ">
Accumulated volume fluxes across all Q boundaries, summed to a single timeseries. Can be a positive or negative quantity.
</td>
<td style="text-align:left;width: 10%; ">
m<span class="math inline">\(^3\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 10%; ">
<b>FV_MF_NS</b>
</td>
<td style="text-align:left;width: 80%; ">
Accumulated volume fluxes across all WL, WLS and QN boundaries, summed to a single timeseries. Can be a positive or negative quantity.
</td>
<td style="text-align:left;width: 10%; ">
m<span class="math inline">\(^3\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 10%; ">
<b>FV_MF_EVAP</b>
</td>
<td style="text-align:left;width: 80%; ">
Accumulated evaporative flux. Always a negative quantity.
</td>
<td style="text-align:left;width: 10%; ">
m<span class="math inline">\(^3\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 10%; ">
<b>FV_MF_PREC</b>
</td>
<td style="text-align:left;width: 80%; ">
Accumulated precipitation flux. Always a positive quantity.
</td>
<td style="text-align:left;width: 10%; ">
m<span class="math inline">\(^3\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 10%; ">
<b>FV_MF_TOTAL</b>
</td>
<td style="text-align:left;width: 80%; ">
Total of accumulated volume fluxes, with individual signs preserved. Can be a positive or negative quantity.
</td>
<td style="text-align:left;width: 10%; ">
m<span class="math inline">\(^3\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 10%; ">
<b>MF_VOLUME</b>
</td>
<td style="text-align:left;width: 80%; ">
Estimate of total volume computed from summing previous timestep volume and current timestep volume fluxes. Always a positive quantity.
</td>
<td style="text-align:left;width: 10%; ">
m<span class="math inline">\(^3\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 10%; ">
<b>MF_PCT_ERROR</b>
</td>
<td style="text-align:left;width: 80%; ">
The percentage error of the different between <b>FV_VOL</b> and <b>MF_VOL</b>. Can be a positive or negative quantity.
</td>
<td style="text-align:left;width: 10%; ">
%
</td>
</tr>
<tr>
<td style="text-align:left;width: 10%; ">
<b>MF_TURNOVERS</b>
</td>
<td style="text-align:left;width: 80%; ">
See explanatory text (Section <a href="HD-1.html#HDMassBalance-2">2.4</a>). Always a positive quantity.
</td>
<td style="text-align:left;width: 10%; ">
No units
</td>
</tr>
</tbody>
</table>
<p>Mass balance outputs are triggered by issuing a <tblk>massbalance</tblk> type output block. As for the previously available <tblk>mass</tblk> and <tblk>flux</tblk> types, the only parameter to be specified for <tblk>massbalance</tblk> is the output interval, in seconds.</p>
<p><tcmd>Output</tcmd><teq> == </teq><tblk>massbalance</tblk><br />
    <tcmd>Output Interval</tcmd><teq> == </teq><tblk>900.0</tblk><br>
<tcmd>End Output</tcmd></p>
<p>An example of a mass balance output for volume is presented in Figure <a href="HD-1.html#fig:fig-OxMassBalV">2.3</a>. The quantities in the legend are as per Table <a href="HD-1.html#tab:tab-HDHeaders">2.1</a>. The figure shows total volume in the top panel and fluxes in the bottom. The water volume balance between catchment inflows and tidal outflows is clear, and the volume of the system considered has turned over approximate 160 times in the period considered.</p>
<center>
<div class="figure"><span style="display:block;" id="fig:fig-OxMassBalV"></span>
<img src="images/AA_Volume.png" alt="**Mass balance output: Volume**"  />
<p class="caption">
Figure 2.3: <strong>Mass balance output: Volume</strong>
</p>
</div>
</center>
</div>
<div id="HDMassBalance-WL_CURT-3" class="section level3 hasAnchor newbox4" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Mass Balance WL_CURT Support<a href="HD-1.html#HDMassBalance-WL_CURT-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The calculation of FV_MF_NS (as desribed in Section <a href="HD-1.html#HDMassBalance-2">2.4</a>) has been upgraded to include support for WL_CURT boundary types. Accumulated fluxes are now calculated across all WL, WL_CURT, WLS and QN boundaries, summed to a single timeseries. Can be a positive or negative quantity.</p>
</div>
<div id="HDMinorEnhancements-2" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Minor Enhancements and Fixes<a href="HD-1.html#HDMinorEnhancements-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="HDExTurbScaling-3" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> External Turbulence Scaling<a href="HD-1.html#HDExTurbScaling-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When using <tcmd>Vertical Mixing Model</tcmd> <teq> ==</teq><tblk> External</tblk>, the computed eddy viscosity and scalar diffusivity can be optionally scaled through the <tcmd>Vertical Mixing Parameters</tcmd> command. This command requires two parameters: Eddy viscosity scale factor and Scalar diffusivity scale factor. The final (modelled) eddy viscosity and scalar diffusivity are determined as follows.</p>
<pre><code>Eddy viscosity = Computed eddy viscosity x Eddy viscosity scale factor
Scalar diffusivity = Computed scalar diffusivity x Scalar diffusivity scale factor</code></pre>
<p>For example:</p>
<p><tcmd>Vertical Mixing Model</tcmd> <teq>==</teq><tblk> External</tblk><br>
<tcmd>Vertical Mixing Parameters</tcmd><teq> ==</teq><tblk> 1.0, 1.0</tblk>  <tgrn>! {1.0} Eddy viscosity scale factor, {1.0} Scalar diffusivity scale factor</tgrn><br></p>
</div>
<div id="HDDVProduct-3" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Depth Velocity Product Output Parameter<a href="HD-1.html#HDDVProduct-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The product of depth and velocity is now available by invoking the map or point output parameter ‘z0’ noting:</p>
<ul>
<li>The 0 in z0 is a zero, not the letter O</li>
<li>2D or 3D map output is supported for NetCDF output format</li>
<li>2D output is calculated by multiplying the water depth by the depth averaged velocity</li>
<li>3D output is calculated by multiplying the water depth by the surface 3D layer velocity</li>
<li>Maximum and minimum statistics tracking is supported via the <tcmd>Output Statistics</tcmd> output block command</li>
<li>Depth averaged map output is available via XMDF and DATV output formats</li>
<li>Point output is supported</li>
</ul>
<p>The following two examples show the output of z0 for NetCDF and Point outputs respectively.</p>
<p><tcmd>Output</tcmd> <teq>==</teq> <tblk>NetCDF</tblk><br>
  <tcmd>Output Parameters</tcmd> <teq>==</teq> <tblk>h, v, d, zb, z0</tblk><br>
  <tcmd>Output Interval</tcmd> <teq>==</teq> <tblk>300.</tblk><br>
  <tcmd>Output Statistics</tcmd> <teq>==</teq> <tblk>max</tblk><br>
  <tcmd>Output Statistics dt</tcmd> <teq>==</teq> <tblk>1</tblk><br>
<tcmd>End Output</tcmd><br><br></p>
<p><tcmd>Output</tcmd> <teq>==</teq> <tblk>Points</tblk><br>
  <tcmd>Read GIS PO</tcmd> <teq>==</teq> <tblk>..\3d_po_Output_Points_001_P.shp</tblk><br>
  <tcmd>Output Parameters</tcmd> <teq>==</teq> <tblk>h, v, d, rhow, z0</tblk><br>
  <tcmd>Output Interval</tcmd> <teq>==</teq> <tblk>300.</tblk><br>
<tcmd>End Output</tcmd></p>
</div>
<div id="HDPointOutputParameters-3" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Additional Point Output Parameters Supported<a href="HD-1.html#HDPointOutputParameters-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The output parameters outlined in Table
<a href="HD-1.html#tab:tab-NewPointOutputParameters">2.2</a> are now available for point time series output. Each can be specified using the <tcmd>Output Parameters</tcmd> output block command as follows.</p>
<p><tcmd>Output </tcmd><teq>==</teq><tblk> Points</tblk><br>
  <tcmd> Read GIS PO </tcmd><teq>==</teq><tblk> ..\3d_po_Output_Points_001_P.shp</tblk><br>
  <tcmd> Output Parameters </tcmd><teq>==</teq><tblk> h, v, rhow</tblk><tgrn> ! water level, vel, density</tgrn><br>
  <tcmd> Output Interval </tcmd><teq>==</teq><tblk> 900.</tblk><br>
<tcmd>End Output</tcmd></p>
<table>
<caption>
<span id="tab:tab-NewPointOutputParameters">Table 2.2: </span>Newly Supported Point Output Parameters
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: rgba(26, 189, 201, 255) !important;">
Point Output Parameter
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: rgba(26, 189, 201, 255) !important;">
Description
</th>
<th style="text-align:left;font-weight: bold;color: WHITE !important;background-color: rgba(26, 189, 201, 255) !important;">
Units
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
BEDLOAD_SED_X
</td>
<td style="text-align:left;">
Bedload for a specific sediment fraction X
</td>
<td style="text-align:left;">
g/m/s
</td>
</tr>
<tr>
<td style="text-align:left;">
PAR
</td>
<td style="text-align:left;">
Photsynthetically active radiation - Z-face
</td>
<td style="text-align:left;">
W/m<span class="math inline">\(^2\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
PAR_CC
</td>
<td style="text-align:left;">
Photsynthetically active radiation - Cell-centered
</td>
<td style="text-align:left;">
W/m<span class="math inline">\(^2\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
RHOW
</td>
<td style="text-align:left;">
Water density
</td>
<td style="text-align:left;">
kg/m<span class="math inline">\(^3\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
SEDLOAD_SED_X
</td>
<td style="text-align:left;">
Sediment load for a specific sediment fraction X
</td>
<td style="text-align:left;">
g/m/s
</td>
</tr>
<tr>
<td style="text-align:left;">
SUSPLOAD_SED_X
</td>
<td style="text-align:left;">
Suspload for a specific sediment fraction X
</td>
<td style="text-align:left;">
g/m/s
</td>
</tr>
<tr>
<td style="text-align:left;">
TURBZ
</td>
<td style="text-align:left;">
Turbulence Output Parameter which includes each of the following TURBZ_ outputs.
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
TURBZ_BVFSQ
</td>
<td style="text-align:left;">
Cell z-face buoyancy production (BRUNT-VAISALA) frequency squared
</td>
<td style="text-align:left;">
/s<span class="math inline">\(^2\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
TURBZ_EPS
</td>
<td style="text-align:left;">
Cell z-face turbulence dissipation
</td>
<td style="text-align:left;">
m<span class="math inline">\(^2\)</span>/s<span class="math inline">\(^3\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
TURBZ_L
</td>
<td style="text-align:left;">
Cell z-face turbulence length-scale
</td>
<td style="text-align:left;">
m
</td>
</tr>
<tr>
<td style="text-align:left;">
TURBZ_NUH
</td>
<td style="text-align:left;">
Cell z-face vertical temperature diffusivity
</td>
<td style="text-align:left;">
m<span class="math inline">\(^2\)</span>/s
</td>
</tr>
<tr>
<td style="text-align:left;">
TURBZ_NUM
</td>
<td style="text-align:left;">
Cell z-face vertical eddy viscosity
</td>
<td style="text-align:left;">
m<span class="math inline">\(^2\)</span>/s
</td>
</tr>
<tr>
<td style="text-align:left;">
TURBZ_NUS
</td>
<td style="text-align:left;">
Cell z-face vertical salinity diffusivity
</td>
<td style="text-align:left;">
m<span class="math inline">\(^2\)</span>/s
</td>
</tr>
<tr>
<td style="text-align:left;">
TURBZ_SPFSQ
</td>
<td style="text-align:left;">
Cell z-face shear production frequency squared
</td>
<td style="text-align:left;">
/s<span class="math inline">\(^2\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
TURBZ_TKE
</td>
<td style="text-align:left;">
Cell z-face turbulent kinetic energy
</td>
<td style="text-align:left;">
m<span class="math inline">\(^2\)</span>/s<span class="math inline">\(^2\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
VMAG
</td>
<td style="text-align:left;">
Velocity magnitude
</td>
<td style="text-align:left;">
m/s
</td>
</tr>
<tr>
<td style="text-align:left;">
W
</td>
<td style="text-align:left;">
Vertical velocity
</td>
<td style="text-align:left;">
m/s
</td>
</tr>
<tr>
<td style="text-align:left;">
WVPERBOT
</td>
<td style="text-align:left;">
Wave near-bed orbital motion period
</td>
<td style="text-align:left;">
s
</td>
</tr>
<tr>
<td style="text-align:left;">
WVUBOT
</td>
<td style="text-align:left;">
Wave near-bed orbital motion amplitude
</td>
<td style="text-align:left;">
m/s
</td>
</tr>
</tbody>
</table>
</div>
<div id="HDBCOverlap-3" class="section level3 hasAnchor" number="2.5.4">
<h3><span class="header-section-number">2.5.4</span> Improved Boundary Nodestring Overlap Checking<a href="HD-1.html#HDBCOverlap-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>TUFLOW FV will now return an error and stop a run if it detects overlap between two or more open boundary nodestrings specified across .2dm and 2d_ns GIS files.</p>
<p>If the model has GIS integration enabled, an entry will be added to the GIS messages layer output to the log directory. This can be reviewed in GIS (refer Figure <a href="HD-1.html#fig:fig-Nodestring-Overlap-Check">2.4</a>).</p>
<center>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-Nodestring-Overlap-Check"></span>
<img src="images/Nodestring_Overlap_Check.png" alt="Nodestring Overlap Check" width="60%" />
<p class="caption">
Figure 2.4: Nodestring Overlap Check
</p>
</div>
</center>
</div>
<div id="HDGPUErrorFix-3" class="section level3 hasAnchor" number="2.5.5">
<h3><span class="header-section-number">2.5.5</span> GPU 3D Drying Z Layer Message Fix<a href="HD-1.html#HDGPUErrorFix-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This fix concerns an incorrect error message for models using z or z-hybrid 3D layering on GPU hardware. CPU runs are not affected.</p>
<p>During simulation, if the top z-layer dried out TUFLOW FV was incorrectly reporting a water level and/or velocity magnitude exceedance message as follows.</p>
<pre><code>ERROR: Water Surface and/or Velocity Magntitude has exceeded limits in cell 20
</code></pre>
<p>The z-layer drying error message has been fixed and the correct error is now reported. For example:</p>
<pre><code>ERROR: Water Surface is less than 0.001m above top zlayer at cell 20</code></pre>
</div>
<div id="HDDuplicateFluxFile-3" class="section level3 hasAnchor" number="2.5.6">
<h3><span class="header-section-number">2.5.6</span> Duplicate Flux File Fix<a href="HD-1.html#HDDuplicateFluxFile-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A fix has been added to allow the output of multiple flux output blocks. As shown in the example below, after one flux output block has been specified, subsequent flux output blocks can be added, provided they contain the <tcmd>Suffix</tcmd> command.</p>
<p><tgrn>! Multiple Flux Outputs </tgrn><br>
<tcmd>Output</tcmd> <teq>==</teq> <tblk>flux</tblk><br>
  <tcmd>Output Interval</tcmd><teq> ==</teq> <tblk>300.</tblk> <tgrn>! 5mins</tgrn><br>
<tcmd>End Output</tcmd><br></p>
<p><tcmd>Output</tcmd> <teq>== </teq><tblk>flux</tblk><br>
  <tcmd>Output Interval</tcmd><teq> ==</teq> <tblk>60.</tblk><br>
  <tcmd>Suffix</tcmd> <teq>==</teq> <tblk>HR</tblk><tgrn> ! 1min HR (high resolution)</tgrn><br>
<tcmd>End Output</tcmd><br></p>
</div>
<div id="HDDepthAverageTURBZ-3" class="section level3 hasAnchor" number="2.5.7">
<h3><span class="header-section-number">2.5.7</span> Turbulence Map Output Fix<a href="HD-1.html#HDDepthAverageTURBZ-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vertical averaging of the ‘TURBZ’ map output parameter has been added for NetCDF format. Previously TUFLOW FV would exit prematurely.</p>
<p>The 2D output of 3D variables is achieved via the <tcmd>Vertical Averaging</tcmd> map output block command. For example:</p>
<p><tgrn>! Average the results 6 to 12m below the water surface and output as 2D</tgrn><br>
<tcmd>Output</tcmd> <teq>==</teq> <tblk>netcdf</tblk><br>
  <tcmd>Output Parameters</tcmd> <teq>==</teq> <tblk>TURBZ</tblk> <tgrn>! Cell face turbulence outputs</tgrn><br>
  <tcmd>Output Interval</tcmd> <teq>==</teq> <tblk>900.</tblk> <tgrn>! 15mins</tgrn><br>
  <tcmd>Vertical Averaging</tcmd> <teq>==</teq> <tblk>depth-range, 6, 12</tblk> <tgrn>! 3D to 2D averaging command</tgrn><br>
<tcmd>End Output</tcmd></p>
</div>
<div id="HDFluxOutputHeader-3" class="section level3 hasAnchor" number="2.5.8">
<h3><span class="header-section-number">2.5.8</span> Flux Output Header Fix<a href="HD-1.html#HDFluxOutputHeader-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Flux output csv files have been updated to ensure ‘NS’ is prefixed on all flux file headings. This now supports integer and string nodestring names and provides backward compatibility for existing post-processing scripts such as MATLAB and Python time series extraction.</p>
<center>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-Flux-Header-2024"></span>
<img src="images/Flux_Header_2024.png" alt="Flux Header Fix" width="80%" />
<p class="caption">
Figure 2.5: Flux Header Fix
</p>
</div>
</center>
</div>
<div id="HD2dmOutputFix-3" class="section level3 hasAnchor" number="2.5.9">
<h3><span class="header-section-number">2.5.9</span> Structured Mesh Check File Fix<a href="HD-1.html#HD2dmOutputFix-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The coordinate field width for the .2dm check file when using regular meshes has been increased to ensure coordinates are written correctly for both spherical and cartesian models. Previously, x and y coordinates were not being correctly delimited for cartesian models, leading to .2dm read errors in supporting GIS software.</p>
</div>
<div class="newbox1">
<div id="HDLDCF-3" class="section level3 hasAnchor" number="2.5.10">
<h3><span class="header-section-number">2.5.10</span> Log Directory Command Fix<a href="HD-1.html#HDLDCF-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fixes an issue with log file creation when a tab character follows the <tcmd>Log Dir</tcmd> command. If a tab was present following the Log Dir command TUFLOW FV would previously exit with the error:</p>
<p><code>ERROR: Could not create directory:</code></p>
</div>
<div id="HDGPU3DMEF-3" class="section level3 hasAnchor" number="2.5.11">
<h3><span class="header-section-number">2.5.11</span> GPU 3D Memory Error Fix<a href="HD-1.html#HDGPU3DMEF-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A memory allocation fix has been included that affected a small subset of 3D models running on GPU. Model set-ups subject to the issue would crash in the first iteration with the error: “NaN value detected in cell”. This issue did not affect simulations run on CPU hardware.</p>
</div>
<div id="HDISLM-3" class="section level3 hasAnchor" number="2.5.12">
<h3><span class="header-section-number">2.5.12</span> Improved Stability Limit Messages<a href="HD-1.html#HDISLM-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Error messages have been improved for water surface elevation or velocity magnitude limit exceedances when using the <tcmd>Stability Limits </tcmd> <teq>==</teq> <tblk></tblk> command as described in the below sub-sections.</p>
<div id="messages-on-cpu-hardware" class="section level4 hasAnchor" number="2.5.12.1">
<h4><span class="header-section-number">2.5.12.1</span> Messages On CPU Hardware<a href="HD-1.html#messages-on-cpu-hardware" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Water Level</strong></p>
<p>If the model exceeds the water level stability limit:</p>
<p>Previously:</p>
<ul>
<li><em>Water Surface has gone above … m at cell … layer … </em></li>
</ul>
<p>Now:</p>
<ul>
<li>Imperial Units: <em>Water surface has exceeded stability limit …. ft at 2D cell … </em></li>
<li>Metric Units: <em>Water surface has exceeded stability limit …. m at 2D cell … </em></li>
</ul>
<p><strong>Velocity</strong>
If the model exceeds the velocity stability limit:</p>
<p>Previously:</p>
<p><em>Velocity has gone above …. m/s at cell …. layer … depth is … </em></p>
<p>Now:</p>
<ul>
<li>Imperial Units 2D Model: <em>Velocity has exceeded stability limit …. ft/s at 2D cell … </em></li>
<li>Imperial Units 3D Model: <em>Velocity has exceeded stability limit …. ft/s at 2D cell … (3D cell … - vertical layer …)</em></li>
<li>Metric Units 2D Model: <em>Velocity has exceeded stability limit …. m/s at 2D cell … </em></li>
<li>Metric Units 3D Model: <em>Velocity has exceeded stability limit …. m/s at 2D cell … (3D cell … - vertical layer …)</em></li>
</ul>
</div>
<div id="messages-on-gpu-hardware" class="section level4 hasAnchor" number="2.5.12.2">
<h4><span class="header-section-number">2.5.12.2</span> Messages On GPU Hardware<a href="HD-1.html#messages-on-gpu-hardware" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Water Level And Velocity</strong></p>
<p>Previously:</p>
<ul>
<li><em>Water Surface and/or Velocity Magnitude has exceeded limits in cell id …</em></li>
</ul>
<p>Now:</p>
<ul>
<li><em>Water surface and/or velocity magnitude has exceeded limits in 2D cell id …</em></li>
</ul>
</div>
</div>
</div>
<div class="newbox3">
<div id="HDCTCFMO-3" class="section level3 hasAnchor" number="2.5.13">
<h3><span class="header-section-number">2.5.13</span> Changes to Cell Face Map Outputs<a href="HD-1.html#HDCTCFMO-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For consistency with other map output parameters, the following output and parameters are now cell-centred whereas they were previously output on z-faces.</p>
<ul>
<li>PAR</li>
<li>TURBZ (TURBZ_TKE, TURBZ_EPS, TURBZ_L, TURBZ_SPFSQ, TURBZ_BVFSQ, TURBZ_NUM, TURBZ_NUH, TURBZ_NUS)</li>
</ul>
</div>
<div id="HDUMUNC-3" class="section level3 hasAnchor" number="2.5.14">
<h3><span class="header-section-number">2.5.14</span> Unstructured Mesh Unused Nodes Check<a href="HD-1.html#HDUMUNC-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A check has been added to identify and report unused nodes in the unstructured mesh when reading a <code>.2dm</code> file via the <tcmd>Geometry 2D</tcmd> command. If unused nodes are found, TUFLOW FV will terminate with an error. For example:</p>
<p><em>2 unused .2dm nodes found - remove disjoint nodes in mesh.</em></p>
<p>The following information is reported:</p>
<ul>
<li>Unused node IDs are printed to the console.</li>
<li>Unused node IDs and their location are written to the model messages GIS layer in the log folder.</li>
</ul>
<p>Unused nodes can be readily removed in Aquaveo SMS via the ‘Select Disjoint’ tool in the <a href="https://www.xmswiki.com/wiki/SMS:2D_Mesh_Nodes_Menu">2D Mesh Nodes</a> menu.</p>
</div>
</div>
<div class="newbox6">
<div id="HDDUSFO-3" class="section level3 hasAnchor" number="2.5.15">
<h3><span class="header-section-number">2.5.15</span> Destratification Unit Structure Flux Output<a href="HD-1.html#HDDUSFO-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The TUFLOW FV bubbler calculations are outputs as part of the structflux output block.</p>
<pre><code>
<tcmd>Output</tcmd> <teq>==</teq> <tblk>Structflux</tblk>
    <tcmd>Output Interval</tcmd> <teq>==</teq> <tblk>900.0</tblk> <tgrn>! s</tgrn>
<tcmd>End Output</tcmd>
</code></pre>
<p>Additional columns are produced for each structure (which can be a single or multiple plumes, depending on the user define value of ‘Number of plumes in the cell’) as follows. The structure number <em>N</em> (e.g. <em>1</em> refers to the order in which the structure blocks are declared by the user):</p>
<ul>
<li>
STRUCTURE_N_BUBBLER_ENTRAINED_FLOW [m^3 s^-1]
<ul>
<li>
The total flow rate of entrained water in structure N at time T. The detrainment rate is excluded in these outputs
</li>
</ul>
</li>
<li>
STRUCTURE_N_BUBBLER_ENTRAINED_SALT_FLUX [psu m^3 s^-1]
<ul>
<li>
(If salt is simulated) The total mass entrainment rate of salt in structure N at time T. The units are to be noted in subsequent calculations. The detrainment rate is excluded in these outputs
</li>
</ul>
</li>
<li>
STRUCTURE_N_BUBBLER_ENTRAINED_TEMP_FLUX [degrees celsius m^3 s^-1]
<ul>
<li>
(If temperature is simulated) The total entrainment rate of temperature in structure N at time T. The units are to be noted in subsequent calculations. The detrainment rate is excluded in these outputs
</li>
</ul>
</li>
</ul>
</div>
<div id="HDGPEAWMO-3" class="section level3 hasAnchor" number="2.5.16">
<h3><span class="header-section-number">2.5.16</span> Global Potentential Energy And Water Mass Output<a href="HD-1.html#HDGPEAWMO-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The TUFLOW FV mass outputs include additional quantities.</p>
<pre><code>
<tcmd>Output</tcmd> <teq>==</teq> <tblk>mass</tblk>
    <tcmd>Output Interval</tcmd> <teq>==</teq> <tblk>900.0</tblk   <tgrn>! s </tgrn>
  <tcmd>End Output</tcmd>
</code></pre>
<p>The additional quantities are:</p>
<p>• WATER_MASS [kg]</p>
<ul>
<li>The total mass of water (including all density effects) in the model at time T.</li>
</ul>
<p>• POTENTIAL_ENERGY [GJ]</p>
<ul>
<li>The total potential energy of water (including all density effects) in the model at time T. Potential energy is computed by summing over all i cells</li>
</ul>
<p><span class="math display">\[
\text{PE} = \sum_{i=1}^{ncell} \rho_i \, g \, z_i
\]</span></p>
<p>where</p>
<p>• PE is potential energy (Gigajoules)</p>
<p>• <span class="math inline">\(\rho_i\)</span> is the density of cell <span class="math inline">\(i\)</span> [kg/m<span class="math inline">\(^3\)</span>]</p>
<p>• g is the acceleration due to gravity [m/s<span class="math inline">\(^2\)</span>]</p>
<p>• <span class="math inline">\(z_i\)</span> is the elevation of cell <span class="math inline">\(i\)</span> above an arbitrary datum that has z=0 at a model elevation less than the minimum bathymetric elevation. This ensures that all cell potential energies are nonnegative</p>
<p>• ncell is the number of computational model cells</p>
</div>
</div>
<p><img src="images/WQFooter.jpg" width="100%" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="SimManagment-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="VMM-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": false,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["https://downloads.tuflow.com/TUFLOWFV/Manuals/2025.2/ReleaseNotes/TUFLOW_FV_ReleaseNotes.pdf", "pdf"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
