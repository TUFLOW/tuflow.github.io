[["index.html", "TUFLOW FV Water Quality (WQ) Module User Manual ", " TUFLOW FV Water Quality (WQ) Module User Manual December 2023 "],["introduction.html", "Introduction About this manual How to use this manual", " Introduction About this manual This document is the user manual for the TUFLOW Water Quality (WQ) Module. How to use this manual Instructions are provided below on how to use this manual, including aspects of navigation, table filtering, plot animation and network diagram interaction. These instructions are not provided elsewhere. Navigation This manual is designed for digital use within any web browser and has the following features: Section headers, to level three, are directly navigable via the left hand pane’s table of contents. This table of contents pane can be toggled on and off from view via the “s” key if more or less page width is required The angled arrows that float at the left and right hand side midpoints of every page can be used to navigate sequentially back and forth to the commencement of preceding or subsequent top level sections Model commands, parameters and cross references for tables and figures are navigable through hyperlinks, where appropriate. This includes parameters within equations, which will also appear as blue hyperlinks when active The space bar can be used to scroll down within each page without skipping text. Shift + space bar will similarly scroll up Browser back and forward buttons (or their equivalent keyboard shortcuts alt + \\(\\langle\\)left arrow\\(\\rangle\\) and alt + \\(\\langle\\)right arrow\\(\\rangle\\), respectively) can be used to navigate through browsing history. Some browsers may not return to the scroll location in a page last visited, but to the last clicked section header. Hyperlinks have been built into the body of the manual, and these can be used in lieu of browser buttons if required It is recommended that this manual be viewed in a browser window that is maximised or operating in full screen mode, with the latter (although browser dependent) typically toggled via the F11 key. When following hyperlinks, the target (i.e. location linked to) is displayed at the top of the landing page. The exception to this occurs when a target is located near the bottom of the landing page’s content. In this case, it is not possible for a web browser to display the target at the top of a page because this would generate underlying white space, and as such, the target will appear in the main body of the landing page. Searching This entire manual content can be searched by using the search box at the top of the table of contents pane (i.e. screen top left near the TUFLOW logo). This search box can be toggled on and off by clicking the search icon (magnifying glass) at the top left of any page. The table of contents is dynamically filtered in response to entering text in the search box, and clicking on any remaining table of contents entry will navigate directly to the searched text. Searched text will be highlighted within a page for easy identification, and multiple instances within one page can be navigated through by using the up and down arrow keys. Clearing the search box will restore the table of contents. Tables Where appropriate, tables are searchable via use of the search box, which is located at the top right of any search enabled table. Not all tables are searchable. When text is entered into the search box, table rows are dynamically filtered to only show those that contain the search text. This allows on-the-fly condensing of large tables so that only relevant content is presented. Tables can be sorted alphabetically (or reverse alphabetically) with respect to any column by clicking column headers. Where appropriate, the number of rows displayed is selectable via the Show entries drop down. Undisplayed rows can be accessed by clicking Previous or Next or by using the numbered navigation boxes, all of which are located at the bottom of each table. Below is an example of a searchable table. Type “nitrate” (without the inverted commas) into the search box to see the table behaviour, or change the number of rows displayed (given this demonstration table has nine rows, only selecting “5” will change the number of rows displayed) and use the navigation buttons at the bottom of the table to look through all the data. The right hand column has hyperlinked words that allow navigation between related commands, or different versions of the same command, for ease of access. All hyperlinks have been deliberately disabled in this demonstration table, but are active (and explained) in live tables elsewhere in this manual. Command Description Links oxygen flux == \\(\\langle\\)\\(F_{sed}^{O_2}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of oxygen. Simulation construction section 4.6.4. \\(\\text{ }\\) inorganic nitrogen model == \\(\\langle\\)AmmoniumNitrate\\(\\rangle\\) Used to commence an inorganic nitrogen constituent model block via specification of a constituent model from the inorganic nitrogen constituent model class. Simulation construction section 4.7.3.3 \\(\\text{ }\\) atmospheric deposition == \\(\\langle\\)\\(\\left[{TN}\\right]_{rain}\\),\\(R_{atm-dry}^{TN}\\),\\(f_{TN}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to control the wet and dry atmospheric deposition of inorganic nitrogen. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) denitrification == \\(\\langle\\)Michaelis Menten,\\(R_{denit}^{NO_3}\\),\\(K_{denit-O2-MM}^{NO_3}\\),\\(\\theta_{denit}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to activate the Michaelis Menten model and control denitrification and its response to ambient oxygen concentrations and temperature. Simulation construction section 4.7.3.3.1 exponential denitrification == \\(\\langle\\)exponential,\\(R_{denit}^{NO_3}\\),\\(K_{denit-O2-exp}^{NO_3}\\),\\(\\theta_{denit}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to activate the exponential model and control denitrification and its response to ambient oxygen concentrations and temperature. Simulation construction section4.7.3.3.1 Michaelis Menten FRP min max == \\(\\langle\\)\\(\\left[FRP\\right]_{min}^{FRP}\\),\\(\\left[FRP\\right]_{max}^{FRP}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to set minimum and maximum FRP concentrations. Simulation construction section 4.7.3.4.1 \\(\\text{ }\\) temperature limitation == \\(\\langle\\)none\\(\\rangle\\) Used in a phytoplankton constituent model block to turn off phytoplankton group temperature limitation. Simulation construction section 4.7.3.5.1.1 standard temperature limitation == \\(\\langle\\)standard,\\(T_{std}^{phy}\\),\\(T_{opt}^{phy}\\),\\(T_{max}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set the standard phytoplankton group temperature limitation function. Simulation construction section 4.7.3.5.1.1 none oxygen == \\(\\langle\\)on;off\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to switch the dependence of FRP processes on dissolved oxygen on or off. Simulation construction section 4.7.3.4.1 \\(\\text{ }\\) Colour coding is often used for distinguishing different tabulated data types. In the above example, WQ Module commands are pink and the associated argument options for each command are blue and contained in angled parentheses. Colour coding applied to other table types is explained throughout this manual when required. Figures Where appropriate, this manual contains interactive figures that support understanding of processes and the influence of specifiable parameters on water quality outcomes. The figure below provides an example. Move the slider or press play to see the effect a sediment property has on water column concentrations. Zoom in by clicking and dragging out a box within the plot axes to be enlarged, and double click to return to the original axis limits. Mouse hover over a line on the figure to see plotted values. Networks Interactive networks are used to assist in describing simulation architectures and process descriptions. In all cases, networks comprise nodes and connecting lines. In the case of architecture networks, nodes are coloured and labelled circles. These nodes represent items within water quality architectural levels and are coloured as simulation classes, model classes, constituent models, or computed variables. Architectural relationships are displayed as connecting directional lines, with each line’s colour matching that of its originating node In the case of process descriptions, nodes are coloured and labelled and are either circles (processes) or squares (computed variables). Circular process nodes are coloured as sources or sinks of computed variables. Where a process is both source and sink, its fill and outline are coloured accordingly. Square computed variables are all presented as the same colour. Process and computed variable relationships are displayed as connecting directional lines, with each line’s colour indicating whether its direction is a source or sink with respect to its originating node. Connecting lines may have midpoint labels, and where present, these indicate indirect relationships to additional processes or computed variables. Single click anywhere on a network to activate interaction. A clicked network will show as being boxed in blue when activated. Once activated: Single click or hover over a node to highlight its nearest neighbours. Single clicking anywhere off the network will deselect these. The intention is that this allows users to quickly identify related processes and computed variables Use the Select by id drop down menu to select a particular node of interest. Its nearest neighbours will also be automatically selected Single click, hold and drag a node to move it if it covers other text or links. All nodes are able to be moved by hand in this way Single click, hold and drag white space anywhere within the activated network area to drag the entire network Use the mouse wheel to zoom in and out of the network Double click on any node that has the label starting text “Cluster on group :”. This will explode the nodes to see its containing subsidiary nodes Double click on any node within an exploded group to implode the group back to its original state Click the Reinitialize clustering button at the bottom of a network that uses clustering to return an exploded network to its original position, zoom and unexploded state. Not all networks use clustering so this button may not always be present Networks are deactivated when anywhere outside its blue box is clicked. In some instances, the network may explode to a position outside the original view frame, and some nodes or connecting lines might disappear. This is intentional, and prevents networks rescaling and becoming unreadably small. If this does happen and content of interest is off screen, simply use the mouse wheel to zoom out, or click, hold and drag the network in a direction that will bring obscured nodes back on screen, or do both. Below are example architecture and process description networks to explore. Commands Where specific commands are described, they appear in highlighted text, and often as a clickable link to the corresponding command description in Appendix B. That Appendix is a searchable table of all commands, as per the demonstration table presented in this introduction. The below is an example of a WQ Module command (the hyperlink has been disabled for this example). \\(\\newcommand{\\blockindent}{\\hspace{0.5cm}}\\) simulation class == Where commands specify computed variable parameters (e.g. half saturation concentrations, sediment fluxes etc.) then for consistency and brevity, these parameters are included directly in the command example using their notation (see following section that describes notation) rather than descriptive words. These notated parameters are also often a clickable link to descriptive explanations in Appendix R. The link below is an example of a WQ Module command with variables presented in their respective notations. Hyperlinks have been removed in this example. \\(\\blockindent\\) oxygen benthic == \\(K_{sed-O_2}^{O_2}\\), \\(\\theta_{sed}^{O_2}\\) Parameter notation The primary groups of computed variable parameters are listed below, with the letter or symbol used to denote each. Typical generalisations of units are parenthesised. Fluxes, \\(F\\) (mass or moles per unit area or volume per unit time) Rates, \\(R\\) (per unit time) Concentrations, \\(K\\) (mass or moles per unit volume) Temperature coefficients, \\(\\theta\\) (dimensionless) Fractions, \\(f\\) (dimensionless decimal between 0.0 and 1.0) Ratios, \\(X\\) (dimensionless decimal that may be greater than 1.0, but always non-negative) Limitation functions, \\(L\\) (a dimensionless decimal between 0.0 and 1.0) Power exponents, \\(P\\) (typically dimensionless), and Velocities, \\(V\\) (metres per day) Boolean flags, \\(B\\) (either zero or one) Typically (but not always) an instance of each of these groups will describe a computed variable and a process. Where appropriate, the computed variable and process are denoted as superscripts and subscripts, respectively. For example: The flux of oxygen across the sediment-water interface is notated as \\(F_{sed}^{O_2}\\) The rate of denitrification of nitrate is notated as \\(R_{denit}^{NO_3}\\), The half saturation concentration of oxygen controlling the flux of filterable reactive phosphorus across the sediment-water interface is notated as \\(K_{sed-O_2}^{FRP}\\) The temperature coefficient controlling the flux of ammonium across the sediment-water interface is notated as \\(\\theta_{sed}^{NH_4}\\) The fraction of total nitrogen rainfall concentration (or dry atmospheric fallout) that is nitrate is notated as \\(f_{atm-TN}^{NO_3}\\) In describing calculation processes (primarily in the Appendices) where a quantity is recomputed by the WQ Module as a direct modification of a user input or previously calculated quantity, then \\(\\left&lt; computed \\right&gt;\\) is used in the quantity’s subscript. For example, a user can specify a sediment flux of ammonium, which is a parameter notated as \\(F_{sed}^{NH_4}\\). The WQ Module can modify this parameter based on dynamic environmental conditions, and if so, the modified quantity is notated as \\(F_{sed \\left&lt; computed \\right&gt;}^{NH_4}\\). Concentration nomenclature Examples of processes and model simulations are provided in this manual, and these in turn refer to computed variable concentrations. These concentrations are denoted in square brackets, such as \\(\\left[NO_3\\right]\\) for nitrate. The commonly accepted nomenclature for these variable concentrations is used in this manual, such as “nitrate concentration”. The numerical value of this concentration refers, however, to the concentration of elemental nitrogen within nitrate molecules: “6 mg/L of nitrate” means 6 mg/L of elemental nitrogen that is contained within nitrate molecules, not 6 mg/L of nitrate molecules. This is implicit in all references to all computed variables. More detail in this regard is provided in Section 4.2, which should be reviewed carefully. Feedback Constructive suggestions to improve this manual are welcome, and can be emailed to support@tuflow.com. "],["Overview-1.html", "Section 1 Overview 1.1 Context 1.2 Features 1.3 Science 1.4 Support", " Section 1 Overview 1.1 Context The TUFLOW FV Water Quality (WQ) Module enables the two- or three-dimensional simulation of water quality and ecological processes in natural and constructed waterways such as (but not limited to) lakes, tidal estuaries, river systems and coastal oceans. The module’s design is flexible so as to support tailoring of its setup to meet individual application demands and complexity. The WQ Module is currently supported for use with TUFLOW FV, for releases from 2022 onward. \\(\\newcommand{\\blockindent}{\\hspace{0.5cm}}\\) 1.2 Features 1.2.1 Usability Several key features have been included in the design of the WQ Module to support its use. Some are listed below. Simulation units. The units of simulation (including specification of initial conditions, boundary conditions and computed variable parameters) can be selected as either the commonly used mg/L (and \\(\\mu\\)g/L for phytoplankton) system, or the mmol/m\\(^3\\) system Library defaults. The WQ Module comes packaged with a fully populated library of default settings for all computed variable parameters. This means that users can quickly set up water quality simulations that automatically draw on these library defaults, with a view to then progressively overriding these defaults and therefore customising simulations to suit Command syntax. The WQ Module uses familiar TUFLOW style command == argument(s) syntax that has a long established pedigree within other TUFLOW products, for example: \\(\\blockindent\\) oxygen benthic == 4.0, 1.07 Log file user feedback. WQ Module simulations generate a log file that reports all simulation configuration details for review Output computed variable names. The WQ Module output variable names are descriptive and include the units used, for example WQ_DISS_OXYGEN_MGL Output diagnostic variable names. The WQ Module output diagnostic variable names are descriptive and include the units used, for example WQ_DIAG_O2_ATMOS_EXCHANGE_MG_M2_D Specification of concentration limits. The WQ Module allows users to optionally specify minimum and maximum concentation limits for each computed variable, and the WQ Module will reset concentrations to these limits if exceedences are detected. All instances of resetting are reported to the WQ Module log file as continuous commentary Inbuilt guidance on parameter specification. The WQ Module checks all user specified parameters and compares them to typical ranges. If a parameter’s specified value falls outside a typical range, then a warning is reported to the WQ Module log file. These ranges are listed in Appendix R of this manual 1.2.2 Constituents and processes Constituents currently simulated by the WQ Module include: Dissolved oxygen Silicate Inorganic nitrogen Ammonium Nitrate Inorganic phosphorus Filterable reactive phosphorus Adsorbed filterable reactive phosphorus Organic matter (labile and refractory) Particulate organic carbon Dissolved organic carbon Particulate organic nitrogen Dissolved organic nitrogen Particulate organic phosphorus Dissolved organic phosphorus Refractory dissolved organic carbon Refractory dissolved organic nitrogen Refractory dissolved organic phosphorus Refractory particulate organic matter Phytoplankton (multiple groups) Basic (excludes internal nutrient simulation) Advanced (includes internal nutrient simulation) Pathogens (multiple groups) Free (excludes attachment/detachment to sediment) Attached (includes attachment/detachment to sediment) Processes captured by the WQ Module include: Water column transformations between constituents (e.g. nitrification) Benthic sediment – water column interactions (e.g. sediment oxygen consumption) Atmospheric exchange (e.g. oxygen dissolution and rainfall deposition) Primary productivity, respiration and exudation of one or more phytoplankton groups Mortality, inactivation, settling and attachment/detachment of one or more pathogen groups Future near-term releases of the WQ Module will include the ability to simulate: Macrophytes Particulate water quality constituents as sediment fractions (linked dynamically to TUFLOW FV’s Sediment Transport (ST) Module) Future mid-term releases will include: Zooplankton Biogeochemical particles (linked dynamically to TUFLOW FV’s Particle Tracking (PT) Module) Sediment diagenesis Geochemistry 1.3 Science The science underpinning the WQ Module is that developed at the School of Agriculture and Environment’s Oceans Institute at The University of Western Australia. The WQ Module has wrapped this world class science into a form that is easily accessed via familiar TUFLOW style commands and workflows, and offers the additional features described in Section 1.2.1. 1.4 Support BMT sells, distributes and supports the WQ Module. Contact support@tuflow.com or sales@tuflow.com for support and sales inquiries. Several supporting appendices have also been included in this manual. These contain interactive content to assist users in understanding and applying the WQ Module, beyond what might typically be included in a static user manual. These Appendices are interlinked and hyperlinked with content from the body of the manual where appropriate, and are: Appendix A Description of command syntax and nomenclature Appendix B Listing of all commands, and their syntax, arguments, descriptions and cross references Appendices C to N Detailed process descriptions, including worked examples using a purpose built small demonstration model Appendix P Listing and descriptions of all computed variables, with supporting information Appendix Q Listing and descriptions of all computed diagnostic variables, with supporting information Appendix R Explanations of all parameters, with symbology, minimums and maximum values, units and commentary Appendix S Demonstration of the mass balance properties of all WQ Module computed variables "],["Architecture-1.html", "Section 2 Architecture 2.1 Context 2.2 Simulation Tiers 2.3 Linkage with TUFLOW FV 2.4 Linkage with Other Hydrodynamic Models", " Section 2 Architecture This section provides a description of the WQ Module’s architecture. This description is intentionally introductory, and details required to set up and execute simulations that deploy the WQ Module are provided in Section 4. The manual’s introduction should be reviewed for instructions regarding the use of interactive components deployed in this manual. \\(\\newcommand{\\blockindent}{\\hspace{0.5cm}}\\) 2.1 Context As our understanding of the natural environment advances, the questions asked of water quality and ecological numerical models are rapidly increasing in breadth and complexity. Setting up, calibrating and executing defensible environmental models has therefore become an increasingly challenging proposition. The architecture of the WQ Module has been deliberately designed to assist users in overcoming some of these challenges, and in doing so improve the efficiency and effectiveness with which numerical modelling can support environmental management. Importantly, the WQ Module’s architecture provides a mechanism by which users can rapidly initiate and execute water quality simulations without (at least in early modelling stages) concerning themselves with the often time consuming set up and parameterisation of simulated environmental processes. In short, the WQ Module has been designed to provide immediate and easy access to its supporting state of the art environmental modelling science. The architecture that provides this easy access is tiered and these tiers are described below. 2.2 Simulation Tiers The WQ Module’s tiers are described below using the nomenclature of Figure 2.1. Every WQ Module simulation has the following tiers: Tier 1: Exactly one instance from a simulation class. This is user defined Tier 2: A suite of instances from a model class. The suite (and therefore number) of these instances is preset per simulation class. The exceptions to this are the phytoplankton and pathogen model classes, which when included in a simulation class can have as many instances within the suite as required by the user, with one instance (the default) per simulated phytoplankton or pathogen group Tier 3: Exactly one constituent model per model class instance (these are user selectable and there may be more than one constituent model available to choose from within a given model class instance) Tier 4: At least one computed variable per constituent model (the suite of computed variables is preset within each constituent model) Figure 2.1: WQ Module tiers Notwithstanding the above, a user need not specify any of the above in order to rapidly set up and execute a first pass WQ Module simulation. In this case, the WQ Module will automatically set the simplest instances of the simulation class, model classes, constituent models and computed variables by drawing on library defaults. Simulation tiers are described below. 2.2.1 Tier 1: Simulation Class This is the highest and overarching tier of the WQ Module’s architecture. Using a single command, this tier sets the overall water quality simulation structure, including the suite of model classes to be deployed (with potentially multiple phytoplankton or pathogen model classes), and therefore the corresponding suite of constituent models and computed variables. The available simulation classes are provided in Table 2.1 as their keywords, together with example uses of each. The simulation class instances are cumulative, that is, a more complex class instance will include all the capability of simpler class instances. Complexity increases with table row in Table 2.1. Table 2.1: WQ Module simulation class instances Simulation Class Instance Potential Uses DO Simulation of rudimentary dissolved oxygen dynamics such as:\\(\\cdot\\blockindent\\)Desalination return water impact analyses\\(\\cdot\\blockindent\\)Seasonal reservoir oxygen analyses\\(\\cdot\\blockindent\\)Agricultural drain oxygen analyses Inorganics Simulation of relatively simple aquatic ecosystems that experience primary productivity such as:\\(\\cdot\\blockindent\\)Shallow urban lakes\\(\\cdot\\blockindent\\)Smaller estuaries\\(\\cdot\\blockindent\\)Coastal ocean zones that are relatively free of organic materials or sediments\\(\\cdot\\blockindent\\)Mine voids Organics Simulation of more complex aquatic ecosystems such as:\\(\\cdot\\blockindent\\)Impacted coastal embayments or nearshore zones\\(\\cdot\\blockindent\\)Impacted lakes\\(\\cdot\\blockindent\\)Larger estuaries\\(\\cdot\\blockindent\\)Wetlands\\(\\cdot\\blockindent\\)Aquaculture operations\\(\\cdot\\blockindent\\)Environments receiving point and/or diffuse source organic pollutants Users can simply specify one preset simulation class (e.g. “organics”) in a water quality control file (Section 4.4 and following sections), and the WQ Module will draw on inbuilt library defaults to automatically construct and execute a water quality simulation, with no further user input required (beyond specification of water quality initial conditions, see Section 4.4.2). For example, a user may simply specify simulation class == organics and initial conditions, and the WQ Module will construct itself, execute and report simulation details via a log file. This initial level of simplicity is intended. 2.2.2 Tier 2: Model Class Each simulation class instance contains a preset suite of model class instances. These suites cannot be changed (although there may be multiple phytoplankton or pathogen model class instances), and are provided in Table 2.2 and as a network in Figure 2.2. For example, simulation class instance “inorganics” has the fixed suite of oxygen, silicate, inorganic nitrogen, inorganic phosphorus and (potentially multiple) phytoplankton model class instances. The exception to this is pathogens. These can be optionally simulated in any simulation class (or none), and if simulated, potentially multiple pathogen model classes can be included. Table 2.2: WQ Module simulation class instances and corresponding preset model class suites Simulation Class Instance Model Class Suite DO \\(\\cdot\\blockindent\\)Oxygen\\(\\cdot\\blockindent\\)Pathogens (optional, potentially multiple) Inorganics \\(\\cdot\\blockindent\\)Oxygen\\(\\cdot\\blockindent\\)Silicate\\(\\cdot\\blockindent\\)Inorganic Nitrogen\\(\\cdot\\blockindent\\)Inorganic Phosphorus\\(\\cdot\\blockindent\\)Phytoplankton (potentially multiple)\\(\\cdot\\blockindent\\)Pathogens (optional, potentially multiple) Organics \\(\\cdot\\blockindent\\)Oxygen\\(\\cdot\\blockindent\\)Silicate\\(\\cdot\\blockindent\\)Inorganic Nitrogen\\(\\cdot\\blockindent\\)Inorganic Phosphorus\\(\\cdot\\blockindent\\)Organic matter\\(\\cdot\\blockindent\\)Phytoplankton (potentially multiple)\\(\\cdot\\blockindent\\)Pathogens (optional, potentially multiple) Figure 2.2: WQ Module simulation class and model class instances 2.2.3 Tier 3: Constituent Model Whilst the suite of model class instances is set per simulation class instance, constituent models are interchangeable within a model class. In this way, a simulation class instance (at Tier 1) can be customised at the constituent model tier (at Tier 3), despite having a preset suite of model classes (at Tier 2, with potentially multiple phytoplankton and/or pathogen model class instances). Available constituent models are provided in Table 2.3, and presented graphically in Figure 2.3 as a direct extension of Figure 2.2. Pathogen model classes (and therefore constituent models) are always optional. Table 2.3: WQ Module model classes and corresponding available constituent models Model Class Available Constituent Models Oxygen O2 Silicate Si Inorganic Nitrogen AmmoniumNitrate Inorganic Phosphorus FRPhs FRPhsads Organic Matter Labile Refractory Phytoplankton Basic Advanced Pathogens Free Attached Figure 2.3: WQ Module simulation class and model class instances, with available constituent models For example, multiple inorganic phosphorus constituent models are available within the inorganic phosphorus model class, where these models execute different water quality processes and contain different computed variables. In this example, this can be set with a single line command: inorganic phosphorus model == frphsads \\(\\blockindent\\) \\(\\langle commands \\rangle\\) end inorganic phosphorus model This allows a user to interchange one phosphorus constituent model for another within the inorganic phosphorus model class, thereby customising the overarching simulation class instance. The environmental processes simulated within each constituent model are fixed. Despite this, these processes can nonetheless be switched on and off as required, offering an additional layer of customisation. For example, if oxygen is not required to be included in silicate sediment flux calculations, the linkage between these processes and oxygen can be turned off by setting: oxygen == off Alternatively, if a user wishes to simulate all inorganic processes other than nitrification for example, then the rate describing this unwanted process can simply be set to zero (as per the following command - the first numerical argument is the nitrification rate) and it will be turned off. All library defaults also set rate processes to zero. \\(\\blockindent\\) nitrification == 0.0, 0.0, 1.0 All processes included within each constituent model, and their respective WQ Module commands, are described in Sections 3 and 4, respectively. 2.2.4 Tier 4: Computed Variables Each Tier 3 constituent model contains a fixed set of computed variables. Table 2.4 (which is a direct extension of Table 2.3) provides the mapping between model classes, constituent models and their associated computed variables. These maps are also provided graphically in Figure 2.4, which is an extension of Figure 2.3, but presented in a non-hierarchical form. Click or hover over nodes to track their paths up or down the simulation tree. For clarity, Figure 2.4 (and elsewhere within this manual) uses acronyms for some computed variable names, and these acronyms are expanded in Appendix P. All references in this manual to “organic matter” are to labile organic computed variables, unless specifically termed as refractory. Table 2.4: WQ Module model classes, available constituent models and computed variables Model Class Available Constituent Models Computed Variables Oxygen O2 Dissolved oxygen Silicate Si Silicate Inorganic Nitrogen AmmoniumNitrate AmmoniumNitrate Inorganic Phosphorus FRPhs Filterable reactive phosphorus (FRP) FRPhsads FRPAdsorbed FRP Organic Matter Labile Labile dissolved and particulate organic carbon, nitrogen and phosphorus Refractory Labile dissolved and particulate organic carbon, nitrogen and phosphorusRefractory dissolved carbon, nitrogen and phosphorus and refractory particulate organic matter Phytoplankton Basic Phytoplankton concentration and optionally cell density Advanced Phytoplankton concentration, internal nitrogen, internal phosphorus and optionally cell density Pathogens Free Pathogen alive and dead concentrations Attached Pathogen alive, attached and dead concentrations Figure 2.4: WQ Module simulation class and model class instances, available constituent models and computed variables Parameters that govern the behaviour of computed variables are set within each constituent model. Parameters that are not set by the user are populated automatically from the WQ Module library defaults. 2.3 Linkage with TUFLOW FV 2.3.1 Process Support is currently provided for linkage of the WQ Module with TUFLOW FV. Within this linkage, TUFLOW FV considers the WQ Module as a peripheral model with which it interacts at arm’s length. The role of TUFLOW FV is that it (in approximate run time order): Requests the number of water quality constituents from the WQ Module at start up, based on user setup specifications (e.g. the setting of the simulation class instance, with any constituent model modifications) Automatically sets up the corresponding number of tracers (one for each computed variable) within its simulation (users do not specify these tracers) Is then responsible for the: Application of WQ Module initial conditions Conservative advection and dispersion of these tracers (that represent the WQ Module’s computed variables) Application of WQ Module boundary conditions Calling the WQ Module at a user specified time step for the WQ Module to execute non-conservative transformation calculations on the suite of passive tracers Writing of WQ Module results files For example, if a WQ Module simulation was set to consider only dissolved oxygen, then TUFLOW FV would automatically allocate one tracer for the dissolved oxygen variable (the user does not need to specify passive tracers within TUFLOW FV), and advect and disperse that tracer throughout the model domain in response to initial and boundary conditions. At a user defined interval, TUFLOW FV would send the two- or three-dimensional tracer concentration field to the WQ Module for it to be modified in response to non-conservative ecological processes The WQ Module would then return this modified tracer field to TUFLOW FV for subsequent advection and dispersion, with this exchange process continuing to simulation end. 2.3.2 Treatment of light The TUFLOW FV heat module must be activated in order to use the WQ Module. One reason for this (beyond the need to compute water temperature) is that the heat module includes calculation of the light field within the model domain. This light field is used by various WQ Module constituent models. In order to provide this light field, TUFLOW FV splits the shortwave radiation specified in the heat module into four bands: near infrared (NIR) photosynthetically available radiation (PAR) ultraviolet A (UVA), and ultraviolet B (UVB) This split can be executed using TUFLOW FV defaults (recommended), or be user specified (not recommended). The corresponding band extinction coefficients in water with zero suspended sediment can also be specified in TUFLOW FV. Defaults are also available for all these coefficients and are recommended. TUFLOW FV uses these coefficients, along with other simulation properties, to compute the four light band intensities at the faces and centroids of each computational cell. The WQ Module uses the same split into bands as the TUFLOW FV defaults and ensures consistency in the treatment of light between TUFLOW FV and the WQ Module. The WQ Module can also modify the light field sent to it from TUFLOW FV via calculation of phytoplankton self shading (section M.1), the absorption of light due to the presence of organic matter and other processes. If this occurs, the WQ Module returns a modified light extinction coefficient field to TUFLOW FV that is then used in subsequent hydrodynamic heat and light calculations. This modification of light by water quality computed variables only occurs for simulation classes beyond DO. 2.4 Linkage with Other Hydrodynamic Models The above communication between TUFLOW FV and the WQ Module is affected via implementation of a publicly available application programming interface (API). This API effectively sets the rules by which TUFLOW FV and the WQ Module communicate, and separates their roles. This API has been designed so that TUFLOW FV can drive any other water quality model that includes the API in its compilation. This is intentional, and allows users of other ecological models to access the hydrodynamic power of TUFLOW FV for their simulations. Contact support@tuflow.com for further information or assistance in this regard. "],["ProcessDescriptions-1.html", "Section 3 Process Descriptions 3.1 Simulation Class: DO 3.2 Simulation Class: Inorganics 3.3 Simulation Class: Organics", " Section 3 Process Descriptions Previous chapters have presented an overview of the architecture and capabilities of the WQ Module, together with a summary of its interactions with TUFLOW FV. This chapter presents the details of each simulation class (see Table 2.1) in terms of its available model classes, the constituent models within those model classes, and the associated computed variables. Process descriptions are listed in this section primarily by name in tables and networks, without inclusion of detail. This is for clarity, with the detailed process descriptions and equations being provided in the Appendices. To facilitate this linkage with supporting material, each process tabulated in this section has been hyperlinked directly to the relevant Appendix, and these hyperlinks colour coded as sources or sinks relative to each computed variable presented. Again for clarity, potential interactions of a computed variable with higher order computed variables (for example oxygen with phytoplankton) are included in this section only in descriptions of those higher order variables and processes. Further: Where a computed variable’s process is modified by a lower order computed variable (e.g. silicate sediment flux modified by oxygen), then the lower order computed variable name is shown diagrammatically in a contrasting style overlying relevant process arrows in network diagrams Where a computed variable or process directly modifies a lower order computed variable (e.g. phytoplankton respiration consumes dissolved oxygen) then the lower order computed variable is explicitly included in tables and networks Computed variables listed in the tables are hyperlinked to supporting information in Appendix P Optional model classes (such as pathogens) are not included in the simulation class conceptual images (such as Figure 3.1) for clarity, but are first described in the simplest simulation class for which they can be deployed. Optional model classes are included in simulation class network diagrams only if they directly influence other water quality computed variables (e.g. pathogens do not, so are excluded from broader network diagrams). The manual’s introduction should be reviewed for guidance on the use of interactive components deployed in this section. 3.1 Simulation Class: DO 3.1.1 Overview The intent of this simulation class is that it provide a relatively simple entry point to commence water quality modelling. There are many applications for this class. For example it might be used to examine basic oxygen dynamics across seasons in a water supply reservoir or a relatively newly constructed urban lake, or the potential impacts of dense desalination plant return waters on local coastal sediment oxygenation processes. This simulation class includes only the oxygen model class as mandatory, but given oxygen’s central role in environmental processes, it provides both a solid foundation for fundamental environmental investigations, and a platform from which to expand to more advanced simulation classes. The pathogens model class can be optionally included. Figure 3.1: Simulation Class: DO (as an estuarine example) 3.1.2 Model Class: Oxygen The following constituent models are available to select from within the oxygen model class. 3.1.2.1 Constituent Model: O2 The constituent model code and associated computed variables, processes and potentially interacting simulated quantities are provided in Figure 3.2 and Table 3.1. \\(\\newcommand{\\blockindent}{\\hspace{0.5cm}}\\) Figure 3.2: Constituent model: O2 Table 3.1: Constituent model properties: O2 Computed Variables Units Processes Interacting Quantities Dissolved oxygen mg/L or mmol/m\\(^3\\) Atmospheric aeration \\(\\cdot\\blockindent\\)Wind speed\\(\\cdot\\blockindent\\)Dissolved oxygen Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties In this relatively simple model, the only process requiring parameterisation is the sediment flux of oxygen. 3.1.3 Model Class: Pathogens (optional) The following constituent models are available to select from within the pathogen model class. 3.1.3.1 Constituent Model: Free The constituent model code and associated computed variables, processes and potentially interacting simulated quantities are provided in Figure 3.3 and Table 3.2. Figure 3.3: Constituent model: Free Table 3.2: Constituent model properties: Free Computed Variables Units Processes Interacting Quantities Alive pathogen CFU/100mL Settling \\(\\cdot\\blockindent\\)Settling model Mortality \\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Temperature\\(\\cdot\\blockindent\\)Mortality parameters Light inactivation \\(\\cdot\\blockindent\\)Light and band splitting\\(\\cdot\\blockindent\\)DO\\(\\cdot\\blockindent\\)Inactivation parameters Attachment \\(\\cdot\\blockindent\\)Attachment parameters Detachment \\(\\cdot\\blockindent\\)Attachment parameters Dead pathogen CFU/100mL Settling \\(\\cdot\\blockindent\\)Settling model Mortality \\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Temperature\\(\\cdot\\blockindent\\)Mortality parameters Light inactivation \\(\\cdot\\blockindent\\)Light and band splitting\\(\\cdot\\blockindent\\)DO\\(\\cdot\\blockindent\\)Inactivation parameters 3.1.3.2 Constituent Model: Attached The constituent model code and associated computed variables, processes and potentially interacting simulated quantities are provided in Figure 3.4 and Table 3.3. This constituent model is the same as the Free constituent model, but allows for pathogens to attach to sediments. Figure 3.4: Constituent model: Attached Table 3.3: Constituent model properties: Attached Computed Variables Units Processes Interacting Quantities Alive pathogen CFU/100mL Settling \\(\\cdot\\blockindent\\)Settling model Mortality \\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Temperature\\(\\cdot\\blockindent\\)Mortality parameters Light inactivation \\(\\cdot\\blockindent\\)Light and band splitting\\(\\cdot\\blockindent\\)DO\\(\\cdot\\blockindent\\)Inactivation parameters Attachment \\(\\cdot\\blockindent\\)Attachment parameters Detachment \\(\\cdot\\blockindent\\)Attachment parameters Dead pathogen CFU/100mL Settling \\(\\cdot\\blockindent\\)Settling model Mortality \\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Temperature\\(\\cdot\\blockindent\\)Mortality parameters Light inactivation \\(\\cdot\\blockindent\\)Light and band splitting\\(\\cdot\\blockindent\\)DO\\(\\cdot\\blockindent\\)Inactivation parameters Attached pathogen CFU/100mL Attachment \\(\\cdot\\blockindent\\)Attachment parameters Detachment \\(\\cdot\\blockindent\\)Attachment parameters Neither of the pathogen constituent models have complementary lower order computed variables, and their operation does not influence the concentrations of any other computed variables. 3.1.4 Computed variables The only mandatory computed variable is this simulation class is dissolved oxygen, and as such the overarching simulation class network diagram is the same as that presented in Figure 3.2. If pathogens are simulated, then the corresponding simulation class network diagram is the (unconnected) aggregation of Figure 3.2 and either Figure 3.3 or Figure 3.4. 3.2 Simulation Class: Inorganics 3.2.1 Overview The intent of this simulation class is that it provide a framework for simulating typical water quality conditions where organic matter does not play a significant role in ecosystem processes. For example it might be used to examine basic inorganic nutrient processing in nearshore coastal environments that include relatively unimpacted sandy bed conditions, or mine voids that receive little catchment inflow. This simulation class could equally be applied to smaller, well flushed estuaries that receive relatively little catchment derived organic matter, or to basic studies of lakes and water supply reservoirs. The latter cases (amongst others) might also use this simulation class as a stepping stone towards subsequent and more detailed simulations that include organic matter cycling. This would simply require upgrade from this simulation class to the organics simulation class. This simulation class includes the oxygen, silicate, inorganic nitrogen, inorganic phosphorus, phytoplankton and (optionally) pathogen model classes. Figure 3.5: Simulation Class: Inorganics (as an estuarine example) 3.2.2 Model Class: Oxygen This model class is the same as that described in Section 3.1.2. 3.2.3 Model Class: Silicate The following constituent models are available to select from within the silicate model class. 3.2.3.1 Constituent Model: Si The constituent model code and associated variables, processes and potentially interacting simulated quantities are provided in Figure 3.6 and Table 3.4. Figure 3.6: Constituent model: Si Table 3.4: Constituent model properties: Si Computed Variables Units Processes Interacting Quantities Silicate mg/L or mmol/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties This is a relatively simple model, with the only process requiring parameterisation being the sediment flux of silicate. By default, this process depends on overlying dissolved oxygen concentrations, but this can optionally be turned off if required. 3.2.4 Model Class: Inorganic nitrogen The following constituent models are available to select from within the inorganic nitrogen model class. 3.2.4.1 Constituent Model: AmmoniumNitrate The constituent model code and associated variables, processes and potentially interacting simulated quantities are provided in Figure 3.7 and Table 3.5. Figure 3.7: Constituent model: AmmoniumNitrate Table 3.5: Constituent model properties: AmmoniumNitrate Computed Variables Units Processes Interacting Quantities Ammonium mg/L or mmol/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Nitrification \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrification parameters\\(\\cdot\\blockindent\\)Ammonium Wet atmospheric deposition \\(\\cdot\\blockindent\\)Rainfall Dry atmospheric deposition \\(\\cdot\\blockindent\\)Atmospheric parameters Anaerobic oxidation of ammonium \\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Anammox parameters\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate Dissimilatory reduction of nitrate to ammonium \\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)DNRA parameters Nitrate mg/L or mmol/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Nitrification \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrification parameters\\(\\cdot\\blockindent\\)Ammonium Denitrification \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Denitrification parameters\\(\\cdot\\blockindent\\)Nitrate Wet atmospheric deposition \\(\\cdot\\blockindent\\)Rainfall Dry atmospheric deposition \\(\\cdot\\blockindent\\)Atmospheric parameters Anaerobic oxidation of ammonium \\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Anammox parameters\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate Dissimilatory reduction of nitrate to ammonium \\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)DNRA parameters This is a slightly more complex model than those described previously, and this reflects the complexity of inorganic nitrogenous environmental chemistry. In addition to specification of two computed variables and their respective sediment flux properties, rates and related parameters for nitrification and denitrification are also specifiable. By design, the library defaults for these processes are set to zero so that all processes are initially inactive. Users may activate these processes by specifying non-zero rate parameters. Whilst dissolved oxygen potentially modifies some processes described to this point (e.g. computed sediment flux rates), nitrification is the first of these processes that also potentially consumes dissolved oxygen. Specifically, if nitrification is simulated (i.e. non-zero rate parameters are specified) and allowed to include the effect of dissolved oxygen (the default), then dissolved oxygen concentrations are drawn down as the process operates. Table 3.6: Complementary lower order computed variables: AmmoniumNitrate Computed Variables Units Processes Interacting Quantities Dissolved oxygen mg/L or mmol/m\\(^3\\) Nitrification \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Nitrification parameters\\(\\cdot\\blockindent\\)Ammonium 3.2.5 Model Class: Inorganic phosphorus The following constituent models are available to select from within the phosphorus model class. 3.2.5.1 Constituent Model: FRPhs The constituent model code and associated variables, processes and potentially interacting simulated quantities are provided in Figure 3.8 and Table 3.7. Figure 3.8: Constituent model: FRPhs Table 3.7: Constituent model properties: FRPhs Computed Variables Units Processes Interacting Quantities FRP mg/L or mmol/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Wet atmospheric deposition \\(\\cdot\\blockindent\\)Rainfall This is a relatively simple constituent model, but one that is critical to the simulation of higher order computed variables such as phytoplankton. 3.2.5.2 Constituent Model: FRPhsAds The constituent model code and associated variables, processes and potentially interacting simulated quantities are provided in Figure 3.9 and Table 3.8. Figure 3.9: Constituent Model: FRPhsAds Table 3.8: Constituent model properties: FRPhsAds Computed Variables Units Processes Interacting Quantities FRP mg/L or mmol/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Wet atmospheric deposition \\(\\cdot\\blockindent\\)Rainfall Adsorption and desorption \\(\\cdot\\blockindent\\)Suspended solids\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Adorption parameters FRP adsorbed mg/L or mmol/m\\(^3\\) Adsorption and desorption \\(\\cdot\\blockindent\\)Suspended solids\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Adorption parameters Settling \\(\\cdot\\blockindent\\)Suspended solids\\(\\cdot\\blockindent\\)Suspended solids settling parameters Dry atmospheric deposition \\(\\cdot\\blockindent\\)Atmospheric parameters In order for this constituent model to be used, the TUFLOW FV Sediment Transport (ST) Module must be activated to simulate at least one fraction of suspended sediment (several fractions may be so set). A WQ Module simulation will not start if the TUFLOW ST Module is not activated. In order to use this FRPhsAds constituent model therefore, the following must be in place: The TUFLOW FV ST Module must be activated and implemented At least one sediment fraction must be set up and executed within TUFLOW FV via the inclusion of a sediment control file, and specification of either of the following TUFLOW FV commands: include sediment == 1,0 ! Do not include sediment in density calculations or include sediment == 1,1 ! Include sediment in density calculations If multiple sediment fractions are specified to be simulated by the ST Module, then TUFLOW FV sends all these fraction concentrations as a sum through the API to the WQ Module, and this sum is used as the sediment concentration against which adsorption is computed. The WQ Module uses this information to compute FRP adsorption and loss of adsorbed FRP through settling. It is recognised that there are limitations of this approach. Future releases of TUFLOW FV and the WQ Module will address some of these limitations and allow for: User control of which ST Module sediment fractions are used in adsorption calculations, and Use of the TUFLOW FV ST Module settling and resuspension routines to dynamically link settling and resuspension of adsorbed FRP 3.2.6 Model Class: Phytoplankton The following constituent models are available to select from within the phytoplankton model class. The differentiator between constituent models is the treatment of internal (to a phytoplankton cell) nutrient simulation. 3.2.6.1 Constituent Model: Basic This basic phytoplankton constituent model assumes that the ratios of both internal nitrogen and phosphorus concentrations to internal chlorophyll a (or carbon) concentration are fixed. These internal nutrients are not simulated explicitly, but increase and decrease proportionately with increasing and decreasing carbonaceous biomass, according to the specified (or default) nitrogen-chlorophyll a and phosphorus-chlorophyll a (or their carbon equivalents) ratios. Carbonaceous biomass is simulated dynamically and is the measure of phytoplankton concentration. Internal nutrient concentrations are not required to be specified as initial or boundary conditions, and are not treated as computed variables. The constituent model code and associated computed variables, processes and potentially interacting simulated quantities are provided in Figure 3.10 and Table 3.9. Silicate interactions only apply if phytoplankton is set to uptake silicate via specification of silicate limitation function parameters (section 4.7.3.5.1). The configuration for phytoplankton simulation presented below applies only to the inorganics simulation class. A different, and expanded, configuration applies when phytoplankton is simulated using this basic constituent model in the organics simulation class. This expanded configuration is described in section 3.3.7.1. Figure 3.10: Constituent model: Basic Table 3.9: Constituent model properties: Basic Computed Variables Units Processes Interacting Quantities Phytoplankton \\(\\mu\\)g Chl a/L or mmol C/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) Settling \\(\\cdot\\blockindent\\)Settling model\\(\\cdot\\blockindent\\)Cell density The three processes that govern phytoplankton behaviour are: Primary productivity (the photosynthetic conversion of light and carbon to stored energy and oxygen, also referred to as growth) Respiration (the expenditure of stored energy and oxygen), and Settling A range of light, temperature, salinity, nitrogen, phosphorus and silicate limitation functions can be parameterised and applied in various combinations to the first two processes above, and a range of settling models are available to tailor the third. By design, the associated library default rates are set to zero so as to render all processes initially inactive. Specification of non-zero rates activates these processes. The distinguishing property of this phytoplankton constituent model is that internal (phytoplankton cell) nutrient concentrations are considered to be fixed proportions of cell chlorophyll a (or carbon) concentrations. They are therefore not treated as computed variables, but rather as multiples of phytoplankton chlorophyll a (or carbon) (which is treated as a computed variable). The key implication of this is the method of calculation of the nitrogen and phosphorus uptake and limitation functions applied to primary productivity. These calculations depend only on ambient (i.e. external to a phytoplankton cell) water column nitrogen and phosphorus concentrations. Simulation of phytoplankton dynamics in the inorganics simulation class directly modifies the concentrations of a range of other computed variables. These are listed in Table 3.10. Silicate interactions only apply if phytoplankton is set to uptake silicate. Table 3.10: Complementary lower order computed variables: Basic Computed Variables Units Processes Interacting Quantities Dissolved oxygen mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light Ammonium mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) Excretion \\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) Mortality \\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) Nitrate mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) FRP mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Silicate (if activated) Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Silicate (if activated) Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Silicate (if activated) Silicate (if activated) mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP 3.2.6.2 Constituent Model: Advanced This phytoplankton constituent model directly simulates internal (phytoplankton cell) nitrogen and phosphorus concentrations. These are allowed to vary between upper and lower limits, expressed as ratios to chlorophyll a (or carbon) concentrations. Internal nutrient concentrations (not as ratios) are required to be specified as initial and boundary conditions, and are treated as computed variables. The constituent model code and associated variables, processes and potentially interacting simulated quantities are provided in Figure 3.11 and Table 3.11. Silicate interactions only apply if phytoplankton is set to uptake silicate. The configuration for phytoplankton simulation presented below applies only to the inorganics simulation class. A different, and expanded, configuration applies when phytoplankton is simulated using this advanced constituent model in the organics simulation class. This expanded configuration is described in section 3.3.7.2. Figure 3.11: Constituent model: Advanced Table 3.11: Constituent model properties: Advanced Computed Variables Units Processes Interacting Quantities Phytoplankton \\(\\mu\\)g Chl a/L or mmol C/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Settling \\(\\cdot\\blockindent\\)Settling model\\(\\cdot\\blockindent\\)Cell density\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Internal nitrogen mg N/L or mmol N/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Uptake \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Internal phosphorus Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Settling \\(\\cdot\\blockindent\\)Settling model\\(\\cdot\\blockindent\\)Cell density\\(\\cdot\\blockindent\\)Internal phosphorus Internal phosphorus mg P/L or mmol P/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Silicate (if activated) Uptake \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Silicate (if activated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Internal nitrogen Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Silicate (if activated) Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Silicate (if activated) Settling \\(\\cdot\\blockindent\\)Settling model\\(\\cdot\\blockindent\\)Cell density\\(\\cdot\\blockindent\\)Internal nitrogen The three processes that govern phytoplankton behaviour are: Primary productivity (the photosynthetic conversion of light and carbon to stored energy and oxygen, also referred to as growth) Respiration (the expenditure of stored energy and oxygen), and Settling A range of light, temperature, salinity, nitrogen, phosphorus and silicate limitation functions can be parameterised and applied in various combinations to the first two processes above, and a range of settling models are available to tailor the third. By design, the associated library default rates are set to zero so as to render all processes initially inactive. Specification of non-zero rates activates these processes. The distinguishing property of this phytoplankton constituent model is that internal (phytoplankton cell) nutrient concentrations are simulated directly. They are therefore treated as computed variables. The key implication of this is the method of calculation of the nitrogen and phosphorus uptake and limitation functions applied to primary productivity. These calculations depend on both internal nutrient stores and ambient (i.e. external to a phytoplankton cell) water column nitrogen and phosphorus concentrations. Simulation of phytoplankton dynamics in the inorganics simulation class directly modifies the concentrations of a range of other computed variables. These are listed in Table 3.12. Silicate interactions only apply if phytoplankton is set to uptake silicate. Table 3.12: Complementary lower order computed variables: Advanced Computed Variables Units Processes Interacting Quantities Dissolved oxygen mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if simulated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light Ammonium mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if simulated) Excretion \\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if simulated) Mortality \\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if simulated) Nitrate mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if simulated) FRP mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if simulated) Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if simulated) Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if simulated) Silicate (if simulated) mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus 3.2.7 Model Class: Pathogens (optional) This model class is the same as that described in Section 3.1.3. 3.2.8 Computed variables The relationships between all available computed variables and processes is this inorganics simulation class are presented in Figure 3.12. Depending on the constituent model classes deployed, not all of the computed variables and processes shown in the figure will necessarily be active. All network link labels have been removed (other than denoting the relevant phytoplankton model), and optional non-interacting model classes (e.g. pathogens) omitted, for clarity. Figure 3.12: Simulation class: Inorganics 3.3 Simulation Class: Organics 3.3.1 Overview The intent of this simulation class is that it provide a relatively advanced water quality modelling tool. There are many applications for this class. For example it might be used to examine detailed reservoir phytoplankton dynamics or the response of an estuary to both inorganic and organic pollutant loading. This simulation class includes the oxygen, silicate, inorganic nitrogen, inorganic phosphorus, organic matter, phytoplankton and (optionally) pathogen model classes. Figure 3.13: Simulation Class: Organics (as an estuarine example) 3.3.2 Model Class: Oxygen This constituent model class is the same as that described in Section 3.1.2 3.3.3 Model Class: Silicate This constituent model class is the same as that described in Section 3.2.3 3.3.4 Model Class: Inorganic nitrogen This constituent model class is the same as that described in Section 3.2.4 3.3.5 Model Class: Inorganic phosphorus This constituent model class is the same as that described in Section 3.2.5 3.3.6 Model Class: Organic matter The following constituent models are available to select from within the organic matter model class. The differentiator between constituent models is the exclusion or inclusion of refractory organic matter. 3.3.6.1 Constituent Model: Labile This organic matter constituent model considers only labile particulate and dissolved organic matter. The constituent model code and associated computed variables, processes and potentially interacting simulated quantities are provided in Figure 3.14 and Table 3.13. Both the Figure and Table (and Table 3.14) make reference to dissolved inorganic carbon (DIC). This is for completeness only because the WQ Module does not currently support simulation of DIC. Doing so is not required in order to deploy either the labile or refractory organic matter constituent model within the WQ Module. Figure 3.14: Constituent model: Labile Table 3.13: Constituent model properties: Labile Computed Variables Units Processes Interacting Quantities Labile particulate organic carbon mg C/L or mmol C/m\\(^3\\) Hydrolysis \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen Settling \\(\\cdot\\blockindent\\)Settling model Labile particulate organic nitrogen mg N/L or mmol N/m\\(^3\\) Hydrolysis \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen Settling \\(\\cdot\\blockindent\\)Settling model Labile particulate organic phosphorus mg P/L or mmol P/m\\(^3\\) Hydrolysis \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen Settling \\(\\cdot\\blockindent\\)Settling model Labile dissolved organic carbon mg C/L or mmol C/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Hydrolysis \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)POC Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate Labile dissolved organic nitrogen mg N/L or mmol N/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Hydrolysis \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)PON Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate Labile dissolved organic phosphorus mg P/L or mmol P/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Hydrolysis \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)POP Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate The four processes that govern (labile) organic matter behaviour in this constituent model are: Sediment flux Hydrolysis (the conversion of particulate organics to dissolved organics) Mineralisation (the conversion of dissolved organics to inorganics), and Settling, of only particulate organics A range of rate constants can be specified to control these processes, or the defaults used. By design, the library default rates are set to zero so as to render all processes initially inactive. Specification of non-zero rates activates these processes. Simulation of labile organic dynamics in the organics simulation class directly modifies the concentrations of other computed variables. These are listed in Table 3.14. Table 3.14: Complementary lower order computed variables: Labile Computed Variables Units Processes Interacting Quantities Dissolved oxygen mg/L or mmol/m\\(^3\\) Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)DON\\(\\cdot\\blockindent\\)DOP Nitrate mg/L or mmol/m\\(^3\\) Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)DON\\(\\cdot\\blockindent\\)DOP Ammonium mg/L or mmol/m\\(^3\\) Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)DON FRP mg/L or mmol/m\\(^3\\) Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)DOP DIC mg/L or mmol/m\\(^3\\) Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)DOC 3.3.6.2 Constituent Model: Refractory This organic matter constituent model considers both labile and refractory particulate and dissolved organic matter. The constituent model code and associated computed variables, processes and potentially interacting simulated quantities are provided in Figure 3.15 and Table 3.15. Both the Figure and Table (and Table 3.16) make reference to dissolved inorganic carbon (DIC). This is for completeness only because the WQ Module does not currently support simulation of DIC. Doing so is not required in order to deploy either the labile or refractory organic matter constituent model within the WQ Module. Figure 3.15: Constituent model: Refractory Table 3.15: Constituent model properties: Refractory Computed Variables Units Processes Interacting Quantities Labile particulate organic carbon mg C/L or mmol C/m\\(^3\\) Hydrolysis \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen Settling \\(\\cdot\\blockindent\\)Settling model Breakdown \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)RPOM Labile particulate organic nitrogen mg N/L or mmol N/m\\(^3\\) Hydrolysis \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen Settling \\(\\cdot\\blockindent\\)Settling model Breakdown \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)RPOM Labile particulate organic phosphorus mg P/L or mmol P/m\\(^3\\) Hydrolysis \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen Settling \\(\\cdot\\blockindent\\)Settling model Breakdown \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)RPOM Labile dissolved organic carbon mg C/L or mmol C/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Hydrolysis \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)POC Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate Activation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)RDOC Photolysis \\(\\cdot\\blockindent\\)Radiation\\(\\cdot\\blockindent\\)RDOC Labile dissolved organic nitrogen mg N/L or mmol N/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Hydrolysis \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)PON Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate Activation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)RDON Photolysis \\(\\cdot\\blockindent\\)Radiation\\(\\cdot\\blockindent\\)RDON Labile dissolved organic phosphorus mg P/L or mmol P/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Hydrolysis \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)POP Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate Activation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)RDOP Photolysis \\(\\cdot\\blockindent\\)Radiation\\(\\cdot\\blockindent\\)RDOP Refractory particulate organic carbon mg C/L or mmol C/m\\(^3\\) Settling \\(\\cdot\\blockindent\\)Settling model Breakdown \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen Refractory dissolved organic carbon mg C/L or mmol C/m\\(^3\\) Activation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen Photolysis \\(\\cdot\\blockindent\\)Radiation\\(\\cdot\\blockindent\\)RDOC Refractory dissolved organic nitrogen mg N/L or mmol N/m\\(^3\\) Activation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen Photolysis \\(\\cdot\\blockindent\\)Radiation\\(\\cdot\\blockindent\\)RDOC\\(\\cdot\\blockindent\\)RDON Refractory dissolved organic phosphorus mg N/L or mmol N/m\\(^3\\) Activation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen Photolysis \\(\\cdot\\blockindent\\)Radiation\\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)RDOC\\(\\cdot\\blockindent\\)RDOP The processes that govern (labile and refractory) organic matter behaviour in this constituent model are: Sediment flux Hydrolysis (the conversion of particulate organics to dissolved organics) Mineralisation (the conversion of dissolved organics to inorganics) Breakdown (the conversion of refractory particulate organic matter to labile particulate organic matter) Photolysis (the conversion of refractory dissolved organic matter to labile dissolved organic matter and corresponding inorganics) Activation (the conversion of refractory dissolved to labile dissolved organic matter) Settling, of only particulate organics A range of rate constants can be specified to control these processes, or the defaults used. By design, the library default rates are set to zero so as to render all processes initially inactive. Specification of non-zero rates activates these processes. Simulation of labile and refractory organic dynamics in the organics simulation class directly modifies the concentrations of other computed variables. These are listed in Table 3.16. Table 3.16: Complementary lower order computed variables: Refractory Computed Variables Units Processes Interacting Quantities Dissolved oxygen mg/L or mmol/m\\(^3\\) Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen Nitrate mg/L or mmol/m\\(^3\\) Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate Ammonium mg/L or mmol/m\\(^3\\) Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate Photolysis \\(\\cdot\\blockindent\\)Radiation\\(\\cdot\\blockindent\\)RDON FRP mg/L or mmol/m\\(^3\\) Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate Photolysis \\(\\cdot\\blockindent\\)Radiation\\(\\cdot\\blockindent\\)RDOP DIC Mineralisation \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrate Photolysis \\(\\cdot\\blockindent\\)Radiation\\(\\cdot\\blockindent\\)RDOC 3.3.7 Model Class: Phytoplankton This constituent model class is the same as that described in Section 3.2.6, except that in the current constituent model class, phytoplanktonic losses are to labile organic computed variables rather than inorganic nutrients. These processes and interactions are described below. 3.3.7.1 Constituent Model: Basic As per Section 3.2.6.1, this phytoplankton constituent model assumes that the ratios of both internal nitrogen and phosphorus concentrations to internal chlorophyll a (or carbon) concentration are fixed. These internal nutrients are not simulated explicitly, but increase and decrease proportionately with increasing and decreasing carbonaceous biomass, according to the specified (or default) nitrogen-chlorophyll a and phosphorus-chlorophyll a (or their carbon equivalents) ratios. Carbonaceous biomass is simulated dynamically and is the measure of phytoplankton concentration. Internal nutrient concentrations are not required to be specified as initial or boundary conditions, and are not treated as computed variables. The constituent model code and associated computed variables, processes and potentially interacting simulated quantities are provided in Figure 3.16 and Table 3.17. Silicate interactions only apply if phytoplankton is set to uptake silicate via specification of silicate limitation function parameters (section 4.7.3.5.1). The configuration for phytoplankton simulation presented below applies only to the organics simulation class. A different, and simpler, configuration applies when phytoplankton is simulated using this basic constituent model in the inorganics simulation class. That simplified configuration is described in section 3.2.6.1. Figure 3.16: Constituent model: Basic Table 3.17: Constituent model properties: Basic Computed Variables Units Processes Interacting Quantities Phytoplankton \\(\\mu\\)g Chl a/L or mmol C/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen Excretion \\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)DON\\(\\cdot\\blockindent\\)DOP\\(\\cdot\\blockindent\\)Silicate (if activated) Mortality \\(\\cdot\\blockindent\\)POC\\(\\cdot\\blockindent\\)PON\\(\\cdot\\blockindent\\)POP\\(\\cdot\\blockindent\\)Silicate (if activated) Settling \\(\\cdot\\blockindent\\)Settling model\\(\\cdot\\blockindent\\)Cell density The three processes that govern phytoplankton behaviour are: Primary productivity (the photosynthetic conversion of light and carbon to stored energy and oxygen, also referred to as growth) Respiration (the expenditure of stored energy and oxygen), and Settling A range of light, temperature, salinity, nitrogen, phosphorus and silicate limitation functions can be parameterised and applied in various combinations to the first two processes above, and a range of settling models are available to tailor the third. By design, the associated library default rates are set to zero so as to render all processes initially inactive. Specification of non-zero rates activates these processes. The distinguishing property of this phytoplankton constituent model is that internal (phytoplankton cell) nutrient concentrations are considered to be fixed proportions of cell chlorophyll a (or carbon) concentrations. They are therefore not treated as computed variables, but rather as multiples of phytoplankton chlorophyll a (or carbon) (which is treated as a computed variable). The key implication of this is the method of calculation of the nitrogen and phosphorus uptake and limitation functions applied to primary productivity. These calculations depend only on ambient (i.e. external to a phytoplankton cell) water column nitrogen and phosphorus concentrations. Simulation of phytoplankton dynamics in the organics simulation class directly modifies the concentrations of a range of other computed variables. These are listed in Table 3.18. Silicate interactions only apply if phytoplankton is set to uptake silicate. Table 3.18: Complementary lower order computed variables: Basic Computed Variables Units Processes Interacting Quantities Dissolved oxygen mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light Ammonium mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) Nitrate mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) FRP mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Silicate (if activated) Silicate (if activated) mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP Excretion \\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)DON\\(\\cdot\\blockindent\\)DOP Mortality \\(\\cdot\\blockindent\\)POC\\(\\cdot\\blockindent\\)PON\\(\\cdot\\blockindent\\)POP Labile particulate organic carbon mg/L or mmol/m\\(^3\\) Mortality \\(\\cdot\\blockindent\\)PON\\(\\cdot\\blockindent\\)POP\\(\\cdot\\blockindent\\)Silicate (if activated) Labile particulate organic nitrogen mg/L or mmol/m\\(^3\\) Mortality \\(\\cdot\\blockindent\\)POC\\(\\cdot\\blockindent\\)POP\\(\\cdot\\blockindent\\)Silicate (if activated) Labile particulate organic phosphorus mg/L or mmol/m\\(^3\\) Mortality \\(\\cdot\\blockindent\\)POC\\(\\cdot\\blockindent\\)PON\\(\\cdot\\blockindent\\)Silicate (if activated) Labile dissolved organic carbon mg/L or mmol/m\\(^3\\) Excretion \\(\\cdot\\blockindent\\)DON\\(\\cdot\\blockindent\\)DOP\\(\\cdot\\blockindent\\)Silicate (if activated) Labile dissolved organic nitrogen mg/L or mmol/m\\(^3\\) Excretion \\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)DOP\\(\\cdot\\blockindent\\)Silicate (if activated) Labile dissolved organic phosphorus mg/L or mmol/m\\(^3\\) Excretion \\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)DON\\(\\cdot\\blockindent\\)Silicate (if activated) 3.3.7.2 Constituent Model: Advanced As per Section 3.2.6.2, this phytoplankton constituent model directly simulates internal (phytoplankton cell) nitrogen and phosphorus concentrations. These are allowed to vary between upper and lower limits, expressed as ratios to chlorophyll a (or carbon) concentrations. Internal nutrient concentrations (not as ratios) are required to be specified as initial and boundary conditions, and are treated as computed variables. The constituent model code and associated variables, processes and potentially interacting simulated quantities are provided in Figure 3.17 and Table 3.19. Silicate interactions only apply if phytoplankton is set to uptake silicate. The configuration for phytoplankton simulation presented below applies only to the organics simulation class. A different, and simplified, configuration applies when phytoplankton is simulated using this advanced constituent model in the inorganics simulation class. That configuration is described in section 3.2.6.2. Figure 3.17: Constituent model: Advanced Table 3.19: Constituent model properties: Advanced Computed Variables Units Processes Interacting Quantities Phytoplankton \\(\\mu\\)g Chl a/L or mmol C/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Excretion \\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)DON\\(\\cdot\\blockindent\\)DOP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Mortality \\(\\cdot\\blockindent\\)POC\\(\\cdot\\blockindent\\)PON\\(\\cdot\\blockindent\\)POP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Settling \\(\\cdot\\blockindent\\)Settling model\\(\\cdot\\blockindent\\)Cell density\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Internal nitrogen mg N/L or mmol N/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Uptake \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Internal phosphorus Excretion \\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)DON\\(\\cdot\\blockindent\\)DOP\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Mortality \\(\\cdot\\blockindent\\)POC\\(\\cdot\\blockindent\\)PON\\(\\cdot\\blockindent\\)POP\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Settling \\(\\cdot\\blockindent\\)Settling model\\(\\cdot\\blockindent\\)Cell density\\(\\cdot\\blockindent\\)Internal phosphorus Internal phosphorus mg P/L or mmol P/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Silicate (if activated) Uptake \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Silicate (if activated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Internal nitrogen Excretion \\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)DON\\(\\cdot\\blockindent\\)DOP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Silicate (if activated) Mortality \\(\\cdot\\blockindent\\)POC\\(\\cdot\\blockindent\\)PON\\(\\cdot\\blockindent\\)POP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Silicate (if activated) Settling \\(\\cdot\\blockindent\\)Settling model\\(\\cdot\\blockindent\\)Cell density\\(\\cdot\\blockindent\\)Internal nitrogen The three processes that govern phytoplankton behaviour are: Primary productivity (the photosynthetic conversion of light and carbon to stored energy and oxygen, also referred to as growth) Respiration (the expenditure of stored energy and oxygen), and Settling A range of light, temperature, salinity, nitrogen, phosphorus and silicate limitation functions can be parameterised and applied in various combinations to the first two processes above, and a range of settling models are available to tailor the third. By design, the associated library default rates are set to zero so as to render all processes initially inactive. Specification of non-zero rates activates these processes. The distinguishing property of this phytoplankton constituent model is that internal (phytoplankton cell) nutrient concentrations are simulated directly. They are therefore treated as computed variables. The key implication of this is the method of calculation of the nitrogen and phosphorus uptake and limitation functions applied to primary productivity. These calculations depend on both internal nutrient stores and ambient (i.e. external to a phytoplankton cell) water column nitrogen and phosphorus concentrations. Simulation of phytoplankton dynamics in the organics simulation class directly modifies the concentrations of a range of other computed variables. These are listed in Table 3.20. Silicate interactions only apply if phytoplankton is set to uptake silicate. Table 3.20: Complementary lower order computed variables: Advanced Computed Variables Units Processes Interacting Quantities Dissolved oxygen mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light Ammonium mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) Nitrate mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) FRP mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Silicate (if activated) mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Excretion \\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)DON\\(\\cdot\\blockindent\\)DOP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Mortality \\(\\cdot\\blockindent\\)POC\\(\\cdot\\blockindent\\)PON\\(\\cdot\\blockindent\\)POP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Labile particulate organic carbon mg/L or mmol/m\\(^3\\) Mortality \\(\\cdot\\blockindent\\)PON\\(\\cdot\\blockindent\\)POP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Labile particulate organic nitrogen mg/L or mmol/m\\(^3\\) Mortality \\(\\cdot\\blockindent\\)POC\\(\\cdot\\blockindent\\)POP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Labile particulate organic phosphorus mg/L or mmol/m\\(^3\\) Mortality \\(\\cdot\\blockindent\\)POC\\(\\cdot\\blockindent\\)PON\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Labile dissolved organic carbon mg/L or mmol/m\\(^3\\) Excretion \\(\\cdot\\blockindent\\)DON\\(\\cdot\\blockindent\\)DOP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Labile dissolved organic nitrogen mg/L or mmol/m\\(^3\\) Excretion \\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)DOP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) Labile dissolved organic phosphorus mg/L or mmol/m\\(^3\\) Excretion \\(\\cdot\\blockindent\\)DOC\\(\\cdot\\blockindent\\)DON\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate (if activated) 3.3.8 Model Class: Pathogens (optional) This model class is the same as that described in Section 3.1.3. 3.3.9 Computed variables The relationships between all available computed variables and processes is this simulation class are presented in Figure 3.18. Depending on the constituent model classes deployed, not all of the computed variables and processes shown in the figure will necessarily be active. All network link labels have been removed (other than denoting the relevant phytoplankton model), and optional non-interacting model classes (e.g. pathogens) omitted, for clarity. Figure 3.18: Simulation class: Organics "],["SimulationConstruction-1.html", "Section 4 Simulation Construction 4.1 Context 4.2 Units 4.3 General arrangement 4.4 TUFLOW FV control file commands 4.5 Water quality control file commands 4.6 Simulation Class: DO 4.7 Simulation Class: Inorganics 4.8 Simulation Class: Organics 4.9 Outputs", " Section 4 Simulation Construction 4.1 Context Previous sections have presented the architecture and water quality processes available within the WQ Module. This section describes the construction of a TUFLOW simulation with the WQ Module activated. This includes descriptions of all commands, with hyperlinks to the Appendices where commands and explanations are listed in a searchable and sortable table for ease of access. TUFLOW FV is the hydrodynamic model used in all descriptions that follow. Optional model classes (such as pathogens) and their construction are first described in the simplest simulation class for which they can be deployed. Commentary on the ordering of optional constituents is provided in subsequent sections only where needed. 4.2 Units The WQ Module allows for simulation construction in one of two unit systems (see Section 4.5.1): A milligrams per litre system (which includes micrograms per litre for phytoplankton) that aligns with typical units of laboratory reporting, and A millimoles per cubic metre system A single units system must be adopted for a WQ Module simulation, and unit systems cannot be mixed within a simulation. This specification has implications for at least the setting of numerical values for: Initial conditions Boundary conditions Computed variable parameters When the milligrams per litre system is used, the WQ Module executes internal conversions between milligrams and millimoles, because millimoles are the units expected by the core water quality calculation routines. This conversion follows the form: \\[\\begin{equation} n = \\frac{m}{M} \\tag{4.1} \\end{equation}\\] where \\(n\\) is millimoles (mmol), \\(m\\) is mass (mg) and \\(M\\) is molar weight (mg/mmol). A similar concept applies to concentration and flux quantities. As such, the WQ Module assigns values to \\(M\\) in converting from milligrams to millimoles, i.e. from user specified milligram initial conditions, boundary conditions and computed variable parameters, to the equivalent millimole quantities. The complete list of values of \\(M\\) for all simulated constituents is provided in Table P.1. The two possibilities for units for each parameter are provided in Appendix R, where relevant. As an example, if a user specifies the milligrams per litre units system (or allows the same default to be set) and sets FRP flux == 3.1 in a materials block, then this value of 3.1 is assumed to be mg/m\\(^2\\)/day. Consistent with typical laboratory reporting conventions (see below), this mass flux is taken to be that of elemental phosphorus \\(P\\), not that of the phosphate molecule \\(PO_4^{3-}\\). This would mean (using Table P.1 and Equation (4.1)) that the equivalent millimole rate would be computed as: \\[\\begin{equation} n = \\frac{3.1}{31} = 0.1 \\hspace{0.1cm} \\text{mmol/m$^2$/day of P} \\tag{4.2} \\end{equation}\\] Given the above, users opting to construct WQ Module simulations in the milligrams units system need to clearly understand what is being reported in: Field and/or laboratory measurements, and Other numerical model predictions that may be used as WQ Module boundary conditions (such as catchment pollutant export models) In the case of laboratory nutrient measurements, it is conventional to report concentrations of the typical quantities used by the WQ Module as silicate-Si, ammonium-N, nitrate-N, FRP-P, organic-C, organic-N, and organic-P. Whilst these quantities might be referred to informally as (for example) “nitrate concentrations”, the reported number is most commonly the concentration of elemental nitrogen contained within nitrate. To be clear, if a nitrate-N concentration is reported by a laboratory to be 3.5 mg/L, this means that in every litre of water, there are 3.5 milligrams of elemental nitrogen contained within nitrate molecules. Given the molar masses of elemental nitrogen and nitrate, this 3.5 milligrams of elemental N means that there are 15.5 milligrams of nitrate molecules (15.5 = 3.5 x 62/14) in the same litre of water. In this example, the concentration with which the WQ Module expects to be provided is 3.5 mg/L, not 15.5 mg/L. The use of other model data to force WQ Module boundary conditions is also interpreted in this way. For example, a catchment model might report that an inflow to the WQ Module at an upstream riverine boundary condition has a “total nitrogen” concentration of 10.0 mg/L, and a user may have then speciated this to nitrate by applying a multiplicative factor of 0.15. If this resulting nitrate concentration of 1.5 mg/L is applied to the WQ Module as a boundary condition, it must be a concentration of elemental nitrogen within nitrate, which is consistent with what would be reported by a laboratory. This means that the user must be sure that the “total nitrogen” reported by the catchment model is in fact an elemental nitrogen concentration. If users elect to construct WQ Module simulations in units of millimoles, then no internal WQ Module conversions take place, and the nature of the quantity (molecular or elemental) being specified is not relevant. For example, the user could specify millimoles units and a “FRP flux” of 0.1. This could be interpreted as a mmol/m\\(^2\\)/day rate of either the \\(PO_4^{3-}\\) molecule, or just phosphorus \\(P\\). This is because in one millimole of \\(PO_4^{3-}\\), there is also one millimole of elemental \\(P\\). The same one to one relationship holds for all other WQ Module relevant computed quantities (see Table P.1), other than oxygen which is treated as a diatomic molecule. 4.3 General arrangement A water quality simulation is set up and executed under the umbrella of a TUFLOW FV control file (Figure 4.1, with other optional modules shown for illustrative purposes). That is: The TUFLOW FV control file (*.fvc) file remains the central file that initiates and coordinates an overall simulation. This mirrors the way in which other TUFLOW FV modules, such as the ST Module and PT Module, are activated and executed The TUFLOW FV control file contains a path to a separate WQ Module control file (*.fvwq) that in turn contains all the commands required to configure a WQ Module simulation \\(\\newcommand{\\blockindent}{\\hspace{0.5cm}}\\) Figure 4.1: Simulation Coordination TUFLOW FV and WQ Module control file commands are presented following. 4.4 TUFLOW FV control file commands A TUFLOW FV simulation is executed as described in the TUFLOW FV user manual. If the WQ Module is to be activated in a simulation then the following commands are to be included. 4.4.1 WQ Module activation Activation of the WQ Module is affected by specification of the following mandatory command in the TUFLOW control file: water quality model == TUFLOW Following this activation, TUFLOW FV will look for the specification of the name of the separate WQ Module control file via the following mandatory command: water quality control file == &lt;water quality control file name&gt;.fvwq This *.fvwq is separate to the *.fvc and contains user specified information that describes the configuration of the water quality simulation. If the *.fvwq is located in the same directory as the *.fvc, then this filename specification needs no associated path. It is recommended however that the *.fvwq be located in a directory separate to the *.fvc so that log and other related water quality specific files can be easily curated. If this approach is adopted, the following additional *.fvc command is required, noting that the folder path is specified as relative to the folder in which the *.fvc resides: water quality model directory == &lt;relative path to WQ directory&gt;\\(\\backslash\\) This command must terminate in a \\(\\backslash\\) character. If this command is issued, then the *.fvwq water quality control file must be located in the directory specified. In certain circumstances, executing water quality calculations in shallow cells can cause numerical instabilities. To control this behaviour, the WQ Module allows for water quality calculations to be switched off in cells that have depths less than a specified minimum (advection dispersion calculations will however continue to be performed - it is only the water quality-related non-conservative transformations that are turned off). This minimum depth (in meters) is specified in the TUFLOW FV *.fvc via the command: cell water quality depth == \\(d_{min-wq}\\) If this command is not issued then the default minimum depth of 0.01m (1cm) is applied. This command parallels the TUFLOW FV command that controls the execution of hydrodynamic calculations as a function of water depth: cell wet/dry depths == cell dry depth (m), cell wet depth (m) In this TUFLOW FV command: The cell dry depth value (default = 1.0e-06 m) corresponds to the water depth below which a cell is dropped completely from hydrodynamic (TUFLOW FV) computations (subject to the status of surrounding cells) and is therefore considered to be ‘dry’. Cells that have dried in a given time step are given a stat value of 0 in all TUFLOW FV results files, so this stat field acts as a mask to determine which cells are wet and dry when using post processing tools and or scripts. Dry cells are not contoured in QGIS or SMS when viewed, but appear as transparent. If set to a negative value the cell dry depth is set to zero. The cell wet depth value (default = 1.0e-02 m) corresponds to the water depth below which a cell’s momentum is set to zero in order to avoid unphysical velocities at very low depths. The cell is not considered to be dry and therefore has a stat value of -1. If this value is less than or equal to the cell dry depth, it is set to the cell dry depth. Given this, it is therefore recommended that across these commands and/or defaults, a user ensures that the following holds (as it does for the default values noted above): \\[\\begin{equation} \\text{cell dry depth} \\lt \\text{cell wet depth} \\lt \\text{cell water quality depth} \\tag{4.3} \\end{equation}\\] If, for example, cell water quality depth is set to a value less than cell dry depth, then water quality calculations will be attempted on cells that TUFLOW FV considers to be dry, which is to be avoided. If a situation arose where it was absolutely necessary, then cell water quality depth could be set to a value less than cell wet depth (but still greater than cell dry depth), but this is not recommended. To summarise, and if the recommended relative magnitudes of depths presented in Equation (4.3) is adopted, then the following applies: water depth \\(\\gt\\) cell water quality depth: water quality calculations and momentum calculations performed cell water quality depth \\(\\gt\\) water depth \\(\\gt\\) cell wet depth : water quality calculations switched off, momentum calculations performed (advection and dispersion calculations also performed on water quality variables) cell wet depth \\(\\gt\\) water depth \\(\\gt\\) cell dry depth: water quality calculations switched off, momentum calculations switched off (advection and dispersion calculations also performed) cell dry depth \\(\\gt\\) water depth: no calculations performed - cell is considered dry To support debugging, water quality calculations can also be turned off completely for all cells and all timesteps by issuing this command in the TUFLOW FV *.fvc: disable water quality model == \\(B_{disable-wq}\\) and setting \\(B_{disable-wq}\\) = 1. Omitting this command, or setting \\(B_{disable-wq}\\) to zero (“0”) instead of one (“1”), will activate water quality calculations. If this command is set to one (“1”), then the WQ Module will still initialise are report as such, but when TUFLOW executes, the module will not be called. Consistent with their specification in the *.fvc, the status of these latter two commands and their arguments are reported in the TUFLOW FV log file, rather than the WQ Module log file. An example block of these five commands that together activate the WQ Module, point TUFLOW FV to the water quality control file ..\\(\\backslash\\)WQ\\(\\backslash\\)Model_000.fvwq and set the minimum depth for executing water quality calculations to 5 centimetres is: water quality model == TUFLOW water quality model directory == ..\\WQ\\ water quality control file == .\\Model_000.fvwq cell water quality depth == 0.05 disable water quality model == 0 4.4.2 Initial and boundary conditions In addition to activating the WQ Module and specifying its control file, WQ Module initial and boundary condition information is also set through the TUFLOW FV control file. The processes for doing so are described below. These are followed by discussion of the related matter of constituent ordering within initial and boundary condition specifications. 4.4.2.1 Initial conditions Water quality initial conditions are specified within or via the TUFLOW FV control file, akin to the manner in which the sediment initial conditions are set on behalf of the sediment transport module. This specification is mandatory. There are currently a number of ways that water quality initial conditions may be specified. All are affected through TUFLOW FV commands which are described in the TUFLOW FV user manual. If no water quality initial conditions are specified, then a simulation will not execute. The specifications relevant to water quality simulations are described below. The potential limitations of some of these approaches are recognised and will be addressed in future release of the WQ Module. 4.4.2.1.1 Restart files Restart files are binary files that are generated from previous simulations. These can be used as inputs to initialise water quality simulations, provided that the restart and simulation model geometries, and water quality simulation computed variables and units are identical. A restart file is specified for all simulated quantities (not just water quality) and is controlled through commands described in the TUFLOW FV user manual. The key command is restart == &lt;restart file name&gt;.rst Most often, restart files are located in the log directory, but this is not mandatory. 4.4.2.1.2 Globally uniform Globally uniform (i.e. across all spatial dimensions) initial conditions are set via a command issued from within the TUFLOW FV control file. This is often useful in setting initial conditions for simple small water bodies or at the commencement of a modelling process where initial conditions are set to be placeholders and updated at a later time. The command to do so is: initial wq concentration == ordered initial conditions Each water quality computed variable is set to a single value everywhere. These initial concentrations must be specified in a particular order and this order is described in the following sections for different simulation classes. If the above command is used to set water quality initial conditions, then it must be accompanied by parallel commands that set globally uniform salinity, temperature (and optionally sediment) initial conditions: initial temperature == 15.0 initial Water Level == 1.00 initial sediment concentration == 10.0 initial salinity == 3.5 Setting a mix of globally uniform and other initial conditions (such as profile, 2d or 3d) is not permitted. 4.4.2.1.3 Globally laterally uniform Globally laterally uniform initial conditions use an initial profile to set hydrodynamic and water quality computed variable concentrations to be everywhere the same laterally, but to vary vertically. This is often useful in setting initial conditions for deep stationary water bodies such as lakes or reservoirs. The command to do so is: initial scalar profile == &lt;initial condition file name&gt;.csv An example of the form of the text file argument initial condition file name.csv for simulating five water quality constituents is: Depth,Sal,temp,sed_1,WQ_1,WQ_2,WQ_3,WQ_4,WQ_5 0.0,2.0,22.0,5.0,8.0,22.0,2.6,1.4,0.5 10.0,2.5,15.0,15.0,5.0,32.0,2.6,1.4,0.2 20.0,3.0,10.0,25.0,0.0,42.0,5.6,5.4,0.1 If the above command is used, then it must include profile information that also sets laterally uniform salinity, temperature (and optionally sediment) initial conditions. Setting a mix of laterally uniform and other initial conditions (such as globally uniform, 2d or 3d) is not permitted. The order of these columns in the argument csv file is not important, but the columns headers are keywords and must be used as shown. For example, the following structure for initial condition file name.csv is permitted: Depth,temp,WQ_3,Sal,sed_1,WQ_4,WQ_1,WQ_2,WQ_5 0,22,2.6,2,5,1.4,8,22,0.5 10,15,2.6,2.5,15,1.4,5,32,0.2 20,10,3,3,25,5.4,0,42,0.1 Notwithstanding this, it is still considered best practise to develop initial and boundary condition files that have a logically sequential order. Water quality initial conditions headers are labelled “WQ_1”, “WQ_2” onward, and the match between these header labels and water quality computed variables is set by the computed variable ordering of the simulation class deployed. 4.4.2.1.4 Globally vertically uniform Globally vertically uniform initial conditions use an initial two dimensional map to set hydrodynamic and water quality computed variable concentrations to be everywhere the same vertically, but to vary laterally. This is often useful in setting initial conditions for shallow water bodies that have horizontal concentration gradients such as small estuaries or urban lakes. The command to do so is: initial condition 2d == &lt;initial condition file name&gt;.csv An example of the form of the text file argument initial condition file name.csv for simulating five water quality constituents is: ID,WL,sal,temp,sed_1,WQ_1 1,1.0,3.5,15,10.0,8.0 2,1.0,3.5,15,10.0,7.5 3,1.0,3.5,15,10.0,7.0 4,1.0,3.5,15,10.0,6.5 If the above command is used, then it must include information that also sets vertically uniform salinity and temperature (and optionally sediment) initial conditions, as well as water level. Setting a mix of vertically uniform and other initial conditions (such as globally uniform, laterally uniform or 3d) is not permitted. The order of these columns in the argument csv file is not important, but the columns headers are keywords and must be used as shown. For example, the following structure for initial condition file name.csv is permitted: ID,WQ_1,WL,sed_1,sal,temp 1,8.0,1.0,10.0,3.5,15 2,7.5,1.0,10.0,3.5,15 3,7.0,1.0,10.0,3.5,15 4,6.5,1.0,10.0,3.5,15 Notwithstanding this, it is still considered best practise to develop initial and boundary condition files that have a logically sequential order. Water quality initial conditions headers are labelled “WQ_1”, “WQ_2” onward, and the match between these header labels and water quality computed variables is set by the computed variable ordering of the simulation class deployed. 4.4.2.1.5 Globally varying Globally variable initial conditions use an initial three dimensional map to set hydrodynamic and water quality computed variable concentrations at each 3D cell. This is analogous to using a restart file. The command to do so is: initial condition 3d == &lt;initial condition file name&gt;.csv An example of the form of the text file argument initial condition file name.csv for simulating five water quality constituents is as follows, noting that the “ID” column refers to a three dimensional cell ID, rather than the two dimensional column ID used in the initial condition 2d == command. ID,WL,sal,temp,sed_1,WQ_1 1,1.0,3.5,15,10.0,8.0 2,1.0,3.5,14,10.0,7.5 3,1.0,3.5,13,10.0,7.0 4,1.0,3.5,12,8.0,6.5 5,1.0,3.5,15,10.0,8.0 6,1.0,3.5,14,10.0,7.4 7,1.0,3.5,13,10.0,7.1 8,1.0,3.5,11,9.0,6.6 If the above command is used, then it must include information that also sets globally varying salinity and temperature (and optionally sediment) initial conditions, as well as water level. Setting a mix of vertically uniform and other initial conditions (such as globally uniform, laterally uniform or 2d) is not permitted. The order of these columns in the argument csv file is not important, but the columns headers are keywords and must be used as shown. For example, the following structure for initial condition file name.csv is permitted: ID,WQ_1,WL,sed_1,sal,temp 1,8.0,1.0,10.0,3.5,15 2,7.5,1.0,10.0,3.5,14 3,7.0,1.0,10.0,3.5,13 4,6.5,1.0,8.0,3.5,12 5,8.0,1.0,10.0,3.5,15 6,7.4,1.0,10.0,3.5,14 7,7.1,1.0,10.0,3.5,13 8,6.6,1.0,9.0,3.5,12 Notwithstanding this, it is still considered best practise to develop initial and boundary condition files that have a logically sequential order. Water quality initial conditions headers are labelled “WQ_1”, “WQ_2” onward, and the match between these header labels and water quality computed variables is set by the computed variable ordering of the simulation class deployed. 4.4.2.2 Boundary conditions Water quality boundary conditions are also specified via the *.fvc file, either directly or via an include statement that points TUFLOW FV to a subsidiary boundary condition control file(s). This specification of water quality variable concentrations is optional, so in early water quality model construction stages this specification can be omitted. Omitted water quality boundary conditions will be set to zero. It is not recommended that this approach be taken beyond initial simulation setup stages, but that it be used only to develop a water quality simulation to the point where it executes without issuing error or unwanted warning messages. At this point, all water quality boundary conditions should be assigned. All TUFLOW boundary conditions that specify water temperature or salinity will also require specification of the behaviour of simulated water quality variables. Common boundary conditions to which this applies include inflows (e.g. types Q, QC, QN, QG and others) and tidal boundaries (e.g. types WLS). Wave and meteorological boundary conditions do not need specification of water quality conditions. As for initial conditions, boundary conditions that use columnar data structures (e.g. *.csv files) are interpreted using column headers specified in an expected order within calling TUFLOW FV BC blocks. Further detail and the associated ordering is provided in the following sections (sections 4.6, 4.7 and 4.8 for simulation classes DO, inorganics and organics, respectively). 4.4.2.3 Ordering Specification of initial conditions and most boundary conditions presently relies on listing water quality variables in a particular order. This applies in all instances when water quality initial or boundary conditions are provided in columnar or list form, which is most frequently in text file format. This is conceptually similar to the manner in which TUFLOW FV also relies on ordering of its initial and boundary conditions. Future releases of TUFLOW FV will allow alternative methods for specification of initial and boundary conditions that do not rely on assumed ordering. In the interim however, the following applies. 4.4.2.3.1 Initial Conditions Initial conditions, if set using means other than a restart file, must be specified with water quality constituents in a preset order (globally uniform), or be referenced using incrementally numbered headers as “WQ_1”, “WQ_2” etc (profile, 2d or 3d, see Section 4.4.2.1). For globally uniform initial conditions (Section 4.4.2.1.2), the following *.fvc command can be used for a typical inorganics simulation class: initial wq concentration == 7.5, 0.0, 4.2, 10.5, 0.6, 5.5 There are no references to headers or variable names, but TUFLOW FV assumes that these numbers correspond to the ordered variables of the particular configuration of the inorganics simulation class returned to it from the WQ Module. In this example, this ordering is: Dissolved oxygen (7.5 mg/L) Silicate (0.0 mg/L) Ammonium (4.2 mg/L) Nitrate (10.5 mg/L) Filterable reactive phosphorus (0.6 mg/L), and One phytoplankton group (5.5 \\(\\mu\\)g/L) The expected ordering is the same as that for boundary condition specifications, as described below. For other initial condition specifications that involve providing csv files, the headers “WQ_1”, “WQ_2” etc must be used to denote water quality initial conditions. The ordering of the associated columns does not matter, however the assignment of a computed variable initial condition to a “WQ_XX” header (where XX is a number) does rely on the ordering described below - the first water quality computed variable expected should be headed “WQ_1” and so on. 4.4.2.3.2 Boundary Conditions Ordering of water quality boundary conditions is only important when specifying header information via the bc header == (or equivalent) command within a TUFLOW FV *.fvc file BC block. It is in these commands (where comma separated header strings are specified) that TUFLOW FV expects a particular order of TUFLOW FV and WQ Module constituents. No column ordering is expected in boundary condition data files themselves. Ordering is only expected in the order of headers specified within a BC block within an TUFLOW FV control file. This is best illustrated by example. If a user has elected to deploy the inorganics simulation class without sediment, then the following will be simulated (beyond the basic velocity and water level hydrodynamic variable suite): Salinity Temperature Dissolved oxygen Silicate Ammonium Nitrate Filterable reactive phosphorus One (assumed for this example, but can be multiple) phytoplankton group These will eventually need proper boundary condition specification in boundary condition blocks and have supporting data provided in (usually) text files. In a simple model with only one WL boundary condition, a bc block of the following form would be required as a minimum to properly specify the hydrodynamic and water quality boundaries: bc == WL, 1, datafile.csv \\(\\blockindent\\) bc header == time, wsel, sali, temp, DOxy, SiO4, NH41, nitr, frph, bluegreen end bc To be clear: The names listed on the bc header == line (time, wse etc.) are not keywords or special names, and can be any names that a user chooses TUFLOW FV will however, assume that these names (whatever they have been set to) have been listed in such an order that they have a one to one correspondence to the ten computed variables as follows: time \\(\\rightarrow\\) Time stamp wsel \\(\\rightarrow\\) Water surface elevation sali \\(\\rightarrow\\) Salinity temp \\(\\rightarrow\\) Temperature DOxy \\(\\rightarrow\\) Dissolved oxygen SiO4 \\(\\rightarrow\\) Silicate NH41 \\(\\rightarrow\\) Ammonium nitr \\(\\rightarrow\\) Nitrate frph \\(\\rightarrow\\) Filterable reactive phosphorus bluegreen \\(\\rightarrow\\) Phytoplankton group one TUFLOW then matches the user specified names to the expected simulation variables, based on this ordering, to then interrogate boundary condition files. Following the above matching, TUFLOW FV interrogates the relevant boundary condition file (“datafile.csv” in the example above), where this file can have its columns arranged in any order: the order of these columns does not matter because TUFLOW FV will use the mapping previously developed via the bc header == command to look through all data file columns one by one, searching for the headers specified, regardless of the actual ordering of boundary condition file columns. For example, the silicate boundary condition data could be positioned in column 14 of the boundary condition file, but as long as it is labelled with the correct header (“SiO4” as specified in bc header ==), TUFLOW FV will know to assign column 14 of the boundary condition data file to the silicate computed variable. Ordering is set by the user’s selection of simulation class and constituent models, and is explicitly listed in each simulation class section (Sections 4.6.5, 4.7.5 and 4.8.5 for DO, inorganics and organics, respectively). The expected ordering for a particular simulation is also reported in the simulation water quality log file for checking. 4.5 Water quality control file commands The water quality control file comprises three parts, with each part containing different types of commands and flags. Whilst it is recommended that these parts be kept separate and in the order described below (especially given how complex water quality simulations can become), doing so is not mandatory and commands or command blocks may be entered in any order. These parts are as follows, with the first two mirroring the architecture described in Section 2: Simulation controls (i.e. simulation class) Constituent model settings (i.e. constituent model class) Material specifications Notwithstanding this, a WQ Module control file need not contain any commands, and can be completely blank. This is by design, and intended to allow users to rapidly set up and execute a TUFLOW water quality simulation. If the water quality control file is left blank, then the WQ Module will: Construct a simulation using the dissolved oxygen simulation class (which is the simplest class) Set the simulation units to mg/L Set library defaults for all parameters Set the water quality model timestep to the default Assign zero dissolved oxygen concentration to all boundary conditions. This is by design, and will assist in ensuring that the subsequent user-defined updating of boundary conditions is thorough and complete (zero dissolved oxygen boundary conditions are rare and therefore easily identifiable). Initial conditions will also need to be specified in the TUFLOW FV control file as per Section 4.4.2. Specification of boundary conditions can be deferred. The water quality control file sections are described below. Details specific to each simulation class and constituent model are provided in subsequent sections 4.5.1 Part 1: Simulation controls Simulation controls set the high level operation of the WQ Module and are not specific to a simulation class. All are optional. Available commands set the: Simulation class via simulation class == Timestep dt (in seconds) at which TUFLOW calls the WQ Module via wq dt == Units of simulation via wq units == Frequency of equilibrium substepping fess (in number of timesteps) to execute non-kinetic equilibrium calculations via wq equilibrium substeps == Reporting or suppression of minimum / maximum concentration exceedances (see Section 4.5.2) via report min max warnings == A typical simulation control section might therefore look like the following: simulation class == DO wq dt == 600.0 wq units == mgl wq equilibrium substeps == 1 report min max warnings == on 4.5.2 Part 2: Constituent model settings Constituent model settings are those that: Specify the constituent model to be used within each preset constituent model class. These are referred to as constituent model blocks Set the parameters for each of these constituent models, as commands within these blocks All are optional, however if a constituent model block is initiated then it requires an end XXXX model command to terminate the block, where XXXX is the name of the constituent model class, such as inorganic nitrogen. An example of a user selecting to use the adsorbed filterable reactive phosphorous constituent model (that is a model available within the inorganic phosphorus constituent model class), and setting some parameters within that model is as follows: inorganic phosphorus model == frpads atmospheric deposition == 12.6, 0.5 end inorganic phosphorus model Parameters not specified by the user are set to library defaults. All constituent models allow for constraining (and then reporting) the predictions of their respective computed variable concentrations via the setting of minimum and maximum limits, if desired. This is often useful in identifying unusual model behaviours or instabilities. Where exceedences of these limits are identified by the WQ Module: Time and model cell information is written to the WQ Module log file in real time. This allows for easy identification of potential model issues via periodic examination of the WQ Module log file, rather than waiting for simulation completion The WQ Module resets the computed concentration to the relevant specified minimum or maximum concentration The above resetting will result in mass conservation errors. It should not be relied on to artificially control the behaviour of an otherwise unstable or runaway water quality simulation. Rather, this functionality should be used as a convenient way to check model performance and flag potential issues, with a view to then implementing corrective action. Equally, suppressing warnings written to the WQ log file using the report min max warnings == command described in Section 4.5.1 is not recommended because doing so may mask underlying model construction issues. These limits are optionally specified in each constituent model block. An example that sets these limits for ammonium is: ammonium min max == 0.0, 25.0 Although in the strictest sense, sediment (benthic) flux half saturation concentrations and temperature coefficients are benthic properties, the WQ Module does not yet support these parameters being applied on a spatially varying basis (i.e. per material). As such, these are considered to be constituent model global parameters and so are set in this part of the water quality control file, i.e. within respective constituent model blocks. An example that sets an oxygen half saturation and temperature coefficient for benthic flux is: oxygen benthic == 5.0, 1.08 4.5.3 Part 3: Material specifications The final part of the water quality control file (*.fvwq) provides for specification of benthic (sediment) fluxes, via material blocks. The commands required to commence and terminate a materials block are as follows: material == &lt;up to 10 comma separated material numbers, or “default”&gt; and end material This material block nomenclature mirrors that used in the TUFLOW FV and sediment transport control files. An example of specifying oxygen and nitrate benthic fluxes for materials 2, 7 and 12 is: material == 2, 7, 12 oxygen flux == -60.0 nitrate flux == 12.5 end material The WQ Module allows for specification of a default set of benthic fluxes that are applied across all materials, by using the key word default instead of specifying material numbers in a material block. These defaults can then be progressively overwritten on a material by material basis by specifying subsequent material blocks. For example, a model that has ten materials in total, eight of which have the same oxygen benthic flux (all materials except 4 and 7), can have its overall oxygen benthic flux specified as: material == default oxygen flux == -60.0 end material material == 4, 7 oxygen flux == -20.0 end material 4.5.4 Summary In order to set up and execute a water quality simulation using the WQ Module, the following steps are required: Modify the TUFLOW FV control file: Add at least the following commands to TUFLOW FV control file (*.fvc): water quality model == TUFLOW water quality control file == &lt;water quality control file name&gt;.fvwq Optionally add a folder path command to the TUFLOW FV control file (*.fvc) with a trailing backslash: water quality model dir == &lt;relative path to *.fvwq file&gt;\\(\\backslash\\) Add appropriate initial conditions for all water quality constituents, observing ordering rules where required Initially optionally add boundary conditions for all water quality constituents, observing ordering rules in bc header == commands Create the water quality control file with the corresponding name and path Modify the water quality control file Optionally add to the water quality control file: Part 1: A simulation controls section Part 2: A constituent model setting section with one or more constituent model blocks with one or more parameter commands Part 3: A material block specifications section Once initially constructed, boundary conditions can be added (if not already in place), and progressive refinement and parameterisation of constituent models and benthic fluxes can be affected. Details of these commands and their options within each specific simulation class are provided in subsequent sections. Subsections are separated into the above water quality control file parts for ease and consistency of reference. All commands are optional. 4.5.5 Log files Every WQ Module water quality simulation generates a log file that contains an echo of the WQ Module construction and execution commentary. It is written to the same location (and with the same name) as the WQ Module control file, with the file extension “fvwqlog”. This file contains a great deal of information that should be carefully reviewed. Suppressing warnings written to this log file, although possible, is not recommended or encouraged. 4.6 Simulation Class: DO If no simulation class is specified then a simulation will be automatically constructed using this DO class, and populated with library defaults for all parameters. Computed variables will be: Dissolved oxygen Pathogens (optional, potentially multiple) 4.6.1 Prerequisites The DO simulation class requires simulation of the following in TUFLOW FV: Hydrodynamics, in either two or three dimensions (including any internal one dimensional structures if present) Salinity Temperature Heat module on (i.e. meteorological forcing is required) Simulation of suspended sediment (via TUFLOW FV’s sediment transport module) is optional, unless attached pathogens are simulated. 4.6.2 Part 1: Simulation specification The DO simulation class is set via simulation class == DO The other commands in this part are not specific to this simulation class. See section 4.5.1. 4.6.3 Part 2: Constituent model specification As per Tables 2.2 and 2.3, oxygen is the only mandatory constituent model class available within the DO simulation class, and there is only one oxygen constituent model within that class, with code O2. Pathogens may be optionally simulated (in any simulation class). 4.6.3.1 Model class: Oxygen 4.6.3.1.1 Constituent model: O2 This constituent model is specified as: oxygen model == O2 Minimum and maximum concentrations are specified as: \\(\\blockindent\\) oxygen min max == \\(\\left[DO\\right]_{min}^{O_2}\\), \\(\\left[DO\\right]_{max}^{O_2}\\) Global benthic parameters (used in Equation (D.6)) are specified as: \\(\\blockindent\\) oxygen benthic == \\(K_{sed-O_2}^{O_2}\\), \\(\\theta_{sed}^{O_2}\\) The oxygen piston model to be used (in either Equation (D.2) or Equation (D.3)) is specified as: \\(\\blockindent\\) oxygen piston model == Wanninkhof92 or \\(\\blockindent\\) oxygen piston model == Ho16 The argument (either “Wanninkhof92” or “Ho16”) activates a different oxygen piston model (Equation (D.2) or Equation (D.3), respectively). Although not strictly necessary, the use of “oxygen” to prefix these block commands is deliberate so as to maintain consistency of command style with other constituent model blocks that include more than one computed variable, such as nitrogen, phosphorus and organics. Nonetheless, if the “oxygen” prefix is omitted within this constituent model block, the WQ Module will still interpret the above commands correctly. This constituent model block must be terminated using the command: end oxygen model 4.6.3.2 Model class: Pathogens (optional) This model class is optional. 4.6.3.2.1 Constituent model: Free This constituent model is specified as: pathogen model == free, pathname pathname is any user specified pathogen group name that: Uses only alphanumeric characters Has no spaces Excludes the keyword ‘PATH’, and Is not the same as any other group name Minimum and maximum concentrations are specified as: \\(\\blockindent\\) alive min max == \\(\\left[PTH_a\\right]_{min}^{pth}\\), \\(\\left[PTH_a\\right]_{max}^{pth}\\) Mortality parameters are specified as: \\(\\blockindent\\) mortality == \\(k_{d}^{pth}\\), \\(C_{SM}^{pth}\\), \\(\\alpha\\), \\(\\beta\\), \\(\\theta_{mor}^{pth}\\) \\(\\beta\\) is not currently used but must be retained as a placeholder in this command for future use. Light inactivation parameters are specified in three separate but related commands, with one command per light band (visible, UV-A and UV-B): \\(\\blockindent\\) visible inactivation == \\(k_{vis}\\), \\(c_{S_{vis}}^{pth}\\), \\(K_{DO_{vis}}^{pth}\\) \\(\\blockindent\\) uva inactivation == \\(k_{uva}\\), \\(c_{S_{uva}}^{pth}\\), \\(K_{DO_{uva}}^{pth}\\) \\(\\blockindent\\) uvb inactivation == \\(k_{uvb}\\), \\(c_{S_{uvb}}^{pth}\\), \\(K_{DO_{uvb}}^{pth}\\) Settling of non-attached pathogens is specified as follows, with a negative number being a downwards velocity: \\(\\blockindent\\) settling == \\(V_{settle}^{pth}\\) This constituent model block must be terminated using the command: end pathogen model 4.6.3.2.2 Constituent model: Attached This constituent model must be accompanied by simulation of at least one sediment fraction within the TUFLOW FV sediment transport (ST) module, and is specified as: pathogen model == attached, pathname pathname is any user specified pathogen group name that: Uses only alphanumeric characters Has no spaces Excludes the keyword ‘PATH’, and Is not the same as any other group name The commands are the same as those specified within a free pathogen constituent model block (Section 4.6.3.2.1), with the following modification or additions. Settling is specified for both free and attached pathogens: \\(\\blockindent\\) settling == \\(V_{settle}^{pth}\\), \\(V_{settle}^{pth_t}\\) The target attached pathogen fraction is specified as: \\(\\blockindent\\) target attached fraction == \\(f_{att}^{pth}\\) This constituent model block must be terminated using the command: end pathogen model 4.6.4 Part 3: Material specification Oxygen benthic flux (used in Equation (D.6)) is specified within both default and numbered material blocks as: \\(\\blockindent\\) oxygen flux == \\(F_{sed}^{O_2}\\) 4.6.5 Constituent ordering Dissolved oxygen is the only mandatory constituent simulated by the WQ Module for this simulation class, and therefore oxygen concentration is specified as the first variable (shown in symbolic form below): initial wq concentration == \\(\\left[ DO \\right]\\) Similarly, in a bc header == command within a bc block, oxygen is expected to be the first and only mandatory water quality variable after hydrodynamic boundary conditions. \\(\\blockindent\\)bc header == time, water_elev, sal, temp, clay, sand, DO_mgL DO_mgL is the header used to designate oxygen in the related boundary condition file, noting that the DO_mgL column in the boundary condition file can appear in any column in the boundary condition file, and that it does not need to be the seventh column. The header text “DO_mgL” is just an example, and it can be any header desired, as long as it matches the correct column header in the boundary condition file. 4.6.5.1 Pathogens (optional) If pathogens are simulated, then their headers are required at the end of any lists, regardless of the other hydrodynamic and water quality constituents simulated. This therefore applies to all simulation classes from DO to organics. Alive and dead pathogens are always required to be specified, in that order, and if attached pathogens are simulated then that attached pathogens header is listed between those of alive and dead. This pattern is repeated for each specified pathogen group, in the order in which pathogen groups are defined via pathogen constituent model blocks in the water quality control file. For example, where two pathogen groups are simulated (called ECOLI and CRYPTO, and defined in that order in the corresponding water quality control file), with ECOLI including attachment, the above bc header would be extended to the following: \\(\\blockindent\\)bc header == time, water_elev, sal, temp, clay, sand, DO_mgL, ECOLI_alive, ECOLI_att, ECOLI_dead, CRYPTO_al, CRYPTO_de 4.6.6 Example Following is an example of all the available WQ Module simulation class == DO commands. A single material applied as zeros everywhere as the default, other than for materials 1 and 4 where the default flux is overwritten. One (optional) pathogen constituent model block has been included, but is not required. simulation class == DO wq dt == 600 wq units == mgl oxygen model == O2 oxygen benthic == 4.0, 1.05 oxygen min max == 0.0, 15.0 end oxygen model !optional pathogen constituent model block: pathogen model == basic, crypto alive min max == 0.0, 1e7 mortality == 0.08, 2e-12, 6.1, 1.0, 1.11 visible inactivation == 0.082, 0.0067, 0.5 uva inactivation == 0.5, 0.0067, 0.5 uvb inactivation == 1.0, 0.0067, 0.5 settling == -0.03 end pathogen model material == default oxygen flux == 0 end material material == 1, 4 oxygen flux == -137.0 end material 4.7 Simulation Class: Inorganics If the inorganics simulation class is specified with no subsequent constituent model blocks, then a simulation will be automatically constructed using this inorganics class, and populated with library defaults for all parameters. Computed variables will be: Dissolved oxygen Silicate Ammonium Nitrate Filterable reactive phosphorus One phytoplankton group named ‘dummy’ that uses the basic phytoplankton constituent model 4.7.1 Prerequisites The inorganics simulation class requires simulation of the following in TUFLOW FV: Hydrodynamics, in either two or three dimensions (including any internal one dimensional structures if present) Salinity Temperature Heat module on (i.e. meteorological forcing is required) Simulation of suspended sediment (via TUFLOW FV’s sediment transport module) is required only if adsorbed phosphorus is to be simulated by the WQ Module. This is affected through specification of the adsorbed phosphorus constituent model within the phosphorus constituent model class. 4.7.2 Part 1: Simulation specification The inorganics simulation class is set via simulation class == inorganics The other commands in this part are not specific to this simulation class. See section 4.5.1. 4.7.3 Part 2: Constituent model specification As per Tables 2.2 and 2.3, there are several constituent model classes available within the inorganics simulation class. The commands for each are described following. 4.7.3.1 Model class: Oxygen 4.7.3.1.1 Constituent model: O2 The commands for this constituent model are described in Section 4.6.3.1.1. 4.7.3.2 Model class: Silicate 4.7.3.2.1 Constituent model: Si This constituent model is specified as: silicate model == Si Minimum and maximum concentrations are specified as: \\(\\blockindent\\) silicate min max == \\(\\left[Si\\right]_{min}^{Si}\\), \\(\\left[Si\\right]_{max}^{Si}\\) Global benthic flux parameters (used in Equation (E.1)) are specified as: \\(\\blockindent\\) silicate benthic == \\(K_{sed-O_2}^{Si}\\), \\(\\theta_{sed}^{Si}\\) Although not strictly necessary, the use of “silicate” to prefix the above block commands is deliberate so as to maintain consistency of command style with other constituent model blocks that include more than one computed variable, such as nitrogen, phosphorus and organics. Silicate sediment flux calculations are set to be dependent on dissolved oxygen concentrations by default. Although not recommended, the following will switch off this dependence by setting the term labelled “Influence of oxygen” in Equation (E.1) to a value of 1.0. \\(\\blockindent\\) oxygen == off This constituent model block must be terminated using the command: end silicate model 4.7.3.3 Model class: Inorganic nitrogen 4.7.3.3.1 Constituent model: AmmoniumNitrate This constituent model is specified as: inorganic nitrogen model == AmmoniumNitrate Minimum and maximum concentrations for both ammonium and nitrate are specified as: \\(\\blockindent\\) ammonium min max == \\(\\left[NH_4\\right]_{min}^{NH_4}\\), \\(\\left[NH_4\\right]_{max}^{NH_4}\\) \\(\\blockindent\\) nitrate min max == \\(\\left[NO_3\\right]_{min}^{NO_3}\\), \\(\\left[NO_3\\right]_{max}^{NO_3}\\) Global benthic flux parameters (used in Equation (F.1)) for ammonium and nitrate are specified as: \\(\\blockindent\\) ammonium benthic == \\(K_{sed-O_2}^{NH_4}\\), \\(\\theta_{sed}^{NH_4}\\) \\(\\blockindent\\) nitrate benthic == \\(K_{sed-O_2}^{NO_3}\\), \\(\\theta_{sed}^{NO_3}\\) Nitrification parameters (used in (F.3) and therefore (F.4)) are set in a single command as: \\(\\blockindent\\) nitrification == \\(R_{nitrif}^{NH_4}\\), \\(K_{nitrif-O_2}^{NH_4}\\), \\(\\theta_{nitrif}^{NH_4}\\) Denitrification parameters (used in Equation (F.5) or Equation (F.6)) are also set in a single command as: \\(\\blockindent\\) denitrification == Michaelis Menten, \\(R_{denit}^{NO_3}\\), \\(K_{denit-O_2-MM}^{NO_3}\\), \\(\\theta_{denit}^{NO_3}\\) or \\(\\blockindent\\) denitrification == exponential, \\(R_{denit}^{NO_3}\\), \\(K_{denit-O_2-exp}^{NO_3}\\), \\(\\theta_{denit}^{NO_3}\\) The first argument (either “michaelis menten” or “exponential”) activates a different denitrification model (Equation (F.5) or Equation (F.6), respectively). Anaerobic oxidation of ammonium parameters (used in Equation (F.10)) are also set in a single command as: \\(\\blockindent\\) anaerobic oxidation of ammonium == \\(R_{anmx}^{NH_4,NO_3}\\), \\(K_{anmx-NH_4}^{NH_4,NO_3}\\), \\(K_{anmx-NO_3}^{NH_4,NO_3}\\) Dissimilatory reduction of nitrate to ammonium parameters (used in Equation (F.11)) are set in a single command as: \\(\\blockindent\\) diss nitrate reduction to ammonium == \\(R_{DRNA}^{NO_3}\\), \\(K_{DRNA-O_2}^{NO_3}\\) Ammonium and nitrate sediment flux, nitrification, denitrification, anammox and DRNA calculations are all set to be dependent on dissolved oxygen concentrations by default. Although not recommended, the following will switch off this dependence for all these processes. \\(\\blockindent\\) oxygen == off This command overrides any previously specified values of \\(K_{sed-O_2}^{NH_4}\\), \\(K_{sed-O_2}^{NO_3}\\), \\(K_{nitrif-O_2}^{NH_4}\\), \\(K_{denit-O_2-MM}^{NO_3}\\) and \\(K_{denit-O_2-exp}^{NO_3}\\). It should be specified after all other related commands if the influence of oxygen on nitrogen processes is to be switched off. Setting this command to ‘off’ will completely disable anammox and DRNA calculations. Atmospheric deposition parameters (used in Equations (F.13), (F.14), (F.17) and (F.18)) are set via the command: \\(\\blockindent\\) atmospheric deposition == \\(\\left[TN\\right]_{rain}\\), \\(R_{atm-dry}^{TN}\\), \\(f_{TN}^{NO_3}\\) The same split of TN into ammonium and nitrate is applied to both \\(\\left[TN\\right]_{rain}\\) and \\(R_{atm-dry}^{TN}\\). This constituent model block must be terminated using the command: end inorganic nitrogen model 4.7.3.4 Model class: Inorganic phosphorus 4.7.3.4.1 Constituent model: FRPhs This constituent model is specified as: inorganic phosphorus model == FRPhs Minimum and maximum concentrations for FRP are specified as: \\(\\blockindent\\) FRP min max == \\(\\left[FRP\\right]_{min}^{FRP}\\), \\(\\left[FRP\\right]_{max}^{FRP}\\) Global benthic flux parameters (used in Equation (G.1)) are specified as: \\(\\blockindent\\) FRP benthic == \\(K_{sed-O_2}^{FRP}\\), \\(\\theta_{sed}^{FRP}\\) FRP sediment flux calculations are set to be dependent on dissolved oxygen concentrations by default. Although not recommended, the following will switch off this dependence by setting the term labelled “Influence of oxygen” in Equation (G.1) to a value of 1.0. \\(\\blockindent\\) oxygen == off Wet atmospheric deposition parameters (used in Equation (G.2)) are set via the command: \\(\\blockindent\\) atmospheric deposition == \\(\\left[FRP\\right]_{rain}\\) An additional parameter for dry atmospheric deposition is required in the FRPhsads constituent model (see Section 4.7.3.4.2). This constituent model block must be terminated using the command: end inorganic phosphorus model 4.7.3.4.2 Constituent model: FRPhsads This constituent model is specified as: inorganic phosphorus model == FRPhsads The TUFLOW FV Sediment Transport (ST) Module must be used to simulate at least one sediment fraction in order to use this WQ Module constituent model. In addition to the commands described in Section 4.7.3.4.1, the following commands are available in this constituent model. Minimum and maximum concentrations for adsorbed FRP are specified as: \\(\\blockindent\\) FRP ads min max == \\(\\left[FRPads\\right]_{min}^{FRPads}\\), \\(\\left[FRPads\\right]_{max}^{FRPads}\\) Two FRP adsorption models are available, as per Equations (G.6) and (G.7). These require specification of one (linear) or two (quadratic) parameters, respectively after specification of the model to be used: \\(\\blockindent\\) adsorption == linear, \\(K_{ads-L}^{FRP}\\) or \\(\\blockindent\\) adsorption == quadratic, \\(K_{ads-Q}^{FRP}\\), \\(Q_{max}^{FRP}\\) The settling velocity of adsorbed phosphorus is set as follows. Future releases of the WQ Module will dynamically link this settling velocity to the calculations of the TUFLOW FV ST Module. \\(\\blockindent\\) settling == \\(V_{settle}^{FRPads}\\) Dry atmospheric deposition of FRP is activated in this simulation model (used in Equation (G.3)) and is specified via the same command as wet deposition, but with one additional argument. This additional argument is ignored if the FRPhsads constituent model has not been set: \\(\\blockindent\\) atmospheric deposition == \\(\\left[FRP\\right]_{rain}\\), \\(R_{atm-dry}^{FRP}\\) This constituent model block must be terminated using the command: end inorganic phosphorus model 4.7.3.5 Model class: Phytoplankton Given the large number of potential commands and options for phytoplankton simulation, horizontal rules have been used to separate subsections below for clarity. 4.7.3.5.1 Constituent model: Basic This constituent model is specified as: phyto model == basic, groupname groupname is any user specified phytoplankton group name that: Uses only alphanumeric characters Has no spaces Excludes the keywords ‘COM’ and ‘PHYTO’, or any combination of letters already included in a standard computed variable name, such as “INT_N_”, “INT_P” or “_rho”, and Is not the same as any other group name Minimum and maximum concentrations for a phytoplankton group are specified as follows. No prefix keyword (as was the case for constituents such as “ammonium”) is required: \\(\\blockindent\\) min max == \\(\\left[PHY\\right]_{min}^{PHY}\\), \\(\\left[PHY\\right]_{max}^{PHY}\\) 4.7.3.5.1.1 Temperature limitation Temperature limitation can be specified by one of the following models: None (no temperature limitation applied) \\(\\blockindent\\) temperature limitation == none or Standard (used in Equations (J.1) through to (J.8)) \\(\\blockindent\\) temperature limitation == standard, \\(T_{std}^{phy}\\), \\(T_{opt}^{phy}\\), \\(T_{max}^{phy}\\) 4.7.3.5.1.2 Salinity limitation Salinity limitation can be specified by one of the following models. All functions can be applied to either (not both) primary productivity or respiration, except for the estuarine limitation model which can only be applied to primary productivity. Specifically: Specifying respective function limitation values (i.e. \\(L_{max-fresh}^{phy}\\) or \\(L_{zero-marine}^{phy}\\) or \\(L_{zero-mix}^{phy}\\)) to be between zero and one will set a function to apply to primary productivity rates as a reducer Specifying respective function limitation values (i.e. \\(L_{max-fresh}^{phy}\\) or \\(L_{zero-marine}^{phy}\\) or \\(L_{zero-mix}^{phy}\\)) to be greater than one will set a function to apply to respiration rates as an enhancer The available models are as follows: None (no salinity limitation applied) \\(\\blockindent\\) salinity limitation == none or Fresh (used in Equation (J.27)) \\(\\blockindent\\) salinity limitation == fresh, \\(S_{opt-fresh}^{phy}\\), \\(S_{max-fresh}^{phy}\\), \\(L_{max-fresh}^{phy}\\) or Marine (used in Equation (J.30)) \\(\\blockindent\\) salinity limitation == marine, \\(S_{opt-marine}^{phy}\\), \\(L_{zero-marine}^{phy}\\) or Mixed (used in Equation (J.33)) \\(\\blockindent\\) salinity limitation == mixed, \\(S_{opt-mix}^{phy}\\), \\(S_{max-mix}^{phy}\\), \\(L_{zero-mix}^{phy}\\) or Estuarine (used in Equation (J.36)) \\(\\blockindent\\) salinity limitation == estuarine, \\(S_{opt-est}^{phy}\\), \\(S_{max-est}^{phy}\\), \\(P_{est}^{phy}\\) 4.7.3.5.1.3 Light limitation Light limitation can be specified by one of the following models: Basic (used in Equation (J.19)) \\(\\blockindent\\) light limitation == basic, \\(Ke^{phy}\\), \\(I_{K-bas}\\) or Monod (used in Equation (J.20)) \\(\\blockindent\\) light limitation == monod, \\(Ke^{phy}\\), \\(I_{K-mon}\\) or Steele (used in Equation (J.21)) \\(\\blockindent\\) light limitation == steele, \\(Ke^{phy}\\), \\(I_{S-ste}\\) or Webb (used in Equation (J.22)) \\(\\blockindent\\) light limitation == webb, \\(Ke^{phy}\\), \\(I_{K-web}\\) or Jassby (used in Equation (J.23)) \\(\\blockindent\\) light limitation == jassby, \\(Ke^{phy}\\), \\(I_{K-jas}\\) or Chalker (used in Equation (J.24)) \\(\\blockindent\\) light limitation == chalker, \\(Ke^{phy}\\), \\(I_{K-cha}\\) or Klepper (used in Equation (J.25)) \\(\\blockindent\\) light limitation == klepper, \\(Ke^{phy}\\), \\(I_{S-kle}\\) or Integrated (used in Equation (J.26)) \\(\\blockindent\\) light limitation == integrated, \\(Ke^{phy}\\), \\(I_{S-int}\\) 4.7.3.5.1.4 Nitrogen limitation Nitrogen limitation parameters (used in Equation (J.9), Section J.3.1) are set via the command: \\(\\blockindent\\) nitrogen limitation == \\(\\left[N\\right]_{min}^{phy}\\), \\(K_{lim-N}^{phy}\\) These, together with additional parameters, are the same as those used in specifying the nitrogen limitation behaviour of the advanced phytoplankton model (Section 4.7.3.5.2.1). 4.7.3.5.1.5 Phosphorus limitation Phosphorus limitation parameters (used in Equation (J.13), Section J.4.1) are set via the command: \\(\\blockindent\\) phosphorus limitation == \\(\\left[P\\right]_{min}^{phy}\\), \\(K_{lim-P}^{phy}\\) These, together with additional parameters, are the same as those used in specifying the phosphorus limitation behaviour of the advanced phytoplankton model (Section 4.7.3.5.2.2). 4.7.3.5.1.6 Silicate limitation Silicate limitation parameters (used in Equation (J.17), Section J.5) are set via the command: \\(\\blockindent\\) silicate limitation == \\(\\left[Si\\right]_{min}^{phy}\\), \\(K_{lim-Si}^{phy}\\) Specification of this limitation triggers the uptake of silicate to be on in the phytoplankton group’s block in which the command appears. Omit this command to set silicate uptake to off for a given phytoplankton group. 4.7.3.5.1.7 Uptake Nutrient uptake parameters for nitrogen, phosphorus and silicate (if relevant) (used in Equations (K.2), (K.7) and (K.9) respectively) are set via the command: \\(\\blockindent\\) uptake == \\(X_{N-C-con}^{phy}\\), \\(X_{P-C-con}^{phy}\\), \\(X_{Si-C-con}^{phy}\\) If specified, the value of \\(X_{Si-C-con}^{phy}\\) is ignored if silicate uptake has not been triggered via specification of silicate limitation parameters via silicate limitation ==. 4.7.3.5.1.8 Primary productivity Primary productivity (growth) parameters (used in Equation (I.2)) are set via the command: \\(\\blockindent\\) primary productivity == \\(R_{prod}^{phy}\\), \\(\\theta_{prod}^{phy}\\) 4.7.3.5.1.9 Respiration Respiration parameters are set via the following command. The first two parameters are used directly to compute the respiration rate \\(R_{resp\\langle computed\\rangle}^{phy}\\) via Equation (I.6). The third and fourth parameters are used to compute excretive and mortality fluxes in Equations (L.1) and (L.2), respectively. Both these equations use the respiration rate computed from the first two parameters \\(R_{resp}^{phy}\\) and \\(\\theta_{resp}^{phy}\\). Although not strictly related to respiration, the final parameter does represent a reduction of biomass and is used to compute exudation loss using Equation (I.12). \\(\\blockindent\\) respiration == \\(R_{resp}^{phy}\\), \\(\\theta_{resp}^{phy}\\), \\(f_{true-resp}^{phy}\\), \\(f_{excr-loss}^{phy}\\), \\(f_{exud}^{phy}\\) 4.7.3.5.1.10 Carbon to Chlorophyll a ratio The carbon to chlorophyll a ratio (used in converting between simulation units, and reporting total chlorophyll a as a diagnostic variable if the mmol units system is used) is specified via the command: \\(\\blockindent\\) carbon chla ratio == \\(X_{cc}^{phy}\\) 4.7.3.5.1.11 Nitrogen fixing Nitrogen fixing parameters are specified as follows. The first parameter is used in Equation (K.2) to compute the nitrogen fixation flux, and the second parameter modifies computed primary productivity via Equation (I.3). \\(\\blockindent\\) nitrogen fixing == \\(R_{nfix}^{N_2}\\), \\(f_{nfix}^{phy}\\) Setting this command triggers nitrogen fixing to be on, otherwise it is off by default. 4.7.3.5.1.12 Settling Settling can be specified by one of the following models: None \\(\\blockindent\\) settling == none or Constant \\(\\blockindent\\) settling == constant, \\(V_{settle}^{phy}\\) or Constant with density correction (as per Equation (I.18)) \\(\\blockindent\\) settling == thermal, \\(V_{settle}^{phy}\\) or Stokes (used in Equation (I.19)), where density is required to be simulated as a computed variable, and thus requires the specification of \\(I_K\\). \\(\\blockindent\\) settling == stokes, \\(I_{K-sto}\\) If \\(I_K\\) is specified in any light limitation model applied to a phytoplankton group with stokes settling, then a value of \\(I_{K-sto}\\) specified in the stokes model will be ignored. Cell density limits are applied as the defaults and are not user specifiable. 4.7.3.5.1.13 Termination This constituent model block must be terminated using the command: end phyto model 4.7.3.5.2 Constituent model: Advanced This constituent model is specified as: phyto model == advanced, groupname groupname is any user specified phytoplankton group name that: Uses only alphanumeric characters Has no spaces Excludes the keywords ‘COM’ and ‘PHYTO’, or any combination of letters already included in a standard computed variable name, such as “INT_N_”, “INT_P” or “_rho”, and Is not the same as any other group name The following commands are the same as those described for the basic phytoplankton model in Section 4.7.3.5.1 (links are to relevant sections above rather than to the command Appendix, for ease of cross reference): \\(\\blockindent\\) min max == \\(\\blockindent\\) temperature limitation == \\(\\blockindent\\) light limitation == \\(\\blockindent\\) silicate limitation == \\(\\blockindent\\) primary productivity == \\(\\blockindent\\) respiration == \\(\\blockindent\\) carbon chla ratio == \\(\\blockindent\\) nitrogen fixing == \\(\\blockindent\\) settling == end phyto model The following commands differ for the advanced phytoplankton model compared to the basic model. 4.7.3.5.2.1 Nitrogen limitation Nitrogen limitation parameters (used in Equation (J.11), Section J.3.2) are set via the command: \\(\\blockindent\\) nitrogen limitation == \\(\\left[N\\right]_{min}^{phy}\\), \\(K_{N}^{phy}\\), \\(X_{N-C-min}^{phy}\\), \\(X_{N-C-max}^{phy}\\) The first two parameters are the same as those that would be specified using the same command in the basic phytoplankton model (Section 4.7.3.5.1.4). 4.7.3.5.2.2 Phosphorus limitation Phosphorus limitation parameters (used in Equation (J.15), Section J.4.2) are set via the command: \\(\\blockindent\\) phosphorus limitation == \\(\\left[P\\right]_{min}^{phy}\\), \\(K_{P}^{phy}\\), \\(X_{P-C-min}^{phy}\\), \\(X_{P-C-max}^{phy}\\) The first two parameters are the same as those that would be specified using the same command in the basic phytoplankton model (Section 4.7.3.5.1.5). 4.7.3.5.2.3 Uptake Nutrient uptake parameters for nitrogen, phosphorus and silicate (if relevant) (used in Equations (K.4), (K.8) and (K.9) respectively) are set via the command: \\(\\blockindent\\) uptake == \\(R_{N-uptake}^{phy}\\), \\(R_{P-uptake}^{phy}\\), \\(X_{Si-C-con}^{phy}\\) The value of \\(X_{Si-C-con}^{phy}\\) is ignored if silicate uptake has not been triggered through specification of a silicate limitation function. 4.7.3.5.2.4 Settling An additional settling model can be specified in the advanced phytoplankton constituent model as: Motile (Section I.4.5), where internal nutrient simulation is required to simulate motility \\(\\blockindent\\) settling == motile, \\(V_{mot}^{phy}\\), \\(I_{K-mot}\\) If \\(I_K\\) is specified in any light limitation model applied to an advanced constituent model phytoplankton group with motile settling, then a value of \\(I_{K-mot}\\) specified in the motile model will be ignored. Cell density limits are applied as the defaults and are not user specifiable. This constituent model block must be terminated using the command: end phyto model 4.7.3.6 Model class: Pathogens (optional) This model class is optional. 4.7.3.6.1 Constituent model: Free The commands for this constituent model are described in Section 4.6.3.2.1. 4.7.3.6.2 Constituent model: Attached The commands for this constituent model are described in Section 4.6.3.2.2. 4.7.4 Part 3: Material specification Oxygen, silicate, ammonium, nitrate and FRP benthic fluxes are specified within both default and numbered material blocks as: \\(\\blockindent\\) oxygen flux == \\(F_{sed}^{O_2}\\) \\(\\blockindent\\) silicate flux == \\(F_{sed}^{sil}\\) \\(\\blockindent\\) ammonium flux == \\(F_{sed}^{NH_4}\\) \\(\\blockindent\\) nitrate flux == \\(F_{sed}^{NO_3}\\) \\(\\blockindent\\) FRP flux == \\(F_{sed}^{FRP}\\) No adsorbed FRP or phytoplankton sediment fluxes are required. 4.7.5 Constituent ordering Different constituent model selections result in different ordering requirements for specifying computed variable initial conditions (either globally with an implied order, or setting the ordered map from water quality computed variables to “WQ_1”, “WQ_2” etc) and bc header == commands. For clarity, these are initially presented below using only phytoplankton placeholders in lists. This is possible because phytoplankton specifications are always appended at the end of initial condition or bc header == lists. Phytoplankton specifications are then presented as additive to these lists in subsequent sections. This is not meant to imply that phytoplankton simulation is optional in the inorganics simulation class - it is mandatory and has only been described separately here only for clarity of presentation. 4.7.5.1 Excluding phytoplankton The only constituent model choice that influences ordering (other than phytoplankton) is the phosphorus model. These two possibilities are described below. 4.7.5.1.1 Phosphorus model FRPhs If adsorbed FRP is not simulated (i.e. phosphorus model == FRPhs), then in all columnar and list style initial conditions, computed variables are expected in the following order (and map to “WQ_1” etc accordingly): initial wq concentration == \\(\\left[ DO \\right]\\), \\(\\left[ Si \\right]\\), \\(\\left[ NH_4 \\right]\\), \\(\\left[ NO_3 \\right]\\), \\(\\left[ FRP \\right]\\), \\(\\ldots\\) {phytoplankton placeholder/s} Similarly, in a bc header == command within a bc block, the following order of computed variables is expected after hydrodynamic (HD BCs) boundary conditions: \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL, \\(\\ldots\\) {phytoplankton placeholder/s} With regard to the abovebc header == command: DO_mgL, Si_mgL, Amm_mgL, Nit_mgL and FRP_mgL are the headers used to designate oxygen, silicate, ammonium, nitrate and FRP in the related boundary condition file, respectively Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file The header texts “DO_mgL”, “Si_mgL”, “Amm_mgL”, “Nit_mgL” and “FRP_mgL” are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers 4.7.5.1.2 Phosphorus model FRPhsads If adsorbed FRP is simulated (i.e. phosphorus model == FRPhsads), then in all columnar and list style initial conditions, computed variables are expected in the following order (and map to “WQ_1” etc accordingly): initial wq concentration == \\(\\left[ DO \\right]\\), \\(\\left[ Si \\right]\\), \\(\\left[ NH_4 \\right]\\), \\(\\left[ NO_3 \\right]\\), \\(\\left[ FRP \\right]\\), \\(\\left[ FRPads \\right]\\), \\(\\ldots\\) {phytoplankton placeholder/s} Similarly, in a bc header == command within a bc block, the following order of computed variables is expected after hydrodynamic boundary conditions: \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL, FRP_ads_mgL, \\(\\ldots\\) {phytoplankton placeholder/s} With regard to the abovebc header == command: DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL and FRP_ads_mgL are the headers used to designate oxygen, silicate, ammonium, nitrate, FRP and adsorbed FRP in the related boundary condition file, respectively Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file The header texts “DO_mgL”, “Si_mgL”, “Amm_mgL”, “Nit_mgL”, “FRP_mgL” and “FRP_ads_mgL”are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers #### Including phytoplankton {#ConOrdIncPhy-4} Phytoplankton initial conditions and bc header == fields are appended directly to the above computed variable specifications, as denoted by the {phytoplankton placeholder/s} flag above. Each phytoplankton group is specified using a cluster of values (initial conditions) or headers (bc block) and these clusters must appear in the same order as phytoplankton groups are specified in the water quality control file. The content of each phytoplankton cluster is determined both by the phytoplankton constituent model used and the settling model selected. These are described below, using a placeholder for preceding (non-phytoplankton) computed variables for clarity. These are described above and can be interpreted as either of the orderings specified in sections 4.7.5.1.1 or 4.7.5.1.2. Two phytoplankton groups are used in all examples. 4.7.5.1.3 Basic phytoplankton model If the basic phytoplankton constituent model is used, then in all columnar and list style initial conditions, computed variables are expected in the following order (and map to “WQ_XX” after the final computed variable number accordingly): initial wq concentration == {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{[PHY_1]}_{\\text{Cluster 1}}\\), \\(\\underbrace{[PHY_2]}_{\\text{Cluster 2}}\\) In order to match water quality control file groups with initial conditions, it is assumed that the groups’ clusters of initial conditions are specified above in the same order that phyto model == blocks are presented in the water quality control file. Similarly, in a bc header == command within a bc block, the following order of computed variables is expected after hydrodynamic and non-phytoplankton boundary conditions: \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{\\text{phyto_green}}_{\\text{Cluster 1}}\\), \\(\\underbrace{\\text{phyto_bluegreen}}_{\\text{Cluster 2}}\\) With regard to the abovebc header == command: phyto_green and phyto_bluegreen are the headers used to designate the boundary concentrations of the two phytoplankton groups listed in the water quality control file In order to match water quality control file groups with these boundary condition clusters, it is assumed that the groups’ boundary condition header clusters are specified above in the same order that phyto model == blocks appear in the water quality control file Although the names listed in the bc header == command above do not need to match the names listed in the water quality control file phytoplankton blocks, it is recommended that they do have names that are correlated with the phytoplankton group names in the water quality control file, for model integrity Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file The header texts “phyto_green” and “phyto_bluegreen” are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers If the command settling == stokes is used for a phytoplankton group, then phytoplankton cell density must be simulated as a computed variable that requires initial and boundary conditions. This therefore affects the clustering of phytoplankton initial and boundary conditions. For example, if the first (and not the second) phytoplankton group above used the stokes settling model, then the following initial condition command would be required: \\(\\blockindent\\)initial wq concentration == {HD} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{[PHY_1],\\rho_{phy1}}_{\\text{Cluster 1}}\\), \\(\\underbrace{[PHY_2]}_{\\text{Cluster 2}}\\) \\(\\rho_{phy1}\\) is the initial density of the first phytoplankton group’s cells. A density initial condition is not required for the second phytoplankton species because it does not use stokes settling. Similarly, in a bc header == command within a bc block, the following order of computed variables is expected after hydrodynamic and non-phytoplankton boundary conditions: \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{\\text{phyto_green, phyto_green_density}}_{\\text{Cluster 1}}\\), \\(\\underbrace{\\text{phyto_bluegreen}}_{\\text{Cluster 2}}\\) If both phytoplankton groups simulated density then the corresponding initial condition and boundary condition commands would be as follows: \\(\\blockindent\\)initial wq concentration == {HD} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{[PHY_1],\\rho_{phy1}}_{\\text{Cluster 1}}\\), \\(\\underbrace{[PHY_2],\\rho_{phy2} }_{\\text{Cluster 2}}\\) \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{\\text{phyto_green, phyto_green_density}}_{\\text{Cluster 1}}\\), \\(\\underbrace{\\text{phyto_bluegreen, phyto_bluegreen_density}}_{\\text{Cluster 2}}\\) \\(\\rho_{phy1}\\) and \\(\\rho_{phy1}\\) are the initial densities of the first and second phytoplankton group’s cells. The same notes provided above apply to these commands. 4.7.5.1.4 Advanced phytoplankton model If the advanced phytoplankton constituent model is used, then in all columnar and list style initial conditions, computed variables are expected in the following order (and map to “WQ_XX” after the final computed variable number accordingly): initial wq concentration == {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{[PHY_1],[IN_1],[IP_1]}_{\\text{Cluster 1}}\\), \\(\\underbrace{[PHY_2],[IN_2],[IP_2]}_{\\text{Cluster 2}}\\) In order to match water quality control file groups with initial conditions, it is assumed that the groups’ initial conditions are specified above in the same order that phyto model == blocks are presented in the water quality control file. Similarly, in a bc header == command within a bc block, the following order of computed variables is expected after hydrodynamic and non-phytoplankton boundary conditions: \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{\\text{phyto_gr, gr_intN, gr_intP}}_{\\text{Cluster 1}}\\), \\(\\underbrace{\\text{phyto_blgr, blgr_intN, blgr_intP}}_{\\text{Cluster 2}}\\) With regard to the abovebc header == command: phyto_gr and phyto_blgr are the headers used to designate the boundary concentrations of the two phytoplankton groups listed in the water quality control file gr_intN and gr_intP are the headers used to designate the boundary concentrations of internal nitrogen and internal phosphorus for the green phytoplankton group, respectively blgr_intN and blgr_intP are the headers used to designate the boundary concentrations of internal nitrogen and internal phosphorus for the bluegreen group, respectively In order to match water quality control file groups with these boundary conditions, it is assumed that the groups’ boundary condition header clusters are specified above in the same order that phyto model == blocks appear in the water quality control file Although the names listed in the bc header == command above do not need to match the names listed in the water quality control file phytoplankton blocks, it is recommended that they do have names that are correlated with the phytoplankton group names in the water quality control file, for model integrity Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file The header texts “phyto_gr” and “phyto_blgr” are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers If the command settling == stokes is used for a phytoplankton group, then phytoplankton cell density must be simulated as a computed variable that requires initial and boundary conditions. This therefore affects the clustering of phytoplankton initial and boundary conditions. If the first phytoplankton group above used the advanced phytoplankton model with the stokes settling model, and the second group used the basic phytoplankton model without stokes settling, then the following commands would be required: initial wq concentration == {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{[PHY_1],\\rho_{phy_1},[IN_1],[IP_1]}_{\\text{Cluster 1}}\\), \\(\\underbrace{[PHY_2]}_{\\text{Cluster 2}}\\) Similarly, in a bc header == command within a bc block, the following order of computed variables is expected after hydrodynamic and non-phytoplankton boundary conditions: \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{\\text{phyto_gr, gr_dens, gr_intN, gr_intP}}_{\\text{Cluster 1}}\\), \\(\\underbrace{\\text{phyto_blgr}}_{\\text{Cluster 2}}\\) If both phytoplankton groups simulated density, again with the first and second groups using the advanced and basic models respectively, then the corresponding commands would be as follows: initial wq concentration == {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{[PHY_1],\\rho_{phy_1},[IN_1],[IP_1]}_{\\text{Cluster 1}}\\), \\(\\underbrace{[PHY_2],\\rho_{phy_2}}_{\\text{Cluster 2}}\\) \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{\\text{phyto_gr, gr_dens, gr_intN, gr_intP}}_{\\text{Cluster 1}}\\), \\(\\underbrace{\\text{phyto_blgr, blgr_dens}}_{\\text{Cluster 2}}\\) The same notes provided above apply to these commands. 4.7.5.2 Including pathogens (optional) The ordering requirements for pathogens are the same as those described in Section 4.6.5.1. Pathogen headers are always included last (i.e. after phytoplankton in the inorganics simulation class). 4.7.6 Example Following is an example of all the available WQ Module simulation class == inorganics commands, with a single material applied as zeros everywhere as the default, and then modified by a further specification for materials 3 and 7. Two phytoplankton groups (one each of the basic and advanced models) are set. Pathogens have been omitted for clarity, but could be added as per Section @(ExampleDO). simulation class == inorganics wq dt == 3600 wq units == mgl oxygen model == O2 oxygen benthic == 4.0, 1.05 oxygen min max == 0.0, 25.0 end oxygen model silicate model == si silicate benthic == 4.0, 1.05 silicate min max == 0.0, 2500.0 oxygen == on end silicate model inorganic nitrogen model == AmmoniumNitrate ammonium benthic == 4.0, 1.05 nitrate benthic == 4.0, 1.05 ammonium min max == 0.0, 50.0 nitrate min max == 0.0, 110.0 nitrification == 0.1, 4.0, 1.05 denitrification == exponential, 0.5, 8.0, 1.05 atmospheric deposition == 10.0, 2.4, 0.15 oxygen == on end inorganic nitrogen model inorganic phosphorus model == frphsads frp benthic == 4.0, 1.05 frp min max == 0.0, 50.0 frpads min max == 0.0, 50.0 atmospheric deposition == 5.0, 1.4 adsorption == quadratic, 1.5, 0.5 settling == 0.000001 oxygen == on end inorganic phosphorus model phyto model == basic, green min max == 0.01, 40.0 temperature limitation == standard, 11.0, 14.0, 30.0 salinity limitation == none light limitation == monod, 0.3, 70.0 settling == constant, 0.01 nitrogen limitation == 0.01, 1.5 phosphorus limitation == 0.001, 0.03 silicate limitation == 0.5, 7.0 uptake == 4.7, 0.6, 8.9 carbon chla ratio == 32.0 primary productivity == 2.0, 1.06 respiration == 0.02, 1.04, 0.1, 0.05, 0.6 end phyto model phyto model == advanced, bluegreen min max == 0.5, 50.0 temperature limitation == standard, 10.0, 15.0, 25.0 salinity limitation == estuarine, 22.0, 35.0, 0.0 light limitation == monod, 0.5, 51.0 settling == motile, 0.5 nitrogen limitation == 0.05, 2.5, 4.0, 5.0 phosphorus limitation == 0.01, 0.05, 0.64, 0.67 silicate limitation == 1.0, 5.0 uptake == 0.05, 0.05, 8.9 carbon chla ratio == 27.0 nitrogen fixing == 0.100, 0.100 primary productivity == 1.0, 1.08 respiration == 0.01, 1.01, 0.2, 0.0, 0.4 end phyto model material == default oxygen flux == 0.0 silicate flux == 0.0 ammonium flux == 0.0 nitrate flux == 0.0 frp flux == 0.0 end material material == 3, 7 oxygen flux == -800.0 silicate flux == 122.0 ammonium flux == 37.0 nitrate flux == 3.7 frp flux == 1.4 end material 4.8 Simulation Class: Organics If the organics simulation class is specified with no subsequent constituent model blocks, then a simulation will be automatically constructed using this organics class, and populated with library defaults for all parameters. Computed variables will be: Dissolved oxygen Silicate Ammonium Nitrate Filterable reactive phosphorus Dissolved organic carbon Particulate organic carbon Dissolved organic nitrogen Particulate organic nitrogen Dissolved organic phosphorus Particulate organic phosphorus One phytoplankton group named ‘dummy’ that uses the basic phytoplankton constituent model For clarity, this section uses acronyms for some computed variable names, and these acronyms are expanded in Appendix P. All references below to “organic matter” are to labile organic computed variables, unless specifically termed as refractory. 4.8.1 Prerequisites The organics simulation class requires simulation of the following in TUFLOW FV: Hydrodynamics, in either two or three dimensions (including any internal one dimensional structures if present) Salinity Temperature Heat module on (i.e. meteorological forcing is required) Simulation of suspended sediment (via TUFLOW FV’s sediment transport module) is required only if adsorbed phosphorus is to be simulated by the WQ Module. 4.8.2 Part 1: Simulation specification The organics simulation class is set via simulation class == organics The other commands in this part are not specific to this simulation class. See section 4.5.1. 4.8.3 Part 2: Constituent model specification As per Tables 2.2 and 2.3, there are several constituent model classes available within the organics simulation class. The commands for each are described following. To avoid repetition, cross references to explanations are provided for commands that are included in previous simulation classes and remain the same for this class. 4.8.3.1 Model class: Oxygen 4.8.3.1.1 Constituent model: O2 The commands for this constituent model are described in Section 4.7.3.1.1. 4.8.3.2 Model class: Silicate 4.8.3.2.1 Constituent model: Si The commands for this constituent model are described in Section 4.7.3.2.1. 4.8.3.3 Model class: Inorganic nitrogen 4.8.3.3.1 Constituent model: AmmoniumNitrate The commands for this constituent model are described in Section 4.7.3.3.1. 4.8.3.4 Model class: Inorganic phosphorus 4.8.3.4.1 Constituent model: FRPhs The commands for this constituent model are described in Section 4.7.3.4.1. 4.8.3.4.2 Constituent model: FRPhsads The commands for this constituent model are described in Section 4.7.3.4.2. 4.8.3.5 Model class: Organic matter 4.8.3.5.1 Constituent model: Labile This constituent model is specified as: organic matter model == labile Minimum and maximum concentrations are specified as: \\(\\blockindent\\) carbon min max == \\(\\left[POC\\right]_{min}^{POC}\\), \\(\\left[POC\\right]_{max}^{POC}\\), \\(\\left[DOC\\right]_{min}^{DOC}\\), \\(\\left[DOC\\right]_{max}^{DOC}\\) \\(\\blockindent\\) nitrogen min max == \\(\\left[PON\\right]_{min}^{PON}\\), \\(\\left[PON\\right]_{max}^{PON}\\), \\(\\left[DON\\right]_{min}^{DON}\\), \\(\\left[DON\\right]_{max}^{DON}\\) \\(\\blockindent\\) phosphorus min max == \\(\\left[POP\\right]_{min}^{POP}\\), \\(\\left[POP\\right]_{max}^{POP}\\), \\(\\left[DOP\\right]_{min}^{DOP}\\), \\(\\left[DOP\\right]_{max}^{DOP}\\) Global benthic flux parameters (used in Equation (N.1)) are specified as: \\(\\blockindent\\) organics benthic == \\(K_{sed-O_2}^{DOM}\\), \\(\\theta_{sed}^{DOM}\\) Although not strictly necessary, the use of “organics” to prefix the above block command is deliberate so as to maintain consistency of command style with other constituent model blocks that include more than one computed variable, such as nitrogen and phosphorus. The command will also be accepted simply as benthic ==. Particulate organic hydrolysis parameters (used in (N.2) and therefore (N.3)) are set in a single command as: \\(\\blockindent\\) hydrolysis == \\(R_{hyd}^{POC}\\), \\(R_{hyd}^{PON}\\), \\(R_{hyd}^{POP}\\), \\(K_{hyd-O_2}^{POM}\\), \\(\\theta_{hyd}^{POM}\\) Dissolved organic mineralisation parameters (used in (N.8) and therefore (N.9)) are set in a single command, together with the corresponding denitrification parameters describing associated consumption of nitrate due to mineralisation (used in Equations (N.10) and (N.14)) as: \\(\\blockindent\\) mineralisation == \\(R_{miner}^{DOM}\\), \\(K_{miner-O_2}^{DOM}\\), \\(\\theta_{miner}^{DOM}\\), \\(f_{an}\\), \\(K_{miner-NO_3}^{NO_3}\\) If \\(K_{miner-NO_3}^{NO_3}\\) is set to 0.0, then the consumption of nitrate due to mineralisation of organic matter is switched off. Settling of labile particulate organic matter can be specified by one of the following models: None \\(\\blockindent\\) settling == none or Constant \\(\\blockindent\\) settling == constant, \\(V_{settle}^{lorg}\\) or Constant with density correction (as per Equation (N.28)) \\(\\blockindent\\) settling == thermal, \\(V_{settle}^{lorg}\\) or Stokes (used in Equation (N.29)) \\(\\blockindent\\) settling == stokes, \\(d_{lorg}\\), \\(\\rho_{lorg}\\) Self shading due to the presence of labile organics (used in Equation (N.26)) parameters are set as: \\(\\blockindent\\) self shading == \\(Ke^{POM}\\), \\(Ke^{DOM}\\) This constituent model block must be terminated using the command: end organic matter model 4.8.3.5.2 Constituent model: Refractory This constituent model encompasses all the functionality (and commands) of the labile organic matter constituent model, but offers further commands to simulate refractory organic processes, and their interaction with labile organic and inorganic computed variables. This constituent model is specified as: organic matter model == refractory Minimum and maximum concentrations are specified as follows. The carbon command includes the specification of refractory particulate organic matter minimums and maximums, as well as dissolved refractories. \\(\\blockindent\\) ref carbon min max == \\(\\left[RPOM\\right]_{min}^{RPOM}\\), \\(\\left[RPOM\\right]_{max}^{RPOM}\\), \\(\\left[RDOC\\right]_{min}^{RDOC}\\), \\(\\left[RDOC\\right]_{max}^{RDOC}\\) \\(\\blockindent\\) ref nitrogen min max == \\(\\left[RDON\\right]_{min}^{RDON}\\), \\(\\left[RDON\\right]_{max}^{RDON}\\) \\(\\blockindent\\) ref phosphorus min max == \\(\\left[RDOP\\right]_{min}^{RDOP}\\), \\(\\left[RDOP\\right]_{max}^{RDOP}\\) The breakdown of refractory particulate organic matter into labile particulate organic matter (used in Equations (N.5) and (N.6)) parameters are set as: \\(\\blockindent\\) ref breakdown == \\(R_{bdn}^{RPOM}\\), \\(X_N^{RPOM}\\), \\(X_P^{RPOM}\\) The activation of refractory dissolved organic matter to labile dissolved organic matter (used in Equations (N.17) and (N.18)) parameter is set as: \\(\\blockindent\\) ref activation == \\(R_{act}^{RDOM}\\) The photolysis of refractory organics (used in Equation (N.27)) is not turned on unless the following command is issued. It sets the parameter that proportions the split of photolysed refractory dissolved organics to labile dissolved organics and inorganics: \\(\\blockindent\\) ref photolysis == \\(f_{photo}^{RDOM}\\) Settling of refractory particulate organic matter can be specified by one of the following models: None \\(\\blockindent\\) ref settling == none or Constant \\(\\blockindent\\) ref settling == constant, \\(V_{settle}^{rorg}\\) or Constant with density correction (as per Equation (N.28)) \\(\\blockindent\\) ref settling == thermal, \\(V_{settle}^{rorg}\\) or Stokes (used in Equation (N.29)) \\(\\blockindent\\) ref settling == stokes, \\(d_{rorg}\\), \\(\\rho_{rorg}\\) The settling model selected for the refractory particulate organic matter model must be the same as that of the labile particulate organic matter. The input parameters to this model may be different. Self shading due to the presence of refractory organics (used in Equation (N.27)) parameters are set as: \\(\\blockindent\\) ref self shading == \\(Ke^{RPOM}\\), \\(R_{CDOM}^{RDOM}\\) This constituent model block must be terminated using the command: end organic matter model 4.8.3.6 Model class: Phytoplankton 4.8.3.6.1 Constituent model: Basic The commands for this constituent model are described in Section 4.7.3.5.1. 4.8.3.6.2 Constituent model: Advanced The commands for this constituent model are described in Section 4.7.3.5.2. 4.8.3.7 Model class: Pathogens (optional) This model class is optional. 4.8.3.7.1 Constituent model: Free The commands for this constituent model are described in Section 4.6.3.2.1. 4.8.3.7.2 Constituent model: Attached The commands for this constituent model are described in Section 4.6.3.2.2. 4.8.4 Part 3: Material specification Oxygen, silicate, ammonium, nitrate FRP, dissolved organic carbon, dissolved organic nitrogen and dissolved organic phosphorus benthic fluxes are specified within both default and numbered material blocks as: \\(\\blockindent\\) oxygen flux == \\(F_{sed}^{O_2}\\) \\(\\blockindent\\) silicate flux == \\(F_{sed}^{sil}\\) \\(\\blockindent\\) ammonium flux == \\(F_{sed}^{NH_4}\\) \\(\\blockindent\\) nitrate flux == \\(F_{sed}^{NO_3}\\) \\(\\blockindent\\) FRP flux == \\(F_{sed}^{FRP}\\) \\(\\blockindent\\) DOC flux == \\(F_{sed}^{DOC}\\) \\(\\blockindent\\) DON flux == \\(F_{sed}^{DON}\\) \\(\\blockindent\\) DOP flux == \\(F_{sed}^{DOP}\\) No adsorbed FRP, phytoplankton or particulate organic fluxes are required. 4.8.5 Constituent ordering As for the inorganics simulation class (see Section 4.7.5) different organic matter constituent model selections require different orderings in specifying computed variable initial conditions and bc header == commands. Notwithstanding this, all the ordering information presented in Section 4.7.5 for the inorganics simulation class applies equally to the organics simulation class, other than for insertions related to the simulation of organics (described below). As such, that section should be reviewed with regard to ordering of the following: Dissolved oxygen Silicate Inorganic nitrogen Inorganic phosphorus (including the optional simulation of adsorbed FRP), and Phytoplankton groups (including the basic and advanced phytoplankton constituent models, with and without simulation of cell density) The additional initial condition and bc header == fields related to the organics simulation class do not change the order of computed variable fields presented in Section 4.7.5 other than to insert organic matter constituent model computed variables immediately after FRP computed variables and immediately prior to required phytoplankton fields. This insertion and ordering is presented following for the labile and refractory organic matter constituent models. 4.8.5.1 Labile The computed variables required to be specified within the labile organic matter constituent model are, in order: Dissolved organic carbon Particulate organic carbon Dissolved organic nitrogen Particulate organic nitrogen Dissolved organic phosphorus Particulate organic phosphorus All columnar and list style initial condition computed variables are therefore expected in the following order (and map to “WQ_1” etc accordingly) initial wq concentration == \\(\\left[ DO \\right]\\), \\(\\left[ Si \\right]\\), \\(\\left[ NH_4 \\right]\\), \\(\\left[ NO_3 \\right]\\), \\(\\left[ FRP \\right]\\), (optionally \\(\\left[ FRPads \\right]\\)), \\(\\left[ DOC \\right]\\), \\(\\left[ POC \\right]\\), \\(\\left[ DON \\right]\\), \\(\\left[ PON \\right]\\), \\(\\left[ DOP \\right]\\), \\(\\left[ POP \\right]\\), \\(\\ldots\\) {phytoplankton placeholder/s} Similarly, in a bc header == command within a bc block, the following order of computed variables is expected after hydrodynamic (HD BCs) boundary conditions (and map to “WQ_1” etc accordingly): \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL, (optionally FRPads_mgL), DOC_mgL, POC_mgL, DON_mgL, PON_mgL, DOP_mgL, POP_mgL, \\(\\ldots\\) {phytoplankton placeholder/s} With regard to the abovebc header == command: DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL (optionally FRPads_mgL), DOC_mgL, POC_mgL, DON_mgL, PON_mgL, DOP_mgL and POP_mgL are the headers used to designate oxygen, silicate, ammonium, nitrate, FRP (optionally adsorbed FRP), dissolved organic carbon, particulate organic carbon, dissolved organic nitrogen, particulate organic nitrogen, dissolved organic phosphorus and particulate organic phosphorus in the related boundary condition file, respectively Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file The header texts “DO_mgL”, “Si_mgL”, “Amm_mgL”, “Nit_mgL”, “FRP_mgL” (optionally “FRPads_mgL”), “DOC_mgL”, “POC_mgL”, “DON_mgL”, “PON_mgL”, “DOP_mgL” and “POP_mgL” are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers 4.8.5.2 Refractory The computed variables required to be specified within the labile organic matter constituent model are, in order: Dissolved organic carbon Particulate organic carbon Dissolved organic nitrogen Particulate organic nitrogen Dissolved organic phosphorus Particulate organic phosphorus Refractory dissolved organic carbon Refractory dissolved organic nitrogen Refractory dissolved organic phosphorus Refractory particulate organic matter All columnar and list style initial condition computed variables are therefore expected in the following order (and map to “WQ_1” etc accordingly) initial wq concentration == \\(\\left[ DO \\right]\\), \\(\\left[ Si \\right]\\), \\(\\left[ NH_4 \\right]\\), \\(\\left[ NO_3 \\right]\\), \\(\\left[ FRP \\right]\\), (optionally \\(\\left[ FRPads \\right]\\)), \\(\\left[ DOC \\right]\\), \\(\\left[ POC \\right]\\), \\(\\left[ DON \\right]\\), \\(\\left[ PON \\right]\\), \\(\\left[ DOP \\right]\\), \\(\\left[ POP \\right]\\), \\(\\left[ RDOC \\right]\\), \\(\\left[ RDON \\right]\\), \\(\\left[ RDOP \\right]\\), \\(\\left[ RPOM \\right]\\), \\(\\ldots\\) {phytoplankton placeholder/s} Similarly, in a bc header == command within a bc block, the following order of computed variables is expected after hydrodynamic (HD BCs) boundary conditions (and map to “WQ_1” etc accordingly): \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL, (optionally FRPads_mgL), DOC_mgL, POC_mgL, DON_mgL, PON_mgL, DOP_mgL, POP_mgL, RDOC_mgL, RDON_mgL, RDOP_mgL, RPOM_mgL, \\(\\ldots\\) {phytoplankton placeholder/s} With regard to the abovebc header == command: DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL (optionally FRPads_mgL), DOC_mgL, POC_mgL, DON_mgL, PON_mgL, DOP_mgL, POP_mgL, RDOC_mgL, RDON_mgL, RDOP_mgL and RPOM_mgL are the headers used to designate oxygen, silicate, ammonium, nitrate, FRP (optionally adsorbed FRP), dissolved organic carbon, particulate organic carbon, dissolved organic nitrogen, particulate organic nitrogen, dissolved organic phosphorus, particulate organic phosphorus, refractory dissolved organic carbon, refractory dissolved nitrogen, refractory dissolved phosphorus and refractory particulate organic matter in the related boundary condition file, respectively Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file The header texts “DO_mgL”, “Si_mgL”, “Amm_mgL”, “Nit_mgL”, “FRP_mgL” (optionally “FRPads_mgL”), “DOC_mgL”, “POC_mgL”, “DON_mgL”, “PON_mgL”, “DOP_mgL”, “POP_mgL”, “RDOC_mgL”, “RDON_mgL”, “RDOP_mgL” and “RPOM_mgL” are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers. 4.8.5.3 Including pathogens (optional) The ordering requirements for pathogens are the same as those described in Section 4.6.5.1. Pathogen headers are always included last (i.e. after phytoplankton in the organics simulation class). 4.8.6 Example Following is an example of all the available WQ Module simulation class == organics commands, with a single material applied as zeros everywhere as the default, and then modified by a further specification for materials 3 and 7. Two phytoplankton groups (one each of the basic and advanced models) are set, and the refractory organic matter constituent model deployed. Pathogens have been omitted for clarity, but could be added as per Section @(ExampleDO). simulation class == organics wq dt == 900 wq units == mgl oxygen model == O2 oxygen benthic == 4.0, 1.05 oxygen min max == 0.0, 25.0 end oxygen model silicate model == si silicate benthic == 4.0, 1.05 silicate min max == 0.0, 2500.0 oxygen == on end silicate model inorganic nitrogen model == AmmoniumNitrate ammonium benthic == 4.0, 1.05 nitrate benthic == 4.0, 1.05 ammonium min max == 0.0, 50.0 nitrate min max == 0.0, 50.0 nitrification == 0.1, 4.0, 1.05 denitrification == exponential, 0.5, 8.0, 1.05 atmospheric deposition == 10.0, 2.4, 0.15 oxygen == on end inorganic nitrogen model inorganic phosphorus model == frphsads frp benthic == 4.0, 1.05 frp min max == 0.0, 35.0 frpads min max == 0.0, 35.0 atmospheric deposition == 5.0, 1.4 adsorption == quadratic, 1.5, 0.5 oxygen == on end inorganic phosphorus model phyto model == basic, green min max == 0.01, 40.0 temperature limitation == standard, 11.0, 14.0, 30.0 salinity limitation == none light limitation == monod, 0.3, 70.0 settling == constant, 0.01 nitrogen limitation == 0.01, 1.5 phosphorus limitation == 0.001, 0.03 silicate limitation == 0.5, 7.0 uptake == 4.7, 0.6, 8.9 carbon chla ratio == 32.0 primary productivity == 2.0, 1.06 respiration == 0.02, 1.04, 0.1, 0.05, 0.6 end phyto model phyto model == advanced, bluegreen min max == 0.5, 50.0 temperature limitation == standard, 10.0, 15.0, 25.0 salinity limitation == estuarine, 22.0, 35.0, 0.0 light limitation == monod, 0.5, 51.0 settling == motile, 0.5 nitrogen limitation == 0.05, 2.5, 4.0, 5.0 phosphorus limitation == 0.01, 0.05, 0.64, 0.67 silicate limitation == 1.0, 5.0 uptake == 0.05, 0.05, 8.9 carbon chla ratio == 27.0 nitrogen fixing == 0.100, 0.100 primary productivity == 1.0, 1.08 respiration == 0.01, 1.01, 0.2, 0.0, 0.4 end phyto model organic matter model == refractory carbon min max == 0.0, 35.0, 0.0, 35.0, 0.0, 50.0 nitrogen min max == 0.0, 25.0, 0.0, 25.0 phosphorus min max == 0.0, 5.0, 0.0, 5.0 organics benthic == 4.5, 1.03 hydrolysis == 1.2, 0.19, 0.031, 4.2, 1.1 mineralisation == 0.053, 4.1, 1.02, 0.6, 1.2 self shading == 0.0003, 0.00025 ref carbon min max == 0.0, 40.0, 0.0, 35.0 ref nitrogen min max == 0.0, 25.0 ref phosphorus min max == 0.0, 5.0 ref breakdown == 0.002, 0.15, 0.0094 ref activation == 0.02 ref photolysis == 0.03 ref self shading == 0.00031, 0.00022 end organic matter model material == default oxygen flux == 0.0 silicate flux == 0.0 ammonium flux == 0.0 nitrate flux == 0.0 frp flux == 0.0 DOC flux == 0.0 DON flux == 0.0 DOP flux == 0.0 end material material == 3, 7 oxygen flux == -400.0 silicate flux == 12.0 ammonium flux == 33.0 nitrate flux == 3.7 frp flux == 1.4 DOC flux == 12.0 DON flux == 1.81 DOP flux == 0.29 end material 4.9 Outputs WQ Module outputs are set via commands specified in the TUFLOW FV control file, as described below. Available outputs include: WQ Module outputs: Computed variables, i.e. time varying concentrations of simulated quantities (e.g. dissolved oxygen). See Appendix P Diagnostic variables, i.e. time varying quantities that describe rates, and similar such processes which modify computed variables (e.g. sediment flux of nitrate). See Appendix Q TUFLOW FV integrated outputs of WQ Module variables: Fluxes, e.g. the time varying flux of a WQ Module computed variable integrated by TUFLOW FV across a two dimensional vertical curtain, and Masses, e.g. the time varying integrated mass of a WQ Module computed or diagnostic variable, computed across the entire model domain Computed and diagnostic variables are output directly by the WQ Module, whilst integrated outputs are computed by TUFLOW FV, using WQ Module computed and diagnostic variables as inputs. All these types of outputs use the same structures as described in the TUFLOW FV user manual for hydrodynamic and other TUFLOW FV outputs, namely via specification of output == blocks. The relevant sections of the TUFLOW FV manual should be reviewed to supplement the material presented here. WQ Module and TUFLOW FV outputs are described below. 4.9.1 WQ Module outputs All WQ Module output computed and diagnostic variables, together with their output names, are included in Appendices P and Q. The listed output names can be copied and pasted directly from the Appendices to a control file, with the exception of phytoplankton variables, where the user specified group name is included within the variable name, so will need to be inserted by the user. The most common output == blocks used by the WQ Module to report the time variation of computed and/or diagnostic variables are: 0D points: output == points (these are depth averaged timeseries outputs at an X/Y location) 1D profiles: output == profiles 2D maps: output == datv 3D fields: output == netcdf The simplest manner in which to specify the computed and diagnostic variables to be included in these blocks is to use the wq_all and wq_diag_all flags against the output parameters command. An example of a 3D netcdf output block that reports computed variables (wq_all) and diagnostic variables (wq_diag_all) every hour is: output == netcdf output parameters == wq_all, wq_diag_all output interval == 3600.00 end output WQ Module outputs need not be in distinct output blocks of their own, but can be added to existing TUFLOW output blocks, for example: output == datv output parameters == h, V, wq_all, wq_diag_all output interval == 3600.00 vertical averaging == depth-all end output Water quality outputs are often voluminous. In order to avoid potentially cumbersome data handling issues around large output files, the output parameters == command arguments can be tailored to list only those computed or diagnostic variables required for analysis, rather than using the blanket wq_all and wq_diag_all arguments. An example of such an output command block that only reports dissolved oxygen concentration and atmospheric oxygen exchange is: output == netcdf output parameters == h, WQ_DISS_OXYGEN_MG_L, WQ_DIAG_O2_ATMOS_EXCHANGE_MG_M2_D output interval == 3600.00 end output 4.9.2 TUFLOW FV outputs The most common output == blocks used to report the time variation of integrated quantities computed by TUFLOW FV are: Mass: output == mass flux: output == flux Variable names are not specified, with all available variables being included by default. Examples of such output blocks are: output == mass output interval == 3600.00 end output output == flux output interval == 3600.00 end output Both these output types produce .csv files with headers that append ’_MASS’ and ’_FLUX’ to the variable names presented in the Appendices. 4.9.3 Units All output units are as set by the user (i.e. either the mg/L or mmol/m\\(^3\\) systems). In binary outputs (i.e. netcdf and datv outputs) quantities are reported simply in the simulated units. The names of variables in these binary files will also denote the units of reporting. For example, dissolved oxygen concentrations reported in a three dimensional netcdf file that was generated by a mg/L water quality simulation will: Be in units of mg/L. A reported value of “6.5” will be 6.5 mg/L Have the variable name WQ_DISS_OXYGEN_MG_L In text based outputs (i.e. mass, flux and points outputs), units are reported in column headers. For consistency, SI units of kg, m\\(^3\\) and seconds are used to report in the mg/L system. In the mmol system, reporting units are moles, m\\(^3\\) and seconds. In both cases, these units may also deploy engineering notation (e.g. “x10^3” or “x10^6”) so that text field outputs are manageable. In these cases, the reported numbers in the columns have been multiplied by the noted magnitude in each header before being written to file. For example, a unit header of “x10^3 kg” that subsequently reports a value of “4,000”, indicates that the simulated quantity was actually “4” kg - the simulated quantity has been multiplied by 10^3 before being reported. Some specific examples of header notated units, and their simplifications include: mg/L system: “x 10^3 kg m^-3” is mg/L “x 10^6 kg Chla m^-3” is \\(\\mu\\)g/L “x 10^3 kg” is grams “x 10^6 kg” is milligrams “x 10^3 kg s^-1” is grams per second mmol/m\\(^3\\) system: “x 10^3 mol m^-3” is mmol/m\\(^3\\) “x 10^3 mol” is mmol “x 10^3 mols^-1” is millimoles per second Another way of thinking about this conversion is that if a unit is reported as “x 10^z units”, then the reported quantity needs to be divided by 10\\(^z\\) to recover the original quantity in “units”. For diagnostic variables, the outputting of “points” (which are depth averaged), “mass” and “flux” files is rarely meaningful and should be avoided. No support for units of these output types is therefore provided. Binary files of these outputs are meaningful (they are used in the mass balance analysis for example) so have the units of each diagnostic denoted in its name (e.g. “WQ_DIAG_FRP_ADS_SEDMTN_FLUX_MG_M2_D” is in mg/m\\(^2\\)/day). "],["AppSyntax.html", "Appendix A Syntax of command descriptions A.1 Commands A.2 Arguments A.3 Defaults", " Appendix A Syntax of command descriptions The manual’s introduction should be reviewed for instructions regarding the use of interactive components deployed in this section. All WQ Module commands and descriptions are provided in Table B.1. This Appendix describes the syntax of that table. A.1 Commands WQ Module commands are coloured, for example frp adsorption parameters ==. These can be copied and pasted directly into a *.fvwq (or *.fvc where appropriate) control file, and arguments added. A.2 Arguments Descriptions of the arguments expected by WQ Module commands (i.e. information provided after the ==) are contrastingly coloured and always included in angle parentheses, as \\(\\langle\\)argument\\(\\rangle\\) . This argument content takes one of the following forms: A description. For example, for the material == WQ Module command, the argument is described as \\(\\langle\\)Up to 10 comma separated material numbers\\(\\rangle\\). An example of implementing this description would therefore be material == 1, 6, 3 Single keyword options. Options are separated by semicolons. Options need to be used exactly as written because they are keywords. For example, \\(\\langle\\)DO;inorganics;organics\\(\\rangle\\) describes the three available simulation options for the command simulation class ==. An example of implementing this description would therefore be simulation class == organics Single numeric values. Values are presented using their associated symbol, using the notation described in the manual’s introductory sections. For example, \\(F_{sed}^{NO_3}\\) describes the single numeric value for the command nitrate flux ==. An example of implementing this description would therefore be nitrate flux == 5.7 Multiple numeric values. Values are presented using their associated symbol, using the notation described in the manual’s introductory sections, and are separated by commas. The number of comma separated symbols indicates the number of expected numeric values. For example, \\(\\langle K_{sed-O_2}^{NH_4},\\theta_{sed}^{NH_4} \\rangle\\) describes the two numeric values expected for the command ammonium benthic ==. An example of implementing this description would therefore be ammonium benthic == 4.2, 1.08 Combined keyword and numeric value/s options. Arguments are separated by commas. Numeric arguments are represented by their associated symbol, using the notation described in the manual’s introductory sections. Options need to be used exactly as written because they are keywords. Where different keyword options (for the same command) require different numbers or types of corresponding numerical arguments, these are listed as separate table entries for clarity. These different implementations of the same command are however easily navigated between by using the hyperlinked descriptive words in the right hand most table column. A.3 Defaults All WQ Module commands are optional (see Section 4.5), and where not specified by the user, the WQ Module will use library default arguments. These defaults are listed in a separate column of Table B.1. Where defaults are not appropriate, then “N/A” is listed in this column. Initial conditions must be specified via the *.fvc control file and do not have defaults. "],["AppCommands.html", "Appendix B Commands", " Appendix B Commands .book .book-body .page-wrapper .page-inner { max-width: 95%; } All WQ Module commands and descriptions follow. This page has deliberately been set to be wider than the main document so as to accommodate the detail contained within the table. Tips provided in the manual’s introduction for interacting with the table should be reviewed, especially with regard to searching and navigation. Other tips for use specific to this table include: Commands are coloured and although they show as underlined on mouse hover, these are not hyperlinked Corresponding arguments (presented as their symbols) are coloured and listed in the required order within angled parentheses following each command ==. Each argument is a hyperlink to its description in the relevant Appendix. This description then includes hyperlinks to the relevant science and command syntax (Section 4). This allows easy navigation between command, parameter and scientific information The final text of each description is ‘Simulation construction section …’ and is a link to the relevant part of Section 4 where the command syntax is presented in context. More parameter details and descriptions are subsequently available via further hyperlinks included in the construction section Commands that have multiple possible combinations of more than one argument are presented as separate table entries. These related entries (that share the same command) are easily navigable by use of the links provided in the right hand table column, headed “Links” Table B.1: WQ Module Commands Command Description Links oxygen flux == \\(\\langle\\)\\(F_{sed}^{O_2}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of oxygen. Simulation construction section 4.6.4. \\(\\text{ }\\) oxygen benthic == \\(\\langle\\)\\(K_{sed-O_2}^{O_2}\\),\\(\\theta_{sed}^{O_2}\\)\\(\\rangle\\) Used in an oxygen constituent model block to control the response of benthic oxygen flux to temperature and oxygen concentration. Simulation construction section 4.6.3.1.1. \\(\\text{ }\\) oxygen model == \\(\\langle\\)O2\\(\\rangle\\) Used to commence an oxygen constituent model block via specification of a constituent model from the oxygen constituent model class. Simulation construction section 4.6.3.1. \\(\\text{ }\\) oxygen min max == \\(\\langle\\)\\(\\left[DO\\right]_{min}^{O_2}\\),\\(\\left[DO\\right]_{max}^{O_2}\\)\\(\\rangle\\) Used in an oxygen constituent model block to set minimum and maximum dissolved oxygen concentrations. Simulation construction section 4.6.3.1.1. \\(\\text{ }\\) simulation class == \\(\\langle\\)DO;inorganics;organics\\(\\rangle\\) Used in Part 1: Simulation controls of WQ Module control file to specify water quality simulation class. If not specified, “DO” is assumed and all associated “DO” class default parameters are applied. Simulation construction section 4.5.1. \\(\\text{ }\\) end oxygen model Used to terminate an oxygen constituent model block. Must follow an oxygen model == command. Simulation construction section 4.6.3.1.1. \\(\\text{ }\\) wq units == \\(\\langle\\)mgl;mmm\\(\\rangle\\) Used in Part 1: Simulation controls of WQ Module control file to set the units used for water quality simulation. Milligrams per litre and millimoles per cubic metre are “mgl” and “mmm”, respectively. Simulation construction section 4.5.1. \\(\\text{ }\\) wq dt == \\(\\langle\\)\\(dt\\)\\(\\rangle\\) Used in Part 1: Simulation controls of WQ Module control file to set the timestep at which TUFLOW calls the WQ Module to undertake non-conservative water quality calculations, in seconds. Simulation construction section 4.5.1. \\(\\text{ }\\) silicate flux == \\(\\langle\\)\\(F_{sed}^{Si}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of silicate. Simulation construction section 4.7.4. \\(\\text{ }\\) silicate benthic == \\(\\langle\\)\\(K_{sed-O_2}^{Si}\\),\\(\\theta_{sed}^{Si}\\)\\(\\rangle\\) Used in a silicate constituent model block to control the response of benthic silicate flux to temperature and oxygen concentration. Simulation construction section 4.7.3.2.1. \\(\\text{ }\\) silicate min max == \\(\\langle\\)\\(\\left[Si\\right]_{min}^{Si}\\),\\(\\left[Si\\right]_{max}^{Si}\\)\\(\\rangle\\) Used in a silicate constituent model block to set minimum and maximum silicate concentrations. Simulation construction section 4.7.3.2.1. \\(\\text{ }\\) silicate model == \\(\\langle\\)Si\\(\\rangle\\) Used to commence a silicate constituent model block via specification of a constituent model from the silicate constituent model class. Simulation construction section 4.7.3.2. \\(\\text{ }\\) oxygen == \\(\\langle\\)on;off\\(\\rangle\\) Used in a silicate constituent model block to switch the dependence of silicate processes on dissolved oxygen on or off. Simulation construction section 4.7.3.2.1. \\(\\text{ }\\) ammonium flux == \\(\\langle\\)\\(F_{sed}^{NH_4}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of ammonium. Simulation construction section 4.7.4. \\(\\text{ }\\) ammonium benthic == \\(\\langle\\)\\(K_{sed-O_2}^{NH_4}\\),\\(\\theta_{sed}^{NH_4}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to control the response of benthic ammonium flux to temperature and oxygen concentration. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) ammonium min max == \\(\\langle\\)\\(\\left[NH_4\\right]_{min}^{NH_4}\\),\\(\\left[NH_4\\right]_{max}^{NH_4}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to set minimum and maximum ammonium concentrations. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) inorganic nitrogen model == \\(\\langle\\)AmmoniumNitrate\\(\\rangle\\) Used to commence an inorganic nitrogen constituent model block via specification of a constituent model from the inorganic nitrogen constituent model class. Simulation construction section 4.7.3.3. \\(\\text{ }\\) oxygen == \\(\\langle\\)on;off\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to switch the dependence of all nitrogen (ammonium and nitrate) processes on dissolved oxygen on or off. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) end silicate model Used to terminate a silicate constituent model block. Must follow a silicate model == command. Simulation construction section 4.7.3.2.1. \\(\\text{ }\\) end inorganic nitrogen model Used to terminate an inorganic nitrogen nitrogen constituent model block. Must follow an inorganic nitrogen model == command. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) nitrate flux == \\(\\langle\\)\\(F_{sed}^{NO_3}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of nitrate. Simulation construction section 4.7.4. \\(\\text{ }\\) nitrate benthic == \\(\\langle\\)\\(K_{sed-O_2}^{NO_3}\\),\\(\\theta_{sed}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to control the response of benthic nitrate flux to temperature and oxygen concentration. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) nitrate min max == \\(\\langle\\)\\(\\left[NO_3\\right]_{min}^{NO_3}\\),\\(\\left[NO_3\\right]_{max}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to set minimum and maximum nitrate concentrations. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) nitrification == \\(\\langle\\)\\(R_{nitrif}^{NH_4}\\),\\(K_{nitrif-O_2}^{NH_4}\\),\\(\\theta_{nitrif}^{NH_4}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to control nitrification and its response to oxygen concentration and temperature. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) denitrification == \\(\\langle\\)Michaelis Menten,\\(R_{denit}^{NO_3}\\),\\(K_{denit-O2-MM}^{NO_3}\\),\\(\\theta_{denit}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to activate the Michaelis Menten model and control denitrification and its response to ambient oxygen concentrations and temperature. Simulation construction section 4.7.3.3.1. to exponential denitrification == \\(\\langle\\)exponential,\\(R_{denit}^{NO_3}\\),\\(K_{denit-O2-exp}^{NO_3}\\),\\(\\theta_{denit}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to activate the exponential model and control denitrification and its response to ambient oxygen concentrations and temperature. Simulation construction section 4.7.3.3.1. to Michaelis Menten atmospheric deposition == \\(\\langle\\)\\(\\left[{TN}\\right]_{rain}\\),\\(R_{atm-dry}^{TN}\\),\\(f_{TN}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to control the wet and dry atmospheric deposition of inorganic nitrogen. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) inorganic phosphorus model == \\(\\langle\\)FRPhs,FRPhsads\\(\\rangle\\) Used to commence an inorganic phosphorus constituent model block via specification of a constituent model from the inorganic phosphorus constituent model class. Simulation construction section 4.7.3.4. \\(\\text{ }\\) end inorganic phosphorus model Used to terminate an inorganic phosphorus phosphorus constituent model block. Must follow a inorganic phosphorus model == command. Simulation construction section 4.7.3.4.1. \\(\\text{ }\\) FRP min max == \\(\\langle\\)\\(\\left[FRP\\right]_{min}^{FRP}\\),\\(\\left[FRP\\right]_{max}^{FRP}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to set minimum and maximum FRP concentrations. Simulation construction section 4.7.3.4.1. \\(\\text{ }\\) FRP flux == \\(\\langle\\)\\(F_{sed}^{FRP}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of FRP. Simulation construction section 4.7.4. \\(\\text{ }\\) FRP benthic == \\(\\langle\\)\\(K_{sed-O_2}^{FRP}\\),\\(\\theta_{sed}^{FRP}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to control the response of benthic FRP flux to temperature and oxygen concentration. Simulation construction section 4.7.3.4.1. \\(\\text{ }\\) oxygen == \\(\\langle\\)on;off\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to switch the dependence of FRP processes on dissolved oxygen on or off. Simulation construction section 4.7.3.4.1. \\(\\text{ }\\) atmospheric deposition == \\(\\langle\\)\\(\\left[{FRP}\\right]_{rain}\\),\\(R_{atm-dry}^{FRPads}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to control the wet (and dry) atmospheric deposition of FRP (adsorbed FRP). Simulation construction section 4.7.3.4.1. \\(\\text{ }\\) FRPads min max == \\(\\langle\\)\\(\\left[FRPads\\right]_{min}^{FRPads}\\),\\(\\left[FRPads\\right]_{max}^{FRPads}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to set minimum and maximum adsorbed FRP concentrations. Simulation construction section 4.7.3.4.2. \\(\\text{ }\\) adsorption == \\(\\langle\\)linear,\\(K_{ads-L}^{FRP}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to set the paramters for the linear FRP adsorption model. Simulation construction section 4.7.3.4.2. to quadratic adsorption == \\(\\langle\\)quadratic,\\(K_{ads-Q}^{FRP}\\),\\(Q^{FRP}_{max}\\)\\(\\rangle\\) Used in a constituent model block to set the paramters for the quadratic FRP adsorption model. Simulation construction section 4.7.3.4.2. to linear phyto model == \\(\\langle\\)basic;advanced,group_name\\(\\rangle\\) Used to commence a phytoplankton constituent model block via specification of a model from the phytoplankton constituent model class, and a phytoplankton group name. The group name can be any name required. If the advanced phytoplankton model is used then internal nitrogen and phosphorus concentrations will be simulated as computed variables and therefore must have respective initial conditions and boundary conditions specified, paying attention to ordering rules as required. Simulation construction section 4.7.3.5. \\(\\text{ }\\) min max == \\(\\langle\\)\\(\\left[PHY\\right]_{min}^{PHY}\\),\\(\\left[PHY\\right]_{max}^{PHY}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set minimum and maximum phytoplankton group concentrations. Simulation construction section 4.7.3.5.1. \\(\\text{ }\\) temperature limitation == \\(\\langle\\)none\\(\\rangle\\) Used in a phytoplankton constituent model block to turn off phytoplankton group temperature limitation. Simulation construction section 4.7.3.5.1.1. to standard temperature limitation == \\(\\langle\\)standard,\\(T_{std}^{phy}\\),\\(T_{opt}^{phy}\\),\\(T_{max}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set the standard phytoplankton group temperature limitation function. Simulation construction section 4.7.3.5.1.1. to none salinity limitation == \\(\\langle\\)none\\(\\rangle\\) Used in a phytoplankton constituent model block to turn off phytoplankton group salinity limitation. Simulation construction section 4.7.3.5.1.2. to fresh,to marine,to mixed,to estuarine salinity limitation == \\(\\langle\\)fresh,\\(S_{opt-fresh}^{phy}\\),\\(S_{max-fresh}^{phy}\\),\\(L_{max-fresh}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to select the freshwater phytoplankton group salinity limitation. Simulation construction section 4.7.3.5.1.2. to none,to marine,to mixed,to estuarine salinity limitation == \\(\\langle\\)marine,\\(S_{opt-marine}^{phy}\\),\\(L_{zero-marine}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to select the marine phytoplankton group salinity limitation. Simulation construction section 4.7.3.5.1.2. to none,to fresh,to mixed,to estuarine salinity limitation == \\(\\langle\\)mixed,\\(S_{opt-mix}^{phy}\\),\\(S_{max-mix}^{phy}\\),\\(L_{zero-mix}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to select the mixed phytoplankton group salinity limitation. Simulation construction section 4.7.3.5.1.2. to none,to marine,to mixed,to estuarine salinity limitation == \\(\\langle\\)estuarine,\\(S_{opt-est}^{phy}\\),\\(S_{max-est}^{phy}\\),\\(P_{est}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to select the estuarine phytoplankton group salinity limitation. Simulation construction section 4.7.3.5.1.2. to none,to fresh,to marine,to mixed nitrogen limitation == \\(\\langle\\)\\(\\left[N\\right]_{min}^{phy}\\),\\(K_{lim-N}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set nitrogen limitation parameters for the basic phytoplankton model. Simulation construction section 4.7.3.5.1.4. to advanced nitrogen limitation == \\(\\langle\\)\\(\\left[N\\right]_{min}^{phy}\\),\\(K_{lim-N}^{phy}\\),\\(X_{N-C-min}^{phy}\\),\\(X_{N-C-max}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set nitrogen limitation parameters for the advanced phytoplankton model. Simulation construction section 4.7.3.5.2.1. to basic phosphorus limitation == \\(\\langle\\)\\(\\left[P\\right]_{min}^{phy}\\),\\(K_{lim-P}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set phosphorus limitation parameters for the basic phytoplankton model. Simulation construction section 4.7.3.5.1.5. to advanced phosphorus limitation == \\(\\langle\\)\\(\\left[P\\right]_{min}^{phy}\\),\\(K_{lim-P}^{phy}\\),\\(X_{P-C-min}^{phy}\\),\\(X_{P-C-max}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set phosphorus limitation parameters for the advanced phytoplankton model. Simulation construction section 4.7.3.5.2.2. to basic silicate limitation == \\(\\langle\\)\\(\\left[Si\\right]_{min}^{phy}\\),\\(K_{lim-Si}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set silicate limitation parameters for the basic phytoplankton model. Specifying this command triggers silicate uptake. Simulation construction section 4.7.3.5.1.6. \\(\\text{ }\\) light limitation == \\(\\langle\\)basic,\\(Ke^{phy}\\),\\(I_{K-bas}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set basic light limitation parameters for the basic and advanced phytoplankton constituent models. If stokes settling is used then the vlaue of \\(I_K\\) specified in this command overrides any value specified using the settling == stokes , \\(I_K\\) command. Simulation construction section 4.7.3.5.1.3. to monod,to steele,to webb,to jassby,to chalker,to klepper,to integrated, light limitation == \\(\\langle\\)monod,\\(Ke^{phy}\\),\\(I_{K-mon}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set monod light limitation parameters for the basic and advanced phytoplankton constituent models. If stokes settling is used then the vlaue of \\(I_K\\) specified in this command overrides any value specified using the settling == stokes , \\(I_K\\) command. Simulation construction section 4.7.3.5.1.3. to basic,to steele,to webb,to jassby,to chalker,to klepper,to integrated, light limitation == \\(\\langle\\)steele,\\(Ke^{phy}\\),\\(I_{S-ste}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set steele light limitation parameters for the basic and advanced phytoplankton constituent models. Simulation construction section 4.7.3.5.1.3. to basic,to monod,to webb,to jassby,to chalker,to klepper,to integrated, light limitation == \\(\\langle\\)webb,\\(Ke^{phy}\\),\\(I_{K-web}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set webb light limitation parameters for the basic and advanced phytoplankton constituent models. If stokes settling is used then the vlaue of \\(I_K\\) specified in this command overrides any value specified using the settling == stokes , \\(I_K\\) command. Simulation construction section 4.7.3.5.1.3. to basic,to steele,to monod,to jassby,to chalker,to klepper,to integrated, light limitation == \\(\\langle\\)jassby,\\(Ke^{phy}\\),\\(I_{K-jas}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set jassby light limitation parameters for the basic and advanced phytoplankton constituent models. If stokes settling is used then the vlaue of \\(I_K\\) specified in this command overrides any value specified using the settling == stokes , \\(I_K\\) command. Simulation construction section 4.7.3.5.1.3. to basic,to steele,to webb,to monod,to chalker,to klepper,to integrated, light limitation == \\(\\langle\\)chalker,\\(Ke^{phy}\\),\\(I_{K-cha}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set chalker light limitation parameters for the basic and advanced phytoplankton constituent models. If stokes settling is used then the vlaue of \\(I_K\\) specified in this command overrides any value specified using the settling == stokes , \\(I_K\\) command. Simulation construction section 4.7.3.5.1.3. to basic,to steele,to webb,to jassby,to monod,to klepper,to integrated, light limitation == \\(\\langle\\)klepper,\\(Ke^{phy}\\),\\(I_{S-kle}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set klepper light limitation parameters for the basic and advanced phytoplankton constituent models. Simulation construction section 4.7.3.5.1.3. to basic,to steele,to webb,to jassby,to chalker,to monod,to integrated, light limitation == \\(\\langle\\)integrated,\\(Ke^{phy}\\),\\(I_{S-int}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set integrated light limitation parameters for the basic and advanced phytoplankton constituent models. Simulation construction section 4.7.3.5.1.3. to basic,to steele,to webb,to jassby,to chalker,to klepper,to monod, uptake == \\(\\langle\\)\\(X_{N-C-con}^{phy}\\),\\(X_{P-C-con}^{phy}\\),\\(X_{Si-C-con}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set constant nitrogen, phosphorus and optionally silicate to biomass ratios for the basic phytoplankton constituent model only. Simulation construction section 4.7.3.5.1.7. to advanced uptake == \\(\\langle\\)\\(R_{N-uptake}^{phy}\\),\\(R_{P-uptake}^{phy}\\),\\(X_{Si-C-con}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set nitrogen and phosphorus (and optionally silicate) uptake rates for the advanced phytoplankton constituent model only. The silicate internal concentration ratio is ignored if silicate uptake is not activated. Simulation construction section 4.7.3.5.2.3. to basic settling == \\(\\langle\\)none\\(\\rangle\\) Used in a phytoplankton constituent model block to turn off settling in both basic and advanced phytoplankton constituent models. Simulation construction section 4.7.3.5.1.12. to constant,to thermal,to stokes,to motile settling == \\(\\langle\\)constant,\\(V_{settle}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set a constant settling velocity in both basic and advanced phytoplankton constituent models. A negative value specified in this command is a downwards velocity. Setting the settling velocity to zero in this model is the same as using settling == none. Simulation construction section 4.7.3.5.1.12. to none,to thermal,to stokes,to motile settling == \\(\\langle\\)thermal,\\(V_{settle}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set a constant settling velocity in both basic and advanced phytoplankton constituent models, allowing for temperature effects to settling. A negative value specified in this command is a downwards velocity. Simulation construction section 4.7.3.5.1.12. to none,to constant,to stokes,to motile settling == \\(\\langle\\)stokes,\\(I_{K-sto}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to compute settling velocity via stokes settling laws in both basic and advanced phytoplankton constituent models. Density must be simulated as a computed variable for each phytoplankton group that uses this model, so must have cell density initial conditions and boundary conditions specified as per ordering rules. The specification of \\(I_K\\) is not mandatory in this command. If it is not specified then the \\(I_K\\) specified in the phytoplankton constituent model’s light limitation model will be used. If a light limitaton model is not specified, or uses \\(I_S\\) instead of \\(I_K\\), then the library default value of \\(I_K\\) is used. If \\(I_K\\) is specified both in this stokes settling command and a phytoplankton constituent model light limitation function, then the value specified in the “light limitation ==” command is used, and the value specified in this command is ignored. Simulation construction section 4.7.3.5.1.12. to none,to constant,to thermal,to motile settling == \\(\\langle\\)motile,\\(V_{mot}^{phy}\\),\\(I_{K-mot}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to compute settling velocity via motility functions that depend on ambient conditions, in only the advanced phytoplankton constituent model. The specification of \\(I_K\\) is not mandatory in this command. If it is not specified then the \\(I_K\\) specified in the phytoplankton constituent model’s light limitation model will be used. If a light limitaton model is not specified, or uses \\(I_S\\) instead of \\(I_K\\), then the library default value of \\(I_K\\) is used. If \\(I_K\\) is specified both in this motile settling command and a phytoplankton constituent model light limitation function, then the value specified in the “light limitation ==” command is used, and the value specified in this command is ignored. Simulation construction section 4.7.3.5.2.4. to none,to constant,to thermal,to stokes carbon chla ratio == \\(\\langle\\)\\(X_{cc}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set the ratio of phytoplankton cell carbon biomass to chlorophyll a . Simulation construction section 4.7.3.5.1.10. \\(\\text{ }\\) end phyto model Used to terminate a phytoplankton constituent model block. Must follow a phyto model == command. Simulation construction section 4.7.3.5.1.13. \\(\\text{ }\\) nitrogen fixing == \\(\\langle\\)\\(R_{nfix}^{N_2}\\),\\(f_{nfix}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set the nitrogen fixing parameters of a phytoplankton constituent model. The first parameter sets the rate of nitrogen fixing and the second dictates the influence of nitrogen fixing on primary productivity. Simulation construction section 4.7.3.5.1.11. \\(\\text{ }\\) primary productivity == \\(\\langle\\)\\(R_{prod}^{phy}\\),\\(\\theta_{prod}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set primary productivity parameters of a phytoplankton constituent model. Simulation construction section 4.7.3.5.1.8. \\(\\text{ }\\) respiration == \\(\\langle\\)\\(R_{resp}^{phy}\\),\\(\\theta_{resp}^{phy}\\),\\(f_{true-resp}^{phy}\\),\\(f_{excr-loss}^{phy}\\),\\(f_{exud}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set respiration and exudation parameters of a phytoplankton constituent model. Simulation construction section 4.7.3.5.1.9. \\(\\text{ }\\) water quality model == \\(\\langle\\)tuflow\\(\\rangle\\) Instruct TUFLOW FV to activate TUFLOW WQ Module. Simulation construction section 4.4.1. \\(\\text{ }\\) water quality control file == \\(\\langle\\)water quality control file name\\(\\rangle\\) Name of WQ Module control file, with no path. If this file is not in the FV control file directory, then additionally use command water quality mode directory ==. Simulation construction section 4.4.1. \\(\\text{ }\\) water quality model directory == \\(\\langle\\)water quality control file directory\\(\\rangle\\) Relative path from location of FV control file to the WQ Module control file directory, including last backslash, e.g. “..\\(\\backslash\\)WQM\\(\\backslash\\)”. Simulation construction section 4.4.1. \\(\\text{ }\\) restart == \\(\\langle\\)restart file path and name\\(\\rangle\\) Specification of full path and name of previously saved restart file. Simulation construction section 4.4.2.1. \\(\\text{ }\\) initial wq concentration == \\(\\langle\\)comma separated wq initial conditions\\(\\rangle\\) Ordered individual computed variable initial conditions. Simulation construction section 4.4.2.1. \\(\\text{ }\\) initial scalar profile == \\(\\langle\\)initial condition file name and path\\(\\rangle\\) Ordered individual computed variable initial conditions in a columnar text file. Simulation construction section 4.4.2.1. \\(\\text{ }\\) initial condition 2d == \\(\\langle\\)initial condition file name and path\\(\\rangle\\) Ordered individual computed variable initial conditions in a columnar text file. Simulation construction section 4.4.2.1. \\(\\text{ }\\) initial condition 3d == \\(\\langle\\)initial condition file name and path\\(\\rangle\\) Ordered individual computed variable initial conditions in a columnar text file. Simulation construction section 4.4.2.1. \\(\\text{ }\\) material == \\(\\langle\\)Up to 10 comma separated material integers\\(\\rangle\\) Command to initiate a materials block. Commands within this block apply to the material numbers listed in this command. Simulation construction section 4.5.3. \\(\\text{ }\\) end material Command to terminate a materials block. This command must be paired with a corresponding material command to initiate the block. Simulation construction section 4.5.3. \\(\\text{ }\\) include sediment == \\(\\langle\\)include sediment transport calculations,include sediment in density calculation\\(\\rangle\\) TUFLOW FV command to include sediment simulation. Sediment must be simulated if adsorbed phosphorus is included in a WQ Module simulation. Simulation construction section 4.7.5.1.2. \\(\\text{ }\\) carbon min max == \\(\\langle\\)\\(\\left[POC\\right]_{min}^{POC}\\),\\(\\left[POC\\right]_{max}^{POC}\\),\\(\\left[DOC\\right]_{min}^{DOC}\\),\\(\\left[DOC\\right]_{max}^{DOC}\\)\\(\\rangle\\) Used in an organic matter constituent model block to set minimum and maximum particulate and dissolved organic carbon concentrations. Simulation construction section 4.8.3.5. \\(\\text{ }\\) nitrogen min max == \\(\\langle\\)\\(\\left[PON\\right]_{min}^{PON}\\),\\(\\left[PON\\right]_{max}^{PON}\\),\\(\\left[DON\\right]_{min}^{DON}\\),\\(\\left[DON\\right]_{max}^{DON}\\)\\(\\rangle\\) Used in an organic matter constituent model block to set minimum and maximum particulate and dissolved organic nitrogen concentrations. Simulation construction section 4.8.3.5. \\(\\text{ }\\) phosphorus min max == \\(\\langle\\)\\(\\left[POP\\right]_{min}^{POP}\\),\\(\\left[POP\\right]_{max}^{POP}\\),\\(\\left[DOP\\right]_{min}^{DOP}\\),\\(\\left[DOP\\right]_{max}^{DOP}\\)\\(\\rangle\\) Used in an organic matter constituent model block to set minimum and maximum particulate and dissolved organic phosphorus concentrations. Simulation construction section 4.8.3.5. \\(\\text{ }\\) organic matter model == \\(\\langle\\)labile,refractory\\(\\rangle\\) Used to commence an organics constituent model block via specification of a model from the organics constituent model class.. Simulation construction section 4.8.3.5. \\(\\text{ }\\) DOC flux == \\(\\langle\\)\\(F_{sed}^{DOC}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of DOC. Simulation construction section 4.8.4. \\(\\text{ }\\) DON flux == \\(\\langle\\)\\(F_{sed}^{DON}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of DON. Simulation construction section 4.8.4. \\(\\text{ }\\) DOP flux == \\(\\langle\\)\\(F_{sed}^{DOP}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of DOP. Simulation construction section 4.8.4. \\(\\text{ }\\) organics benthic == \\(\\langle\\)\\(K_{sed-O_2}^{DOM}\\),\\(\\theta_{sed}^{DOM}\\)\\(\\rangle\\) Used in an organics constituent model block to control the response of benthic DOM flux to temperature and oxygen concentration. Simulation construction section 4.8.3.5.1. \\(\\text{ }\\) end organic matter model Used to terminate an organics constituent model block. Must follow an organic matter model == command. Simulation construction section 4.8.3.5.1. \\(\\text{ }\\) oxygen == \\(\\langle\\)on;off\\(\\rangle\\) Used in an organics constituent model block to switch the dependence of all processes on dissolved oxygen on or off. Anammox and DRNA processes will be switched off entirely if this command is issued asnd set to ‘off’. Simulation construction section 4.8.3.5.1. \\(\\text{ }\\) hydrolysis == \\(\\langle\\)\\(R_{hyd}^{POC}\\),\\(R_{hyd}^{PON}\\),\\(R_{hyd}^{POP}\\),\\(K_{hyd-O_2}^{POM}\\),\\(\\theta_{hyd}^{POM}\\)\\(\\rangle\\) Used in an organics constituent model block to parameterise particulate organic carbon, nitrogen and phosphorus hydrolysis. Simulation construction section 4.8.3.5.1. \\(\\text{ }\\) mineralisation == \\(\\langle\\)\\(R_{miner}^{DOM}\\),\\(K_{miner-O_2}^{DOM}\\),\\(\\theta_{miner}^{DOM}\\),\\(f_{an}\\),\\(K_{miner-NO_3}^{NO_3}\\)\\(\\rangle\\) Used in an organics constituent model block to parameterise dissolved organic matter (carbon, nitrogen and phosphorus) mineralisation. It includes the parameters that govern anaerobic mineralisation, that is, the consumption of nitrate in the dissolved organic matter mineralisation process. Simulation construction section 4.8.3.5.1. \\(\\text{ }\\) self shading == \\(\\langle\\)\\(Ke^{POM}\\),\\(Ke^{DOM}\\)\\(\\rangle\\) Used in an organics constituent model block to parameterise light attenuation due to the presence of particulate and dissolved organic matter. Simulation construction section 4.8.3.5.1. \\(\\text{ }\\) ref breakdown == \\(\\langle\\)\\(R_{bdn}^{RPOM}\\),\\(X_N^{RPOM}\\),\\(X_P^{RPOM}\\)\\(\\rangle\\) Used in an organics constituent model block to parameterise the breakdown of refractory particulate organic matter. Simulation construction section 4.8.3.5.2. \\(\\text{ }\\) ref carbon min max == \\(\\langle\\)\\(\\left[RPOM\\right]_{min}^{RPOM}\\),\\(\\left[RPOM\\right]_{max}^{RPOM}\\),\\(\\left[RDOC\\right]_{min}^{RDOC}\\),\\(\\left[RDOC\\right]_{max}^{RDOC}\\)\\(\\rangle\\) Used in an organic matter constituent model block to set minimum and maximum refractory particulate organic matter and refractory dissolved organic carbon concentrations. Simulation construction section 4.8.3.5.2. \\(\\text{ }\\) ref nitrogen min max == \\(\\langle\\)\\(\\left[RDON\\right]_{min}^{RDON}\\),\\(\\left[RDON\\right]_{max}^{RDON}\\)\\(\\rangle\\) Used in an organic matter constituent model block to set minimum and maximum refractory dissolved organic nitrogen concentrations. Simulation construction section 4.8.3.5.2. \\(\\text{ }\\) ref phosphorus min max == \\(\\langle\\)\\(\\left[RDOP\\right]_{min}^{RDOP}\\),\\(\\left[RDOP\\right]_{max}^{RDOP}\\)\\(\\rangle\\) Used in an organic matter constituent model block to set minimum and maximum refractory dissolved organic phosphorus concentrations. Simulation construction section 4.8.3.5.2. \\(\\text{ }\\) ref activation == \\(\\langle\\)\\(R_{act}^{RDOM}\\)\\(\\rangle\\) Used in an organic matter constituent model block to set the rate of activation of refractory dissolved organic carbon, nitrogen and phosphorus. Simulation construction section 4.8.3.5.2. \\(\\text{ }\\) ref self shading == \\(\\langle\\)\\(Ke^{RPOM}\\),\\(R_{CDOM}^{RDOM}\\)\\(\\rangle\\) Used in an organics constituent model block to parameterise light attenuation due to the presence of refractory particulate and dissolved organic matter. Simulation construction section 4.8.3.5.2. \\(\\text{ }\\) ref photolysis == \\(\\langle\\)\\(f_{photo}^{RDOM}\\)\\(\\rangle\\) Used in an organics constituent model block to parameterise the proportion of photolysis of refractory dissolved organic matter that produces labile dissolved organic matter. Simulation construction section 4.8.3.5.2. \\(\\text{ }\\) anaerobic oxidation of ammonium == \\(\\langle\\)\\(k_{anmx}^{N_2}\\),\\(K_{anmx-NH_4}^{N_2}\\),\\(K_{anmx-NO_2}^{N_2}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to control anaerobic oxidation of ammonium and its response to ambient ammonium and nitrate concentrations. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) diss nitrate reduction to ammonium == \\(\\langle\\)\\(R_{DRNA}^{NO_3}\\),\\(K_{DRNA-O_2}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to control dissimilatory reduction of nitrate to ammonium and its response to ambient oxygen concentrations. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) settling == \\(\\langle\\)\\(V_{settle}^{FRP}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to control the settling rate of adsorbed FRP. This will be linked directly to the TUFLOW FV ST Module in future releases of the WQ Module. Simulation construction section 4.7.3.4.2. \\(\\text{ }\\) settling == \\(\\langle\\)none\\(\\rangle\\) Used in an organic matter constituent model block to set the settling rate of labile particulate organic matter to zero. Simulation construction section 4.8.3.5.1. \\(\\text{ }\\) settling == \\(\\langle\\)constant,\\(V_{settle}^{lorg}\\)\\(\\rangle\\) Used in an organic matter constituent model block to control the settling rate of labile particulate organic matter. This will be linked directly to the TUFLOW FV ST Module in future releases of the WQ Module. Simulation construction section 4.8.3.5.1. \\(\\text{ }\\) settling == \\(\\langle\\)thermal,\\(V_{settle}^{lorg}\\)\\(\\rangle\\) Used in an organic matter constituent model block to control the settling rate of labile particulate organic matter. This will be linked directly to the TUFLOW FV ST Module in future releases of the WQ Module. Simulation construction section 4.8.3.5.1. \\(\\text{ }\\) settling == \\(\\langle\\)stokes,\\(d_{lorg}\\),\\(\\rho_{lorg}\\)\\(\\rangle\\) Used in an organic matter constituent model block to control the settling rate of labile particulate organic matter. This will be linked directly to the TUFLOW FV ST Module in future releases of the WQ Module. Simulation construction section 4.8.3.5.1. \\(\\text{ }\\) ref settling == \\(\\langle\\)none\\(\\rangle\\) Used in an organic matter constituent model block to set the settling rate of refractory particulate organic matter to zero. Simulation construction section 4.8.3.5.2. \\(\\text{ }\\) ref settling == \\(\\langle\\)constant,\\(V_{settle}^{rorg}\\)\\(\\rangle\\) Used in an organic matter constituent model block to control the settling rate of refractory particulate organic matter. This will be linked directly to the TUFLOW FV ST Module in future releases of the WQ Module. Simulation construction section 4.8.3.5.2. \\(\\text{ }\\) ref settling == \\(\\langle\\)thermal,\\(V_{settle}^{rorg}\\)\\(\\rangle\\) Used in an organic matter constituent model block to control the settling rate of refractory particulate organic matter. This will be linked directly to the TUFLOW FV ST Module in future releases of the WQ Module. Simulation construction section 4.8.3.5.2. \\(\\text{ }\\) ref settling == \\(\\langle\\)stokes,\\(d_{rorg}\\),\\(\\rho_{rorg}\\)\\(\\rangle\\) Used in an organic matter constituent model block to control the settling rate of refractory particulate organic matter. This will be linked directly to the TUFLOW FV ST Module in future releases of the WQ Module. Simulation construction section 4.8.3.5.2. \\(\\text{ }\\) cell water quality depth == \\(\\langle\\)\\(d_{min-wq}\\)\\(\\rangle\\) Instruct TUFLOW FV to not execute water quality calculations on cells that have depths less than this specified value. Simulation construction section 4.4.1. \\(\\text{ }\\) disable water quality model == \\(\\langle\\)\\(B_{disable-wq}\\)\\(\\rangle\\) Instruct TUFLOW FV to disable (1) or enable (0) water quality calculations on all cells. Simulation construction section 4.4.1. \\(\\text{ }\\) wq equilibrium substeps == \\(\\langle\\)\\(fess\\)\\(\\rangle\\) Used in Part 1: Simulation controls of WQ Module control file to set the frequency of timesteps at which the WQ Module undertakes non-kinetic calculations, in number of water quality timesteps. This only applies to FRP adsorption. Simulation construction section 4.5.1. \\(\\text{ }\\) oxygen piston model == \\(\\langle\\)Wanninkhof92\\(\\rangle\\) Used in an oxygen constituent model block to activate the Wanninkhof 1992 oxygen piston model. Simulation construction section 4.6.3.1. to Ho16 oxygen piston model == \\(\\langle\\)Ho16\\(\\rangle\\) Used in an oxygen constituent model block to activate the Ho et al 2016 oxygen piston model. Simulation construction section 4.6.3.1. to Wanninkhof92 report min max warnings == \\(\\langle\\)on;off\\(\\rangle\\) Used in Part 1: Simulation controls of WQ Module control file to suppress writing concentration limit exceedance warnings to the WQ log file. If not specified it is set to on. This command should not be used as a way to ignore concentration exceedances, and has only been included in the WQ Module to allow for the rare occassions when known and expected exceedances occurr regularly - writing of these to the log file can cause very large log files to be written and result in system instability. Simulation construction section 4.5.1. \\(\\text{ }\\) mortality == \\(\\langle\\)\\(k_d^{pth}\\),\\(C_{SM}^{pth}\\),\\(\\alpha\\),\\(\\beta\\),\\(\\theta_{mor}^{pth}\\)\\(\\rangle\\) Used in an (optional) pathogens constituent model block to control the mortality of pathogens. The fourth parameter \\(\\beta\\) is unused but must be kept as a palceholder in this command so that five arguments are specified. Simulation construction section 4.6.3.2.1. \\(\\text{ }\\) visible inactivation == \\(\\langle\\)\\(k_{vis}^{pth}\\),\\(c_{S_{vis}}^{pth}\\),\\(K_{DO_{vis}}^{pth}\\)\\(\\rangle\\) Used in an (optional) pathogens constituent model block to control the inactivation of pathogens due to visible light. Simulation construction section 4.6.3.2.1. \\(\\text{ }\\) uva inactivation == \\(\\langle\\)\\(k_{uva}^{pth}\\),\\(c_{S_{uva}}^{pth}\\),\\(K_{DO_{uva}}^{pth}\\)\\(\\rangle\\) Used in an (optional) pathogens constituent model block to control the inactivation of pathogens due to UV-A light. Simulation construction section 4.6.3.2.1. \\(\\text{ }\\) uvb inactivation == \\(\\langle\\)\\(k_{uvb}^{pth}\\),\\(c_{S_{uvb}}^{pth}\\),\\(K_{DO_{uvb}}^{pth}\\)\\(\\rangle\\) Used in an (optional) pathogens constituent model block to control the inactivation of pathogens due to UV-B light. Simulation construction section 4.6.3.2.1. \\(\\text{ }\\) alive min max == \\(\\langle\\)\\(\\left[PTH_a\\right]_{min}^{pth}\\),\\(\\left[PTH_a\\right]_{max}^{pth}\\)\\(\\rangle\\) Used in an (optional) pathogens constituent model block to set minimum and maximum alive (free) pathogen concentrations. Simulation construction section 4.6.3.2.1. \\(\\text{ }\\) settling == \\(\\langle\\)\\(V_{settle}^{pth}\\)\\(\\rangle\\) Used in an (optional) pathogens constituent model block to set free pathogen settling velocities. This will be linked directly to the TUFLOW FV ST Module in future releases of the WQ Module. Simulation construction section 4.6.3.2.1. to attached settling == \\(\\langle\\)\\(V_{settle}^{pth}\\),\\(V_{settle}^{pth_t}\\)\\(\\rangle\\) Used in an (optional) pathogens constituent model block to set free and attached pathogen settling velocities. This will be linked directly to the TUFLOW FV ST Module in future releases of the WQ Module. Simulation construction section 4.6.3.2.2. to free "],["AppDemoModel.html", "Appendix C Demonstration model", " Appendix C Demonstration model Explanations of the processes captured by the WQ Module are described in the Appendices that follow. A demonstration model has been constructed to generate data to support these explanations via different interactive means. This model is referred to as the demonstration model. It has the following features, unless specified otherwise: General 1 week (168 hours) duration Includes salinity, temperature (and heat calculations), sediment and varying numbers of water quality computed variables Hourly output Geometry Single two-dimensional flat bottomed cell Lateral cell dimensions of 1 metre \\(\\times\\) 1 metre Depth of 0.5 metres Boundary conditions No inflows, outflows or other flow boundaries Meteorological boundaries applied Hourly timestep Corresponding twenty four row record repeated for each day Wind turned off, unless noted otherwise Constant air temperature, varied to match simulation needs Typical shortwave, longwave radiation and relative humidity Initial conditions Varied to match simulation needs Water quality parameterisation Varied to match simulation needs Additional model details are described in each Appendix where required. "],["AppO.html", "Appendix D Processes: oxygen D.1 Atmospheric oxygen flux D.2 Sediment oxygen flux", " Appendix D Processes: oxygen D.1 Atmospheric oxygen flux Atmospheric oxygen flux is a key source of water column dissolved oxygen. Oxygenation is implemented in the upper model layer by the WQ Module, and then this oxygenated water is mixed downwards by TUFLOW in subsequent timesteps. Initially, a Schmidt number \\(Sc_{atm}^{O_2}\\) is computed via Equation (D.1). \\[\\begin{equation} Sc_{atm}^{O_2} = \\left(0.9 + \\frac{S}{350.0}\\right)\\times\\left(2073.1-125.62T+3.6276T^2-0.043219T^3\\right) \\tag{D.1} \\end{equation}\\] \\(T\\) and \\(S\\) are ambient water temperature and salinity respectively. An oxygen piston velocity \\(V_{pist}^{O_2}\\) (also known as a gas transfer velocity) is then computed. Two piston models for \\(V_{pist}^{O_2}\\) are available. The first is due to Wanninkhof (1992): \\[\\begin{equation} V_{pist}^{O_2} = 0.31 \\left( V_{wind}^{O_2} \\right) ^2 \\times \\left(\\frac{660.0}{Sc_{atm}^{O_2}}\\right)^x \\tag{D.2} \\end{equation}\\] where \\(V_{wind}^{O_2}\\) is wind speed. For wind speed \\(V_{wind}^{O_2}\\)&lt;3.0 m/s, \\(x\\) is 0.66, otherwise \\(x\\) is 0.5. Wind speed is assumed to be provided from TUFLOW at 10 metres from the water surface. The second is due to Ho et al. (2016): \\[\\begin{equation} V_{pist}^{O_2} = \\left(0.77 \\sqrt{\\frac{V_{water}}{H_{layer}}} + 0.266 \\left(V_{wind}^{O_2} \\right) ^2\\right) \\times \\sqrt{\\frac{660.0}{Sc_{atm}^{O_2}}} \\tag{D.3} \\end{equation}\\] where \\(V_{water}\\) is surface water speed, \\(H_{layer}\\) is the thickness of the uppermost TUFLOW FV computational layer and \\(V_{wind}^{O_2}\\) is wind speed. There are other models available for computing both \\(Sc_{atm}^{O_2}\\) and \\(V_{pist}^{O_2}\\) within the WQ Module. Contact support@tuflow.com if these are required. Once \\(Sc_{atm}^{O_2}\\) and \\(V_{pist}^{O_2}\\) are known, oxygenation to the surface layer is computed as per Equation (D.4). \\[\\begin{equation} \\href{AppDiags.html#WQDiagDOAtmFlx}{F_{atm}^{O_2}} = V_{pist}^{O_2} \\left(\\left[DO\\right]_{air} - \\left[DO\\right]\\right) \\tag{D.4} \\end{equation}\\] \\(F_{atm}^{O_2}\\) is the flux of atmospheric oxygen to the surface layer, and \\(\\left[DO\\right]_{air}\\) and \\(\\left[DO\\right]\\) are the oxygen concentrations in air and water (as a computed variable in a computational cell) at the air-water interface, respectively. \\(\\left[DO\\right]_{air}\\) is assumed to be the saturation concentration of dissolved oxygen in water which is at the ambient surface water’s temperature and salinity conditions. As such, supersaturated surface waters will release dissolved oxygen to the atmosphere under this schematisation. Oxygen percent saturation is computed as per Equation (D.5). \\[\\begin{equation} \\left.\\begin{aligned} \\left[DO\\right]_{psat} =&amp; 100.0 \\times \\frac{\\left[DO\\right]}{\\left[DO\\right]_{sat}} \\\\ \\\\ \\href{AppDiags.html#WQDiagDOSat}{\\left[DO\\right]_{sat}} =&amp; 1.42763 \\times e^{C} \\\\ \\\\ C =&amp; -173.4292 + \\left(249.6339 \\times \\frac{100.0}{T+273.15}\\right) + \\left(143.3483 \\times \\ln\\left(\\frac{T+273.15}{100.0}\\right)\\right) \\ldots \\\\ &amp; \\left(-21.8492 \\times \\frac{T+273.15}{100.0}\\right) \\ldots \\\\ &amp; - S \\times \\left(-0.033096 + \\left(0.014259 \\times \\frac{T+273.15}{100.0}\\right) - 0.0017 \\times \\left(\\frac{T+273.15}{100.0}\\right)^{2.0}\\right) \\end{aligned}\\right\\} \\tag{D.5} \\end{equation}\\] \\(T\\) and \\(S\\) are ambient water temperature and salinity respectively. D.2 Sediment oxygen flux Oxygen is exchanged between the water column and sediments via specification of a sediment flux representing the net effect of biological activity. In the case of oxygen, this flux is most commonly into the sediments, i.e. a negative sediment flux. Although it is rare that sediments act as sources of oxygen, the WQ Module can be parameterised to allow for this if required. The user specified sediment oxygen flux (which can be spatially varying) is modified by overlying ambient dissolved oxygen concentration (together with a user specified half saturation oxygen concentration) and water temperature. These modifications are simulated via Michaelis-Menten and Arrhenius models, respectively, as per Equation (D.6). \\[\\begin{equation} \\href{AppDiags.html#WQDiagDOSedFlx}{F_{sed\\langle computed\\rangle}^{O_2}} = F_{sed}^{O_2} \\times \\underbrace{\\frac{\\left[DO\\right]}{K_{sed-O_2}^{O_2} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{ \\vphantom{ \\frac{\\left[DO\\right]}{K_{sed-O_2}^{O_2} + \\left[DO\\right]} } \\left[\\theta_{sed}^{O_2}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{D.6} \\end{equation}\\] \\(F_{sed}^{O_2}\\) is the user specified oxygen sediment flux at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the overlying dissolved oxygen concentration computed by the WQ Module, \\(K_{sed-O_2}^{O_2}\\) and \\(\\theta_{sed}^{O_2}\\) are the half saturation oxygen concentration and temperature coefficient for dissolved oxygen sediment flux respectively, and \\(T\\) is ambient water temperature. The form of the above relationship between dissolved oxygen concentration and the computed oxygen sediment flux, for a range of \\(K_{sed-O_2}^{O_2}\\) values is provided in Figure D.1. Water temperature is held constant at 20\\(^o\\)C and \\(\\theta_{sed}^{O_2}=1\\) (i.e. the Arrhenius temperature function is switched off). The user specified benthic oxygen sediment flux is -4,800 mg/m\\(^2\\)/day. Use the “play” button or drag the slider to see how different half saturation oxygen concentrations change the oxygen sediment flux (ordinate), as a function of ambient dissolved oxygen concentration (abscissa). Figure D.1: Move the slider to see the effect of changing \\(K_{sed-O_2}^{O_2}\\) on the computed oxygen sediment flux The figure demonstrates that in this example, the smaller the value of \\(K_{sed-O_2}^{O_2}\\), the faster the magnitude of the computed oxygen sediment flux increases with ambient dissolved oxygen concentration. This is consistent with one interpretation of \\(K_{sed-O_2}^{O_2}\\), that it is the ambient dissolved oxygen concentration at which the computed oxygen sediment flux is half that of the user specified \\(F_{sed}^{O_2}\\), when temperature effects are turned off. In light of the above, the demonstration model has been used to illustrate the influence that the half saturation concentration has on the rate of drawdown of water column dissolved oxygen. The model was repeatedly executed using a different \\(K_{sed-O_2}^{O_2}\\) for each simulation, but at the same water temperature of (approximately) 20\\(^o\\)C, and with temperature effects turned off. The predicted temporal evolution of water column dissolved oxygen concentration is provided in Figure D.2. Use the “play” button or drag the slider to see how different half saturation oxygen concentrations change the rate of dissolved oxygen (ordinate) drawdown with time (abscissa). Figure D.2: Move the slider to see the effect of changing \\(K_{sed-O_2}^{O_2}\\) on the rate of consumption of dissolved oxygen in water immediately above the sediments Consistent with the behaviour demonstrated in Figure D.1, Figure D.2 has a less rapid drawdown of ambient dissolved oxygen concentrations with increasing \\(K_{sed-O_2}^{O_2}\\). The rate of dissolved oxygen drawdown is also related to ambient water temperature, via the Arrhenius model in Equation (D.6). To illustrate this, the demonstration model was executed at a range of ambient temperatures, a constant half saturation oxygen concentration for oxygen sediment flux of 4 mg/L and a temperature factor \\(\\theta_{sed}^{O_2}\\) of 1.05. The results are provided in Figure D.3. Use the “play” button or drag the slider to see how different ambient temperatures change the rate of dissolved oxygen (ordinate) drawdown under these conditions, with time (abscissa). Figure D.3: Move the slider to see the effect of changing the ambient water temperature on dissolved oxygen concentrations The figure confirms the expected result that the rate of dissolved oxygen drawdown increases with increasing ambient water temperature. This increased rate reflects the expected increase in benthic biological activity with temperature. "],["AppSil.html", "Appendix E Processes: silicate E.1 Sediment silicate flux", " Appendix E Processes: silicate E.1 Sediment silicate flux Silicate is exchanged between the water column and sediments via specification of a sediment flux. In the case of silicate, this flux is most commonly out of the sediments, i.e. a positive specification of sediment flux. Although it is rare that sediments act as sinks of silicate, the WQ Module can be parameterised to allow for this if required. The user specified rate of sediment silicate flux (which can be spatially varying) is modified by overlying ambient dissolved oxygen concentration, a user specified half saturation oxygen concentration and water temperature. These modifications are simulated via Michaelis-Menten and Arrhenius models, respectively, as per Equation (E.1). \\[\\begin{equation} \\href{AppDiags.html#WQDiagSiSedFlx}{F_{sed\\langle computed\\rangle}^{Si}} = F_{sed}^{Si} \\times \\underbrace{\\frac{K_{sed-O_2}^{Si}}{K_{sed-O_2}^{Si} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{\\vphantom{\\frac{K_{sed-O_2}^{Si}}{K_{sed-O_2}^{Si} + \\left[DO\\right]}} \\left[\\theta_{sed}^{Si}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{E.1} \\end{equation}\\] \\(F_{sed}^{Si}\\) is the user specified silicate sediment flux at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the overlying dissolved oxygen concentration, \\(K_{sed-O_2}^{Si}\\) and \\(\\theta_{sed}^{Si}\\) are the half saturation concentration of dissolved oxygen and temperature coefficient for silicate sediment production respectively (both are user specified), and \\(T\\) is ambient water temperature. The form of the above relationship between dissolved oxygen concentration and the computed silicate sediment flux, for a range of \\(K_{sed-O_2}^{Si}\\) values is provided in E.1. Water temperature is held constant at 20\\(^o\\)C and \\(\\theta_{sed}^{Si}\\)=1 (i.e. the Arrhenius temperature function is switched off). The user specified benthic silicate sediment flux is 1,120 mg/m\\(^2\\)/day. Use the “play” button or drag the slider to see how different half saturation oxygen concentrations change the silicate sediment flux (ordinate) with dissolved oxygen concentration (abscissa). Figure E.1: Move the slider to see the effect of changing the \\(K_{sed-O_2}^{Si}\\) value on the computed silicate sediment flux The figure demonstrates that in this example, the smaller the value of \\(K_{sed-O_2}^{Si}\\), the faster the magnitude of the computed silicate sediment flux increases with ambient dissolved oxygen concentration. This is consistent with one interpretation of \\(K_{sed-O_2}^{Si}\\), that it is the ambient dissolved oxygen concentration at which the computed silicate sediment flux is half that of the user specified \\(F_{sed}^{Si}\\), when temperature effects are turned off. More generally, for constant dissolved oxygen concentration and \\(K_{sed-O_2}^{Si}\\) and without temperature effects, Equation (E.1) has that the computed silicate sediment flux is constant. This means that silicate drawdown also occurs at a constant rate in the demonstration model, so the figure analogous to Figure D.2 is not presented here. A more realistic environmental setting has sediment silicate fluxes occurring against a background of oxygen concentration drawdown. The demonstration model has been used to illustrate this via execution of a suite of simulations that experience dissolved oxygen drawdown (in the dissolved oxygen constituent model, with \\(K_{sed-O_2}^{O_2}\\) = 4 mg/L) and each simulation using a different value of \\(K_{sed-O_2}^{Si}\\). The silicate sediment flux rate was specified as above and temperature effects were turned off. The predicted temporal evolution of water column silicate concentration is provided in Figure E.2. Use the “play” button or drag the slider to see how different half saturation concentrations change predicted silicate concentrations (ordinate) in time (abscissa). Figure E.2: Move the slider to see the effect of changing the \\(K_{sed-O_2}^{Si}\\) value on the rate of prodution of silicate in water immediately above the sediments Finally, the demonstration model was executed over a suite of simulations that had constant sediment flux rates (as above), half saturation coefficients (both \\(K_{sed-O_2}^{O_2}\\) and \\(K_{sed-O_2}^{Si}\\) = 4 mg/L) and temperature coefficients (both \\(\\theta_{sed}^{O_2}\\) and \\(\\theta_{sed}^{Si}\\) = 1.05), but varied ambient water temperature. The predicted temporal evolution of water column silicate concentration is provided in Figure E.3. Use the “play” button or drag the slider to see how different water temperatures change silicate concentrations (ordinate) in time (abscissa). Figure E.3: Move the slider to see the effect of changing the ambient water temperature on silicate concentration Although not recommended, the influence of oxygen in all the above processes can be removed by setting the command oxygen == off in the silicate model block. "],["AppIN.html", "Appendix F Processes: inorganic nitrogen F.1 Sediment ammonium and nitrate flux F.2 Nitrification F.3 Denitrification F.4 Anaerobic oxidation of ammonium F.5 Dissimilatory reduction of nitrate to ammonium F.6 Wet deposition of inorganic nitrogen F.7 Dry deposition of inorganic nitrogen", " Appendix F Processes: inorganic nitrogen F.1 Sediment ammonium and nitrate flux Ammonium and nitrate are exchanged between the water column and sediments via specification of separate sediment fluxes. In both cases, this flux is most commonly out of the sediments, i.e. a positive specification of sediment flux. Although it is rare that sediments act as sinks of these nitrogenous species, the WQ Module can be parameterised to allow for this if required. The user specified rates of ammonium and nitrate fluxes (which can be spatially varying) are modified by overlying ambient dissolved oxygen concentration (together with respective user specified half saturation oxygen concentrations) and water temperature. These modifications are simulated via Michaelis-Menten and Arrhenius models, respectively, as per Equation (F.1). \\[\\begin{equation} \\left.\\begin{aligned} \\href{AppDiags.html#WQDiagAmmSedFlx}{F_{sed\\langle computed\\rangle}^{NH_4}} =&amp; F_{sed}^{NH_4} \\times \\frac{K_{sed-O_2}^{NH_4}}{K_{sed-O_2}^{NH_4} + \\left[DO\\right]} \\times \\hphantom{\\text{ab}} \\left[\\theta_{sed}^{NH_4}\\right]^{\\left(T-20\\right)} \\\\ \\\\ \\href{AppDiags.html#WQDiagNitSedFlx}{F_{sed\\langle computed\\rangle}^{NO_3}} =&amp; F_{sed}^{NO_3} \\times \\underbrace{\\frac{\\left[DO\\right]}{K_{sed-O_2}^{NO_3} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{\\vphantom{\\frac{\\left[DO\\right]}{K_{sed-O_2}^{NO_3} + \\left[DO\\right]}} \\left[\\theta_{sed}^{NO_3}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\end{aligned}\\right\\} \\tag{F.1} \\end{equation}\\] \\(F_{sed}^{NH_4}\\) and \\(F_{sed}^{NO_3}\\) are the user specified ammonium and nitrate sediment fluxes at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the overlying dissolved oxygen concentration, \\(K_{sed-O_2}^{NH_4}\\) and \\(K_{sed-O_2}^{NO_3}\\) are the user specified half saturation concentrations of dissolved oxygen for ammonium and nitrate sediment flux, \\(\\theta_{sed}^{NH_4}\\) and \\(\\theta_{sed}^{NO_3}\\) are the corresponding temperature coefficients, and \\(T\\) is ambient water temperature. As per silicate sediment flux (see Section E.1), the above equations lead to linearly varying ambient ammonium and nitrate concentrations in the demonstration model when dissolved oxygen concentration, half saturation oxygen concentrations and ambient temperature are set to be constant. A more realistic environmental setting has sediment ammonium and nitrate fluxes occurring against a background of oxygen concentration drawdown. The demonstration model has been used to illustrate this via execution of a suite of simulations that experience dissolved oxygen drawdown (in the dissolved oxygen constituent model, with \\(K_{sed-O_2}^{O_2}\\) = 4 mg/L) and each simulation using a the same value for both \\(K_{sed-O_2}^{NH_4}\\) and \\(K_{sed-O_2}^{NO_3}\\). The ammonium and nitrate sediment flux rates were both specified as 140 mg/m\\(^2\\)/d, and temperature effects were turned off. The predicted temporal evolution of water column ammonium and nitrate concentrations is provided in Figure F.1. Use the “play” button or drag the slider to see how different half saturation concentrations change ambient concentrations (ordinate) in time (abscissa). Figure F.1: Move the slider to see the effect of changing the \\(K_{sed-O_2}^{NH_4}\\) (and \\(K_{sed-O_2}^{NO_3}\\) - they are set to be equal to each other in this example) values on ambient ammonium and nitrate concentrations. Ambient dissolved oxygen is drawn down in time Figure F.1 illustrates the different oxygen responses of ammonium and nitrate sediment fluxes, as reflected in the different formulations within Equation (F.1). Importantly, the figure demonstrates that as ambient oxygen concentrations reach zero near 60 hours (see Figure D.2 with the slider bar set to \\(K_{sed-O_2}^{O_2}\\) = 4 mg/L), nitrate sediment flux ceases and the resultant ambient concentrations plateau. The converse is true to ammonium. One implication of this behaviour is that in environmental systems being simulated using the WQ Module, the rate of delivery of ammonium mass to the water column will generally increase under low dissolved oxygen conditions (e.g. waters isolated underneath a strong lacustrine a thermocline), whilst the corresponding nitrate mass fluxes will reduce under the same conditions. This is the expected and observed behaviour of environmental systems. The rate of ammonium and nitrate flux is also related to ambient water temperature, via the Arrhenius model in Equation (F.1). To demonstrate this, the same model above (with time varying dissolved oxygen concentration) was executed at a range of ambient temperatures, but constant half saturation concentrations for oxygen for both ammonium and nitrate set to 4 mg/L. All temperature coefficients were set to 1.05. The results are provided in Figure F.2. Use the “play” button or drag the slider to see how different ambient temperatures change the ambient ammonium and nitrate concentrations (ordinate) in time (abscissa). Figure F.2: Move the slider to see the effect of changing the ambient water temperature on ammonium and nitrate concentrations, with ambient dissolved oxygen drawdown The figure shows that as ambient water temperature increases, the rate of increases of both ammonium and nitrate concentrations follow suit. Again, nitrate concentrations plateau once background dissolved oxygen concentrations reach zero, however ammonium concentrations continue to rise throughout the simulation. This is expected behaviour. F.2 Nitrification Nitrification is the pelagic biological oxidation of ammonium to nitrate. The equations representing this process (including intermediates) are as follows. \\[\\begin{equation} \\left.\\begin{aligned} 2NH_4^{+} + 3O_2 \\rightarrow &amp; 2NO_2^{-} + 4H^+ + 2H_2O \\\\ \\\\ 2NO_2^{-} + O_2 \\rightarrow &amp; 2NO_3^- \\end{aligned}\\right\\} \\tag{F.2} \\end{equation}\\] Dissolved oxygen is consumed by nitrification of ammonium, in a molar ratio of 1:2 N:O\\(_2\\) (i.e. 2 moles of ammonium consume 4 moles of diatomic oxygen). Nitrite is an intermediate product of nitrification, and simulation of this quantity is possible within the WQ Module although not currently activated. Contact support@tuflow.com if this capability is required. The pelagic nitrification rate is computed within the WQ Module via Equation (F.3). \\[\\begin{equation} R_{nitrif\\langle computed\\rangle}^{NH_4} = R_{nitrif}^{NH_4} \\times \\underbrace{\\frac{\\left[ DO \\right]}{K_{nitrif-O_2}^{NH_4} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{ \\vphantom{\\frac{\\left[ DO \\right]}{K_{nitrif-O_2}^{NH_4} + \\left[DO\\right]}} \\left[\\theta_{nitrif}^{NH_4}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{F.3} \\end{equation}\\] \\(R_{nitrif}^{NH_4}\\) is the user specified ammonium nitrifcation rate at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the ambient dissolved oxygen concentration, \\(K_{nitrif-O_2}^{NH_4}\\) and \\(\\theta_{nitrif}^{NH_4}\\) are the half saturation concentration of dissolved oxygen and temperature coefficient for nitrification of ammonium respectively (both are user specified), and \\(T\\) is ambient water temperature. The nitrification rate from Equation (F.3) is multiplied by ambient ammonium concentration to compute the flux of ammonium to nitrate at each model timestep in each model cell via Equation (F.4). \\[\\begin{equation} \\href{AppDiags.html#WQDiagNitrif}{F_{nitrif\\langle computed\\rangle}^{NH_4}} = R_{nitrif\\langle computed\\rangle}^{NH_4} \\times \\left[ NH_4 \\right] \\tag{F.4} \\end{equation}\\] Equation (F.3) reveals a linear relationship between \\(R_{nitrif\\langle computed\\rangle}^{NH_4}\\) and both (constant) dissolved oxygen concentration and half saturation oxygen concentration. In dissolved oxygen conditions away from oxygen sinks other than nitrification itself (such as sediments), this leaves ambient temperature as the key external determinant of the computed nitrification rates. A suite of demonstration model simulations were executed to illustrate this, with each simulation having its own temperature, and a constant nitrification rate \\(R_{nitrif}^{NH_4}\\) of 0.1/day. Ammonium and nitrate initial conditions were always set to 4 and 0 mg/L respectively, \\(K_{nitrif-O_2}^{NH_4}\\) to 4 mg/L and \\(\\theta_{nitrif}^{NH_4}\\) was set to 1.05. In order to illustrate only the workings of nitrification, all sediment fluxes were set to zero. The predicted temporal evolution of water column ammonium and nitrate concentrations in these simulations are provided in Figure F.3. Corresponding dissolved oxygen concentrations are also included to demonstrate the impact of nitrification on water column oxygen. Use the “play” button or drag the slider to see how different ambient temperatures change the ambient ammonium, nitrate and dissolved oxygen concentrations (ordinate) in time (abscissa). Figure F.3: Move the slider to see the effect of changing ambient water temperature on the concentrations of ammonia, nitrate and oxygen The figure demonstrates the expected behaviour, where ammonium is consumed and nitrate produced. The drawdown in oxygen presented in the figure is due only to nitrification. The figure also reveals the mass conserving behaviour of the WQ Module: the decrease in ammonium (N) concentration is the same as the corresponding increase in nitrate (N) concentration for each of the different temperature simulations. This confirms the 1:1 ratio of nitrogen conversion from ammonium to nitrate in moles (Equation (F.2)), and hence concentration in an otherwise closed system. The drawdown in oxygen also demonstrates the WQ Module mass balance. In the 12\\(^o\\)C case for example: The change in dissolved oxygen concentration is 4.37 mg/L Converting this to moles of O\\(_2\\) gives 0.1366 moles O\\(_2\\) (= 4.37/32) The change in ammonium (or nitrate) concentration is 0.955 mg/L Converting this to moles of N gives 0.0682 moles of N (= 0.955/14) The number of moles of dissolved oxygen consumed (0.137) is twice that the number of moles of N transformed from ammonium to nitrate (0.0682), to two decimal places. This is consistent with Equation (F.2). A full WQ Module mass balance is presented in Appendix S. F.3 Denitrification Denitrification is the pelagic biological reduction of nitrate to free nitrogen gas, \\(N_2\\). This typically occurs as a result of microbial oxygen stripping from nitrate in low dissolved oxygen environments. It occurs through a series of intermediate stages, but is typically represented as a single-step process with a governing denitrification rate. This rate is computed within the WQ Module via either Equation (F.5) or (F.6). These are identical other than their treatment of the influence of dissolved oxygen on denitrification, which is either Michaelis-Menten or exponential, respectively. Unlike nitrification, denitrification includes the influence of nitrate concentration in both rate calculations, again in a Michaelis-Menten form. \\[\\begin{equation} R_{denit\\langle computed\\rangle}^{NO_3} = R_{denit}^{NO_3} \\hphantom{\\text{abc}} \\times \\hphantom{\\text{abc}} \\frac{K_{denit-O_2-MM}^{NO_3}}{K_{denit-O_2-MM}^{NO_3} + \\left[DO\\right]} \\times \\left[\\theta_{denit}^{NO_3}\\right]^{\\left(T-20\\right)} \\times \\frac{\\left[NO_3\\right]}{K_{denit-NO_3}^{NO_3} + \\left[NO_3\\right]} \\tag{F.5} \\end{equation}\\] \\[\\begin{equation} R_{denit\\langle computed\\rangle}^{NO_3} = R_{denit}^{NO_3} \\hphantom{\\text{abc}} \\times \\hphantom{\\text{abc}} \\underbrace{\\vphantom{\\frac{\\left[NO_3\\right]}{K_{denit-NO_3}^{NO_3} + \\left[NO_3\\right]}}{\\rm e}^{\\left[\\frac{-\\left[DO\\right]}{K_{denit-O_2-exp}^{NO_3}}\\right]}}_{\\text{Influence of oxygen}} \\times \\hphantom{\\text{abcd}} \\underbrace{\\vphantom{\\frac{\\left[NO_3\\right]}{K_{denit-NO_3}^{NO_3} + \\left[NO_3\\right]}}\\left[\\theta_{denit}^{NO_3}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\times \\underbrace{\\frac{\\left[NO_3\\right]}{K_{denit-NO_3}^{NO_3} + \\left[NO_3\\right]}}_{\\text{Influence of nitrate}} \\tag{F.6} \\end{equation}\\] \\(R_{denit}^{NO_3}\\) is the user specified nitrate denitrification rate at 20\\(^o\\)C and without the influence of dissolved oxygen, and \\(\\left[DO\\right]\\) and \\(\\left[NO_3\\right]\\) are the ambient dissolved oxygen and nitrate concentrations respectively. If the Michaelis-Menten oxygen model is used then \\(K_{denit-O2-MM}^{NO_3}\\) is the half saturation concentration of oxygen for denitrification. If the exponential model is used then \\(K_{denit-O2-exp}^{NO_3}\\) is the dissolved oxygen concentration that normalises (i.e. non-dimensionalises) the ambient oxygen concentration used in Equation (F.6). Equation (F.5) is the default. Finally, \\(\\theta_{denit}^{NO_3}\\) is the temperature coefficient for denitrification of nitrate, \\(T\\) is ambient water temperature, and \\(K_{denit-NO_3}^{NO_3}\\) is the Michaelis-Menten half saturation nitrate concentration that influences denitrification in both Equations (F.5) and (F.6). \\(K_{denit-NO_3}^{NO_3}\\) is not user definable, but hardwired to a value of 0.07 mg/L of nitrate (5.0 mmol/m\\(^3\\)). The computed denitrification rate from Equation (F.5) or (F.6) is then multiplied by ambient nitrate concentration to compute the flux of nitrate to free nitrogen gas at each model timestep in each model cell via Equation (F.7). \\[\\begin{equation} \\href{AppDiags.html#WQDiagDenitrif}{F_{denit\\langle computed\\rangle}^{NO_3}} = R_{denit\\langle computed\\rangle}^{NO_3} \\times \\left[ NO_3 \\right] \\tag{F.7} \\end{equation}\\] Unlike nitrification, denitrification does not produce or consume dissolved oxygen. It does, however, consume nitrate and therefore presents a feedback loop in Equations (F.5) through (F.7). The demonstration model was executed over two suites of identical simulations that varied temperature from one simulation to the next, with the first suite using Equation (F.5) and the second suite using Equation (F.6). Only denitrification was turned on, and constant values for \\(R_{denit}^{NO_3}\\) (1.5/day - a deliberately very large value was chosen to demonstrate trends), \\(K_{denit-O_2}^{NO_3}\\) (4 mg/L) and \\(K_{denit-NO_3}^{NO_3}\\) (15.5 mg/L) were set. Temperature coefficients were set to 1.05. The predicted temporal evolution of water column nitrate concentrations in these simulation pairs are provided in Figure F.4. Figure F.4: Move the slider to see the effect of changing temperature on the concentrations of nitrate, where two different denitrification models are used The figure demonstrates the expected behaviour, where nitrate is consumed in a non-linear manner. The different models produce different drawdown rates, also as expected. In this example, these differences are substantial. The same two suites of demonstration models were also used to illustrate the influence of varying \\(K_{denit-O_2}^{NO_3}\\) (instead of temperature) on denitrification. All set ups from the models used above were retained, other than setting ambient water temperature to constant at 20 \\(^o\\)C, and allowing \\(K_{denit-O_2}^{NO_3}\\) to vary. The predicted temporal evolution of water column nitrate concentrations in these demonstration model simulation pairs are provided in Figure F.5. Figure F.5: Move the slider to see the effect of changing \\(K_{denit-O_2}^{NO_3}\\) on the concentrations of nitrate, where two different denitrification models are used Substantial differences in the prediction of nitrate concentrations is again observed, especially at lower half saturation concentrations. F.4 Anaerobic oxidation of ammonium Anaerobic oxidation of ammonium (also referred to as anammox) is the microbial conversion of ammonium and nitrite to free nitrogen gas in low dissolved oxygen environments. Oxygen for this process is stripped from nitrite. The equation representing this process is as follows. \\[\\begin{equation} NH_4^{+} + NO_2^{-} \\rightarrow N_2 + 2H_2O \\tag{F.8} \\end{equation}\\] \\(NH_4^{+}\\) and \\(NO_2^{-}\\) are ammonium and nitrite, respectively, and N\\(_2\\) is free nitrogen gas. In the absence of simulating nitrite, the WQ Module assumes that nitrite and nitrate are related (only at dissolved oxygen concentrations below 0.1 mg/L) as follows. \\[\\begin{equation} \\left[NO_2\\right] = \\left[NO_3\\right] \\times \\left( 1.0 - \\frac{\\left[ DO \\right]}{0.1 + \\left[ DO \\right]}\\right) \\tag{F.9} \\end{equation}\\] \\(\\left[NO_2\\right]\\), \\(\\left[NO_3\\right]\\) and \\(\\left[DO\\right]\\) are the ambient nitrite, ammonium and dissolved oxygen concentrations, respectively. The anammox flux to free nitrogen gas N at each model timestep in each model cell that has an ambient dissolved oxygen concentration less than 0.1 mg/L is computed as per Equation (F.10). \\[\\begin{equation} \\href{AppDiags.html#WQDiagAnammox}{F_{anmx\\langle computed\\rangle}^{N_2}} = k_{anmx}^{N_2} \\times \\frac{\\left[NH_4\\right]}{K_{anmx-NH_4}^{N_2} + \\left[NH_4\\right]} \\times \\frac{\\left[NO_2\\right]}{K_{anmx-NO_2}^{N_2} + \\left[NO_2\\right]} \\tag{F.10} \\end{equation}\\] \\(k_{anmx}^{N_2}\\) is the user specified anaerobic volumetric mass oxidation rate without the influence of ammonium or nitrite, \\(K_{anmx-NH_4}^{N_2}\\) and \\(K_{anmx-NO_2}^{N_2}\\) are the Michaelis-Menten half saturation ammonium and nitrite concentrations for anammox respectively, and \\(\\left[NH_4\\right]\\) and \\(\\left[NO_2\\right]\\) are the ambient ammonium and nitrite concentrations, respectively. For ambient conditions that have dissolved oxygen concentrations greater than 0.1 mg/L, the anammox rate is set to zero. F.5 Dissimilatory reduction of nitrate to ammonium Dissimilatory reduction of nitrate to ammonium (also referred to as DRNA) is the microbial conversion of nitrate to ammonium. Dissolved oxygen is not consumed in this process. The WQ Module assumes the number of moles of nitrate-N consumed is the same as the number of ammonium-N moles produced. The DRNA rate is computed within the WQ Module via Equation (F.11). \\[\\begin{equation} R_{DRNA\\langle computed\\rangle}^{NO_3} = R_{DRNA}^{NO_3} \\times \\frac{K_{DRNA-O_2}^{NO_3}}{K_{DRNA-O_2}^{NO_3} + \\left[DO\\right]} \\tag{F.11} \\end{equation}\\] \\(R_{DRNA}^{NO_3}\\) is the user specified rate of dissimilatory reduction of nitrate to ammonium without the influence of oxygen, \\(K_{DRNA-O_2}^{NO_3}\\) is the Michaelis-Menten half saturation dissolved oxygen concentration for DRNA, and \\(\\left[DO\\right]\\) is the ambient dissolved oxygen concentration. The computed DRNA rate from Equation (F.11) is multiplied by ambient nitrate concentration to compute the flux to ammonium at each model timestep in each model cell as per Equation (F.12). \\[\\begin{equation} \\href{AppDiags.html#WQDiagDRNA}{F_{DRNA\\langle computed\\rangle}^{NO_3}} = R_{DRNA\\langle computed\\rangle}^{NO_3} \\times \\left[NO_3\\right] \\tag{F.12} \\end{equation}\\] Although not recommended, the influence of oxygen in all the processes described in sections F.1 to F.5 can be removed by setting the command oxygen == off in the nitrogen model block. This switch applies to sediment flux, nitrification and denitrification. Anammox and DRNA will be switched off entirely if this command is issued. F.6 Wet deposition of inorganic nitrogen Wet deposition of inorganic nitrogen includes the pluvial delivery of both ammonium and nitrate to the water column. A global total inorganic nitrogen concentration in rainfall is specifiable, together with the proportion of that total that is nitrate. From this, the WQ Module computes ammonium and nitrate concentrations (Equations (F.13) and (F.14), respectively). \\[\\begin{equation} \\left[{NH_4}\\right]_{rain} = \\left[{TN}\\right]_{rain} \\times (1-f_{TN}^{NO_3}) \\tag{F.13} \\end{equation}\\] \\[\\begin{equation} \\left[{NO_3}\\right]_{rain} = \\left[{TN}\\right]_{rain} \\times f_{TN}^{NO_3} \\tag{F.14} \\end{equation}\\] \\(\\left[{TN}\\right]_{rain}\\) and \\(f_{TN}^{NO_3}\\) are the concentration of total nitrogen in rain and the fraction of that total that is nitrate, respectively. The WQ Module separately multiplies \\(\\left[{NH_4}\\right]_{rain}\\) and \\(\\left[{NO_3}\\right]_{rain}\\) by each timestep’s rainfall depth and corresponding model surface area(s) to compute the wet mass flux of ammonium and nitrate (Equations (F.15) and (F.16), respectively). These masses are added to the uppermost model layer cells and corresponding changes to ambient concentrations computed. \\[\\begin{equation} F_{atm-wet}^{NH_4} = \\left[{NH_4}\\right]_{rain} \\times \\text{Timestep rainfall depth} \\times \\text{Model area(s)} \\tag{F.15} \\end{equation}\\] \\[\\begin{equation} F_{atm-wet}^{NO_3} = \\left[{NO_3}\\right]_{rain} \\times \\text{Timestep rainfall depth} \\times \\text{Model area(s)} \\tag{F.16} \\end{equation}\\] If rainfall depth is specified as being spatially variable (i.e. by application of multiple atmospheric boundary conditions within TUFLOW FV), then \\(F_{atm-wet}^{NH_4}\\) and \\(F_{atm-wet}^{NO_3}\\) will correspondingly vary spatially. F.7 Dry deposition of inorganic nitrogen Dry deposition of nitrogen includes the delivery of both ammonium and nitrate to the water column from atmospheric fallout. This fallout is typically thought of as being associated with dust, with the dry fallout dissolving on entry to the water column to become dissolved inorganic nitrogen. A single constant daily deposition rate of total nitrogen is specifiable, and the WQ Module splits this into separate ammonia and nitrate rates using the same fraction applied to the wet deposition total inorganic nitrogen concentration (Section F.6). \\[\\begin{equation} R^{NH_4}_{atm-dry} = R^{TN}_{atm-dry} \\times (1-f_{TN}^{NO_3}) \\tag{F.17} \\end{equation}\\] \\[\\begin{equation} R^{NO_3}_{atm-dry} = R^{TN}_{atm-dry} \\times f_{TN}^{NO_3} \\tag{F.18} \\end{equation}\\] \\(R^{TN}_{atm-dry}\\) and \\(f_{TN}^{NO_3}\\) are the user specified rate of dry total inorganic nitrogen deposition, and the fraction that is nitrate, respectively. These individual rates \\(R^{NH_4}_{atm-dry}\\) and \\(R^{NO_3}_{atm-dry}\\) are multiplied by model timestep and the global model surface area to compute the dry mass flux of ammonium and nitrate (Equations (F.19) and (F.20), respectively). These masses are added to the uppermost model layer cells and corresponding changes to ambient concentrations computed. \\[\\begin{equation} F_{atm-dry}^{NH_4} = R^{NH_4}_{atm-dry} \\times \\text{Timestep} \\times \\text{Global model area} \\tag{F.19} \\end{equation}\\] \\[\\begin{equation} F_{atm-dry}^{NO_3} = R^{NO_3}_{atm-dry} \\times \\text{Timestep} \\times \\text{Global model area} \\tag{F.20} \\end{equation}\\] This constant dry mass flux for each of ammonium and nitrate is applied globally. The total atmospheric depositional flux of dissolved inorganic nitrogen (noting that dry atmospheric flux is assumed to dissolve on entry to the water column) is as per Equation (F.21). \\[\\begin{equation} \\href{AppDiags.html#WQDiagDINAtmFlx}{F_{atm-din\\langle computed \\rangle}^{N}} = F_{atm-wet}^{NH_4} + F_{atm-wet}^{NO_3} + F_{atm-dry}^{NH_4} + F_{atm-dry}^{NO_3} \\tag{F.21} \\end{equation}\\] "],["AppIP.html", "Appendix G Processes: inorganic phosphorus G.1 Sediment FRP flux G.2 Wet deposition of inorganic phosphorus G.3 Dry deposition of inorganic phosphorus G.4 Adsorption and desorption G.5 Settling", " Appendix G Processes: inorganic phosphorus G.1 Sediment FRP flux Filterable reactive phosphorus (FRP) is exchanged between the water column and sediments via specification of sediment fluxes. This flux is most commonly out of the sediments, i.e. a positive specification of sediment flux. Although it is rare that sediments act as sinks of FRP, WQ Module can be parameterised to allow for this if required. The user specified rate of FRP flux (which can be spatially varying) is modified by overlying ambient dissolved oxygen concentration (together with a user specified half saturation oxygen concentration) and water temperature. These modifications are simulated via Michaelis-Menten and Arrhenius models, respectively, as per Equation (G.1). \\[\\begin{equation} \\href{AppDiags.html#WQDiagFRPSedFlx}{F_{sed\\langle computed\\rangle}^{FRP}} = F_{sed}^{FRP} \\times \\underbrace{\\frac{K_{sed-O_2}^{FRP}}{K_{sed-O_2}^{FRP} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{\\vphantom{\\frac{K_{sed-O_2}^{FRP}}{K_{sed-O_2}^{FRP} + \\left[DO\\right]}} \\left[\\theta_{sed}^{FRP}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{G.1} \\end{equation}\\] \\(F_{sed}^{FRP}\\) is the user specified FRP sediment flux at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the overlying dissolved oxygen concentration, \\(K_{sed-O_2}^{FRP}\\) is the user specified half saturation concentration of dissolved oxygen for FRP sediment flux, \\(\\theta_{sed}^{FRP}\\) is the corresponding temperature coefficient, and \\(T\\) is ambient water temperature. As per silicate sediment fluxes (see Section E.1), the above equation leads to linearly varying ambient FRP concentrations in the demonstration model when dissolved oxygen concentration, half saturation oxygen concentration and temperature are set to be constant. A more realistic environmental setting has sediment FRP flux occurring against a background of oxygen concentration drawdown. The demonstration model has been used to illustrate this via execution of a suite of simulations that experience dissolved oxygen drawdown, with \\(K_{sed-O_2}^{O_2}\\) = 4 mg/L and each simulation using a different \\(K_{sed-O_2}^{FRP}\\). The FRP sediment flux rate was specified as 400 mg/m\\(^2\\)/d and temperature effects were turned off. The predicted temporal evolution of water column FRP concentrations is provided in Figure G.1. Use the “play” button or drag the slider to see how different half saturation concentrations change ambient concentrations. Figure G.1: Move the slider to see the effect of changing the \\(K_{sed-O_2}^{FRP}\\) values on ambient FRP concentrations. Ambient dissolved oxygen is drawn down in time The rate of FRP flux is also related to ambient water temperature, via the Arrhenius model in Equations (G.1). To demonstrate this, the same model above (with time varying dissolved oxygen concentration) was executed at a range of ambient temperatures, but constant half saturation concentrations for oxygen set to 4 mg/L. All temperature coefficients were set to 1.05. The results are provided in Figure G.2. Use the “play” button or drag the slider to see how different ambient temperatures change ambient concentrations. Figure G.2: Move the slider to see the effect of changing the ambient water temperature on the rate of FRP fluxes to water immediately above the sediments, with ambient dissolved oxygen drawdown The figure shows that as ambient water temperature increases, the rate of increase of FRP concentrations follow suit. This is expected behaviour. G.2 Wet deposition of inorganic phosphorus Wet deposition of inorganic phosphorus includes the pluvial delivery of filterable reactive phosphorus to the water column. A global FRP concentration in rainfall is specifiable. The WQ Module multiplies this concentration by each timestep’s rainfall depth and corresponding model surface area(s) to compute the wet mass flux of FRP over each timestep (Equation (G.2)). \\[\\begin{equation} F_{atm-wet}^{FRP} = \\left[{FRP}\\right]_{rain} \\times \\text{Timestep rainfall depth} \\times \\text{Model area} \\tag{G.2} \\end{equation}\\] \\(\\left[{FRP}\\right]_{rain}\\) is the specified rainfall concentration of FRP. This mass is added to the uppermost model layer cells and corresponding changes to ambient FRP concentrations computed. If rainfall depth is specified as being spatially variable (i.e. by application of multiple atmospheric boundary conditions within TUFLOW FV), then \\(F_{atm-wet}^{FRP}\\) will correspondingly vary spatially. G.3 Dry deposition of inorganic phosphorus Dry deposition of inorganic phosphorus includes the delivery of adsorbed FRP to the water column from atmospheric dust fallout. A constant daily mass loading rate of adsorbed FRP is specifiable, and the WQ Module multiples this rate by model timestep and the global model surface area to compute the mass flux of adsorbed FRP (Equation (G.3)). This mass is added to the uppermost model layer cells and corresponding changes to ambient concentrations computed. Dry deposition is only included in calculations if adsorbed FRP is simulated. \\[\\begin{equation} F_{atm-dry}^{FRPads} = R^{FRPads}_{atm-dry} \\times \\text{Timestep} \\times \\text{Global model area} \\tag{G.3} \\end{equation}\\] \\(R^{FRPads}_{atm-dry}\\) is the user specified rate of adsorbed FRP atmospheric fallout. One (constant) mass flux is applied globally. This dry deposition is only applied if FRP adsorption is simulated, and if this is the case, then this introduction of dry deposited FRP is assigned to the adsorbed FRP computed variable. If adsorbed FRP is not included in a simulation, then dry deposition of FRP will be ignored. The total atmospheric depositional flux of inorganic phosphorus is as per Equation (G.4). \\[\\begin{equation} \\href{AppDiags.html#WQDiagDIPAtmFlx}{F_{atm-dip\\langle computed \\rangle}^{P}} = F_{atm-wet}^{FRP} + F_{atm-dry}^{FRPads} \\tag{G.4} \\end{equation}\\] G.4 Adsorption and desorption At each timestep and within each active computational cell, the WQ Module distributes the total FRP mass between dissolved FRP and adsorbed FRP if the phosphorus adsorption constituent model is used. Total FRP is conserved via Equation (G.5). \\[\\begin{equation} \\left[FRP\\right]_{tot} = \\left[FRPads\\right] + \\left[FRP\\right] \\tag{G.5} \\end{equation}\\] \\(\\left[FRP\\right]_{tot}\\) is the total FRP available for distribution between dissolved and adsorbed states, and \\(\\left[FRPads\\right]\\) and \\(\\left[FRP\\right]\\) are the ambient adsorbed and dissolved FRP concentrations, respectively. The distribution between adsorbed and dissolved FRP concentrations is computed within the WQ Module via either a linear or quadratic model. These offer alternative approaches to simulating the distribution of total FRP between adsorbed and free states. G.4.1 Linear model Equation (G.6) is the linear adsorption model, and the default. \\[\\begin{equation} \\left.\\begin{aligned} \\left[FRPads\\right] &amp;= \\left(\\frac{K_{ads-L}^{FRP} \\times \\left[SS\\right]}{1 + K_{ads-L}^{FRP} \\times \\left[SS\\right]}\\right) \\times \\left[FRP\\right]_{tot}\\\\ \\\\ \\left[FRP\\right] &amp;= \\left(\\frac{1}{1 + K_{ads-L}^{FRP} \\times \\left[SS\\right]}\\right) \\times \\left[FRP\\right]_{tot} \\end{aligned}\\right\\} \\tag{G.6} \\end{equation}\\] \\(\\left[SS\\right]\\) is the sum of suspended sediment concentrations of sediment fractions that have been designated as able to adsorb FRP and \\(K_{ads-L}^{FRP}\\) is the linear sorption partitioning coefficient. Figure G.3 provides an indicative representation of the general form of the linear relationship, for assumed total FRP (0.1 mg/L) and SS (5mg/L) concentrations. Figure G.3: The change in distribution of dissolved and adsorbed FRP under the linear adsorption model. This figure has no slider bar As a guide, equation (G.6) has that if \\(K_{ads-L}^{FRP} \\times \\left[SS\\right]\\) has a value of 1, then an equal (50:50) proportioning of free and adsorbed FRP will result. This guide can be useful if ambient suspended sediment concentrations are known - even approximately - in advance. G.4.2 Quadratic model Equation (G.7) is the quadratic adsorption model. \\[\\begin{equation} \\left.\\begin{aligned} \\left[FRPads\\right] &amp;= \\frac{1}{2} \\times \\left[\\left(\\left[FRP\\right]_{Tot} + \\frac{1}{K_{ads-Q}^{FRP}} + \\left(\\left[SS\\right] \\times Q^{FRP}_{max}\\right)\\right) - \\text{C} \\right] \\\\ \\\\ \\left[FRP\\right] &amp;= \\frac{1}{2} \\times \\left[\\left(\\left[FRP\\right]_{Tot} - \\frac{1}{K_{ads-Q}^{FRP}} - \\left(\\left[SS\\right] \\times Q^{FRP}_{max}\\right)\\right) + \\text{C} \\right] \\\\ \\\\ \\text{C} &amp;= \\sqrt{\\left(\\left[FRP\\right]_{Tot} + \\frac{1}{K_{ads-Q}^{FRP}} - \\left(\\left[SS\\right] \\times Q^{FRP}_{max}\\right)\\right)^2 + \\left(\\frac{4.0\\times \\left[SS\\right] \\times Q^{FRP}_{max}}{K_{ads-Q}^{FRP}}\\right)} \\end{aligned}\\right\\} \\tag{G.7} \\end{equation}\\] \\(\\left[SS\\right]\\) is again the sum of suspended sediment concentrations of sediment fractions that have been designated as able to adsorb FRP, \\(K_{ads-Q}^{FRP}\\) is the ratio of adsorption and desorption rate coefficients and \\(Q^{FRP}_{max}\\) is the maximum adsorption capacity of suspended sediment, for FRP. Figure G.4 provides an indicative representation of the general form of the quadratic relationship, again for assumed total FRP (0.1 mg/L) and SS (5mg/L) concentrations. Figure G.4: The change in distribution of dissolved and adsorbed FRP under the quadratic adsorption model The parameters used to prepare the above figures were deliberately chosen to illustrate the different behaviour that can result from these two models. This underscores the need to make careful decisions regarding the selection of an adsorption model. G.5 Settling At each timestep and within each active computational cell, the WQ Module computes the mass of adsorbed FRP that has settled either through the water column or onto the bed, using the settling velocity provided by the user. The limitations of this approach are recognised and future releases of the WQ Module will link this process directly to the settling and resuspension calculations of the TUFLOW FV ST Module. "],["AppPhy.html", "Appendix H Processes: phyto general H.1 General H.2 Units", " Appendix H Processes: phyto general H.1 General Any number of phytoplankton groups may be simulated within the WQ Module, however the majority of environmental modelling applications rarely require (or have data to justify) including more than a relatively small number. Each phytoplankton group can have its properties set independently, where these properties typically relate to interaction with temperature, light, salinity and nutrients. The WQ Module offers two constituent models for the simulation of phytoplankton. These are referred to as basic and advanced, and are primarily differentiated on the basis of whether internal nutrients are simulated, as: Constituent model basic does not include simulation of internal phytoplanktonic nutrients Constituent model advanced does include simulation of internal phytoplanktonic nutrients This constituent model naming is intended to reflect a view that excluding simulation of internal nutrients is a simpler, more rudimentary, approach to phytoplankton modelling. Similarly, internal nutrient simulation generally requires specification of a larger suite of parameters than when the process is excluded, so is often considered to be a more complex and involved approach to phytoplankton simulation. A WQ Module simulation can include any combination of these two constituent models if multiple phytoplankton groups are simulated. For example, if three phytoplankton groups are to be simulated, two groups could be set to use the basic constituent model, and one to use the advanced constituent model. Where WQ Module calculations are completed differently between these two constituent models, their respective approaches are presented in a complementary but distinct manner following. H.2 Units Phytoplankton is accounted within the WQ Module in units of carbon, however carbon need not be explicitly simulated within the WQ Module as either inorganic (not yet available) or organic (labile and/or refractory) to support this approach. If this is the case, then uptake or loss of carbon by phytoplankton is still computed as it is the basis for accounting and reporting phytoplankton concentrations. The associated carbon sources and sinks that interact with phytoplankton carbon however, are assumed to be large and are not specifically accounted for as computed variables. A user specified (or default) conversion ratio between mg of carbon and mg of chlorophyll a, \\(X_{cc}^{phy}\\), is used to present carbon model outputs in units of \\(\\mu\\)/L chlorophyll a when necessary. "],["PhyRates-3.html", "Appendix I Processes: phyto biomass rates I.1 Primary productivity I.2 Respiration I.3 Exudation I.4 Settling", " Appendix I Processes: phyto biomass rates The rates that determine the temporal evolution of a phytoplankton group’s biomass are primary productivity, respiration, exudation and settling. In general terms these processes can be thought of as follows: Primary productivity is the consumption of carbon and the generation of oxygen and carbohydrate due to photosynthesis. Photosynthetically active radiation catalyses this process so it occurs only during daylight hours. This process is also referred to as growth or gross primary productivity Respiration is the consumption of oxygen and stored carbohydrate and the production of carbon. This can be thought of as the reverse of primary productivity. Respiration dominates phytoplankton dynamics during nighttime hours, although it generally still operates during the daytime Exudation (also referred to as photo exudation) is the loss of phytoplankton biomass as a result of primary productivity Settling is the physical settling of phytoplankton, including motility The general form of the phytoplankton flux relationship for any given computational cell is therefore given by Equation (I.1). \\[\\begin{equation} F^{phy} = \\text{Primary productivity} - f(\\text{Respiration, Exudation}) - \\text{Settling} \\tag{I.1} \\end{equation}\\] \\(f\\) represents functions described in Appendix L. The fundamental rates in Equation (I.1) - primary productivity, respiration, exudation and settling - are described following. I.1 Primary productivity The primary productivity rate is computed in a series of stages within the WQ Module, where the combination of these stages used for any given phytoplankton group depends on group configuration. These stages are described below. For clarity, supporting functions nested within primary productivity rate calculations (such as limitation functions) are initially presented in passing, but are cross referenced to detailed descriptions in subsequent Appendices. The rate of primary productivity (often referred to as just productivity or growth rate) of a phytoplankton group is a /day rate. It is computed initially within the WQ Module as per Equation (I.2). \\[\\begin{equation} R_{prod\\langle computed\\rangle}^{phy} = R_{prod}^{phy} \\times L_T^{phy} \\times \\text{min}\\left(L_{lght}^{phy},L_{nit}^{phy},L_{phs}^{phy},L_{sil}^{phy}\\right) \\tag{I.2} \\end{equation}\\] For each phytoplankton group, \\(R_{prod}^{phy}\\) is the user specified (or default) phytoplankton productivity (growth) rate at 20\\(^o\\)C with no light, temperature, salinity, silicate or nutrient limitation, and \\(L_T^{phy}\\), \\(L_{lght}^{phy}\\), \\(L_{nit}^{phy}\\), \\(L_{phs}^{phy}\\), \\(L_{sil}^{phy}\\) are the computed limitation functions for water temperature, light, nitrogen, phosphorus and silicate, respectively. These functions, when appropriate, act to modify \\(R_{prod}^{phy}\\), noting that only \\(L_T^{phy}\\) always does so. The other limitation functions in Equation (I.2) act collectively, with only the most limiting (i.e. the smallest function value) of \\(L_{lght}^{phy}\\), \\(L_{nit}^{phy}\\), \\(L_{phs}^{phy}\\) and \\(L_{sil}^{phy}\\) being selected to also multiplicatively modify \\(R_{prod}^{phy}\\) with \\(L_T^{phy}\\). If nitrogen fixing is implemented, then the productivity rate computed in Equation (I.2) is further modified as per Equation (I.3). \\[\\begin{equation} R_{prod\\langle computed\\rangle}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times \\left(f_{nfix}^{phy} + L_{nit}^{phy} \\times \\left(1.0 - f_{nfix}^{phy}\\right)\\right) \\tag{I.3} \\end{equation}\\] \\(f_{nfix}^{phy}\\) accounts for the metabolic cost of nitrogen fixing on primary productivity and is the user specified (or default) reductive factor applied to productivity under full nitrogen fixing conditions. Specifically: Full nitrogen fixing occurs when \\(L_{nit}^{phy}\\) is zero (i.e. no water column nitrogen is available for uptake), and Equation (I.3) then has \\(R_{prod\\langle computed\\rangle}^{phy}\\) reduced by the factor \\(f_{nfix}^{phy}\\) No nitrogen fixing occurs when \\(L_{nit}^{phy}\\) is one (i.e. excess water column nitrogen is available for uptake), and Equation (I.3) then has \\(R_{prod\\langle computed\\rangle}^{phy}\\) unchanged Salinity limitation of primary productivity is not mandatory, and can be switched on and off by the user, or equally set to be an enhancer of respiration rather then reducer of productivity. If salinity limitation of productivity is implemented, then the \\(R_{prod\\langle computed\\rangle}^{phy}\\) computed above is further modified as per Equation (I.4). \\[\\begin{equation} R_{prod\\langle computed\\rangle}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times L_{sal-pp}^{phy} \\tag{I.4} \\end{equation}\\] \\(L_{sal-pp}^{phy}\\) is the limitation on primary productivity due to salinity and is between zero and one, as per the other limitation functions noted above. Once the rate of primary productivity has been computed by applying Equation (I.2), and potentially Equations (I.3) and (I.4), the corresponding flux of carbon (i.e. phytoplankton growth) to a phytoplankton group is computed as per Equation (I.5). \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhyPriProd}{F_{prod\\langle computed\\rangle}^{phy}} = R_{prod\\langle computed\\rangle}^{phy} \\times \\left[PHY\\right] \\tag{I.5} \\end{equation}\\] \\(\\left[PHY\\right]\\) is the ambient phytoplankton group concentration. These fluxes are summed over all simulated phytoplankton groups to compute the community primary productivity, \\(F_{prod\\langle computed\\rangle}^{comm}\\). The corresponding fluxes of nitrogen due to this primary productivity are described by Equations (K.2) (basic model) and (K.4) (advanced model). Similarly, the corresponding fluxes of phosphorus are described by Equations (K.7) (basic model) and (K.8) (advanced model). The same diagnostic variable name is used to report these fluxes, regardless of the phytoplankton model used. The WQ Module uses a minimum concentration \\(\\left[PHY\\right]_{min}\\) to maintain phytoplankton concentrations above zero. This is because if concentrations decrease to zero, then by Equation (I.5), phytoplankton fluxes (and therefore concentrations) will remain at zero regardless of computed primary productivity rates. I.2 Respiration The respiration rate is computed in a series of stages within the WQ Module, where the combination of these stages used for any given phytoplankton group depends on group configuration. These stages are described below. For clarity, supporting functions nested within respiration rate calculations (such as limitation functions) are initially presented in passing, but are cross referenced to detailed descriptions in subsequent sections. The rate of respiration of a phytoplankton group is a /day rate. It is computed initially within the WQ Module as per Equation (I.6). \\[\\begin{equation} R_{resp\\langle computed\\rangle}^{phy} = R_{resp}^{phy} \\times \\underbrace{\\left[\\theta_{resp}^{phy}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{I.6} \\end{equation}\\] \\(R_{resp}^{phy}\\) is the user specified phytoplankton respiration rate at 20\\(^o\\)C, \\(\\theta_{resp}^{phy}\\) is the temperature coefficient for respiration, and \\(T\\) is ambient water temperature. Figure I.1 presents the influence of \\(\\theta_{resp}^{phy}\\) on \\(R_{resp}^{phy}\\), as a function of temperature. Figure I.1: Move the slider to see the effect of changing temperature coefficient on the computed phytoplankton respiration rate As for primary productivity, salinity limitation of respiration is not mandatory, and can be switched on and off by the user. If salinity limitation of respiration is implemented, then the \\(R_{resp\\langle computed\\rangle}^{phy}\\) computed above is further modified as per Equation (I.7). \\[\\begin{equation} R_{resp\\langle computed\\rangle}^{phy} = R_{resp\\langle computed\\rangle}^{phy} \\times L_{sal-r}^{phy} \\tag{I.7} \\end{equation}\\] \\(L^{phy}_{sal-r}\\) is the limitation function on respiration due to salinity, and is always greater than one. This limitation function can therefore be conceptualised as a respiration enhancer: it acts to reduce biomass via increasing respiration rather than reducing primary productivity. Salinity limitation is applied to only one of primary production (Section I.1) or respiration, depending on the salinity limitation model selected, and not both. If a group’s ambient phytoplankton concentration is less than the user defined (or default) minimum concentration \\(\\left[PHY\\right]_{min}\\), then the respiration rate is set to zero. Once the respiration rate has been computed, the corresponding flux of carbon (i.e. phytoplankton respiration) from a phytoplankton group due only to respiration (i.e. excluding mortality and excretive losses) is as per Equation (I.8). \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhyResp}{F_{resp\\langle computed\\rangle}^{phy}} = R_{resp\\langle computed\\rangle}^{phy} \\times f_{true-resp}^{phy} \\times \\left[PHY\\right] \\tag{I.8} \\end{equation}\\] \\(f_{true-resp}^{phy}\\) is the user specified (or default) fraction of respiration that corresponds to the generation of energy via consumption of stored chlorophyll a (i.e. the fraction that does not result in excretive or mortality losses) and \\(\\left[PHY\\right]\\) is the ambient phytoplankton group concentration. For a given phytoplankton group, net productivity is calculated as primary productivity, less the flux computed in Equation (I.8) (i.e. respiration due only to energy generation). These net productivity fluxes are summed over the number of simulated phytoplankton groups (i.e. n = 1 to num_phy) to compute the community net primary productivity as per Equation (I.9). \\[\\begin{equation} \\href{AppDiags.html#WQDiagCPhyNetProd}{F_{netprod\\langle computed\\rangle}^{comm}} = \\sum_{n=1}^{\\text{num_phy}} \\left[ F_{prod\\langle computed\\rangle}^{phy_n} - F_{resp\\langle computed\\rangle}^{phy_n} \\right] \\tag{I.9} \\end{equation}\\] The respiration fluxes of nitrogen and phosphorus corresponding to Equation (I.8) are as per Equations (I.10) and (I.11), respectively. \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhyRespN}{F_{resp-N\\langle computed\\rangle}^{phy}} = R_{resp\\langle computed\\rangle}^{phy} \\times f_{true-resp}^{phy} \\times \\left[IN\\right] \\tag{I.10} \\end{equation}\\] \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhyRespP}{F_{resp-P\\langle computed\\rangle}^{phy}} = R_{resp\\langle computed\\rangle}^{phy} \\times f_{true-resp}^{phy} \\times \\left[IP\\right] \\tag{I.11} \\end{equation}\\] \\(\\left[IN\\right]\\) and \\(\\left[IP\\right]\\) are the internal phytoplankton nitrogen and phosphorus concentrations, respectively. These are either constant ratios of nitrogen and phosphorus to phytoplankton biomass (i.e. the basic phytoplankton model) or computed variables (i.e. the advanced phytoplankton model), and the WQ Module will use the appropriate value based on the phytoplankton model deployed, on a group by group basis. I.3 Exudation The exudation rate of a phytoplankton group is a /day rate. It is computed within the WQ Module as per Equation (I.12). \\[\\begin{equation} R_{exud\\langle computed\\rangle}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times f_{exud}^{phy} \\tag{I.12} \\end{equation}\\] \\(R_{prod\\langle computed\\rangle}^{phy}\\) is the previously computed phytoplankton primary production rate (Equations (I.2), and potentially (I.3) and (I.4)), and \\(f_{exud}^{phy}\\) is the user defined (or default) fraction of primary production lost to exudation. This exudation loss is a linear function. If a group’s ambient phytoplankton concentration is less than the user defined (or default) minimum concentration \\(\\left[PHY\\right]_{min}\\), then the exudation rate is set to zero. I.4 Settling The settling rate \\(V_{settle}^{phy}\\) (also referred to as motility) of a phytoplankton group is applied within the WQ Module for each phytoplankton group, prior to the corresponding primary production, respiration and exudation rate calculations. There are several phytoplankton settling models available within the WQ Module. These are described following, and once the settling rate has been computed, the flux (loss) of phytoplankton carbon to the sediments (i.e. from the bottom cell of each computational water column only) is computed for each phytoplankton group via Equation (I.13). \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhySedmtn}{F_{sedmtn\\langle computed\\rangle}^{phy}} = \\frac{V_{settle}^{phy}}{dz} \\times \\left[PHY\\right] \\tag{I.13} \\end{equation}\\] \\(dz\\) is the relevant cell thickness, and divides the flux to produce a per volume result for consistency with other corresponding diagnostics (such as mortality). These fluxes are summed over all simulated phytoplankton groups to compute the community sedimentation rate, \\(F_{sedmtn\\langle computed\\rangle}^{comm}\\). The latter is in per area units. The corresponding sedimentation flux of phytoplanktonic nitrogen is computed via either Equation (I.14) (basic model) or (I.15) (advanced model). The same diagnostic variable name is used to report these fluxes, regardless of the phytoplankton model used. \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhySedmtnN}{F_{sedmtn-N\\langle computed\\rangle}^{phy}} = \\frac{V_{settle}^{phy}}{dz} \\times \\left[PHY\\right] \\times X_{N-C-con}^{phy} \\tag{I.14} \\end{equation}\\] \\(X_{N-C-con}^{phy}\\) is the specified (or default) constant ratio of internal nitrogen to carbon in the phytoplankton group being considered. \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhySedmtnN}{F_{sedmtn-N\\langle computed\\rangle}^{phy}} = \\frac{V_{settle}^{phy}}{dz} \\times \\left[IN\\right] \\tag{I.15} \\end{equation}\\] \\(\\left[IN\\right]\\) is the internal phytoplankton nitrogen concentration. The corresponding sedimentation flux of phytoplanktonic phosphorus is computed via either Equation (I.16) (basic model) or (I.17) (advanced model). The same diagnostic variable name is used to report these fluxes, regardless of the phytoplankton model used. \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhySedmtnP}{F_{sedmtn-P\\langle computed\\rangle}^{phy}} = \\frac{V_{settle}^{phy}}{dz} \\times \\left[PHY\\right] \\times X_{P-C-con}^{phy} \\tag{I.16} \\end{equation}\\] \\(X_{P-C-con}^{phy}\\) is the specified (or default) constant ratio of internal phosphorus to carbon in the phytoplankton group being considered. \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhySedmtnP}{F_{sedmtn-P\\langle computed\\rangle}^{phy}} = \\frac{V_{settle}^{phy}}{dz} \\times \\left[IP\\right] \\tag{I.17} \\end{equation}\\] \\(\\left[IP\\right]\\) is the internal phytoplankton phosphorus concentration. I.4.1 None In this model, phytoplankton settling \\(V_{settle}^{phy}\\) is set to zero and phytoplankton are simply advected by the hydrodynamic flow field. I.4.2 Constant In this model, phytoplankton settling \\(V_{settle}^{phy}\\) is set to a constant value, and phytoplankton are settled at this velocity. A negative specification of this quantity corresponds to a downwards settling velocity. I.4.3 Constant with density correction In this model, phytoplankton settling \\(V_{settle}^{phy}\\) is set to a constant value, and phytoplankton are settled at this velocity, but corrected for ambient water density effects, as per Equation (I.18). \\[\\begin{equation} V_{sett\\langle computed\\rangle}^{phy} = V_{settle}^{phy} \\times \\frac{\\mu_{20}\\times\\rho_w}{\\mu\\times\\rho_{w20}} \\tag{I.18} \\end{equation}\\] \\(V_{settle}^{phy}\\) is the specified settling rate (velocity) at 20\\(^o\\)C, \\(\\mu\\) and \\(\\rho_w\\) are the ambient water dynamic viscosity (in Ns/m\\(^2\\)) and density (in kg/m\\(^3\\)), respectively, and \\(\\mu_{20}\\) and \\(\\rho_{w20}\\) are the dynamic viscosity and density of freshwater at 20\\(^o\\)C, respectively. A negative specification of \\(V_{settle}^{phy}\\) corresponds to a downwards settling velocity. I.4.4 Stokes In this model, phytoplankton settling is computed using the Stokes equation and cell diameter and density, as per Equation (I.19). \\[\\begin{equation} V_{sett\\langle computed\\rangle}^{phy} = -g \\times d_{phy}^2 \\times \\frac{\\left(\\rho_{phy}-\\rho_w\\right)}{18\\mu} \\tag{I.19} \\end{equation}\\] \\(g\\) is acceleration due to gravity, \\(d_{phy}\\) and \\(\\rho_{phy}\\) are phytoplankton cell diameter and density, respectively, and \\(\\rho_w\\) and \\(\\mu\\) are the ambient water density and dynamic viscosity, respectively. This model is only available if phytoplankton cell density is dynamically simulated. Cell density is therefore required to be simulated as a computed variable in both cases, with supporting initial and boundary condition specifications. Cell diameter is fixed at 1 \\(\\times\\) 10 \\(^{-5}\\) m. Even though a half saturation light intensity \\(I_K\\) is not required to compute the settling velocity directly, it is required to compute the cell density term in Equation (I.19). Cell density is computed as described in Appendix M.2. \\(I_K\\) can therefore be specified in the command to set stokes settling (referred to as \\(I_{K-sto}\\)), if it is not already specified in a phytoplankton constituent model light limitation function. I.4.5 Motile The motility settling model can only be used if internal nutrients are simulated, via deployment of the advanced phytoplankton constituent model. In this model, phytoplankton are permitted to be motile, with the motility velocity being either a user specified value (and either upwards or downwards), or zero. This motility behaviour is governed by phytoplankton internal nutrient status and ambient environmental conditions, as follows: If \\(Q \\lt 0.675 \\times X_{N-C-max}^{phy}\\) then phytoplankton is starved of nutrients and swims downwards at a rate \\(V_{mot}^{phy}\\) If \\(Q \\gt 0.750 \\times X_{N-C-max}^{phy}\\) then phytoplankton is replete of nutrients and: If local photosynthetically available radiation is greater than \\(I_{K-mot}\\) then phytoplankton swim up at \\(V_{mot}^{phy}\\) If local photosynthetically available radiation is less than \\(I_{K-mot}\\) then phytoplankton are not motile If \\(0.675 \\times X_{N-C-max}^{phy} \\lt Q \\lt 0.750 \\times X_{N-C-max}^{phy}\\) then phytoplankton are not motile \\(V_{mot}^{phy}\\) is the user specified motility velocity where a negative value is treated as a downwards motility, \\(Q\\) is the instantaneous ratio of phytoplankton internal nitrogen to carbon computed by the WQ Module (N/C, not \\(R_{IN-IP}^{phy}\\)), \\(X_{N-C-max}^{phy}\\) is the maximum internal nitrogen to carbon concentration ratio either user specified (or default) in the advanced constituent model and \\(I_{K-mot}\\) is the half saturation constant for light limitation of growth. A value of \\(I_{K-mot}\\) specified in the settling model will be ignored if it has been specified in the light limitation model. Overriding all of the above is the condition that if local photosynthetically available radiation is greater than 95% of the water surface value, motility is set to zero as phytoplankton are considered to already be at the surface of the model domain. "],["PhyLimits-3.html", "Appendix J Processes: phyto limitation J.1 General J.2 Temperature J.3 Nitrogen J.4 Phosphorus J.5 Silicate J.6 Light J.7 Salinity", " Appendix J Processes: phyto limitation J.1 General Several functions are available within the WQ Module that allow for modification of computed phytoplankton rates in response to environmental conditions. These functions were mentioned in passing in previous Appendices and are called limitation functions because they describe how temperature, nitrogen, phosphorus, silicate, light and salinity potentially limit phytoplankton rates. Their computed values are always dimensionless and between zero and one, and are applied multiplicatively to modify initially computed rates. Limitation functions of zero completely shut off initially computed rates, and conversely, limitation functions of one do not affect these rates whatsoever. Limitation functions that are valued between zero and one linearly affect computed rates as per Equation (I.2). The key principle of limitation functions is that they provide a quantitative comparison of phytoplanktonic rate requirements with ambient conditions, and then modify phytoplankton behaviour accordingly. For example, an initially computed \\(R_{prod\\langle computed\\rangle}^{phy}\\) may make a productivity demand on ambient nitrogen that exceeds instantaneous nitrogen availability. In this case, primary production will need to be reduced to reflect this nitrogen scarcity. This is affected via the multiplicative application to the initial primary productivity rate of a (computed) nitrogen limitation \\(L_{nit}^{phy}\\) that is less than one. A similar principle applies to temperature, phosphorus, silicate, light and salinity limitation functions: they modify computed phytoplanktonic rates based on a relative assessment of these rates to instantaneous ambient environmental conditions. There are multiple limitation functions available within the WQ Module for each of temperature, nitrogen, phosphorus, silicate, light and salinity. These are described below. J.2 Temperature Temperature limitation is often considered a key influencer of phytoplankton dynamics. The WQ Module offers the following temperature limitation functions. J.2.1 None This model includes no temperature limitation to the computed primary productivity rate. The temperature limitation is set to 1.0 for all temperatures. J.2.2 Standard This is a generic yet customisable temperature limitation function. It comprises three piecewise continuous sub functions: \\[\\begin{equation} L_{T}^{phy} = \\begin{cases} \\left[\\theta_{prod}^{phy}\\right]^{\\left(T-20\\right)} &amp; \\text{$T \\le T_{std}^{phy}$} \\\\ \\\\ f(T_{opt}^{phy},T_{std}^{phy},T_{max}^{phy}) &amp; \\text{$T_{std}^{phy} \\lt T \\le T_{max}^{phy}$} \\\\ \\\\ 0 &amp; \\text{$T_{max}^{phy} \\lt T$} \\end{cases} \\tag{J.1} \\end{equation}\\] \\(\\theta_{prod}^{phy}\\) is the temperature coefficient for primary productivity, \\(f\\) is a sub function of \\(T_{opt}^{phy}\\), \\(T_{std}^{phy}\\) and \\(T_{max}^{phy}\\), which are the optimal, standard and maximum water temperatures respectively, and \\(T\\) is ambient water temperature. The function \\(f\\) comprises a two stage algorithm: Stage 1. Preprocess \\(T_{opt}^{phy}\\), \\(T_{std}^{phy}\\) and \\(T_{max}^{phy}\\) in a once-off iterative calculation to generate a secondary suite of parameters that are then used in Stage 2 computations Stage 2. Use ambient environmental conditions, \\(\\theta_{prod}^{phy}\\), \\(T_{std}^{phy}\\) and the parameters generated in Stage 1 to compute the temperature limitation function at every water quality timestep and computational cell throughout a simulation Stage 1 The intent of Stage 1 is to use \\(T_{opt}^{phy}\\), \\(T_{std}^{phy}\\) and \\(T_{max}^{phy}\\) to iteratively compute three parameters \\(aTn\\), \\(bTn\\) and \\(kTn\\) that describe a curve fitting of \\(L_{T}^{phy}\\) between \\(T_{std}^{phy}\\) and \\(T_{max}^{phy}\\) (i.e. function \\(f\\) in Equation (J.1)). The conditions for this curve fitting ensure that \\(L_{T}^{phy}\\) is piecewise continuous: \\[\\begin{equation} L_{T}^{phy} = \\begin{cases} \\left[\\theta_{prod}^{phy}\\right]^{\\left(T-20\\right)} &amp; \\text{$T = T_{std}^{phy}$} \\\\ \\\\ 0 &amp; \\text{$T = T_{max}^{phy}$} \\end{cases} \\tag{J.2} \\end{equation}\\] To do so, the WQ Module uses Equation (J.3) to compute the intermediate quantity \\(G\\) by iterating on \\(kTn\\), with the \\(kTn\\) seed set to 6.0. \\[\\begin{equation} \\left.\\begin{aligned} G = &amp;\\left(kTn \\times \\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{opt}^{phy}\\right)} \\times \\left[\\theta_{prod}^{phy}\\right]^{\\left(T_{max}^{phy} - 20.0 \\right)}\\right) - \\ldots \\\\ \\\\ &amp;\\left(\\left[\\theta_{prod}^{phy}\\right]^{\\left(T_{opt}^{phy} - 20.0 \\right)} \\times \\left( \\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{max}^{phy}\\right)} - \\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{std}^{phy}\\right)} \\right)\\right) \\end{aligned}\\right\\} \\tag{J.3} \\end{equation}\\] The iteration target is \\(|G| \\le 0.5\\). If this target is not met on a given iteration, a new value of \\(kTn\\) is computed as per Equation (J.4). \\[\\begin{equation} kTn = kTn - \\frac{G}{\\nabla G} \\tag{J.4} \\end{equation}\\] \\(\\nabla G\\) is computed as per Equation (J.5). \\[\\begin{equation} \\left.\\begin{aligned} \\nabla G =&amp; \\left(\\left(\\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{opt}^{phy}\\right)} \\times \\left[\\theta_{prod}^{phy}\\right]^{\\left(T_{max}^{phy} - 20.0 \\right)}\\right) \\times \\left(1.0 + kTn \\times T_{opt}^{phy} \\times ln\\left(\\theta_{prod}^{phy}\\right)\\right)\\right) - \\ldots \\\\ \\\\ &amp;\\left(\\left[\\theta_{prod}^{phy}\\right]^{\\left(T_{opt}^{phy} - 20.0 \\right)} \\times ln\\left(\\theta_{T}^{phy}\\right) \\times \\left(T_{max}^{phy} \\times \\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{max}^{phy}\\right)} - T_{std}^{phy} \\times \\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{std}^{phy}\\right)}\\right)\\right) \\end{aligned}\\right\\} \\tag{J.5} \\end{equation}\\] Once the iteration target is met (i.e. \\(|G| \\le 0.5\\)), the final value of \\(kTn\\) is used to compute \\(aTn\\) and \\(bTn\\) as per Equation (J.6). \\[\\begin{equation} \\left.\\begin{aligned} aTn &amp;= \\frac{-ln\\left(\\frac{\\left[\\theta_{prod}^{phy}\\right]^{\\left(T_{opt}^{phy}-20\\right)}}{kTn \\times \\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{opt}^{phy}\\right)}}\\right)}{kTn \\times ln\\left(\\theta_{prod}^{phy}\\right)} \\\\ \\\\ bTn &amp;= \\left[\\theta_{prod}^{phy}\\right]^{kTn \\times \\left(T_{std}^{phy}-aTn\\right)} \\end{aligned}\\right\\} \\tag{J.6} \\end{equation}\\] All of \\(aTn\\), \\(bTn\\) and \\(kTn\\) are fixed at the end of Stage 1 for repeated use in Stage 2. and used in Stage 2 at every timestep and model cell to compute \\(L_{T}^{phy}\\) in the water temperature range between \\(T_{std}^{phy}\\) and \\(T_{max}^{phy}\\). Stage 2 The intent of Stage 2 is to use \\(aTn\\), \\(bTn\\) and \\(kTn\\) to describe a curve for \\(L_{T}^{phy}\\) between \\(T_{std}^{phy}\\) and \\(T_{max}^{phy}\\). This curve is computed as per Equation (J.7). \\[\\begin{equation} L_{T}^{phy} = \\left[\\theta_{prod}^{phy}\\right]^{\\left(T-20\\right)} - \\left[\\theta_{prod}^{phy}\\right]^{kTn \\times \\left(T-aTn\\right)} + bTn \\tag{J.7} \\end{equation}\\] The complete piecewise continuous function for the generic temperature limitation function \\(L_T^{phy}\\) is provided in Equation (J.8). \\[\\begin{equation} L_{T}^{phy} = \\begin{cases} \\left[\\theta_{prod}^{phy}\\right]^{\\left(T-20\\right)} &amp; \\text{$T \\le T_{std}^{phy}$} \\\\ \\\\ \\left[\\theta_{prod}^{phy}\\right]^{\\left(T-20\\right)} - \\left[\\theta_{prod}^{phy}\\right]^{kTn \\times \\left(T-aTn\\right)} + bTn &amp; \\text{$T_{std}^{phy} \\lt T \\le T_{max}^{phy}$} \\\\ \\\\ 0 &amp; \\text{$T_{max}^{phy} \\lt T$} \\end{cases} \\tag{J.8} \\end{equation}\\] Depending on the user specification of \\(T_{std}\\) and \\(T_{opt}\\), this limitation function can have a value greater than 1.0. This is acceptable, and can be interpreted as temperature effects actively increasing phytoplankton growth. \\(L_{T}^{phy}\\) is the only limitation function (other than limitation functions that are applied to enhance respiration due to salinity - see Sections J.7.2.2, J.7.3.2 and J.7.4.2) that can vary outside the range 0.0 to 1.0. The form of \\(L_{T}^{phy}\\) with varying \\(T\\) depends on three user specified (or default) temperatures and their derived quantities \\(aTn\\), \\(bTn\\) and \\(kTn\\). As such, the following two figures present \\(L_{T}^{phy}\\) varying with \\(T\\) and at constant \\(T_{max}^{phy}\\) = 25\\(^o\\)C, with the following conditions: Figure J.1: Line 1: \\(T_{std}^{phy}\\) held constant at 10\\(^o\\)C, with the slider varying \\(T_{opt}^{phy}\\) Line 2: \\(T_{std}^{phy}\\) held constant at 18\\(^o\\)C, with the slider varying \\(T_{opt}^{phy}\\) Figure J.2: Line 1: \\(T_{opt}^{phy}\\) held constant at 10\\(^o\\)C, with the slider varying \\(T_{std}^{phy}\\) Line 2: \\(T_{opt}^{phy}\\) held constant at 18\\(^o\\)C, with the slider varying \\(T_{std}^{phy}\\) Figure J.1: Move the slider to see the effect of changing \\(T_{opt}^{phy}\\) on the computed temperature limitation function Figure J.2: Move the slider to see the effect of changing \\(T_{std}^{phy}\\) on the computed temperature limitation function The WQ log file reports the computed temperature limitation function for each phytoplankton group as columnar data. Users can copy and paste these data into plotting software (such as Microsoft Excel) to view each temperature imitation function and therefore ensure that its form is as intended. J.3 Nitrogen Nitrogen offers two limitation functions, one for each of the basic and advanced phytoplankton constituent models. These are described separately following. If nitrogen fixing is implemented for a particular phytoplankton group, then the calculations following are not implemented and \\(L_{nit}^{phy}\\) is set to one. J.3.1 Basic phytoplankton constituent model If internal phytoplankton nutrients are not simulated dynamically, Equation (J.9) is used to compute \\(L_{nit}^{phy}\\). \\[\\begin{equation} L_{nit}^{phy} = \\frac{\\left(\\left[N\\right]_{avail} - \\left[N\\right]_{min}^{phy}\\right)}{\\left(\\left[N\\right]_{avail} - \\left[N\\right]_{min}^{phy}\\right) + K_{lim-N}^{phy}} \\tag{J.9} \\end{equation}\\] \\(\\left[N\\right]_{avail}\\) is the available ambient nitrogen pool on which phytoplankton can draw for primary productivity, and is the sum of inorganic (ammonium and nitrate) nitrogen. \\(\\left[N\\right]_{min}^{phy}\\) is the nitrogen concentration below which phytoplankton is no longer permitted to uptake nitrogen. \\(K_{lim-N}^{phy}\\) is the half saturation nitrogen concentration for phytoplankton uptake. All these parameters are considered by the WQ Module to be combined quantities, i.e. they are not specific to any particular nitrogen species, but rather, to nitrogen-N concentrations across all species uptaken. In the case of the basic phytoplankton constituent model, this is simply the sum of ammonium-N and nitrate-N concentrations. Equation (J.9) has that when \\(K_{lim-N}^{phy}\\) is equal to the difference between ambient nitrogen concentration and \\(\\left[N\\right]_{min}^{phy}\\), i.e. when \\[\\begin{equation} K_{lim-N}^{phy} = \\left[N\\right]_{avail} - \\left[N\\right]_{min}^{phy} \\tag{J.10} \\end{equation}\\] then \\(L_{nit}^{phy}\\) = 0.5. The form of \\(L_{nit}^{phy}\\) with varying \\(\\left[N\\right]_{min}^{phy}\\) and \\(K_{lim-N}^{phy}\\) is provided in Figure J.3, for constant \\(\\left[N\\right]_{avail}\\) = 1.0 mg/L. Figure J.3: Move the slider to see the effect of changing \\(K_{lim-N}^{phy}\\) on the computed nitrogen limitation function The parameter \\(K_{lim-N}^{phy}\\) is the same as that specified in the computation of the the fraction of ammonium that is taken up with primary production (Appendix K.2.1) in the basic phytoplankton constituent model (Equation (K.3)). As such its setting should be considered in terms of its impacts on both nitrogen limitation and uptake processes. J.3.2 Advanced phytoplankton constituent model If internal phytoplankton nutrients are simulated dynamically, and phytoplankton concentrations are greater than the specified (or default) minimum, then Equation (J.11) is used to compute \\(L_{nit}^{phy}\\). \\[\\begin{equation} L_{nit}^{phy} = \\frac{X_{N-C-max}^{phy} \\times \\left(1.0 - \\frac{X_{N-C-min}^{phy} \\times \\left[PHY\\right] }{\\left[IN\\right]}\\right)}{X_{N-C-max}^{phy} - X_{N-C-min}^{phy}} \\tag{J.11} \\end{equation}\\] \\(X_{N-C-min}^{phy}\\) and \\(X_{N-C-max}^{phy}\\) are the specified (or default) minimum and maximum internal nitrogen to Chl a (or carbon if using mmm units) ratios, respectively and \\(\\left[PHY\\right]\\) and \\(\\left[IN\\right]\\) are the current internal Chl a (or carbon) and nitrogen concentrations in the computational cell being considered, respectively. Substituting the definition for the minimum nitrogen to Chl a (or carbon) ratio \\(X_{N-C-min}^{phy}=\\left[IN\\right]_{min}/\\left[PHY\\right]\\) (where \\(\\left[PHY\\right]\\) is in either mgl or mmm units) into Equation (J.11) and rearranging, reveals the form of \\(L_{nit}^{phy}\\) as per Equation (J.12). \\[\\begin{equation} L_{nit}^{phy} = \\frac{X_{N-C-max}^{phy} \\times \\left(1.0 - \\frac{\\left[IN\\right]_{min}} {\\left[IN\\right]}\\right)}{X_{N-C-max}^{phy} - X_{N-C-min}^{phy}} \\tag{J.12} \\end{equation}\\] \\(\\left[IN\\right]_{min}\\) is the minimum internal nitrogen concentation corresponding to the current phytoplankton group \\(\\left[PHY\\right]\\). Equation (J.12) demonstrates that: If an internal nitrogen concentration is equal to \\(\\left[IN\\right]_{min}\\), then \\(L_{nit}^{phy}\\) is zero. This means that no internal nitrogen is available for primary production in the current timestep and that nitrogen is therefore completely preventing growth If an internal nitrogen concentration is equal to \\(\\left[IN\\right]_{max}\\), then \\(L_{nit}^{phy}\\) is one. This means that maximum internal nitrogen is available for primary production in the current timestep and that nitrogen is therefore placing no limit on growth If internal phytoplankton nutrients are simulated dynamically, and phytoplankton concentration is less than the specified (or default) minimum, then phytoplankton will look to external (i.e. ambient water column) nitrogen pools to support primary productivity. The associated limitation function is therefore computed in the same manner as Equation (J.9) in Appendix J.3.1. If this is the case, then the parameters \\(K_{lim-N}^{phy}\\) and \\(\\left[N\\right]_{min}^{phy}\\) are used. This same parameter is also used in the computation of the nitrogen that is taken up with primary production (Appendix K.2.2) in the advanced phytoplankton constituent model (Equation (K.4)). As such its setting should be considered in terms of its impacts on both nitrogen limitation and uptake processes in the advanced phytoplankton constituent model. J.4 Phosphorus Phosphorus offers two limitation functions, one for each of the basic and advanced phytoplankton constituent models. These are described separately following. J.4.1 Basic phytoplankton constituent model If internal phytoplankton nutrients are not dynamically simulated, Equation (J.13) is used to compute \\(L_{phs}^{phy}\\). \\[\\begin{equation} L_{phs}^{phy} = \\frac{\\left(\\left[P\\right]_{avail} - \\left[P\\right]_{min}^{phy}\\right)}{\\left(\\left[P\\right]_{avail} - \\left[P\\right]_{min}^{phy}\\right) + K_{lim-P}^{phy}} \\tag{J.13} \\end{equation}\\] \\(\\left[P\\right]_{avail}\\) is the available phosphorus pool on which phytoplankton can draw for primary productivity, and is simply FRP. \\(\\left[P\\right]_{min}^{phy}\\) is the phosphorus concentration below which phytoplankton no longer is permitted to uptake phosphorus \\(K_{lim-P}^{phy}\\) is the half saturation phosphorus concentration for phytoplankton uptake. Equation (J.13) has that when \\(K_{lim-P}^{phy}\\) is equal to the difference between ambient phosphorus concentration and \\(\\left[P\\right]_{min}^{phy}\\), i.e. when \\[\\begin{equation} K_{lim-P}^{phy} = \\left[P\\right]_{avail} - \\left[P\\right]_{min}^{phy} \\tag{J.14} \\end{equation}\\] then \\(L_{phs}^{phy}\\) = 0.5. The form of \\(L_{phs}^{phy}\\) with varying \\(\\left[P\\right]_{min}^{phy}\\) and \\(K_{lim-P}^{phy}\\) is provided in Figure J.4, for constant \\(\\left[P\\right]_{avail}\\) = 1.0 mg/L. Figure J.4: Move the slider to see the effect of changing \\(K_{lim-P}^{phy}\\) on the computed phosphorus limitation function J.4.2 Advanced phytoplankton constituent model If internal phytoplankton nutrients are simulated dynamically, and phytoplankton concentrations are greater than the specified (or default) minimum, then Equation (J.15) is used to compute \\(L_{phs}^{phy}\\). \\[\\begin{equation} L_{phs}^{phy} = \\frac{X_{P-C-max}^{phy} \\times \\left(1.0 - \\frac{X_{P-C-min}^{phy} \\times \\left[PHY\\right] }{\\left[IP\\right]}\\right)}{X_{P-C-max}^{phy} - X_{P-C-min}^{phy}} \\tag{J.15} \\end{equation}\\] \\(X_{P-C-min}^{phy}\\) and \\(X_{P-C-max}^{phy}\\) are the specified (or default) minimum and maximum internal phosphorus to Chl a (or carbon if using mmm units) ratios, respectively and \\(\\left[PHY\\right]\\) and \\(\\left[IP\\right]\\) are the current internal Chla a (or carbon) and phosphorus concentrations in the computational cell being considered, respectively. Substituting the definition for the minimum phosphorus to Chl a (or carbon) ratio \\(X_{P-C-min}^{phy}=\\left[IP\\right]_{min}/\\left[PHY\\right]\\) (where \\(\\left[PHY\\right]\\) is in either mgl or mmm units) into Equation (J.15) and rearranging, reveals the form of \\(L_{phs}^{phy}\\) as per Equation (J.16). \\[\\begin{equation} L_{phs}^{phy} = \\frac{X_{P-C-max}^{phy} \\times \\left(1.0 - \\frac{\\left[IP\\right]_{min}} {\\left[IP\\right]}\\right)}{X_{P-C-max}^{phy} - X_{P-C-min}^{phy}} \\tag{J.16} \\end{equation}\\] \\(\\left[IP\\right]_{min}\\) is the minimum internal phosphorus concentation corresponding to the current \\(\\left[PHY\\right]\\). Equation (J.16) demonstrates that: If an internal phosphorus concentration is equal to \\(\\left[IP\\right]_{min}\\), then \\(L_{phs}^{phy}\\) is zero. This means that no internal phosphorus is available for primary production in the current timestep and that phosphorus is therefore completely preventing growth If an internal phosphorus concentration is equal to \\(\\left[IP\\right]_{max}\\), then \\(L_{phs}^{phy}\\) is one. This means that maximum internal phosphorus is available for primary production in the current timestep and that phosphorus is therefore placing no limit on growth If internal phytoplankton nutrients are simulated dynamically, and phytoplankton concentrations are less than the specified (or default) minimum, then phytoplankton will look to external (i.e. ambient water column) phosphorus pools to support primary productivity. The associated limitation function is therefore computed in the same manner as Equation (J.13) in Appendix J.4.1. If this is the case, then the parameters \\(K_{lim-P}^{phy}\\) and \\(\\left[P\\right]_{min}^{phy}\\) are used. This same parameter is also used in the computation of the phosphorus that is taken up with primary production (Appendix K.3.2) in the advanced phytoplankton constituent model (Equation (K.8)). As such its setting should be considered in terms of its impacts on both phosphorus limitation and uptake processes in the advanced phytoplankton constituent model. J.5 Silicate Equation (J.17) is used to compute \\(L_{sil}^{phy}\\), if phytoplankton is configured to take up silicate. Specifying silicate limitation parameters will trigger the WQ Module to take up silicate (Section 4.7.3.5.1.6). \\[\\begin{equation} L_{sil}^{phy} = \\frac{\\left(\\left[Si\\right] - \\left[Si\\right]_{min}\\right)}{\\left(\\left[Si\\right] - \\left[Si\\right]_{min}\\right) + K_{lim-Si}^{phy}} \\tag{J.17} \\end{equation}\\] \\(\\left[Si\\right]\\) is the ambient silicate concentration. \\(\\left[Si\\right]_{min}\\) is the silicate concentration below which phytoplankton no longer is permitted to uptake silicate and \\(K_{lim-Si}^{phy}\\) is the half saturation silicate concentration for phytoplankton uptake. \\(K_{lim-Si}^{phy}\\) is specified as a silicate concentration. When this concentration is equal to the difference between the relevant ambient concentration and \\(\\left[Si\\right]_{min}\\), i.e. when \\[\\begin{equation} K_{lim-Si}^{phy} = \\left[Si\\right] - \\left[Si\\right]_{min} \\tag{J.18} \\end{equation}\\] then \\(L_{sil}^{phy}\\) = 0.5. The form of \\(L_{sil}^{phy}\\) with varying \\(\\left[Si\\right]_{min}\\) and \\(K_{lim-Si}^{phy}\\) is provided in Figure J.5, for constant \\(\\left[Si\\right]_{avail}\\) = 1.0 mg/L. Figure J.5: Move the slider to see the effect of changing \\(K_{lim-Si}^{phy}\\) on the computed silicate limitation function J.6 Light Phytoplankton require photosynthetically active radiation (PAR) in order to affect primary productivity. The required PAR may not always be available due to a range of environmental factors and as such may limit phytoplankton growth. In addition, some phytoplankton groups may suffer photoinhibition, which is a reduction in the ability to photosynthesise as a result of damage incurred by greater levels of radiation than can be tolerated. This is also referred to as light-induced damage, and in general terms means that increasing light intensity experienced by a phytoplankton group does not translate into a monotonic increase in the light limitation function: primary productivity can decrease with increasing available light where photoinhibition occurs. A saturating light intensity \\(I_S\\) is specified for those models that include photoinhibition (rather then a half saturation light for limitation \\(I_K\\) specified for models that exclude photoinhibition) and \\(I_S\\) can be interpreted as the light intensity at which the limitation function has its peak, usually at a value of 1.0. Either side of this \\(I_S\\) light intensity, the limitation function decreases toward zero. The WQ Module offers a number of different models that deploy combinations of these processes to estimate phytoplankton light limitation functions. These are described following. J.6.1 Basic This model includes phytoplankton light limitation but with no photoinhibition. Limitation is therefore purely due to insufficient light availability. The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (J.19). \\[\\begin{equation} L_{lght}^{phy} = 1.0 - \\left[ \\int_{\\frac{-PAR_b}{I_{K-bas}}}^{\\infty} \\! \\left( \\frac{e^{-t}}{t} \\right)\\, \\mathrm{d}t - \\int_{\\frac{-PAR_t}{I_{K-bas}}}^{\\infty} \\! \\left( \\frac{e^{-t}}{t} \\right)\\, \\mathrm{d}t\\right] \\times \\left[ \\vphantom{\\int_{\\frac{-PAR_b}{I_{K-bas}}}^{\\infty} \\! \\left( \\frac{e^{-t}}{t} \\right)\\, \\mathrm{d}t} \\frac{1}{\\text{max}(k_{bio}\\times dz,10^{-3})}\\right] \\tag{J.19} \\end{equation}\\] \\(PAR_b\\) and \\(PAR_t\\) are photosynthetically available radiation at the bottom and top faces of a model cell, respectively, \\(I_{K-bas}\\) is the half saturation constant for light limitation of growth, \\(\\text{k}_\\text{bio}\\) is the local change in light extinction coefficient due to self shading and \\(dz\\) is cell vertical thickness. J.6.2 Monod This model includes phytoplankton light limitation but with no photoinhibition, as per Monod (1950). Limitation is therefore purely due to insufficient light availability. The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (J.20). \\[\\begin{equation} L_{lght}^{phy} = \\frac{\\frac{PAR_c}{I_{K-mon}}}{1 + \\frac{PAR_c}{I_{K-mon}}} \\tag{J.20} \\end{equation}\\] \\(PAR_c\\) is the photosynthetically available radiation at the centre of a model cell and \\(I_{K-mon}\\) is the half saturation constant for light limitation of growth. Equation (J.20) has that when \\(PAR_c\\) is equal to \\(I_{K-mon}\\), \\(L_{lght}^{phy}\\) = 0.5. J.6.3 Steele This model includes phytoplankton light limitation with photoinhibition, as per Steele (1962). The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (J.21). \\[\\begin{equation} L_{lght}^{phy} = \\frac{PAR_c}{I_{S-ste}} \\times e^{\\left(1.0 - \\frac{PAR_c}{I_{S-ste}}\\right)} \\tag{J.21} \\end{equation}\\] \\(PAR_c\\) is the photosynthetically available radiation at the centre of a model cell and \\(I_{S-ste}\\) is the saturating light intensity. Equation (J.21) has that when \\(PAR_c\\) is equal to \\(I_{S-ste}\\), \\(L_{lght}^{phy}\\) = 1.0, i.e., the light intensity at which no light limitation or photoinhibition occurs. The form of Equation (J.21) is presented in Figure J.6, with the abscissa spanning a typical range of instantaneous photosynthetically available radiation. Figure J.6: Move the slider to see the effect of changing \\(I_S\\) on the computed light limitation function J.6.4 Webb This model includes phytoplankton light limitation with no photoinhibition, as per Webb (1974). The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (J.22). \\[\\begin{equation} L_{lght}^{phy} = 1.0 - e^{-\\left(\\frac{PAR_c}{I_{K-web}}\\right)} \\tag{J.22} \\end{equation}\\] \\(PAR_c\\) is the photosynthetically available radiation at the centre of a model cell and \\(I_{K-web}\\) is the half saturation constant for light limitation of growth. The form of Equation (J.22) is presented in Figure J.7, with the abscissa spanning a typical range of instantaneous photosynthetically available radiation. Figure J.7: Move the slider to see the effect of changing \\(I_K\\) on the computed light limitation function J.6.5 Jassby This model includes phytoplankton light limitation with no photoinhibition, as per Jassby and Platt (1976). The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (J.23). \\[\\begin{equation} L_{lght}^{phy} = tanh\\left(\\frac{PAR_c}{I_{K-jas}}\\right) \\tag{J.23} \\end{equation}\\] \\(PAR_c\\) is the photosynthetically available radiation at the centre of a model cell and \\(I_{K-jas}\\) is the half saturation constant for light limitation of growth. The form of Equation (J.23) is presented in Figure J.8, with the abscissa spanning a typical range of instantaneous photosynthetically available radiation. Figure J.8: Move the slider to see the effect of changing \\(I_K\\) on the computed light limitation function J.6.6 Chalker This model includes phytoplankton light limitation with no photoinhibition, as per Chalker (1980). The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (J.24). \\[\\begin{equation} L_{lght}^{phy} = \\frac{e^{1.5\\left(\\frac{PAR_c}{I_{K-cha}}\\right)}-1.0}{e^{1.5\\left(\\frac{PAR_c}{I_{K-cha}}\\right)}+0.5} \\tag{J.24} \\end{equation}\\] \\(PAR_c\\) is the photosynthetically available radiation at the centre of a model cell and \\(I_{K-cha}\\) is the half saturation constant for light limitation of growth. The form of Equation (J.24) is presented in Figure J.9, with the abscissa spanning a typical range of instantaneous photosynthetically available radiation. Figure J.9: Move the slider to see the effect of changing \\(I_K\\) on the computed light limitation function J.6.7 Klepper This model includes phytoplankton light limitation with photoinhibition, as per Klepper et al. (1988) and Ebenhoh et al. (1997). The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (J.25). \\[\\begin{equation} L_{lght}^{phy} = \\frac{7.0\\times\\left(\\frac{PAR_c}{I_{S-kle}}\\right)}{1.0 + 5.0\\times\\left(\\frac{PAR_c}{I_{S-kle}}\\right) + \\left(\\frac{PAR_c}{I_{S-kle}}\\right)^2} \\tag{J.25} \\end{equation}\\] \\(PAR_c\\) is the photosynthetically available radiation at the centre of a model cell and \\(I_{S-kle}\\) is the saturating light intensity. The form of Equation (J.25) is presented in Figure J.10, with the abscissa spanning a typical range of instantaneous photosynthetically available radiation. Figure J.10: Move the slider to see the effect of changing \\(I_S\\) on the computed light limitation function J.6.8 Integrated This model includes phytoplankton light limitation with photoinhibition, and is the integrated form of the Steele (1962) model provided in Equation (J.21). In this form, the limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (J.26). \\[\\begin{equation} L_{lght}^{phy} = \\frac{e^{\\left(1.0 - \\frac{PAR_b}{I_{S-int}}\\right)} - e^{\\left(1.0 - \\frac{PAR_t}{I_{S-int}}\\right)}}{\\text{k}_\\text{bio} \\times dz} \\tag{J.26} \\end{equation}\\] \\(PAR_b\\) and \\(PAR_t\\) are photosynthetically available radiation at the bottom and top faces of a model cell, respectively, \\(I_{S-int}\\) is the saturating light intensity, \\(\\text{k}_\\text{bio}\\) is the local change in light extinction coefficient due to self shading and \\(dz\\) is cell vertical thickness. In most cases, this model should produce similar results to the Steele model in section J.6.3. J.7 Salinity Phytoplankton can exhibit sensitivity to salinity. Where activated, the WQ Module captures these sensitivities via multiplicative application of a salinity limitation function as either a reduction of primary productivity (Equation (I.4)) or an increase of respiration (Equation (I.7)). Application of these rates is mutually exclusive for a given phytoplankton group: limitation can be applied either to primary productivity or respiration, but not both. One way to conceptualise this is as follows: A salinity limitation \\(L_{sal-pp}^{phy}\\) applied to primary productivity is always between zero and one and will result in a reduction in primary productivity. Corresponding respiration rates will remain unaffected by salinity and therefore by Equation (I.1), phytoplankton biomass should be expected to decrease as a result A salinity limitation \\(L_{sal-r}^{phy}\\) applied to respiration is always greater than one and will result in an enhancement of respiration. Corresponding primary productivity rates will remain unaffected by salinity and therefore by Equation (I.1), phytoplankton biomass should be expected to decrease as a result, noting however that exudation (which is another loss term) will continue and is related to primary productivity The salinity limitation models available within the WQ Module are described following. All can be applied to both primary productivity and respiration, other than the estuarine limitation function which is applicable only to productivity. J.7.1 None This model includes no salinity limitation to either of the computed primary productivity or respiration rates. The salinity limitation set to 1.0 for all salinities. J.7.2 Freshwater This model is typically used for phytoplankton groups that have a preference for fresh water. As such, the salinity limitation is set to 1.0 for all salinities greater than zero and up to a specified (or default) optimal salinity. The general expression for the limitation function above this optimal salinity is presented in Equation (J.27), and this expression is applied to both primary productivity and respiration. Its specific applications to these two processes are described in the following subsections. \\[\\begin{equation} L_{sal-r}^{phy} = L_{sal-pp}^{phy} = \\begin{cases} 1.0 &amp; \\text{$S \\le S_{opt-fresh}^{phy}$} \\\\ \\\\ \\left(\\frac{\\left(L^{phy}_{max-fresh}-1.0\\right)\\times S^2 - \\left(\\left(L^{phy}_{max-fresh}-1.0\\right) \\times 2.0 \\times S_{opt-fresh}^{phy}\\right)\\times S}{\\left(S_{max-fresh}^{phy} - S_{opt-fresh}^{phy}\\right)^2}\\right) + \\ldots \\\\ \\\\ \\text{$ $} \\ldots \\left(\\frac{\\left(\\left(L^{phy}_{max-fresh}-1.0\\right) \\times \\left(S_{opt-fresh}^{phy}\\right)^2\\right)}{\\left(S_{max-fresh}^{phy} - S_{opt-fresh}^{phy}\\right)^2}\\right) + 1.0 &amp; \\text{$S_{opt-fresh}^{phy} \\lt S$}\\\\ \\\\ \\end{cases} \\tag{J.27} \\end{equation}\\] \\(S_{opt-fresh}^{phy}\\) and \\(S_{max-fresh}^{phy}\\) are the optimal and maximum salinities respectively, \\(L^{phy}_{max-fresh}\\) is the value of the salinity limitation function at \\(S_{max-fresh}^{phy}\\) and \\(S\\) is ambient salinity. J.7.2.1 Primary productivity In order to apply this limitation function to primary productivity, \\(L^{phy}_{max-fresh}\\) is set such that \\[\\begin{equation} 0.0 \\le L^{phy}_{max-fresh} \\le 1.0 \\tag{J.28} \\end{equation}\\] In this case, and with increasing salinity, the limitation function decreases from 1.0 at \\(S_{opt-fresh}^{phy}\\) to a specified (or default) limitation function value at a specified (or default) maximum salinity. If \\(L^{phy}_{max-fresh}\\) is not zero, then the function continues downward to zero at salinities greater than \\(S_{max-fresh}^{phy}\\). When the function reaches zero it remains there. The simplest application of this limitation function is to set \\(L^{phy}_{max-fresh}\\) as zero at \\(S_{max-fresh}^{phy}\\). This will ensure that no primary productivity occurs above a maximum salinity of \\(S_{max-fresh}^{phy}\\) (this approach is reflected in the naming of \\(L^{phy}_{max-fresh}\\) and \\(S_{max-fresh}^{phy}\\)). For example, if a particular phytoplankton group was known to feel the effects of salinity on primary productivity above a salinity of 5 g/L, and to entirely cease producing at salinities greater than 10 g/L, then the following would be set by the user: \\(S_{opt-fresh}^{phy}\\) = 5.0 g/L \\(S_{max-fresh}^{phy}\\) = 10.0 g/L, and \\(L^{phy}_{max-fresh}\\) = 0.0 Using these values initially but varying \\(S_{max-fresh}^{phy}\\), the form of Equation (J.27) is presented in Figure J.11. Figure J.11: Move the slider to see the effect of changing \\(S_{max-fresh}^{phy}\\) on the computed salinity limitation function. \\(S_{opt-fresh}^{phy}\\) = 5.0 g/L and \\(L^{phy}_{max-fresh}\\) = 0.0 and are fixed Another example is the case where \\(L^{phy}_{max-fresh}\\) is not zero at \\(S_{max-fresh}^{phy}\\). For example, if a particular phytoplankton group was known to feel the effects of salinity on primary productivity above a salinity of 2 g/L, and to have a 75% limitation on productivity at a salinity of 10 g/L, then the following would be set by the user: \\(S_{opt-fresh}^{phy}\\) = 2.0 g/L \\(S_{max-fresh}^{phy}\\) = 10.0 g/L, and \\(L^{phy}_{max-fresh}\\) = 0.25 Using these values initially, but varying \\(S_{max-fresh}^{phy}\\), the form of Equation (J.27) is presented in Figure J.12. The salinity at which the limitation function falls to zero is greater than \\(S_{max-fresh}^{phy}\\), but is always 0.25 at \\(S_{max-fresh}^{phy}\\). Figure J.12: Move the slider to see the effect of changing \\(S_{max-fresh}^{phy}\\) on the computed salinity limitation function. \\(S_{opt-fresh}^{phy}\\) = 2.0 g/L and \\(L^{phy}_{max-fresh}\\) = 0.25 and are fixed J.7.2.2 Respiration In order to apply this limitation function to respiration, \\(L^{phy}_{max-fresh}\\) is set such that \\[\\begin{equation} 1.0 \\lt L^{phy}_{max-fresh} \\tag{J.29} \\end{equation}\\] In this case, and with increasing salinity, the limitation function increases from 1.0 at \\(S_{opt-fresh}^{phy}\\) to a specified (or default) limitation function value at a specified (or default) salinity. The function then increases indefinitely. For example, if a particular phytoplankton group was known to feel the effects of salinity on respiration above a salinity of 5 g/L, such that at a salinity of 10 g/L its respiration rate doubled, then the following would be set by the user: \\(S_{opt-fresh}^{phy}\\) = 5.0 g/L \\(S_{max-fresh}^{phy}\\) = 10.0 g/L, and \\(L^{phy}_{max-fresh}\\) = 2.0 Using these values initially but varying \\(S_{max-fresh}^{phy}\\), the form of Equation (J.27) is presented in Figure J.13. Figure J.13: Move the slider to see the effect of changing \\(S_{max-fresh}^{phy}\\) on the computed salinity limitation function. \\(S_{opt-fresh}^{phy}\\) = 5.0 g/L and \\(L^{phy}_{max-fresh}\\) = 2.0 and are fixed J.7.3 Marine This model is typically used for phytoplankton groups that have a preference for marine (saline) water. As such, the salinity limitation is set to 1.0 for all salinities greater a specified (or default) optimal salinity. The general expression for the limitation function below this optimal salinity is presented in Equation (J.30), and this expression is applied to both primary productivity and respiration. Its specific applications to these two processes are described in the following subsections. \\[\\begin{equation} L_{sal-r}^{phy} = L_{sal-pp}^{phy} = \\begin{cases} \\left(\\frac{\\left(L^{phy}_{zero-marine}-1.0\\right)\\times S^2}{\\left(S_{opt-marine}^{phy}\\right)^2}\\right) - \\left(2.0 \\times \\frac{\\left(L^{phy}_{zero-marine}-1.0\\right)\\times S}{\\left(S_{opt-marine}^{phy}\\right)}\\right) + L^{phy}_{zero-marine} &amp; \\text{$S \\le S_{opt-marine}^{phy}$}\\\\ \\\\ 1.0 &amp; \\text{$S_{opt-marine}^{phy} \\lt S$} \\\\ \\\\ \\end{cases} \\tag{J.30} \\end{equation}\\] \\(S_{opt-marine}^{phy}\\) is the optimal salinity , \\(L^{phy}_{zero-marine}\\) is the value of the salinity limitation function at zero salinity and \\(S\\) is ambient salinity. J.7.3.1 Primary productivity In order to apply this limitation function to primary productivity, \\(L^{phy}_{zero-marine}\\) is set such that \\[\\begin{equation} 0.0 \\le L^{phy}_{zero-marine} \\le 1.0 \\tag{J.31} \\end{equation}\\] In this case, and with decreasing salinity, the limitation function decreases from 1.0 at \\(S_{opt-marine}^{phy}\\) to a specified (or default) limitation function value at zero salinity, \\(L^{phy}_{zero-marine}\\). The simplest application of this limitation function is to set \\(L^{phy}_{zero-marine}\\) to zero. This will ensure that no primary productivity occurs at zero salinity. For example, if a particular phytoplankton group was known to feel the effects of salinity on primary productivity below a salinity of 20 g/L, and to entirely cease producing at salinities of 0 g/L, then the following would be set by the user: \\(S_{opt-marine}^{phy}\\) = 20.0 g/L, and \\(L^{phy}_{zero-marine}\\) = 0.0 Using these values initially but varying \\(S_{opt-marine}^{phy}\\), the form of Equation (J.30) is presented in Figure J.14. Figure J.14: Move the slider to see the effect of changing \\(S_{opt-marine}^{phy}\\) on the computed salinity limitation function. \\(L^{phy}_{zero-marine}\\) = 0.0 and is fixed Another example is the case where \\(L^{phy}_{zero-marine}\\) is not zero. For example, if a particular phytoplankton group was known to feel the effects of salinity on primary productivity below a salinity of 10 g/L, and to have a 75% limitation on productivity at a salinity of 0 g/L (i.e. still produce in completely frsh water), then the following would be set by the user: \\(S_{opt-marine}^{phy}\\) = 10.0 g/L, and \\(L^{phy}_{zero-marine}\\) = 0.25 Using these values initially, but varying \\(S_{zero-marine}^{phy}\\), the form of Equation (J.30) is presented in Figure J.15. Figure J.15: Move the slider to see the effect of changing \\(S_{opt-marine}^{phy}\\) on the computed salinity limitation function. \\(L^{phy}_{zero-marine}\\) = 0.25 and is fixed J.7.3.2 Respiration In order to apply this limitation function to respiration, \\(L^{phy}_{zero-marine}\\) is set such that \\[\\begin{equation} 1.0 \\lt L^{phy}_{zero-marine} \\tag{J.32} \\end{equation}\\] In this case, and with decreasing salinity, the limitation function increases from 1.0 at \\(S_{opt-marine}^{phy}\\) to a specified (or default) limitation function value at zero salinity. For example, if a particular phytoplankton group was known to feel the effects of salinity on respiration below a salinity of 5 g/L, such that at a salinity of 0 g/L its respiration rate doubled, then the following would be set by the user: \\(S_{opt-marine}^{phy}\\) = 5.0 g/L \\(L^{phy}_{zero-marine}\\) = 2.0 Using these values initially but varying \\(S_{zero-marine}^{phy}\\), the form of Equation (J.30) is presented in Figure J.16. Figure J.16: Move the slider to see the effect of changing \\(S_{opt_marine}^{phy}\\) on the computed salinity limitation function. \\(L^{phy}_{zero-marine}\\) = 2.0 and is fixed J.7.4 Mixed This model is typically used for phytoplankton groups that have a preference for mid range salinity waters. As such, the salinity limitation is set to 1.0 between specified (or default) optimal and maximum salinities. The general expression for the limitation function above and below this range is presented in Equation (J.33), and this expression is applied to both primary productivity and respiration. Its specific applications to these two processes are described in the following subsections. \\[\\begin{equation} L_{sal-r}^{phy} = L_{sal-pp}^{phy} = \\begin{cases} \\left(\\frac{\\left(L^{phy}_{zero-mix}-1.0\\right)\\times S^2}{\\left(S_{opt-mix}^{phy}\\right)^2}\\right) - \\left(2.0 \\times \\frac{\\left(L^{phy}_{zero-mix}-1.0\\right)\\times S}{\\left(S_{opt-mix}^{phy}\\right)}\\right) + L^{phy}_{zero-mix} &amp; \\text{$S \\le S_{opt-mix}^{phy}$} \\\\ \\\\ 1.0 &amp; \\text{$S_{opt-mix}^{phy} \\lt S \\le S_{max-mix}^{phy}$} \\\\ \\\\ \\left(\\frac{\\left(L^{phy}_{zero-mix}-1.0\\right)\\times \\left(S_{max-mix}^{phy} + S_{opt-mix}^{phy} - S\\right)^2}{\\left(S_{opt-mix}^{phy}\\right)^2}\\right) - \\ldots \\\\ \\ldots \\left(2.0 \\times \\frac{\\left(L^{phy}_{zero-mix}-1.0\\right)\\times \\left(S_{max-mix}^{phy} + S_{opt-mix}^{phy} - S\\right)}{\\left(S_{opt-mix}^{phy}\\right)}\\right) + L^{phy}_{zero-mix} &amp; \\text{$S_{max-mix}^{phy} \\lt S \\le \\left(S_{max-mix}^{phy} + S_{opt-mix}^{phy}\\right)$} \\\\ \\\\ L^{phy}_{zero-mix} &amp; \\text{$\\left(S_{max-mix}^{phy} + S_{opt-mix}^{phy}\\right) \\lt S$} \\end{cases} \\tag{J.33} \\end{equation}\\] \\(S_{opt-mix}^{phy}\\) and \\(S_{max-mix}^{phy}\\) are the optimal and maximum salinities, respectively, \\(L^{phy}_{zero-mix}\\) is the value of the salinity limitation function at salinities of zero and greater than (\\(S_{opt-mix}^{phy} + S_{max-mix}^{phy}\\)) and \\(S\\) is ambient salinity. J.7.4.1 Primary productivity In order to apply this limitation function to primary productivity, \\(L^{phy}_{zero-mix}\\) is set such that \\[\\begin{equation} 0.0 \\le L^{phy}_{zero-mix} \\le 1.0 \\tag{J.34} \\end{equation}\\] In this case, the limitation function: Decreases at salinities below \\(S_{opt-mix}^{phy}\\) to \\(L^{phy}_{zero-mix}\\) at a salinity of zero, and Decreases at salinities above \\(S_{max-mix}^{phy}\\) to \\(L^{phy}_{zero-mix}\\) at a salinity equal to the sum of the specified optimal and maximum salinities The simplest application of this limitation function is to set \\(L^{phy}_{zero-mix}\\) to zero. This will ensure that no primary productivity occurs both at zero salinity and above a salinity of \\(S_{opt-mix}^{phy}\\) + \\(S_{max-mix}^{phy}\\). For example,if a particular phytoplankton group was known to prefer salinities between 5 and 10 g/L, then the following would be set by the user: \\(S_{opt-mix}^{phy}\\) = 5.0 g/L \\(S_{max-mix}^{phy}\\) = 10.0 g/L \\(L^{phy}_{zero-mix}\\) = 0.0 Using these values initially but varying \\(S_{opt-mix}^{phy}\\), the form of Equation (J.33) is presented in Figure J.17. The absolute range between \\(S_{opt-mix}^{phy}\\) and \\(S_{max-mix}^{phy}\\) is held constant at 5.0 g/L for ease of comparison, so \\(S_{max-mix}^{phy}\\) increases at the same rate as \\(S_{opt-mix}^{phy}\\) when the slider moves. Figure J.17: Move the slider to see the effect of changing \\(S_{opt-mix}^{phy}\\) on the computed salinity limitation function. \\(L^{phy}_{zero-mix}\\) = 0.0 and is fixed. \\(S_{max-mix}^{phy}\\) is set to be \\(S_{opt-mix}^{phy}\\) + 5.0 g/L Another example is the case where \\(L^{phy}_{zero-mix}\\) is not zero. For example,if a particular phytoplankton group was known to prefer salinities between 5 and 10 g/L and have a 60% limitation on productivity at zero salinity, then the following would be set by the user: \\(S_{opt-mix}^{phy}\\) = 5.0 g/L \\(S_{max-mix}^{phy}\\) = 10.0 g/L \\(L^{phy}_{zero-mix}\\) = 0.4 Using these values initially but varying \\(S_{opt-mix}^{phy}\\), the form of Equation (J.33) is presented in Figure J.18. The absolute range between \\(S_{opt-mix}^{phy}\\) and \\(S_{max-mix}^{phy}\\) is again held constant at 5.0 g/L for ease of comparison, so \\(S_{max-mix}^{phy}\\) increases at the same rate as \\(S_{opt-mix}^{phy}\\) when the slider moves. Figure J.18: Move the slider to see the effect of changing \\(S_{opt-mix}^{phy}\\) on the computed salinity limitation function. \\(L^{phy}_{zero-mix}\\) = 0.4 and is fixed. \\(S_{max-mix}^{phy}\\) is set to be \\(S_{opt-mix}^{phy}\\) + 5.0 g/L J.7.4.2 Respiration In order to apply this limitation function to respiration, \\(L^{phy}_{zero-mix}\\) is set such that \\[\\begin{equation} 1.0 \\lt L^{phy}_{zero-mix} \\tag{J.35} \\end{equation}\\] In this case, the limitation function: Increases at salinities below \\(S_{opt-mix}^{phy}\\) to \\(L^{phy}_{zero-mix}\\) at a salinity of zero, and Increases at salinities above \\(S_{max-mix}^{phy}\\) to \\(L^{phy}_{zero-mix}\\) at a salinity equal to the sum of the specified optimal and maximum salinities For example,if a particular phytoplankton group was known to prefer salinities between 5 and 10 g/L but feel the effects of salinity outside this range such that at a salinity of zero its respiration rate doubled, then the following would be set by the user: \\(S_{opt-mix}^{phy}\\) = 5.0 g/L \\(S_{max-mix}^{phy}\\) = 10.0 g/L \\(L^{phy}_{zero-mix}\\) = 2.0 Using these values initially but varying \\(S_{opt-mix}^{phy}\\), the form of Equation (J.33) is presented in Figure J.19. The absolute range between \\(S_{opt-mix}^{phy}\\) and \\(S_{max-mix}^{phy}\\) is again held constant at 5.0 g/L for ease of comparison, so \\(S_{max-mix}^{phy}\\) increases at the same rate as \\(S_{opt-mix}^{phy}\\) when the slider moves. Figure J.19: Move the slider to see the effect of changing \\(S_{opt-mix}^{phy}\\) on the computed salinity limitation function. \\(L^{phy}_{zero-mix}\\) = 2.0 and is fixed. \\(S_{max-mix}^{phy}\\) is set to be \\(S_{opt-mix}^{phy}\\) + 5.0 g/L J.7.5 Estuarine This model is typically used for phytoplankton groups that have a preference for brackish (typically estuarine) waters. As such, the salinity limitation is set to one at a specified (or default) optimal mid range salinity. The general expression for the limitation function above and below this salinity is presented in Equation (J.36), and this expression is applied only to primary productivity. \\[\\begin{equation} L_{sal}^{phy} = \\begin{cases} e^{P^{phy}_{est}\\left(S-S_{opt-est}^{phy}\\right)} \\times \\left( \\frac{\\left(S_{max-est}^{phy}-S\\right)}{\\left(S_{max-est}^{phy}-S_{opt-est}^{phy}\\right)}\\right)^{P^{phy}_{est}\\left(S_{max-est}^{phy}-S_{opt-est}^{phy}\\right)} &amp; \\text{$S \\le S_{max-est}^{phy}$} \\\\ \\\\ 0.0 &amp; \\text{$S_{max-est}^{phy} \\lt S$} \\\\ \\\\ \\end{cases} \\tag{J.36} \\end{equation}\\] \\(S_{opt-est}^{phy}\\) and \\(S_{max-est}^{phy}\\) are the optimal and maximum salinities, respectively, \\(P^{phy}_{est}\\) is the power coefficient and \\(S\\) is ambient salinity. The intention of applying this limitation function is that it be applied to a relatively narrow band of mid range (estuarine or brackish) salinities. For example, if a particular phytoplankton group was known to produce optimally at a salinity of 15 g/L but had its growth completely suppressed less than 5 g/L and greater than 20 g/L, then the following would be set by the user: \\(S_{opt-est}^{phy}\\) = 15.0 g/L \\(S_{max-est}^{phy}\\) = 20.0 g/L \\(P^{phy}_{est}\\) = 1.6 (or greater) Using these values but varying \\(P^{phy}_{est}\\), the form of Equation (J.36) is presented in Figure J.20. \\(S_{opt-est}^{phy}\\) and \\(S_{max-est}^{phy}\\) are held constant at 15.0 g/L and 20 g/L, respectively. The slider starts at a \\(P^{phy}_{est}\\) value of 0.2, and the key feature to note is that the salinity limitation function distribution tightens as \\(P^{phy}_{est}\\) increases. Figure J.20: Move the slider to see the effect of changing \\(P^{phy}_{est}\\) on the computed salinity limitation function. \\(S_{opt-est}^{phy}\\) and \\(S_{max-est}^{phy}\\) are set to be 15 and 20 g/L, respectively, and are fixed "],["PhyUptake-3.html", "Appendix K Processes: phyto uptake K.1 Carbon K.2 Nitrogen K.3 Phosphorus K.4 Silicate", " Appendix K Processes: phyto uptake Once the primary productivity \\(R_{prod\\langle computed\\rangle}^{phy}\\) rate has been computed for a phytoplankton group via Equation (I.2) (and potentially Equations (I.3) and (I.4) if nitrogen fixing and salinity limitation are activated, respectively), then that rate drives the mass uptake of inorganic carbon, nitrogen, phosphorus and silicate. This uptake includes the operation of a number of user specified (or default) parameters, and the respective calculations are described following. Uptakes are denoted as fluxes, \\(F\\). K.1 Carbon Carbon has the simplest uptake calculation, as per Equation (K.1). \\[\\begin{equation} F_{C-uptake}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times \\left[PHY\\right] \\tag{K.1} \\end{equation}\\] \\(F_{C-uptake}^{phy}\\) is the uptake of carbon, \\(R_{prod\\langle computed\\rangle}^{phy}\\) is the computed primary productivity rate and \\(\\left[PHY\\right]\\) is a computational cell’s phytoplankton concentration. This flux is summed over all simulated phytoplankton groups to compute the community carbon uptake, \\(F_{C-uptake\\langle computed\\rangle}^{comm}\\). Carbon does not need to be explicitly simulated as a computed variable for this uptake to occur, but because carbon is used as the units of accounting for phytoplankton biomass, its uptake is computed by the WQ Module in order to report phytoplankton concentrations. These concentrations are either mmol C per m\\(^3\\) or \\(\\mu\\)g chlorophyll a per litre (using a specified or default conversion), depending on the specified simulation units system. Carbon stores from which phytoplankton uptake can draw are assumed to be unlimited and unaccounted for when carbon is not explicitly included in a simulation as a computed variable. K.2 Nitrogen The WQ Module allows for phytoplankton to uptake nitrate and ammonium (i.e. inorganic nitrogen) to meet primary production nitrogen demands. The parallel uptake of organic nitrogen (i.e. simulation of mixotrophic phytoplankton) is not yet implemented within the WQ Module. Uptake is computed differently for the basic and advanced phytoplankton constituent models K.2.1 Basic phytoplankton constituent model If internal phytoplankton nutrients are not simulated dynamically, nitrogen uptake is calculated as per Equation (K.2). \\[\\begin{equation} F_{N-uptake}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times \\left[PHY\\right] \\times X_{N-C-con}^{phy} \\tag{K.2} \\end{equation}\\] \\(F_{N-uptake}^{phy}\\) is the uptake of water column inorganic nitrogen, \\(R_{prod\\langle computed\\rangle}^{phy}\\) is the computed primary productivity rate, \\(\\left[PHY\\right]\\) is a computational cell’s phytoplankton concentration and \\(X_{N-C-con}^{phy}\\) is the specified (or default) constant ratio of internal nitrogen to carbon in the phytoplankton group being considered. This quantity \\(F_{N-uptake}^{phy}\\) is the total uptake of inorganic nitrogen. In order to disaggregate this uptake into that of ammonium and nitrate, the WQ Module applies Equation (K.3), for ammonium concentrations greater than zero. \\[\\begin{equation} \\left.\\begin{aligned} f_{amm-uptake}^{phy} =&amp; \\frac{\\left[NH_4\\right]\\times\\left[NO_3\\right]}{\\left(\\left[NH_4\\right] + K_{lim-N}^{phy}\\right)\\times\\left(\\left[NO_3\\right]+K_{lim-N}^{phy}\\right)} + \\frac{\\left[NH_4\\right]\\times K_{lim-N}^{phy}}{\\left(\\left[NH_4\\right] + \\left[NO_3\\right]\\right)\\times\\left(\\left[NO_3\\right]+K_{lim-N}^{phy}\\right)} \\\\ \\\\ F_{amm-uptake}^{phy} =&amp; F_{N-uptake}^{phy} \\times f_{amm-uptake}^{phy} \\\\ \\\\ F_{nit-uptake}^{phy} =&amp; F_{N-uptake}^{phy} \\times \\left(1.0 - f_{amm-uptake}^{phy}\\right) \\end{aligned}\\right\\} \\tag{K.3} \\end{equation}\\] For a phytoplankton group, \\(f_{amm-uptake}^{phy}\\) is the fraction of nitrogen uptake that is ammonium, \\(\\left[NH_4\\right]\\) and \\(\\left[NO_3\\right]\\) are the ambient water column ammonium and nitrate concentrations, respectively, \\(K_{lim-N}^{phy}\\) is the half saturation nitrogen concentration for phytoplankton uptake and \\(F_{amm-uptake}^{phy}\\) and \\(F_{nit-uptake}^{phy}\\) are the uptake by phytoplankton of ammonium and nitrate, respectively. These fluxes (whether computed from Equation (K.3) or (K.4)) are summed over all simulated phytoplankton groups to compute the community ammonium and nitrate uptake, \\(F_{amm-uptake\\langle computed\\rangle}^{comm}\\) and \\(F_{nit-uptake\\langle computed\\rangle}^{comm}\\), respectively. The form of \\(f_{amm-uptake}^{phy}\\) in Equation (K.3) with ammonium concentration is presented in Figure K.1. Use the “play” button or drag the slider to see how different half saturation concentrations \\(K_{lim-N}^{phy}\\) change the fraction of ammonium taken up by phytoplankton (ordinate), as a function of ambient ammonium concentration (abscissa). Nitrate concentration is set to a fixed 5 mg/L. Figure K.1: Move the slider to see the effect of changing \\(K_{lim-N}^{phy}\\) on the fraction of ammonium taken up by phytoplankton. Nitrate concentration is set to 5 mg/L and is fixed To complement Figure K.1, the form of \\(f_{amm-uptake}^{phy}\\) in Equation (K.3) with nitrate concentration is presented in Figure K.2, using the same ordinate axis limits. Use the “play” button or drag the slider to see how different half saturation concentrations \\(K_{lim-N}^{phy}\\) change the fraction of ammonium taken up by phytoplankton (ordinate), as a function of ambient nitrate concentration (abscissa). Ammonium concentration is set to a fixed 2 mg/L. Figure K.2: Move the slider to see the effect of changing \\(K_{lim-N}^{phy}\\) on the fraction of ammonium taken up by phytoplankton. Ammonium concentration is set to 2 mg/L and is fixed The parameter \\(K_{lim-N}^{phy}\\) is the same as that used for calculation of the nitrogen limitation function in the basic (and advanced if internal nitrogen stores are exhausted) phytoplankton constituent model, so its specification should be considered in terms of its influence on both uptake on limitation. K.2.2 Advanced phytoplankton constituent model If internal phytoplankton nutrients are simulated dynamically, nitrogen uptake is calculated as per Equation (K.4). \\[\\begin{equation} F_{N-uptake}^{phy} = R_{N-uptake}^{phy} \\times L_{T}^{phy} \\times \\left[PHY\\right] \\times \\frac{\\left(X_{N-C-max}^{phy} - \\frac{\\left[IN\\right]}{\\left[PHY\\right]}\\right)}{\\left(X_{N-C-max}^{phy} - X_{N-C-min}^{phy}\\right)} \\times \\frac{\\left(\\left[N\\right]_{avail} - \\left[N\\right]_{min}\\right)}{\\left(\\left[N\\right]_{avail} - \\left[N\\right]_{min}\\right) + K_{lim-N}^{phy}} \\tag{K.4} \\end{equation}\\] \\(F_{N-uptake}^{phy}\\) is the uptake of water column inorganic nitrogen, \\(R_{N-uptake}^{phy}\\) is the specified (or default) rate of uptake of inorganic nitrogen, \\(L_{T}^{phy}\\) is the temperature limitation function, \\(\\left[PHY\\right]\\) and \\(\\left[IN\\right]\\) are a computational cell’s phytoplankton and internal nitrogen concentrations respectively, \\(X_{N-C-min}^{phy}\\) and \\(X_{N-C-max}^{phy}\\) are the specified (or default) minimum and maximum ratios of internal nitrogen to carbon in the phytoplankton group being considered, respectively, \\(\\left[N\\right]_{avail}\\) is the available (water column) nitrogen pool on which phytoplankton can draw for primary productivity, and is the sum of inorganic (ammonium and nitrate) nitrogen, \\(\\left[N\\right]_{min}^{phy}\\) is the nitrogen concentration below which phytoplankton is no longer permitted to uptake nitrogen and \\(K_{lim-N}^{phy}\\) is the half saturation nitrogen concentration for phytoplankton uptake. These last three parameters (and the last term in Equation (K.4)) are the same as that applied to the basic phytoplankton constituent model as per Equation (K.2), via calculation of the limitation function applied to \\(R_{prod\\langle computed\\rangle}^{phy}\\) (as per Equation (J.9)). Equation (K.4) reveals the following: The uptake of water column nitrogen to internal phytoplankton stores is governed by the specified (or default) nitrogen uptake rate This rate is modified by Temperature, using the specified (or default) temperature limitation model for uptake (Section J.2) The current internal nitrogen concentrations, relative to the specified (or default) minima and maxima Ambient water column inorganic nitrogen concentrations, and The half saturation nitrogen concentration for uptake, which is the same parameter as used in the basic phytoplankton constituent model If for example the internal nitrogen concentration \\(\\left[IN\\right]\\) at a particular timestep and computational cell is equal to \\(X_{N-C-max}^{phy} \\times \\left[PHY\\right]\\), then Equation (K.4) has that internal nitrogen stores are full and that uptake is therefore zero. Conversely, if \\(\\left[IN\\right]\\) at a particular timestep and computational cell is equal to \\(X_{N-C-min}^{phy} \\times \\left[PHY\\right]\\), then internal nitrogen stores are at their lowest and therefore (in themselves) do not limit uptake of water column nitrogen. Finally, if the available water column nitrogen \\(\\left[N\\right]_{avail}\\) is equal to the specified (or default) minimum allowable nitrogen concentration for uptake \\(\\left[N\\right]_{min}^{phy}\\), then uptake to internal nutrient stores is zero. If uptake from the water column to internal stores occurs, then the split between ammonium and nitrate uptake is computed as per Equation (K.3). The parameter \\(K_{lim-N}^{phy}\\) is the same as that used for calculation of the nitrogen limitation function in the advanced phytoplankton constituent model if internal nitrogen stores are exhausted, so its specification should be considered in terms of its influence on both uptake on limitation. K.2.3 Nitrogen fixing If nitrogen fixing by phytoplankton is simulated, then a modification to the above computed nitrogen uptakes (for both the basic and advanced phytoplankton constituent models) is applied. The flux of atmospheric nitrogen is computed as per Equation (K.5). \\[\\begin{equation} F_{N-fix}^{phy} = R_{N-fix}^{phy} \\times \\left(1.0 - L_{nit}^{phy}\\right) \\times \\left[PHY\\right] \\tag{K.5} \\end{equation}\\] \\(F_{N-fix}^{phy}\\) is the fixing of atmospheric nitrogen, \\(R_{N-fix}^{phy}\\) is the specified (or default) rate of nitrogen fixing, \\(L_{nit}^{phy}\\) is the nitrogen limitation function computed via either Equation (J.9) or (J.11) for the basic and advanced phytoplankton constituent models, respectively, before \\(L_{nit}^{phy}\\) is set to one. Once computed, \\(F_{N-uptake}^{phy}\\) is modified as follows: If \\(|F_{N-fix}^{phy}| \\ge |F_{N-uptake}^{phy}|\\) then all uptake is assigned to \\(F_{N-fix}^{phy}\\), and \\(F_{N-uptake}^{phy}\\) is set to zero. If If \\(|F_{N-fix}^{phy}| \\le |F_{N-uptake}^{phy}|\\) then nitrogen water column uptake is reduced as per Equation (K.6). \\[\\begin{equation} F_{N-uptake\\langle computed \\rangle}^{phy} = F_{N-uptake}^{phy} \\times \\frac{\\left(|F_{N-uptake}^{phy}| - F_{N-fix}^{phy}\\right)}{|F_{N-uptake}^{phy}|} \\tag{K.6} \\end{equation}\\] Equation (K.6) is a simple linearisation that maps \\(F_{N-uptake\\langle computed \\rangle}^{phy}\\) to a value between 0.0 (where \\(F_{N-fix}^{phy} = F_{N-uptake}^{phy}\\)) and \\(F_{N-uptake\\langle computed \\rangle}^{phy}\\) (where \\(F_{N-fix}^{phy}\\) is zero). K.3 Phosphorus The WQ Module allows for phytoplankton to uptake filterable reactive phosphorus (i.e. inorganic phosphorus, FRP) to meet primary production phosphorus demands. The parallel uptake of organic phosphorus (i.e. simulation of mixotrophic phytoplankton) is not yet implemented within the WQ Module. Uptake is computed differently for the basic and advanced phytoplankton constituent models K.3.1 Basic phytoplankton constituent model If internal phytoplankton nutrients are not simulated dynamically, phosphorus uptake is calculated as per Equation (K.7). \\[\\begin{equation} F_{P-uptake}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times \\left[PHY\\right] \\times X_{P-C-con}^{phy} \\tag{K.7} \\end{equation}\\] \\(F_{P-uptake}^{phy}\\) is the uptake of inorganic phosphorus, \\(R_{prod\\langle computed\\rangle}^{phy}\\) is the computed primary productivity rate, \\(\\left[PHY\\right]\\) is a computational cell’s phytoplankton concentration and \\(X_{P-C-con}^{phy}\\) is the specified (or default) constant ratio of internal phosphorus to carbon in the phytoplankton group being considered. This flux (whether computed from Equation (K.7) or (K.8)) is summed over all simulated phytoplankton groups to compute the community FRP uptake, \\(F_{P-uptake\\langle computed\\rangle}^{comm}\\). K.3.2 Advanced phytoplankton constituent model If internal phytoplankton nutrients are simulated dynamically, phosphorus uptake is calculated as per Equation (K.8). \\[\\begin{equation} F_{P-uptake}^{phy} = R_{P-uptake}^{phy} \\times L_{T}^{phy} \\times \\left[PHY\\right] \\times \\frac{\\left(X_{P-C-max}^{phy} - \\frac{\\left[IP\\right]}{\\left[PHY\\right]}\\right)}{\\left(X_{P-C-max}^{phy} - X_{P-C-min}^{phy}\\right)} \\times \\frac{\\left(\\left[P\\right]_{avail} - \\left[P\\right]_{min}^{phy}\\right)}{\\left(\\left[P\\right]_{avail} - \\left[P\\right]_{min}^{phy}\\right) + K_{lim-P}^{phy}} \\tag{K.8} \\end{equation}\\] \\(F_{P-uptake}^{phy}\\) is the uptake of water column FRP, \\(R_{P-uptake}^{phy}\\) is the specified (or default) rate of uptake of FRP, \\(L_{T}^{phy}\\) is the temperature limitation function, \\(\\left[PHY\\right]\\) and \\(\\left[IP\\right]\\) are a computational cell’s phytoplankton and internal phosphorus concentrations respectively, \\(X_{P-C-min}^{phy}\\) and \\(X_{P-C-max}^{phy}\\) are the specified (or default) minimum and maximum ratios of internal phosphorus to carbon in the phytoplankton group being considered, respectively, \\(\\left[P\\right]_{avail}\\) is the available (i.e. ambient water column) FRP pool on which phytoplankton can draw for primary productivity, \\(\\left[P\\right]_{min}^{phy}\\) is the FRP concentration below which phytoplankton is no longer permitted to uptake phosphorus and \\(K_{lim-P}^{phy}\\) is the half saturation FRP concentration for phytoplankton uptake. These last three parameters (and the last term in Equation (K.8)) are the same as that applied to the basic phytoplankton constituent model as per Equation (K.7), via calculation of the limitation function applied to \\(R_{prod\\langle computed\\rangle}^{phy}\\) (as per Equation (J.13)). Equation (K.8) reveals the following: The uptake of water column FRP to internal phytoplankton stores is governed by the specified (or default) phosphorus uptake rate This rate is modified by Temperature, using the specified (or default) temperature limitation model for uptake (Section J.2) The current internal phosphorus concentrations, relative to the specified (or default) minima and maxima Ambient water column FRP concentrations, and The half saturation phosphorus concentration for uptake, which is the same parameter as used in the basic phytoplankton constituent model If for example the internal phosphorus concentration \\(\\left[IP\\right]\\) at a particular timestep and computational cell is equal to \\(X_{P-C-max}^{phy}\\times \\left[PHY\\right]\\), then Equation (K.8) has that internal phosphorus stores are full and that uptake is therefore zero. Conversely, if \\(\\left[IP\\right]\\) at a particular timestep and computational cell is equal to \\(X_{P-C-min}^{phy} \\times \\left[PHY\\right]\\), then internal phosphorus stores are at their lowest and therefore (in themselves) do not limit uptake of water column FRP. Finally, if the available water column FRP \\(\\left[P\\right]_{avail}\\) is equal to the specified (or default) minimum allowable FRP concentration for uptake \\(\\left[P\\right]_{min}^{phy}\\), then uptake to internal nutrient stores is zero. The parameter \\(K_{lim-P}^{phy}\\) is the same as that used for calculation of the phosphorus limitation function in the advanced phytoplankton constituent model if internal phosphorus stores are exhausted, so its specification should be considered in terms of its influence on both uptake on limitation. K.4 Silicate The WQ Module allows for phytoplankton to uptake silicate to meet primary production demands, for phytoplankton groups that require silicate. Silicate uptake is calculated as per Equation (K.9). \\[\\begin{equation} F_{Si-uptake}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times \\left[PHY\\right] \\times X_{Si-C-con}^{phy} \\tag{K.9} \\end{equation}\\] \\(F_{Si-uptake}^{phy}\\) is the uptake of silicate, \\(R_{prod\\langle computed\\rangle}^{phy}\\) is the computed primary productivity rate, \\(\\left[PHY\\right]\\) is a computational cell’s phytoplankton concentration and \\(X_{Si-C-con}^{phy}\\) is the specified (or default) constant ratio of internal silicate to carbon in the phytoplankton group being considered. "],["PhyLosses-3.html", "Appendix L Processes: phyto losses L.1 Carbon L.2 Nitrogen L.3 Phosphorus L.4 Silicate", " Appendix L Processes: phyto losses Once the respiration \\(R_{resp\\langle computed\\rangle}^{phy}\\) and exudation \\(R_{exud\\langle computed\\rangle}^{phy}\\) rates have been computed for a phytoplankton group via Equation (I.6) and Equation (I.12) respectively (and potentially Equation (I.7) if salinity limitation is activated), then those rates drive the mass losses of carbon, nitrogen, phosphorus and silicate. These losses are computed using a number of user specified (or default) parameters, and for each relevant computed variable, comprise the following: Excretion loss: Computed from a combination of respiration and exudation rates (\\(R_{resp\\langle computed\\rangle}^{phy}\\) and \\(R_{exud\\langle computed\\rangle}^{phy}\\), respectively), and Mortality loss: Computed from the respiration rate \\(R_{resp\\langle computed\\rangle}^{phy}\\) The specifics of the calculation of each relevant computed variable’s excretion and mortality are described following. Losses are denoted as fluxes, \\(F\\). L.1 Carbon Equation (L.1) describes the calculation of excretion losses. \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhyExcr}{F_{C-excr}^{phy}} = \\left(\\left[\\left(1 - f_{true-resp}^{phy}\\right) \\times f_{excr-loss}^{phy} \\times R_{resp\\langle computed\\rangle}^{phy}\\right] + R_{exud\\langle computed\\rangle}^{phy}\\right) \\times \\left[PHY\\right] \\tag{L.1} \\end{equation}\\] \\(F_{C-excr}^{phy}\\) is the excretive loss of carbon and \\(f_{true-resp}^{phy}\\) is the fraction of respiration that corresponds to the generation of energy via consumption of stored chlorophyll a (i.e. the fraction that does not result in excretive or mortality losses). In Equation (L.1), (1 - \\(f_{true-resp}^{phy}\\)) is therefore the respiration that is associated with the combined excretive and mortality losses, rather than energy production. \\(f_{excr-loss}^{phy}\\) is the fraction of this combined loss that is excretive only, \\(R_{resp\\langle computed\\rangle}^{phy}\\) and \\(R_{exud\\langle computed\\rangle}^{phy}\\) are the computed respiration and exudation rates, respectively and \\(\\left[PHY\\right]\\) is a computational cell’s phytoplankton concentration. Equation (L.2) describes the calculation of mortality losses of carbon. \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhyMort}{F_{C-mort}^{phy}} = \\left(\\left(1 - f_{true-resp}^{phy}\\right) \\times\\left(1 - f_{excr-loss}^{phy}\\right) \\times R_{resp\\langle computed\\rangle}^{phy}\\right) \\times \\left[PHY\\right] \\tag{L.2} \\end{equation}\\] \\(F_{C-mort}^{phy}\\) is the mortality loss of carbon and the other terms in Equation (L.2) as the same as Equation (L.1), noting the inclusion of (1 - \\(f_{excr-loss}^{phy}\\)) in Equation (L.2) to isolate the fraction of the combined excretive and mortality loss that is mortality only. As with primary productivity, carbon does not need to be explicitly simulated as a computed variable for these losses to occur, but because carbon is used as the units of accounting for phytoplankton biomass, its losses are computed by the WQ Module in order to report phytoplankton concentrations. Carbon stores to which the phytoplankton losses in Equations (L.1) and (L.2) deliver are assumed to be unlimited when carbon is not explicitly included in a simulation as a computed variable. The form of the entire multiplicative factors immediately preceding \\(\\left[PHY\\right]\\) in Equations (L.1) and (L.2) are presented in Figure L.1, as a function of \\(f_{excr-loss}^{phy}\\). Use the play button or drag the slider to see how different values of \\(f_{true-resp}^{phy}\\) change these multiplicative factors (ordinate), which are shown as functions of \\(f_{excr-loss}^{phy}\\) (abscissa). \\(R_{resp\\langle computed\\rangle}^{phy}\\) and \\(R_{exud\\langle computed\\rangle}^{phy}\\) are set to fixed values of 0.1 and 0.05 /day, respectively. Figure L.1: Move the slider to see the effect of changing \\(f_{true-resp}^{phy}\\) on the form of the multiplicative factors preceding \\([PHY]\\) in the above loss equations. \\(R_{resp&lt;computed&gt;}^{phy}\\) and \\(R_{exud&lt; computed&gt;}^{phy}\\) are set to fixed values of 0.1 and 0.05 /day, respectively To complement Figure L.1, the form of the entire multiplicative factors immediately preceding \\(\\left[PHY\\right]\\) in Equations (L.1) and (L.2) are again presented in Figure L.2, but as a function of \\(f_{true-resp}^{phy}\\). Use the play button or drag the slider to see how different values of \\(f_{excr-loss}^{phy}\\) change these multiplicative factors (ordinate), which are shown as functions of \\(f_{true-resp}^{phy}\\) (abscissa). \\(R_{resp\\langle computed\\rangle}^{phy}\\) and \\(R_{exud\\langle computed\\rangle}^{phy}\\) are again set to the same fixed values of 0.1 and 0.05 /day, respectively. Figure L.2: Move the slider to see the effect of changing \\(f_{excr-loss}^{phy}\\) on the form of the multiplicative factors preceding \\([PHY]\\) in the above loss equations. \\(R_{resp&lt;computed&gt;}^{phy}\\) and \\(R_{exud&lt; computed&gt;}^{phy}\\) are set to fixed values of 0.1 and 0.05 /day, respectively Some key features of the Figures L.1 and L.2 are as follows: If \\(f_{true-resp}^{phy}\\) is set to 1.0, then carbonaceous excretion losses are due solely to exudation, and mortality losses are zero. This is consistent with interpreting \\(f_{true-resp}^{phy}\\) as the fraction of respiration that is associated only with the re-release of energy through metabolism of carbon biomass generated and stored during antecedent phytoplanktonic photosynthesis Conversely, if \\(f_{true-resp}^{phy}\\) is set to 0.0, then (potentially unrealistically) respiration does not re-release any energy, but rather, sees the entire respiration rate expended on excretion of carbon biomass (subject to the value of \\(f_{excr-loss}^{phy}\\)) If \\(f_{excr-loss}^{phy}\\) is set to 1.0, then mortality losses are zero. This is consistent with interpreting this parameter as the proportion of combined excretive and mortality losses that are excretive. The converse applies for a \\(f_{excr-loss}^{phy}\\) of 0.0 Intermediate behaviours to the above limits can be inferred through interacting with Figures L.1 and L.2. L.2 Nitrogen Equation (L.3) describes the calculation of excretion losses. \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhyExcrN}{F_{N-excr}^{phy}} = \\left(\\left(f_{excr-loss}^{phy} \\times R_{resp\\langle computed\\rangle}^{phy}\\right) + R_{exud\\langle computed\\rangle}^{phy}\\right) \\times X_{N-C}^{phy} \\times \\left[PHY\\right] \\tag{L.3} \\end{equation}\\] \\(F_{N-excr}^{phy}\\) is the excretive loss of nitrogen, \\(f_{excr-loss}^{phy}\\) is the fraction of combined excretive and mortality losses that is excretive only, \\(R_{resp\\langle computed\\rangle}^{phy}\\) and \\(R_{exud\\langle computed\\rangle}^{phy}\\) are the computed respiration and exudation rates, respectively, and \\(\\left[PHY\\right]\\) is a computational cell’s phytoplankton concentration. If the basic phytoplankton constituent model is used, then \\(X_{N-C}^{phy}\\) is the specified (or default) constant ratio of internal nitrogen to carbon. If the advanced phytoplankton constituent model is used, then \\(X_{N-C}^{phy}\\) is the dynamically computed ratio of internal nitrogen to carbon concentrations, where this ratio varies only between the specified (or default) minimum and maximum ratios \\(X_{N-C-min}^{phy}\\) and \\(X_{N-C-max}^{phy}\\), respectively. Equation (L.4) describes the calculation of mortality losses. \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhyMortN}{F_{N-mort}^{phy}} = \\left(\\left(1 - f_{excr-loss}^{phy}\\right) \\times R_{resp\\langle computed\\rangle}^{phy}\\right) \\times X_{N-C}^{phy} \\times \\left[PHY\\right] \\tag{L.4} \\end{equation}\\] \\(F_{N-mort}^{phy}\\) is the mortality loss of nitrogen and the other terms in Equation (L.4) as the same as Equation (L.3), noting the inclusion of (1 - \\(f_{excr-loss}^{phy}\\)) in Equation (L.4) to isolate the fraction of the combined excretive and mortality loss that is mortality only. The key feature of Equations (L.3) and (L.4) is that if \\(f_{excr-loss}^{phy}\\) is set to 1.0, then mortality losses are zero. This is consistent with interpreting this parameter as the proportion of combined excretive and mortality losses that are excretive. The converse applies for a \\(f_{excr-loss}^{phy}\\) of 0.0. L.3 Phosphorus Equation (L.5) describes the calculation of excretion losses. \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhyExcrP}{F_{P-excr}^{phy}} = \\left(\\left(f_{excr-loss}^{phy} \\times R_{resp\\langle computed\\rangle}^{phy}\\right) + R_{exud\\langle computed\\rangle}^{phy}\\right) \\times X_{P-C}^{phy} \\times \\left[PHY\\right] \\tag{L.5} \\end{equation}\\] \\(F_{P-excr}^{phy}\\) is the excretive loss of phosphorus, \\(f_{excr-loss}^{phy}\\) is the fraction of combined excretive and mortality losses that is excretive only, \\(R_{resp\\langle computed\\rangle}^{phy}\\) and and \\(R_{exud\\langle computed\\rangle}^{phy}\\) are the computed respiration and exudation rates, respectively, and \\(\\left[PHY\\right]\\) is a computational cell’s phytoplankton concentration. If the basic phytoplankton constituent model is used, then \\(X_{P-C}^{phy}\\) is the specified (or default) constant ratio of internal phosphorus to carbon. If the advanced phytoplankton constituent model is used, then \\(X_{P-C}^{phy}\\) is the dynamically computed ratio of internal phosphorus to carbon concentrations, where this ratio varies only between the specified (or default) minimum and maximum ratios \\(X_{P-C-min}^{phy}\\) and \\(X_{P-C-max}^{phy}\\), respectively. Equation (L.6) describes the calculation of mortality losses. \\[\\begin{equation} \\href{AppDiags.html#WQDiagPhyMortP}{F_{P-mort}^{phy}} = \\left(\\left(1.0 - f_{excr-loss}^{phy}\\right) \\times R_{resp\\langle computed\\rangle}^{phy}\\right) \\times X_{P-C}^{phy} \\times \\left[PHY\\right] \\tag{L.6} \\end{equation}\\] \\(F_{P-mort}^{phy}\\) is the mortality loss of phosphorus and the other terms in Equation (L.6) as the same as Equation (L.5), noting the inclusion of (1 - \\(f_{excr-loss}^{phy}\\)) in Equation (L.6) to isolate the fraction of the combined excretive and mortality loss that is mortality only. As for nitrogen losses, the key feature of Equations (L.5) and (L.6) is that if \\(f_{excr-loss}^{phy}\\) is set to 1.0, then mortality losses are zero. This is consistent with interpreting this parameter as the proportion of combined excretive and mortality losses that are excretive. The converse applies for a \\(f_{excr-loss}^{phy}\\) of 0.0. L.4 Silicate Equation (L.7) describes the calculation of excretion losses, if silicate is included in phytoplanktonic calculations. \\[\\begin{equation} F_{Si-excr}^{phy} = \\left(\\left(f_{excr-loss}^{phy} \\times R_{resp\\langle computed\\rangle}^{phy}\\right) + R_{exud\\langle computed\\rangle}^{phy}\\right) \\times X_{Si-C}^{phy} \\times \\left[PHY\\right] \\tag{L.7} \\end{equation}\\] \\(F_{Si-excr}^{phy}\\) is the excretive loss of silicate, \\(f_{excr-loss}^{phy}\\) is the fraction of combined excretive and mortality losses that is excretive only, \\(R_{resp\\langle computed\\rangle}^{phy}\\) and and \\(R_{exud\\langle computed\\rangle}^{phy}\\) are the computed respiration and exudation rates, respectively, \\(X_{Si-C}^{phy}\\) is the specified (or default) constant ratio of internal silicate to carbon in the phytoplankton group being considered and \\(\\left[PHY\\right]\\) is a computational cell’s phytoplankton concentration. Equation (L.8) describes the calculation of mortality losses. \\[\\begin{equation} F_{Si-mort}^{phy} = \\left(\\left(1.0 - f_{excr-loss}^{phy}\\right) \\times R_{resp\\langle computed\\rangle}^{phy}\\right) \\times X_{Si-C}^{phy} \\times \\left[PHY\\right] \\tag{L.8} \\end{equation}\\] Some key features of the Equations (L.7) and (L.8) are as follows: As for nitrogen and phosphorus losses, the key feature of Equations (L.7) and (L.8) is that if \\(f_{excr-loss}^{phy}\\) is set to 1.0, then mortality losses are zero. This is consistent with interpreting this parameter as the proportion of combined excretive and mortality losses that are excretive. The converse applies for a \\(f_{excr-loss}^{phy}\\) of 0.0 Despite not simulating particulate silicate, Equations (L.7) and (L.8) nonetheless ensure that the mass of silicate delivered to the dissolved pool (that is simulated by the WQ Module) is consistent with that of carbon, nitrogen and phosphorus. "],["AppphyOther.html", "Appendix M Processes: phyto other M.1 Self shading M.2 Cell density", " Appendix M Processes: phyto other M.1 Self shading Photosynthetically available radiation is provided to the WQ Module from TUFLOW for each computational cell at each water quality timestep. It is this two- or three-dimensional field that the WQ Module uses to compute phytoplanktonic responses to light. The WQ Module allows, however, for modification of this TUFLOW field to incorporate the effect of light attenuation due to the presence of phytoplankton. This additional light extinction is computed dynamically at each water quality timestep, based on instantaneous phytoplanktonic concentrations in individual computational cells, as per Equation (M.1). \\[\\begin{equation} Ke_{\\langle computed \\rangle}^{phy} = Ke^{phy} \\times \\left[PHY\\right] \\tag{M.1} \\end{equation}\\] For each phytoplankton group, \\(Ke^{phy}\\) is the user specified (or default) self shading coefficient and \\(\\left[PHY\\right]\\) is the instantaneous phytoplankton concentration in each cell. For each cell and at each timestep, this quantity \\(Ke_{\\langle computed \\rangle}^{phy}\\) is computed for each phytoplankton group. Results are then summed within each cell and returned to TUFLOW as a two- or three-dimensional field which TUFLOW then includes these in subsequent light distribution calculations. M.2 Cell density The principle of the WQ Module density calculations is that cell density is set to increase during daylight primary production (when carbohydrates are created via photosynthesis) and decrease during darkness respiration (when carbohydrates are consumed). Equations (M.2) and (M.3) are used to describe these processes, respectively. \\[\\begin{equation} \\rho_{PHY\\langle computed \\rangle} = \\rho_{PHY} + \\frac{0.124 \\times \\left(1.0 - e^{\\frac{-PAR}{I_K}}\\right) - 0.0230}{60} \\tag{M.2} \\end{equation}\\] \\[\\begin{equation} \\rho_{PHY\\langle computed \\rangle} = \\rho_{PHY} - \\frac{0.0230}{60} \\tag{M.3} \\end{equation}\\] \\(\\rho_{PHY\\langle computed \\rangle}\\) and \\(\\rho_{PHY}\\) are the computed and initial (previous timestep) cell densities, respectively and \\(PAR\\) and \\(I_K\\) are the ambient cell photosynthetically active radiation and half saturation light intensity, respectively. \\(I_K\\) is specified via the light limitation function, or if not, then via the specification of the stokes settling model, or as the default. Computed cell densities are checked against specified (or default) global minima and maxima and reset to these limits if exceeded. Cell density is only used within the WQ Module to compute stokes settling, and need not be included as a computed variable if other settling models are deployed. "],["AppOrg.html", "Appendix N Processes: organic matter N.1 Sediment flux N.2 Hydrolysis N.3 Breakdown N.4 Mineralisation N.5 Activation N.6 Photolysis N.7 Self shading N.8 Settling", " Appendix N Processes: organic matter N.1 Sediment flux Dissolved organic carbon, nitrogen and phosphorus are exchanged between the water column and sediments via specification of separate sediment fluxes. In all cases, this flux is most commonly out of the sediments, i.e. a positive specification of sediment flux. Although it is rare that sediments act as sinks of these species, TUFLOW WQ Module can be parameterised to allow for this if required. Only labile dissolved organic matter is released from the sediments in the WQ Module, and as such, references to organics in this section should be interpreted as labile organics. The user specified rates of dissolved organic fluxes (which can be spatially varying) are modified by overlying ambient dissolved oxygen concentration (together with respective user specified half saturation oxygen concentrations) and water temperature. These modifications are simulated via Michaelis-Menten and Arrhenius models, respectively, as per Equation (N.1). \\[\\begin{equation} \\left.\\begin{aligned} \\href{AppDiags.html#WQDiagDOCSedFlx}{F_{sed\\langle computed\\rangle}^{DOC}} =&amp; F_{sed}^{DOC} \\times \\frac{K_{sed-O_2}^{DOM}}{K_{sed-O_2}^{DOM} + \\left[DO\\right]} \\times \\hphantom{\\text{ab}} \\left[\\theta_{sed}^{DOM}\\right]^{\\left(T-20\\right)} \\\\ \\\\ \\href{AppDiags.html#WQDiagDONSedFlx}{F_{sed\\langle computed\\rangle}^{DON}} =&amp; F_{sed}^{DON} \\times \\frac{K_{sed-O_2}^{DOM}}{K_{sed-O_2}^{DOM} + \\left[DO\\right]} \\times \\hphantom{\\text{ab}} \\left[\\theta_{sed}^{DOM}\\right]^{\\left(T-20\\right)} \\\\ \\\\ \\href{AppDiags.html#WQDiagDOPSedFlx}{F_{sed\\langle computed\\rangle}^{DOP}} =&amp; F_{sed}^{DOP} \\times \\underbrace{\\frac{K_{sed-O_2}^{DOM}}{K_{sed-O_2}^{DOM} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{\\vphantom{\\frac{\\left[DO\\right]}{K_{sed-O_2}^{NO_3} + \\left[DO\\right]}} \\left[\\theta_{sed}^{DOM}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\end{aligned}\\right\\} \\tag{N.1} \\end{equation}\\] \\(F_{sed}^{DOC}\\), \\(F_{sed}^{DON}\\) and \\(F_{sed}^{DOP}\\) are the user specified dissolved organic carbon, nitrogen and phosphorus sediment fluxes at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the overlying dissolved oxygen concentration, \\(K_{sed-O_2}^{DOM}\\) is the user specified half saturation concentration of dissolved oxygen for dissolved organic matter sediment flux, \\(\\theta_{sed}^{DOM}\\) is the corresponding temperature coefficient, and \\(T\\) is ambient water temperature. The values of \\(K_{sed-O_2}^{DOM}\\) and \\(\\theta_{sed}^{DOM}\\) are intentionally applied equally to dissolved organic carbon, nitrogen and phosphorus sediment fluxes. This is because there is one (not three) biological consumption process that generates these constituents: \\(K_{sed-O_2}^{DOM}\\) and \\(\\theta_{sed}^{DOM}\\) apply to this single process. In a similar vein, the user specifications for \\(F_{sed}^{DOC}\\), \\(F_{sed}^{DON}\\) and \\(F_{sed}^{DOP}\\) should not vary significantly in their relative proportions from the ratio that these typically occur in the organic matter being consumed (e.g. the Redfield ratio). As per silicate sediment flux (see Section E.1), the above equations lead to linearly varying ambient dissolved organics concentrations in the demonstration model when dissolved oxygen concentration, half saturation oxygen concentrations and ambient temperature are set to be constant. As per FRP simulation, the above equations also lead to the form of sediment release presented in Figures G.1 and G.2 when oxygen drawdown and temperature changes occur, respectively. N.2 Hydrolysis Hydrolysis is the pelagic biological conversion of labile particulate organic matter to labile dissolved organic matter. It is therefore a source of dissolved carbon, nitrogen and phosphorus, and a sink of the corresponding particulates. Hydrolysis neither consumes or produces dissolved oxygen or bioavailable inorganic nutrients. Hydrolysis is implemented within the labile organics constituent model of the WQ Module, and the term organic matter in this section therefore refers to labile organic matter. Refractory organic matter processes are described elsewhere. The pelagic hydrolysis rate is computed within the labile organics constituent model via Equation (N.2). \\[\\begin{equation} \\left.\\begin{aligned} R_{hyd\\langle computed\\rangle}^{POC} =&amp; R_{hyd}^{POC} \\times \\frac{\\left[DO\\right]}{K_{hyd-O_2}^{POM} + \\left[DO\\right]} \\times \\hphantom{\\text{ab}} \\left[\\theta_{hyd}^{POM}\\right]^{\\left(T-20\\right)} \\\\ \\\\ R_{hyd\\langle computed\\rangle}^{PON} =&amp; R_{hyd}^{PON} \\times \\frac{\\left[DO\\right]}{K_{hyd-O_2}^{POM} + \\left[DO\\right]} \\times \\hphantom{\\text{ab}} \\left[\\theta_{hyd}^{POM}\\right]^{\\left(T-20\\right)} \\\\ \\\\ R_{hyd\\langle computed\\rangle}^{POP} =&amp; R_{hyd}^{POP} \\times \\underbrace{\\frac{\\left[DO\\right]}{K_{hyd-O_2}^{POM} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{\\vphantom{\\frac{\\left[DO\\right]}{K_{sed-O_2}^{NO_3} + \\left[DO\\right]}} \\hphantom{\\text{ab}} \\left[\\theta_{hyd}^{POM}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\end{aligned}\\right\\} \\tag{N.2} \\end{equation}\\] \\(R_{hyd}^{POC}\\), \\(R_{hyd}^{PON}\\) and \\(R_{hyd}^{POP}\\) are the user specified particulate organic carbon, nitrogen and phosphorus hydrolysis rates at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the ambient dissolved oxygen concentration, \\(K_{hyd-O_2}^{POM}\\) is the user specified half saturation concentration of dissolved oxygen for particulate organic matter hydrolysis, \\(\\theta_{hyd}^{POM}\\) is the corresponding temperature coefficient, and \\(T\\) is ambient water temperature. As per sediment fluxes, the values of \\(K_{hyd-O_2}^{POM}\\) and \\(\\theta_{hyd}^{POM}\\) are intentionally applied equally to particulate organic carbon, nitrogen and phosphorus hydrolysis. This is because there is one (not three) biological consumption process that generates these constituents: \\(K_{hyd-O_2}^{POM}\\) and \\(\\theta_{hyd}^{POM}\\) apply to this single process. In a similar vein, the user specifications for \\(R_{hyd}^{POC}\\), \\(R_{hyd}^{PON}\\) and \\(R_{hyd}^{POP}\\) should not vary significantly in their relative proportions from the ratio that these typically occur in the organic matter being consumed (e.g. the Redfield ratio). N.2.1 Consumption The hydrolysis rates from Equation (N.2) are multiplied by their respective ambient particulate organic matter concentrations to compute their respective consumptive fluxes (losses) at each model timestep in each model cell via Equation (N.3). \\[\\begin{equation} \\left.\\begin{aligned} \\href{AppDiags.html#WQDiagPOCHydrol}{F_{hyd\\langle computed\\rangle}^{POC}} =&amp; R_{hyd\\langle computed\\rangle}^{POC} \\times \\left[ POC \\right] \\\\ \\\\ \\href{AppDiags.html#WQDiagPONHydrol}{F_{hyd\\langle computed\\rangle}^{PON}} =&amp; R_{hyd\\langle computed\\rangle}^{PON} \\times \\left[ PON \\right] \\\\ \\\\ \\href{AppDiags.html#WQDiagPOPHydrol}{F_{hyd\\langle computed\\rangle}^{POP}} =&amp; R_{hyd\\langle computed\\rangle}^{POP} \\times \\left[ POP \\right] \\end{aligned}\\right\\} \\tag{N.3} \\end{equation}\\] N.2.2 Production The consumptive fluxes from Equation (N.3) result in the dissolved organic productive fluxes in Equation (N.4). \\[\\begin{equation} \\left.\\begin{aligned} F_{hyd\\langle computed\\rangle}^{DOC} =&amp; F_{hyd\\langle computed\\rangle}^{POC} \\\\ \\\\ F_{hyd\\langle computed\\rangle}^{DON} =&amp; F_{hyd\\langle computed\\rangle}^{PON} \\\\ \\\\ F_{hyd\\langle computed\\rangle}^{DOP} =&amp; F_{hyd\\langle computed\\rangle}^{POP} \\end{aligned}\\right\\} \\tag{N.4} \\end{equation}\\] N.3 Breakdown Breakdown is the pelagic biological conversion of refractory particulate organic matter (which is a single computed variable) to three labile particulate organic matter computed variables. It is therefore a source of labile particulate organic carbon, nitrogen and phosphorus, and a sink of refractory particulate organic matter. Breakdown neither consumes or produces dissolved oxygen or bioavailable inorganic nutrients. Breakdown is implemented within the refractory organics constituent model of the WQ Module only, so the following does not apply if the labile organics constituent model is used. The pelagic breakdown rate of refractory particulate organic matter is computed via Equation (N.5). \\[\\begin{equation} R_{bdn\\langle computed\\rangle}^{RPOM} = R_{bdn}^{RPOM} \\times \\underbrace{\\frac{\\left[DO\\right]}{K_{hyd-O_2}^{POM} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{\\vphantom{\\frac{\\left[DO\\right]}{K_{sed-O_2}^{NO_3} + \\left[DO\\right]}} \\hphantom{\\text{ab}} \\left[\\theta_{hyd}^{POM}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{N.5} \\end{equation}\\] \\(R_{bdn}^{RPOM}\\)is the user specified (or default) refractory particulate organic matter breakdown rate at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the ambient dissolved oxygen concentration, \\(K_{hyd-O_2}^{POM}\\) is the user specified (or default) half saturation concentration of dissolved oxygen for labile particulate organic matter hydrolysis, \\(\\theta_{hyd}^{POM}\\) is the corresponding temperature coefficient, and \\(T\\) is ambient water temperature. The parameters \\(K_{hyd-O_2}^{POM}\\) and \\(\\theta_{hyd}^{POM}\\) used in Equation (N.5) are the same as those used for the hydrolysis calculations described in Section N.2 and specified via the associated labile organic matter hydrolysis command. N.3.1 Consumption The breakdown rate from Equation (N.5) is multiplied by the ambient refractory particulate organic matter concentration to compute its consumptive flux (loss) at each model timestep in each model cell via Equation (N.6). \\[\\begin{equation} \\href{AppDiags.html#WQDiagBdn}{F_{bdn\\langle computed\\rangle}^{RPOM}} = R_{bdn\\langle computed\\rangle}^{RPOM} \\times \\left[ RPOM \\right] \\tag{N.6} \\end{equation}\\] N.3.2 Production The consumptive flux from Equation (N.6) results in the labile particulate organic carbon, nitrogen and phosphorus productive fluxes in Equation (N.7). \\[\\begin{equation} \\left.\\begin{aligned} F_{bdn\\langle computed\\rangle}^{POC} =&amp; F_{bdn\\langle computed\\rangle}^{RPOM} \\\\ \\\\ F_{bdn\\langle computed\\rangle}^{PON} =&amp; F_{bdn\\langle computed\\rangle}^{RPOM} \\times X_N^{RPOM} \\\\ \\\\ F_{bdn\\langle computed\\rangle}^{POP} =&amp; F_{bdn\\langle computed\\rangle}^{RPOM} \\times X_P^{RPOM} \\end{aligned}\\right\\} \\tag{N.7} \\end{equation}\\] \\(X_N^{RPOM}\\) and \\(X_P^{RPOM}\\) are the user specified (or default) molar ratios of nitrogen and phosphorus to carbon within refractory particulate organic matter. These should not differ significantly from the Redfield ratios of 16/106 and 1/106, respectively. N.4 Mineralisation Mineralisation is the pelagic biological conversion of labile dissolved organic matter to dissolved inorganic carbon and nutrients. It is therefore a source of dissolved inorganic carbon, ammonium and filterable reactive phosphorus, and a sink of the corresponding labile dissolved organics. Mineralisation is conceptualised as comprising aerobic (i.e. consuming dissolved oxygen and (via denitrification) inorganic nitrate) and anaerobic components, and is implemented within the labile organics constituent model of the WQ Module. The term organic matter in this section therefore refers to labile organic matter. The same pelagic mineralisation rate is computed within the WQ Module for dissolved organic carbon, nitrogen and phosphorus via Equation (N.8). \\[\\begin{equation} R_{miner\\langle computed\\rangle}^{DOM} = R_{miner}^{DOM} \\times \\underbrace{\\left[\\underbrace{\\frac{\\left[DO\\right]}{K_{miner-O_2}^{DOM} + \\left[DO\\right]}}_{\\text{O2 consumption}} + \\underbrace{f_{an} \\times \\frac{K_{miner-O_2}^{DOM}}{K_{miner-O_2}^{DOM} + \\left[DO\\right]}}_{\\text{non-O2 consumption}}\\right]}_{\\text{Influence of oxygen}} \\times \\underbrace{\\vphantom{\\left[\\underbrace{\\frac{\\left[DO\\right]}{K_{miner-O_2}^{DOM} + \\left[DO\\right]}}_{\\text{aerobic}} + \\underbrace{f_{an} \\times \\frac{K_{miner-O_2}^{DOM}}{K_{miner-O_2}^{DOM} + \\left[DO\\right]}}_{\\text{anaerobic}}\\right]} \\hphantom{\\text{ab}} \\left[\\theta_{miner}^{DOM}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{N.8} \\end{equation}\\] \\(R_{miner}^{DOM}\\) is the user specified (or default) dissolved organic matter (i.e. carbon, nitrogen and phosphorus) mineralisation rate at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the ambient dissolved oxygen concentration, \\(K_{miner-O_2}^{DOM}\\) is the user specified half saturation concentration of dissolved oxygen for dissolved organic matter mineralisation, \\(\\theta_{miner}^{DOM}\\) is the corresponding temperature coefficient, \\(f_{an}\\) is a fractional multiplier that weights the Michaelis-Menten contribution of non-O\\(_2\\) processes within the calculation of total mineralisation and \\(T\\) is ambient water temperature. As per sediment fluxes and hydrolysis, the values of \\(K_{miner-O_2}^{DOM}\\) and \\(\\theta_{miner}^{DOM}\\) are intentionally applied equally to dissolved organic carbon, nitrogen and phosphorus mineralisation. In addition, the rate at which mineralisation of dissolved organic matter (to inorganics) occurs is the same for all dissolved organic constituents. This is because there is one (not three) biological conversion process that is assumed to draw equally on all dissolved organic constituents. Finally, setting \\(f_{an}\\) to zero does not suppress entirely non-O\\(_2\\) mineralisation (see following section), but it does remove the Michaelis-Menten based influence of anaerobic processes on the calculation of total mineralisation. N.4.1 Consumption The mineralisation rate from Equation (N.8) is multiplied by ambient labile dissolved organic carbon, nitrogen and phosphorus concentrations to compute their respective consumptive fluxes (losses) at each model timestep in each model cell via Equation (N.9). \\[\\begin{equation} \\left.\\begin{aligned} \\href{AppDiags.html#WQDiagDOCMiner}{F_{miner\\langle computed\\rangle}^{DOC}} =&amp; R_{miner\\langle computed\\rangle}^{DOM} \\times \\left[ DOC \\right] \\\\ \\\\ \\href{AppDiags.html#WQDiagDONMiner}{F_{miner\\langle computed\\rangle}^{DON}} =&amp; R_{miner\\langle computed\\rangle}^{DOM} \\times \\left[ DON \\right] \\\\ \\\\ \\href{AppDiags.html#WQDiagDOPMiner}{F_{miner\\langle computed\\rangle}^{DOP}} =&amp; R_{miner\\langle computed\\rangle}^{DOM} \\times \\left[ DOP \\right] \\end{aligned}\\right\\} \\tag{N.9} \\end{equation}\\] The fraction of dissolved organic carbon mineralisation that consumes dissolved oxygen \\(O_2\\) is given by Equation (N.10). \\(K_{miner-O_2}^{DOM}\\), \\(\\left[DO\\right]\\) and \\(f_{an}\\) have been described previously. \\[\\begin{equation} f_{miner-O_2\\langle computed\\rangle}^{DOC} = \\frac{\\frac{\\left[DO\\right]}{K_{miner-O_2}^{DOM} + \\left[DO\\right]}}{\\frac{\\left[DO\\right]}{K_{miner-O_2}^{DOM} + \\left[DO\\right]} + f_{an} \\times \\frac{K_{miner-O_2}^{DOM}}{K_{miner-O_2}^{DOM} + \\left[DO\\right]}} \\tag{N.10} \\end{equation}\\] Applying a 1:1 molar ratio of mineralised dissolved organic carbon to consumed diatomic dissolved oxygen, gives the consumptive oxygen flux \\(F_{miner\\langle computed\\rangle}^{O_2}\\) as: \\[\\begin{equation} F_{miner\\langle computed\\rangle}^{O_2} = F_{miner\\langle computed\\rangle}^{DOC} \\times f_{miner-O_2\\langle computed\\rangle}^{DOC} \\tag{N.11} \\end{equation}\\] Substituting Equations (N.8) and (N.9) into Equation (N.11) and cancelling terms gives the final expression for \\(F_{miner\\langle computed\\rangle}^{O_2}\\) as Equation (N.12), again with parameters described previously. \\[\\begin{equation} F_{miner\\langle computed\\rangle}^{O_2} = F_{miner\\langle computed\\rangle}^{DOC} \\times \\frac{\\left[DO\\right]}{K_{miner-O_2}^{DOM} + \\left[DO\\right]} \\tag{N.12} \\end{equation}\\] This is also expressed as the reduction of ambient dissolved oxygen concentration that would result from this consumptive mineralisation over a period of five days. It is a common laboratory reporting unit and referred to as BOD5 (biological oxygen demand over 5 days). BOD5 is computed as per Equation (N.13). \\[\\begin{equation} \\href{AppDiags.html#WQDiagDOCBDO5}{BOD5_{\\langle computed\\rangle}^{O_2}} = F_{miner\\langle computed\\rangle}^{O_2} \\times 5 \\tag{N.13} \\end{equation}\\] A portion of remaining mineralisation (\\(F_{miner\\langle computed\\rangle}^{DOC} - F_{miner\\langle computed\\rangle}^{O_2}\\)) flux (that follows dissolved oxygen consumption) sources its oxygen from ambient nitrate. This consumptive flux of nitrate \\(F_{miner\\langle computed\\rangle}^{NO_3}\\) is referred to as denitrification and is the reduction of nitrate N to free diatomic nitrogen gas. Again applying a 1:1 molar ratio of consumed dissolved organic carbon to nitrate, this is quantity is computed via Equation (N.14). \\[\\begin{equation} \\href{AppDiags.html#WQDiagDOCDenitrif}{F_{miner\\langle computed\\rangle}^{NO_3}} = \\left(F_{miner\\langle computed\\rangle}^{DOC} - F_{miner\\langle computed\\rangle}^{O_2}\\right) \\times \\frac{\\left[NO_3\\right]}{K_{miner-NO_3}^{NO_3} + \\left[NO_3\\right]} \\tag{N.14} \\end{equation}\\] \\(K_{miner-NO_3}^{NO_3}\\) is the user specified half saturation concentration of nitrate for consumption of nitrate as result of mineralisation of dissolved organic carbon and \\(\\left[NO_3\\right]\\) is the ambient nitrate concentration. The remaining dissolved organic carbon mineralisation flux is referred to as anaerobic mineralisation, \\(F_{miner\\langle computed\\rangle}^{an}\\), such that the following overall molar equality applies (with \\(O2\\) and \\(NO_3\\) being in a 1:1 molar ration with their respective carbon fluxes): \\[\\begin{equation} F_{miner\\langle computed\\rangle}^{DOC} = F_{miner\\langle computed\\rangle}^{O_2} + F_{miner\\langle computed\\rangle}^{NO_3} + \\href{AppDiags.html#WQDiagDOCAnMiner}{F_{miner\\langle computed\\rangle}^{an}} \\tag{N.15} \\end{equation}\\] In summary: \\(F_{miner\\langle computed\\rangle}^{DOC}\\) is the total mineralisation flux of DOC to dissolved inorganics \\(F_{miner\\langle computed\\rangle}^{O_2}\\) is the portion of the total mineralisation flux that uses dissolved oxygen as its oxygen source. The flux of DOC and dissolved oxygen are applied as a 1:1 molar ratio \\(F_{miner\\langle computed\\rangle}^{NO_3}\\) is the portion of the total mineralisation flux that uses nitrate as its oxygen source. The flux of DOC and nitrate are applied as a 1:1 molar ratio \\(F_{miner\\langle computed\\rangle}^{an}\\) is the remaining portion of the total mineralisation flux that uses no oxygen. It consumes no computed variables other than DOC All these mineralisation diagnostic variables are reported in units of carbon. N.4.2 Production The consumptive flux from Equation (N.6) results in the inorganic carbon, ammonium and FRP productive fluxes in Equation (N.16). \\[\\begin{equation} \\left.\\begin{aligned} F_{miner\\langle computed\\rangle}^{DIC} =&amp; F_{miner\\langle computed\\rangle}^{DOC} \\\\ \\\\ F_{miner\\langle computed\\rangle}^{NH_4} =&amp; F_{miner\\langle computed\\rangle}^{DON} \\\\ \\\\ F_{miner\\langle computed\\rangle}^{FRP} =&amp; F_{miner\\langle computed\\rangle}^{DOP} \\end{aligned}\\right\\} \\tag{N.16} \\end{equation}\\] The WQ Module does not currently support simulation of dissolved inorganic carbon (DIC) so the corresponding carbonic productive flux in Equation (N.16) has no effect on inorganic water quality dynamics. Contact support@tuflow.com if the DIC model is required. N.5 Activation Activation is the pelagic biological conversion of refractory dissolved organic carbon, nitrogen and phosphorus to their respective labile dissolved organic equivalents. It is therefore a source of dissolved labile organic carbon, nitrogen and phosphorus, and a sink of the corresponding refractory dissolved organics. Activation does not consume or produce any other computed variables, although its computed rate does depend on dissolved oxygen concentration. The pelagic activation rate is computed within the WQ Module for refractory dissolved organic carbon, nitrogen and phosphorus via Equation (N.17). \\[\\begin{equation} R_{act\\langle computed\\rangle}^{RDOM} = R_{act}^{RDOM} \\times \\underbrace{\\left[\\underbrace{\\frac{\\left[DO\\right]}{K_{miner-O_2}^{DOM} + \\left[DO\\right]}}_{\\text{aerobic}} + \\underbrace{f_{an} \\times \\frac{K_{miner-O_2}^{DOM}}{K_{miner-O_2}^{DOM} + \\left[DO\\right]}}_{\\text{anaerobic}}\\right]}_{\\text{Influence of oxygen}} \\times \\underbrace{\\vphantom{\\left[\\underbrace{\\frac{\\left[DO\\right]}{K_{miner-O_2}^{DOM} + \\left[DO\\right]}}_{\\text{aerobic}} + \\underbrace{f_{an} \\times \\frac{K_{miner-O_2}^{DOM}}{K_{miner-O_2}^{DOM} + \\left[DO\\right]}}_{\\text{anaerobic}}\\right]} \\hphantom{\\text{ab}} \\left[\\theta_{miner}^{DOM}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{N.17} \\end{equation}\\] \\(R_{act}^{RDOM}\\) is the user specified refractory dissolved organic matter (i.e. carbon, nitrogen and phosphorus) activation rate at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the ambient dissolved oxygen concentration, \\(K_{miner-O_2}^{DOM}\\) is the user specified half saturation concentration of dissolved oxygen for dissolved organic matter mineralisation, \\(\\theta_{miner}^{DOM}\\) is the corresponding temperature coefficient, \\(f_{an}\\) is a fractional multiplier that weights the Michaelis-Menten contribution of non-O\\(_2\\) processes within the calculation of total mineralisation and \\(T\\) is ambient water temperature. The parameters \\(K_{miner-O_2}^{DOM}\\), \\(f_{an}\\) and \\(\\theta_{miner}^{DOM}\\) used in Equation (N.17) are the same as those used for the mineralisation calculations described in Section N.4 and specified via the associated labile organic matter mineralisation command. If this is the case and labile organic matter mineralisation is not required as a simulated process, then the command can still be issued but with the first argument, \\(R_{miner}^{DOM}\\), equal to zero. N.5.1 Consumption The activation rate from Equation (N.17) is multiplied by the ambient refractory dissolved carbon, nitrogen and phosphorus concentrations to compute their respective consumptive fluxes (losses) at each model timestep in each model cell via Equation (N.18). \\[\\begin{equation} \\left.\\begin{aligned} \\href{AppDiags.html#WQDiagActC}{F_{act\\langle computed\\rangle}^{RDOC}} =&amp; R_{act\\langle computed\\rangle}^{RDOM} \\times \\left[ RDOC \\right] \\\\ \\\\ \\href{AppDiags.html#WQDiagActN}{F_{act\\langle computed\\rangle}^{RDON}} =&amp; R_{act\\langle computed\\rangle}^{RDOM} \\times \\left[ RDON \\right] \\\\ \\\\ \\href{AppDiags.html#WQDiagActP}{F_{act\\langle computed\\rangle}^{RDOP}} =&amp; R_{act\\langle computed\\rangle}^{RDOM} \\times \\left[ RDOP \\right] \\end{aligned}\\right\\} \\tag{N.18} \\end{equation}\\] N.5.2 Production The consumptive flux from Equation (N.18) results in the labile dissolved organic carbon, nitrogen and phosphorus productive fluxes in Equation (N.19). \\[\\begin{equation} \\left.\\begin{aligned} F_{act\\langle computed\\rangle}^{DOC} =&amp; F_{act\\langle computed\\rangle}^{RDOC} \\\\ \\\\ F_{act\\langle computed\\rangle}^{DON} =&amp; F_{act\\langle computed\\rangle}^{RDON} \\\\ \\\\ F_{act\\langle computed\\rangle}^{DOP} =&amp; F_{act\\langle computed\\rangle}^{RDOP} \\end{aligned}\\right\\} \\tag{N.19} \\end{equation}\\] N.6 Photolysis The WQ Module conceptualises photolysis as the conversion of refractory dissolved organic carbon, nitrogen and phosphorus to their labile dissolved and inorganic equivalents, under the action of photosynthetically active (PAR), ultraviolet A (UVA) and ultraviolet B (UVB) radiation. These radiation bands are provided to the WQ Module from TUFLOW for each computational cell at each water quality timestep. The WQ Module computes total photolysis of refractory dissolved organic carbon \\(F_{photo-tot}^{RDOC}\\) as the sum of photolysis due to each of these three bands via Equation (N.20). \\[\\begin{equation} F_{photo-tot}^{RDOC} = F_{photo-PAR}^{RDOC} + F_{photo-UVA}^{RDOC} + F_{photo-UVB}^{RDOC} \\tag{N.20} \\end{equation}\\] Each band’s photolysis is computed via Equation (N.21), with Radiation\\(_{band}\\) (where band is PAR, UVA or UVB) being previously converted from \\(W/m^2\\) (as provided by TUFLOW) to moles of photons. \\[\\begin{equation} F_{photo-band}^{RDOC} = \\text{Radiation$_{band}$} \\times \\underbrace{c \\times 10^{-d \\times \\lambda_{band}}}_{\\text{Apparent quantum yield}} \\times \\underbrace{CDOM \\times e^{S\\times(x-\\lambda_{band})}}_{\\text{Absorption coefficient}} \\tag{N.21} \\end{equation}\\] where \\(c\\) = 7.52, \\(d\\) = 0.0122, \\(\\lambda_{band}\\) is each band’s characteristic wavelength, \\(S\\) = 0.0188 and \\(x\\) = 440.0 nm. \\(CDOM\\) is chromomorphic dissolved organic matter and is computed via Equation (N.22). \\[\\begin{equation} \\href{AppDiags.html#WQDiagCDOM}{CDOM_{\\langle computed \\rangle}} = 0.35 \\times e^{0.1922\\times \\left( \\left[DOC\\right] + \\left[RDOC\\right]\\right) \\times (12/1000)} \\tag{N.22} \\end{equation}\\] \\(\\left[DOC\\right]\\) and \\(\\left[RDOC\\right]\\) and the ambient concentrations of labile and refractory dissolved organic carbon, respectively. N.6.1 Consumption Once total photolysis has been computed, the associated consumptive fluxes (losses) of refractory dissolved organic carbon, nitrogen and phosphorus are computed via Equation (N.23), using ambient refractory dissolved nitrogen and phosphorus concentrations to proportion the computed fluxes. \\[\\begin{equation} \\left.\\begin{aligned} \\href{AppDiags.html#WQDiagPhoto}{F_{photo\\langle computed\\rangle}^{RDOC}} =&amp; F_{photo-tot}^{RDOC} \\\\ \\\\ F_{photo\\langle computed\\rangle}^{RDON} =&amp; F_{photo-tot}^{RDOC} \\times \\frac{\\left[RDON\\right]}{\\left[RDOC\\right]} \\\\ \\\\ F_{photo\\langle computed\\rangle}^{RDOP} =&amp; F_{photo-tot}^{RDOC} \\times \\frac{\\left[RDOP\\right]}{\\left[RDOC\\right]} \\end{aligned}\\right\\} \\tag{N.23} \\end{equation}\\] N.6.2 Production The consumptive fluxes from Equation (N.23) result in the labile dissolved organic carbon, nitrogen and phosphorus productive fluxes in Equation (N.24). \\[\\begin{equation} \\left.\\begin{aligned} F_{photo\\langle computed\\rangle}^{DOC} =&amp; F_{photo\\langle computed\\rangle}^{RDOC} \\times f_{photo}^{RDOM} \\\\ \\\\ F_{photo\\langle computed\\rangle}^{DON} =&amp; F_{photo\\langle computed\\rangle}^{RDON} \\times f_{photo}^{RDOM} \\\\ \\\\ F_{photo\\langle computed\\rangle}^{DOP} =&amp; F_{photo\\langle computed\\rangle}^{RDOP} \\times f_{photo}^{RDOM} \\end{aligned}\\right\\} \\tag{N.24} \\end{equation}\\] \\(f_{photo}^{RDOM}\\) is the proportion of the total photolysed refractory dissolved organic matter that becomes the corresponding labile organics. The remainder of the photolysed refractory dissolved organic matter fluxes produce inorganic carbon and nutrients via Equation (N.25). \\[\\begin{equation} \\left.\\begin{aligned} F_{photo\\langle computed\\rangle}^{DIC} =&amp; F_{photo\\langle computed\\rangle}^{RDOC} \\times \\left(1.0 - f_{photo}^{RDOM}\\right) \\\\ \\\\ F_{photo\\langle computed\\rangle}^{NH_4} =&amp; F_{photo\\langle computed\\rangle}^{RDON} \\times \\left(1.0 - f_{photo}^{RDOM}\\right) \\\\ \\\\ F_{photo\\langle computed\\rangle}^{FRP} =&amp; F_{photo\\langle computed\\rangle}^{RDOP} \\times \\left(1.0 - f_{photo}^{RDOM}\\right) \\end{aligned}\\right\\} \\tag{N.25} \\end{equation}\\] The WQ Module does not currently support simulation of dissolved inorganic carbon (DIC) so the corresponding carbonic productive flux in Equation (N.25) has no effect on inorganic water quality dynamics. Contact support@tuflow.com if the DIC model is required. N.7 Self shading Photosynthetically available radiation is provided to the WQ Module from TUFLOW for each computational cell at each water quality timestep. The WQ Module allows for modification of this TUFLOW field to incorporate the effect of light attenuation due to the presence of particulate and dissolved organic matter. This additional light extinction is computed dynamically at each water quality timestep, based on instantaneous organic matter concentrations in individual computational cells. For labile organics, the associated additive specific light attenuation coefficient is computed as per Equation (N.26). \\[\\begin{equation} Ke_{\\langle computed \\rangle}^{OM} = Ke^{POM} \\times \\left[POC\\right] + Ke^{DOM} \\times \\left[DOC\\right] \\tag{N.26} \\end{equation}\\] \\(Ke^{POM}\\) and \\(Ke^{DOM}\\) are the user specified (or default) specific shading coefficients for labile particulate and dissolved organic matter respectively, and \\(\\left[POC\\right]\\) and \\(\\left[DOC\\right]\\) are the ambient labile particulate and dissolved organic carbon concentrations (used as proxies for organic matter) in each cell. For each cell and at each timestep, this quantity \\(Ke_{\\langle computed \\rangle}^{OM}\\) is computed and returned to TUFLOW as a two- or three-dimensional field which TUFLOW then includes these in subsequent light distribution calculations. For refractory organics (if computed), the associated additive specific light attenuation coefficient is computed as per Equation (N.27). \\[\\begin{equation} Ke_{\\langle computed \\rangle}^{ROM} = R_{CDOM}^{RDOM} \\times CDOM + Ke^{RPOM} \\times \\left[RPOM\\right] \\tag{N.27} \\end{equation}\\] \\(R_{CDOM}^{RDOM}\\) is a user specified (or default) dimensionless multiplier applied to the CDOM computed in Equation (N.22), where the same CDOM is used in photolysis calculations. \\(R_{CDOM}^{RDOM}\\) is not a specific shading coefficient, but can be thought of as (light attenuation (/m) / CDOM (/m)), or the strength of CDOM in attenuating light. \\(Ke^{RPOM}\\) is the user specified (or default) specific shading coefficient for refractory particulate organic matter, and \\(\\left[RPOM\\right]\\) is the instantaneous refractory particulate organic matter concentration in each cell. For each cell and at each timestep, this quantity \\(Ke_{\\langle computed \\rangle}^{ROM}\\) is computed and returned to TUFLOW as a two- or three-dimensional field which TUFLOW then includes these in subsequent light distribution calculations. N.8 Settling Particulate organic matter is able to be settled within the WQ Module. Four settling models are available. These are able to be applied equally to both labile and refractory particulate organic matter to compute \\(V_{settle}^{lorg}\\) and \\(V_{settle}^{rorg}\\), respectively. The same settling model must be applied to both types of particulates, although the parameters ascribed to a model can be different for labile and refractory particulates. Once computed, the same settling rate is applied to each of labile particulate organic carbon, nitrogen and phosphorus. N.8.1 None In this model, particulate organic settling is set to zero and organic matter is simply advected by the hydrodynamic flow field. N.8.2 Constant In this model, \\(V_{settle}^{lorg}\\) and \\(V_{settle}^{rorg}\\) are set to constant values, and matter is settled at these velocities. These can be different velocities for labile and refractory particulate organics. A negative specification of this quantity corresponds to a downwards settling velocity. N.8.3 Constant with density correction In this model, \\(V_{settle}^{lorg}\\) and \\(V_{settle}^{rorg}\\) are set to constant values, and matter is settled at these velocities, but corrected for ambient water density effects, as per Equation (N.28). \\[\\begin{equation} V_{sett\\langle computed\\rangle}^{org} = V_{settle}^{org} \\times \\frac{\\mu_{20}\\times\\rho_w}{\\mu\\times\\rho_{w20}} \\tag{N.28} \\end{equation}\\] \\(V_{settle}^{org}\\) is \\(V_{settle}^{lorg}\\) or \\(V_{settle}^{rorg}\\) at 20\\(^o\\)C, \\(\\mu\\) and \\(\\rho_w\\) are the ambient water dynamic viscosity (in Ns/m\\(^2\\)) and density (in kg/m\\(^3\\)), respectively, and \\(\\mu_{20}\\) and \\(\\rho_{w20}\\) are the dynamic viscosity and density of freshwater at 20\\(^o\\)C, respectively. A negative specification of \\(V_{settle}^{org}\\) corresponds to a downwards settling velocity. N.8.4 Stokes In this model, particulate organic settling is computed using the Stokes equation and particle diameter and density, as per Equations (N.29) and (N.30). \\[\\begin{equation} V_{sett\\langle computed\\rangle}^{lorg} = -g \\times d_{lorg}^2 \\times \\frac{\\left(\\rho_{lorg}-\\rho_w\\right)}{18\\mu} \\tag{N.29} \\end{equation}\\] \\[\\begin{equation} V_{sett\\langle computed\\rangle}^{rorg} = -g \\times d_{rorg}^2 \\times \\frac{\\left(\\rho_{rorg}-\\rho_w\\right)}{18\\mu} \\tag{N.30} \\end{equation}\\] \\(g\\) is acceleration due to gravity, \\(d_{lorg}\\) and \\(d_{rorg}\\) are conceptualised diameters of labile and refractory particulate organic matter respectively, \\(\\rho_{lorg}\\) and \\(\\rho_{rorg}\\) are labile and refractory particulate organic matter densities, respectively, and \\(\\rho_w\\) and \\(\\mu\\) are the ambient water density and dynamic viscosity, respectively. Once the settling velocities for labile and refractory particulate organic matter have been computed, the relevant fluxes are calculated as follows. \\[\\begin{equation} \\left.\\begin{aligned} \\href{AppDiags.html#WQDiagPOCSedmtn}{F_{sedmtn\\langle computed\\rangle}^{POC}} =&amp; \\frac{\\href{AppDiags.html#WQDiagPOMVVel}{V_{settle\\langle computed \\rangle}^{lorg}}}{dz} \\times \\left[ POC \\right] \\\\ \\\\ \\href{AppDiags.html#WQDiagPONSedmtn}{F_{sedmtn\\langle computed\\rangle}^{PON}} =&amp; \\frac{\\href{AppDiags.html#WQDiagPOMVVel}{V_{settle\\langle computed \\rangle}^{lorg}}}{dz} \\times \\left[ PON \\right] \\\\ \\\\ \\href{AppDiags.html#WQDiagPOPSedmtn}{F_{sedmtn\\langle computed\\rangle}^{POP}} =&amp; \\frac{\\href{AppDiags.html#WQDiagPOMVVel}{V_{settle\\langle computed \\rangle}^{lorg}}}{dz} \\times \\left[ POP \\right] \\end{aligned}\\right\\} \\tag{N.31} \\end{equation}\\] \\[\\begin{equation} \\href{AppDiags.html#WQDiagRPOMSedmtn}{F_{sedmtn\\langle computed\\rangle}^{RPOM}} = \\frac{\\href{AppDiags.html#WQDiagRPOMVVel}{V_{settle\\langle computed \\rangle}^{rorg}}}{dz} \\times \\left[ RPOM \\right] \\tag{N.32} \\end{equation}\\] \\(dz\\) is the relevant cell thickness, and divides the flux to produce a per volume result for consistency with other corresponding diagnostics. The limitations of this approach to modelling particulate organic matter settling are recognised. Future releases of the WQ Module will offer direct linkages between the TUFLOW FV ST Module and WQ Module, and treat particulate organics as sediment fractions that are transported using the advanced techniques and models offered by the ST Module. "],["AppPath.html", "Appendix O Processes: pathogens O.1 Mortality O.2 Inactivation O.3 Attachment O.4 Settling O.5 Other", " Appendix O Processes: pathogens O.1 Mortality Natural mortality, or the ‘dark-death rate’ \\(k_d^{pth}\\) is an important process influencing protozoan, bacterial and viral dynamics in surface and coastal waters. Two of the predominant environmental factors known to modify this dark death rate are temperature and salinity, and as such the resultant mortality flux is computed via Equation (O.1). \\[\\begin{equation} \\href{AppDiags.html#WQDiagPathMort}{F_{mor}^{pth}} = \\left[k_d^{pth} + C_{SM}^{pth} \\times S^{\\alpha}\\right] \\times \\left[\\theta_{mor}^{pth}\\right]^{T-20} \\times \\left(\\left[PTH_a\\right] + \\left[PTH_t\\right]\\right) \\tag{O.1} \\end{equation}\\] \\(k_d^{pth}\\) is the user specified dark death rate in freshwater at 20\\(^o\\)C, \\(C_{SM}^{pth}\\) is the salinity effect on mortality, \\(S\\) is ambient salinity, \\(\\alpha\\) is a parameter controlling salinity dependence, \\(\\theta_{mor}^{pth}\\) is the corresponding temperature coefficient, \\(T\\) is ambient water temperature, and \\(\\left[PTH_a\\right]\\) and \\(\\left[PTH_t\\right]\\) are the concentrations of free and attached pathogens, respectively. If attached pathogens are not simulated, then the latter concentration is set to zero for the purposes of the above flux calculation. O.2 Inactivation Sunlight exposure is an important inactivation mechanism for all forms of pathogens and microbial indicators in both fresh and saline waters. In waters of high clarity, it has long been regarded as the most dominant inactivation mechanism. To compute this inactivation flux, the individual inactivation rates due to visible, UVA and UVB light are calculated and combined to compute an overall inactivation rate \\(R_{invn}^{pth}\\) via Equation (O.2). \\[\\begin{equation} \\left.\\begin{aligned} R_{invn}^{pth} = 10^{-6} \\times \\left(\\underbrace{\\left[\\frac{\\left[DO\\right]}{K_{DO_{vis}}^{pth} + \\left[DO\\right]}\\times \\left[k_{vis}+c_{S_{vis}}S\\right]\\times PAR\\right]}_{\\text{Influence of visible light}} + \\ldots \\\\ \\underbrace{\\left[\\frac{\\left[DO\\right]}{K_{DO_{uva}}^{pth} + \\left[DO\\right]}\\times \\left[k_{uva}+c_{S_{uva}}S\\right]\\times UVA\\right]}_{\\text{Influence of UV-A light}} + \\ldots \\\\ \\underbrace{\\left[\\frac{\\left[DO\\right]}{K_{DO_{uvb}}^{pth} + \\left[DO\\right]}\\times \\left[k_{uvb}+c_{S_{uvb}}S\\right]\\times UVB\\right]}_{\\text{Influence of UV-B light}}\\right) \\end{aligned}\\right\\} \\tag{O.2} \\end{equation}\\] \\(K_{DO_{vis}}^{pth}\\),\\(K_{DO_{uva}}^{pth}\\), and \\(K_{DO_{uvb}}^{pth}\\) are the user specified half saturation oxygen concentrations for visible, UV-A and UV-B light inactivation, respectively, \\(k_{vis}^{pth}\\),\\(k_{uva}^{pth}\\), and \\(k_{uvb}^{pth}\\) are the user specified freshwater inactivation rate coefficients for exposure to visible, UV-A and UV-B light, respectively, \\(c_{S_{vis}}^{pth}\\),\\(c_{S_{uva}}^{pth}\\), and \\(c_{S_{uvb}}^{pth}\\) are the user specified coefficients that enhance the inactivation effect of light under saline conditions for exposure to visible, UV-A and UV-B light, respectively, \\(S\\) is ambient salinity, and \\(PAR\\), \\(UVA\\) and \\(UVB\\) are the photosynthetically available, UV-A and UV-B radiation intensities at the centre of a model cell. The multiplier preceding the calculation is for units conversion purposes. The inactivation rate \\(R_{invn}^{pth}\\) from Equation (O.2) is multiplied by free and attached pathogen concentrations to compute the inactivation flux at each model timestep in each model cell via Equation (O.3). \\[\\begin{equation} \\href{AppDiags.html#WQDiagInvn}{F_{invn}^{pth}} = R_{invn}^{pth} \\times \\left( \\left[ PTH_a \\right] + \\frac{\\left[ PTH_t \\right]}{2}\\right) \\tag{O.3} \\end{equation}\\] \\(\\left[PTH_a\\right]\\) and \\(\\left[PTH_t\\right]\\) are the concentrations of free and attached pathogens, respectively. If attached pathogens are not simulated then \\(\\left[PTH_t\\right]\\) is set to zero for the purposes of the above calculation. The reduced (50%) impact of \\(R_{invn}^{pth}\\) on attached pathogens reflects the shading of half of all attached pathogens by their associated sediment particles (i.e. those on the underside). O.3 Attachment Enteric organisms may exist in isolation or be associated with either organic or inorganic suspended particles, depending on the surface properties of the organism and the nature of the suspended material within the system. The simulation of this attachment (and detachment) is therefore allowed for within the TUFLOW WQ Module as an attachment to total suspended sediment. At each water quality timestep, the instantaneous attachment flux \\(F_{att}^{pth}\\) is estimated via Equation (O.4). \\[\\begin{equation} \\href{AppDiags.html#WQDiagAttach}{F_{att}^{pth}} = \\frac{1}{7}\\times \\left(f_{att}^{pth} \\times \\left(\\left[PTH_a \\right] + \\left[PTH_t \\right]\\right) - \\left[PTH_a \\right]\\right) \\tag{O.4} \\end{equation}\\] \\(f_{att}^{pth}\\) is the user specified target attachment fraction, and \\(\\left[PTH_a\\right]\\) and \\(\\left[PTH_t\\right]\\) are the concentrations of free and attached pathogens, respectively. This assumes that left unperturbed, equilibrium would be reached in seven days. A positive (negative) flux represents attachment (detachment). The target attachment fraction is defined as follows, where the concentrations are relative targets, not actual simulated quantities (i.e. so cannot be algebraically cancelled if the expression for \\(f_{att}^{pth}\\) in Equation (O.5) is substituted into Equation (O.4)). \\[\\begin{equation} f_{att}^{pth} = \\frac{\\left[PTH_a \\right]}{\\left[PTH_a \\right] + \\left[PTH_t \\right]} \\tag{O.5} \\end{equation}\\] O.4 Settling Unattached pathogens able to be settled within the WQ Module, at a user specified constant settling velocity, \\(V_{settle}^{pth}\\). This is applied equally to both unattached alive and unattached dead pathogens, and a negative velocity is downwards settling. The relevant fluxes are then calculated as follows. \\[\\begin{equation} \\left.\\begin{aligned} \\href{AppDiags.html#WQDiagAliveSedmtn}{F_{sedmtn\\langle computed\\rangle}^{pth_a}} =&amp; \\frac{V_{settle}^{pth}}{dz} \\times \\left[ PTH_a \\right] \\\\ \\\\ \\href{AppDiags.html#WQDiagDeadSedmtn}{F_{sedmtn\\langle computed\\rangle}^{pth_d}} =&amp; \\frac{V_{settle}^{pth}}{dz} \\times \\left[ PTH_d \\right] \\\\ \\\\ \\end{aligned}\\right\\} \\tag{O.6} \\end{equation}\\] \\(V_{settle}^{pth}\\) is the user specified settling velocity and \\(dz\\) is the relevant cell thickness. The latter divides the flux to produce a per volume result for consistency with other corresponding diagnostics. \\(\\left[PTH_a\\right]\\) and \\(\\left[PTH_d\\right]\\) are the concentrations of unattached alive and dead pathogens, respectively. Settled pathogens are not permitted to resuspend. If attached pathogens are simulated, then their settling velocity \\(V_{settle}^{pth_t}\\) is also specified as a constant (with a negative value again being downwards). This specification should be comparable to the settling velocity/ies specified in the TUFLOW FV Sediment Transport Module configuration. The relevant flux is then calculated as follows. \\[\\begin{equation} \\href{AppDiags.html#WQDiagAttachSedmtn}{F_{sedmtn\\langle computed\\rangle}^{pth_t}} =\\frac{V_{settle}^{pth_t}}{dz} \\times \\left[ PTH_t \\right] \\tag{O.7} \\end{equation}\\] The limitations of the above approaches to modelling pathogenic settling are recognised. Future releases of the WQ Module will offer direct linkages between the TUFLOW FV ST Module and WQ Module, and treat pathogens as sediment fractions that are transported using the advanced techniques and models offered by the ST Module, including resuspension. O.5 Other O.5.1 Total pathogens Total pathogens is reported as a diagnostic variable computed as per Equation (O.8) \\[\\begin{equation} \\href{AppDiags.html#WQDiagTotPath}{\\left[ PTH \\right]^{TOT}} = \\left[ PTH_a \\right] + \\left[ PTH_d \\right] + \\left[ PTH_t \\right] \\tag{O.8} \\end{equation}\\] \\(\\left[PTH_a\\right]\\), \\(\\left[PTH_d\\right]\\) and \\(\\left[PTH_t\\right]\\) are the concentrations of free, dead and attached pathogens, respectively. "],["AppConstits.html", "Appendix P Computed variables", " Appendix P Computed variables .book .book-body .page-wrapper .page-inner { max-width: 95%; } The WQ Module’s computed variables, and the core (lowest order) constituent model class and instance where each is deployed are listed below. Output variable names are also included for cross referencing. Some TUFLOW FV variables are included in the table for completeness. With regard to naming: The text “NAME” in variable names is a placeholder for the user defined phytoplankton group name. “WQ_PHYTO_NAME_INT_N_MGL” list in the table would be named “WQ_PHYTO_CYLINDRO_INT_N_MGL” if a user defined phytoplankton group name was “cylindro” The TUFLOW FV MATLAB toolbox: Offers several post processing tools which rely on output phytoplankton group names. These are defined in ‘..\\TUFLOWFV_Matlab_Utilities_001\\toolbox\\tuflowfv\\fv_variables.m’ with default names: ‘BLUEGREEN’, ‘BGA’, ‘FDIAT’, ‘MDIAT’, ‘DIATOM’, ‘GREEN’, ‘PHY01’, ‘PHY02’, ‘PHY03’, ‘PHY04’, ‘PHY05’, ‘PHY06’, ‘PHY07’, ‘PHY08’, ‘PHY09’, ‘PHY10’ and ‘PHY11’. Users may choose to deploy any of these names and therefore use the MATLAB post processing tools unchanged. If not, then users will need to extend the ‘fvwq_mgl’ or ‘fvwq_mmm’ name lists provided in ‘fv_variables.m’. A template is provided in that mfile, with instructions on what to change. Uses dissolved oxygen in the following example scripts. It has been assumed that the MGL units system has been used so that the variable name of the interrogated data set is ‘WQ_DISS_OXYGEN_MG_L’. Users can change this if desired. Other ancillaries such as plot labels, colour limits and scale factors will also need to be changed for correct presentation of data if oxygen in the MGL units system is not processed: ‘..\\TUFLOWFV_Matlab_Utilities_001\\tutorial\\visual\\3.sheets\\sh_006_impact_sheet_multiple_models.m’ ‘..\\TUFLOWFV_Matlab_Utilities_001\\tutorial\\visual\\4.curtains\\cu_000_plot_curtain_WQ.m’ ‘..\\TUFLOWFV_Matlab_Utilities_001\\tutorial\\visual\\5.combined_plots\\co_000_plot_multiple_ways_WQ.m’ It is recommended that this Appendix be viewed with the left hand pane table of contents hidden. Use the ‘s’ key to toggle this pane on and off. Output computed variable names are exact, and can therefore be copied and pasted directly into output blocks of control files, for example. The exception is phytoplankton variables, where the user specified group name is included within the variable name, so will need to be inserted by the user. When interrogating three dimensional computed variable results in netcdf format, the stat field of each output file indicates whether or not a 2D cell (and hence its associated 3D column) is wet or dry. The stat field is of dimension [number of 2D cells \\(\\times\\) number of timesteps] and a value of zero indicates that a 2D cell (and associated 3D column) is dry. Water quality computed variables are reported as zero when 2D cells are dry, so using the stat field to filter out these dry cells is essential when post processing results from models where cells wet and dry. Similarly, if viewing netcdf water quality computed variables in QGIS using the TUFLOW Viewer, QGIS’s automatic colour bar (displayed in the layer legend and properties tab) will extend to zero if the model considered includes cells that wet and dry - QGIS does not use the stat field to filter out dry cells when automatically determining colour bar ranges. The user can manually adjust this colour bar range as required. The stat field is, however, used when water quality computed variable results are viewed in plan or curtain mode in the map window when using the TUFLOW Viewer: dry cells are set to be transparent, even though their ‘zero’ values may influence the automatic setting of the colour bar range. Table P.1: TUFLOW FV and WQ Module computed variables Common name Notation Units Relevant element Atomic number (Z) Atomic weight (M) Output variable name Core constituent model Dissolved oxygen \\(\\left[DO\\right]\\) mg/L mmol/m\\(^3\\) \\(O_2\\) 16 32 WQ_DISS_OXYGEN_MG_L WQ_DISS_OXYGEN_MM_M3 Oxygen:O2 Silicate \\(\\left[Si\\right]\\) mg/L mmol/m\\(^3\\) \\(Si\\) 14 28 WQ_SILICATE_MG_L WQ_SILICATE_MM_M3 Silicate:Si Ammonium \\(\\left[NH_4\\right]\\) mg/L mmol/m\\(^3\\) \\(N\\) 7 14 WQ_AMMONIUM_MG_L WQ_AMMONIUM_MM_M3 Inorganic nitrogen:AmoniumNitrate Nitrate \\(\\left[NO_3\\right]\\) mg/L mmol/m\\(^3\\) \\(N\\) 7 14 WQ_NITRATE_MG_L WQ_NITRATE_MM_M3 Inorganic nitrogen:AmoniumNitrate Filterable reactive phosphorus \\(\\left[FRP\\right]\\) mg/L mmol/m\\(^3\\) \\(P\\) 15 31 WQ_FRP_MG_L WQ_FRP_MM_M3 Inorganic phosphorus:FRPhs Filterable reactive phosphorus adsorbed \\(\\left[FRPads\\right]\\) mg/L mmol/m\\(^3\\) \\(P\\) 15 31 WQ_FRP_ADS_MG_L WQ_FRP_ADS_MM_M3 Inorganic phosphorus:FRPhsads Dissolved organic carbon \\(\\left[DOC\\right]\\) mg/L mmol/m\\(^3\\) \\(C\\) 6 12 WQ_DOC_MG_L WQ_DOC_MM_M3 Organic matter:Labile Particulate organic carbon \\(\\left[POC\\right]\\) mg/L mmol/m\\(^3\\) \\(C\\) 6 12 WQ_POC_MG_L WQ_POC_MM_M3 Organic matter:Labile Dissolved organic nitrogen \\(\\left[DON\\right]\\) mg/L mmol/m\\(^3\\) \\(N\\) 7 14 WQ_DON_MG_L WQ_DON_MM_M3 Organic matter:Labile Particulate organic nitrogen \\(\\left[PON\\right]\\) mg/L mmol/m\\(^3\\) \\(N\\) 7 14 WQ_PON_MG_L WQ_PON_MM_M3 Organic matter:Labile Dissolved organic phosphorus \\(\\left[DOP\\right]\\) mg/L mmol/m\\(^3\\) \\(P\\) 15 31 WQ_DOP_MG_L WQ_DOP_MM_M3 Organic matter:Labile Particulate organic phosphorus \\(\\left[POP\\right]\\) mg/L mmol/m\\(^3\\) \\(P\\) 15 31 WQ_POP_MG_L WQ_POP_MM_M3 Organic matter:Labile Refractory dissolved organic carbon \\(\\left[RDOC\\right]\\) mg/L mmol/m\\(^3\\) \\(C\\) 6 12 WQ_RDOC_MG_L WQ_RDOC_MM_M3 Organic matter:Refractory Refractory dissolved organic nitrogen \\(\\left[RDON\\right]\\) mg/L mmol/m\\(^3\\) \\(N\\) 7 14 WQ_RDON_MG_L WQ_RDON_MM_M3 Organic matter:Refractory Refractory dissolved organic phosphorus \\(\\left[RDOP\\right]\\) mg/L mmol/m\\(^3\\) \\(P\\) 15 31 WQ_RDOP_MG_L WQ_RDOP_MM_M3 Organic matter:Refractory Refractory particulate organic matter \\(\\left[RPOM\\right]\\) mg/L mmol/m\\(^3\\) \\(C\\) 6 12 WQ_RPOM_MG_L WQ_RPOM_MM_M3 Organic matter:Refractory Phytoplankton \\(\\left[PHY\\right]\\) \\(\\mu\\)g/L mmol/m\\(^3\\) \\(C\\) (or Chl a) 6 12 WQ_PHYTO_NAME_CONC_MICG_L WQ_PHYTO_NAME_CONC_MM_M3 Phytoplankton:Basic Cell density \\(\\rho_{PHY}\\) kg/m\\(^3\\) WQ_PHYTO_NAME_DENS_KG_M3 Phytoplankton:Basic Internal nitrogen \\(\\left[IN\\right]\\) mg/L mmol/m\\(^3\\) \\(N\\) 7 14 WQ_PHYTO_NAME_INT_N_MG_L WQ_PHYTO_NAME_INT_N_MM_M3 Phytoplankton:Advanced Internal phosphorus \\(\\left[IP\\right]\\) mg/L mmol/m\\(^3\\) \\(P\\) 15 31 WQ_PHYTO_NAME_INT_P_MG_L WQ_PHYTO_NAME_INT_P_MM_M3 Phytoplankton:Advanced Suspended sediment \\(\\left[SS\\right]\\) mg/L SED_N Water temperature T \\(^o\\)C TEMP Water salinity S g/L SAL Nitrite \\(\\left[NO_2\\right]\\) mg/L mmol/m\\(^3\\) \\(N\\) 7 14 Alive pathogen \\(\\left[PTH_a\\right]\\) CFU/100mL WQ_PATH_NAME_ALIVE_CFU_100ML WQ_PATH_NAME_ALIVE_CFU_100ML Pathogens:Free Dead pathogen \\(\\left[PTH_d\\right]\\) CFU/100mL WQ_PATH_NAME_DEAD_CFU_100ML WQ_PATH_NAME_DEAD_CFU_100ML Pathogens:Free Attached pathogen \\(\\left[PTH_t\\right]\\) CFU/100mL WQ_PATH_NAME_ATTCHD_CFU_100ML WQ_PATH_NAME_ATTCHD_CFU_100ML Pathogens:Attached "],["AppDiags.html", "Appendix Q Diagnostic variables", " Appendix Q Diagnostic variables .book .book-body .page-wrapper .page-inner { max-width: 95%; } The WQ Module’s diagnostic output variables, and the core (lowest order) constituent model class and instance where each is deployed are listed below. With regard to naming: Units are included in the diagnostic variable names, with “ND” signifying “no dimension” The text “NAME” in variable names is a placeholder for the user defined phytoplankton group name. “WQ_PHYTO_NAME_INT_N_MGL” list in the table would actually be named “WQ_PHYTO_GREEN_INT_N_MGL” if a user defined phytoplankton group name was “green” The text “PHYTO_COM” indicates summed (community level) diagnostics and is not changed by user specification of individual phytoplankton group names It is recommended that this Appendix be viewed with the left hand pane table of contents hidden. Use the ‘s’ key to toggle this pane on and off. Output diagnostic variable names are exact, and can therefore be copied and pasted directly into output blocks of control files, for example. The exception is phytoplankton variables, where the user specified group name is included within the variable name, so will need to be inserted by the user. WQ Module calculations are not performed on computational columns of cells that are shallow. In such instances, the reported diagnostic variables are carried from the previous water quality timestep and as such may not reflect actual diagnostics at the reported time. This matter will be addressed in future releases of the WQ Module, however in the interim, caution should be used in the interpretation of diagnostic variables in cells that are known to regularly wet and dry. In order to preserve shape consistency across all outputs, sheet style diagnostics such as benthic or atmospheric fluxes are reported as fully three dimensional fields. In all cases, these fluxes are reported in the bottom (bed) cell of each computational column (including surface atmospheric fluxes). All other three dimensional cell values are reported as zeros. Therefore, when viewing or interrogating these flux outputs in QGIS, python or MATLAB, the bottom layer of each diagnostic variable should be queried. When interrogating three dimensional diagnostic variable results in netcdf format, the stat field of each output file indicates whether or not a 2D cell (and hence its associated 3D column) is wet or dry. The stat field is of dimension [number of 2D cells \\(\\times\\) number of timesteps] and a value of 0 indicates that a 2D cell (and associated 3D column) is dry. Water quality diagnostic variables are reported as 0 when 2D cells are dry, so using the stat field to filter out these dry cells is essential when post processing results from models where cells wet and dry. In addition, and because diagnostic variables are not tracked or advected and dispersed between timesteps (like computed variables are), they are also set to 0 when water quality calculations are turned off in a given cell due to either the cell being dry, or it having a water depth less than \\(d_{min-wq}\\) (set via the cell water quality depth == command). Therefore, care must be taken when interpreting diagnostic variable outputs in cells that are shallower than the specified or default water quality depth. It is also noted that the first timestep reported in diagnostic variable outputs has a value of zero for all cells. This is because the diagnostic array is initialised at zero before each suite of water quality calculations, including before the first water quality timestep, and so when the diagnostic values are written at output file initialisation, all diagnostic values are zero. This contrasts with computed variables written at the same initialisation of output files - these variables are set to the user specified initial conditions. Diagnostic variables do not have corresponding initial conditions and are therefore set to zero on first writing of results. This should be noted in post processing analyses. If viewing netcdf water quality diagnostic variables in QGIS using the TUFLOW Viewer, QGIS’s automatic colour bar (displayed in the layer legend and properties tab) will extend to zero if the model considered includes cells that wet and dry - QGIS does not use the stat field to filter out dry cells when automatically determining colour bar ranges. The user can manually adjust this colour bar range as required. The stat field is, however, used when water quality diagnostic variable results are viewed in plan or curtain mode in the map window when using the TUFLOW Viewer: dry cells are set to be transparent. Table Q.1: WQ Module diagnostic variables Output diagnostic variable name Common name Symbol Units Description Core constituent model Links WQ_DIAG_O2_SAT_PCT Oxygen saturation \\(\\left[DO\\right]_{psat}\\) % Dissolved oxygen percentage saturation that is the equivalent of the dissolved oxygen concentration at current temperature, salinity and pressure conditions Oxygen:O2 Equation (D.5) WQ_DIAG_ACTUAL_O2_SED_FLUX_MG_M2_D WQ_DIAG_ACTUAL_O2_SED_FLUX_MMOL_M2_D Oxygen sediment flux \\(F_{sed\\langle computed\\rangle}^{O_2}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The dynamically computed flux of oxygen across the sediment water interface. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. Multiply by cell area (m\\(^2\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Oxygen:O2 Equation (D.6) WQ_DIAG_O2_ATMOS_EXCHANGE_MG_M2_D WQ_DIAG_O2_ATMOS_EXCHANGE_MMOL_M2_D Oxygen atmospheric flux \\(F_{atm}^{O_2}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The flux of atmospheric oxygen entering the water column. Positive (negative) values are fluxes to (from) the water column from (to) the atmosphere. Multiply by cell area (m\\(^2\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Oxygen:O2 Equation (D.4) WQ_DIAG_ACTUAL_SI_SED_FLUX_MG_M2_D WQ_DIAG_ACTUAL_SI_SED_FLUX_MMOL_M2_D Silicate sediment flux \\(F_{sed\\langle computed\\rangle}^{Si}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The dynamically computed flux of silicate across the sediment water interface. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. Multiply by cell area (m\\(^2\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Silicate:Si Equation (E.1) WQ_DIAG_ACTUAL_NH4_SED_FLUX_MG_M2_D WQ_DIAG_ACTUAL_NH4_SED_FLUX_MMOL_M2_D Ammonium sediment flux \\(F_{sed\\langle computed\\rangle}^{NH_4}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The dynamically computed flux of ammonium across the sediment water interface. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. Multiply by cell area (m\\(^2\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Inorganic nitrogen:AmmoniumNitrate Equation (F.1) WQ_DIAG_ACTUAL_NO3_SED_FLUX_MG_M2_D WQ_DIAG_ACTUAL_NO3_SED_FLUX_MMOL_M2_D Nitrate sediment flux \\(F_{sed\\langle computed\\rangle}^{NO_3}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The dynamically computed flux of nitrate across the sediment water interface. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. Multiply by cell area (m\\(^2\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Inorganic nitrogen:AmmoniumNitrate Equation (F.1) WQ_DIAG_NITRIFICATION_MG_L_D WQ_DIAG_NITRIFICATION_MMOL_M3_D Nitrification flux \\(F_{nitrif\\langle computed\\rangle}^{NH_4}\\) mg/L/d mmol/m\\(^3\\)/d The flux of ammonium N to nitrate N due to nitrification. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Inorganic nitrogen:AmmoniumNitrate Equation (F.4) WQ_DIAG_DENITRIFICATION_MG_L_D WQ_DIAG_DENITRIFICATION_MMOL_M3_D Denitrification flux \\(F_{denit\\langle computed\\rangle}^{NO_3}\\) mg/L/d mmol/m\\(^3\\)/d The flux of nitrate N to nitrogen gas N due to denitrification. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Inorganic nitrogen:AmmoniumNitrate Equation (F.7) WQ_DIAG_DIN_ATMOS_EXCHANGE_MG_M2_D WQ_DIAG_DIN_ATMOS_EXCHANGE_MMOL_M2_D Nitrogen atmospheric flux \\(F_{atm-din\\langle computed \\rangle}^{N}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The combined wet (rainfall) and dry deposition of inorganic nitrogen across the atmosphere water interface. Positive values are fluxes to the water column from the atmosphere. Multiply by cell area (m\\(^2\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Inorganic nitrogen:AmmoniumNitrate Equation (F.21) WQ_DIAG_ACTUAL_FRP_SED_FLUX_MG_M2_D WQ_DIAG_ACTUAL_FRP_SED_FLUX_MMOL_M2_D FRP sediment flux \\(F_{sed\\langle computed\\rangle}^{FRP}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The dynamically computed flux of FRP across the sediment water interface. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. Multiply by cell area (m\\(^2\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Inorganic phosphorus:FRPhs Equation (G.1) WQ_DIAG_DIP_ATMOS_EXCHANGE_MG_M2_D WQ_DIAG_DIP_ATMOS_EXCHANGE_MMOL_M2_D Phosphorus atmospheric flux \\(F_{atm-dip\\langle computed \\rangle}^{P}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The combined wet (rainfall) and dry deposition of inorganic phosphorus across the atmosphere water interface. Only FRP (FRPads) contributes to wet (dry) deposition. Positive values are fluxes to the water column from the atmosphere. Multiply by cell area (m\\(^2\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Inorganic phosphorus:FRPhs Equation (G.4) WQ_DIAG_POC_SEDMTN_FLUX_MG_L_D WQ_DIAG_POC_SEDMTN_FLUX_MMOL_M3_D POC sedimentation flux \\(F_{sedmtn\\langle computed\\rangle}^{POC}\\) mg/L/d mmol/m\\(^3\\)/d The flux of settling labile particulate organic carbon that leaves the water column and enters the sediment. This is not flux of POC from the sediments. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. Multiply by cell volume (L or m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval. Although often thought of as being a per area (per m\\(^2\\)) loss, the volumetric units of this diagnostic (per L or m\\(^3\\)) have been chosen deliberately for consistency with other analogous volumetric losses such as hydrolysis. This is intended to assist in simplifying post processing Organic matter:Labile Equation (N.31) WQ_DIAG_PON_SEDMTN_FLUX_MG_L_D WQ_DIAG_PON_SEDMTN_FLUX_MMOL_M3_D PON sedimentation flux \\(F_{sedmtn\\langle computed\\rangle}^{PON}\\) mg/L/d mmol/m\\(^3\\)/d The flux of settling labile particulate organic nitrogen that leaves the water column and enters the sediment. This is not flux of PON from the sediments. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. Multiply by cell volume (L or m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval. Although often thought of as being a per area (per m\\(^2\\)) loss, the volumetric units of this diagnostic (per L or m\\(^3\\)) have been chosen deliberately for consistency with other analogous volumetric losses such as hydrolysis. This is intended to assist in simplifying post processing Organic matter:Labile Equation (N.31) WQ_DIAG_POP_SEDMTN_FLUX_MG_L_D WQ_DIAG_POP_SEDMTN_FLUX_MMOL_M3_D POP sedimentation flux \\(F_{sedmtn\\langle computed\\rangle}^{POP}\\) mg/L/d mmol/m\\(^3\\)/d The flux of settling labile particulate organic phosphorus that leaves the water column and enters the sediment. This is not flux of POP from the sediments. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. Multiply by cell volume (L or m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval. Although often thought of as being a per area (per m\\(^2\\)) loss, the volumetric units of this diagnostic (per L or m\\(^3\\)) have been chosen deliberately for consistency with other analogous volumetric losses such as hydrolysis. This is intended to assist in simplifying post processing Organic matter:Labile Equation (N.31) WQ_DIAG_CHRMPHIC_DISS_ORGS_M CDOM \\(CDOM_{\\langle computed \\rangle}\\) /m Chromorphic dissolved organic matter. It is the equivalent extinction coefficient for absorption of radiation at 440 nm. It is computed from DOC (and RDOC if refractory organic matter is simulated) and uses the relationship of Equation (N.22) Organic matter:Refractory Equation (N.22) WQ_DIAG_ACTUAL_DOC_SED_FLUX_MG_M2_D WQ_DIAG_ACTUAL_DOC_SED_FLUX_MMOL_M2_D DOC sediment flux \\(F_{sed\\langle computed\\rangle}^{DOC}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The dynamically computed flux of DOC across the sediment water interface. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. Multiply by cell area (m\\(^2\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Organic matter:Labile Equation (N.1) WQ_DIAG_ACTUAL_DON_SED_FLUX_MG_M2_D WQ_DIAG_ACTUAL_DON_SED_FLUX_MMOL_M2_D DON sediment flux \\(F_{sed\\langle computed\\rangle}^{DON}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The dynamically computed flux of DON across the sediment water interface. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. Multiply by cell area (m\\(^2\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Organic matter:Labile Equation (N.1) WQ_DIAG_ACTUAL_DOP_SED_FLUX_MG_M2_D WQ_DIAG_ACTUAL_DOP_SED_FLUX_MMOL_M2_D DOP sediment flux \\(F_{sed\\langle computed\\rangle}^{DOP}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The dynamically computed flux of DOP across the sediment water interface. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. Multiply by cell area (m\\(^2\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval Organic matter:Labile Equation (N.1) WQ_DIAG_POC_HYDROL_MG_L_D WQ_DIAG_POC_HYDROL_MMOL_M3_D POC hydrolysis flux \\(F_{hyd\\langle computed\\rangle}^{POC}\\) mg/L/d mmol/m\\(^3\\)/d The flux of labile POC to labile DOC due to hydrolysis. Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be hydrolysed in that interval Organic matter:Labile Equation (N.3) WQ_DIAG_DOC_MINERL_MG_L_D WQ_DIAG_DOC_MINERL_MMOL_M3_D DOC mineralisation flux \\(F_{miner\\langle computed\\rangle}^{DOC}\\) mg/L/d mmol/m\\(^3\\)/d The flux of labile DOC to DIC due to mineralisation. Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be mineralised in that interval Organic matter:Labile Equation (N.9) WQ_DIAG_PON_HYDROL_MG_L_D WQ_DIAG_PON_HYDROL_MMOL_M3_D PON hydrolysis flux \\(F_{hyd\\langle computed\\rangle}^{PON}\\) mg/L/d mmol/m\\(^3\\)/d The flux of labile PON to labile DON due to hydrolysis. Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be hydrolysed in that interval Organic matter:Labile Equation (N.3) WQ_DIAG_DON_MINERL_MG_L_D WQ_DIAG_DON_MINERL_MMOL_M3_D DON mineralisation flux \\(F_{miner\\langle computed\\rangle}^{DON}\\) mg/L/d mmol/m\\(^3\\)/d The flux of labile DON to ammonium due to mineralisation. Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be mineralised in that interval Organic matter:Labile Equation (N.9) WQ_DIAG_POP_HYDROL_MG_L_D WQ_DIAG_POP_HYDROL_MMOL_M3_D POP hydrolysis flux \\(F_{hyd\\langle computed\\rangle}^{POP}\\) mg/L/d mmol/m\\(^3\\)/d The flux of labile POP to labile DOP due to hydrolysis. Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be hydrolysed in that interval Organic matter:Labile Equation (N.3) WQ_DIAG_DOP_MINERL_MG_L_D WQ_DIAG_DOP_MINERL_MMOL_M3_D DOP mineralisation flux \\(F_{miner\\langle computed\\rangle}^{DOP}\\) mg/L/d mmol/m\\(^3\\)/d The flux of labile DOP to FRP due to mineralisation. Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be mineralised in that interval Organic matter:Labile Equation (N.9) WQ_DIAG_DOC_MINERL_AN_MG_L_D WQ_DIAG_DOC_MINERL_AN_MMOL_M3_D DOC anaerobic mineralisation flux \\(F_{miner\\langle computed\\rangle}^{an}\\) mg/L/d mmol/m\\(^3\\)/d The component of the mineralisation flux of labile dissolved organic carbon that is anaerobic, i.e. the mineralisation that occurs after oxygen has been consumed from both diatomic dissolved oxygen and nitrate. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) of carbon that would be anaerobically mineralised in that interval. Reporting units of this diagnostic are carbon Organic matter:Labile Equation (N.15) WQ_DIAG_DOC_MINERL_DENIT_MG_L_D WQ_DIAG_DOC_MINERL_DENIT_MMOL_M3_D DOC denitification mineralisation \\(F_{miner\\langle computed\\rangle}^{NO_3}\\) mg/L/d mmol/m\\(^3\\)/d The component of the mineralisation flux of labile dissolved organic carbon that occurs following consumption of dissolved oxygen, and that sources its oxygen from stripping (denitrifying) nitrate. It is the mineralisation that occurs after oxygen has been consumed from diatomic dissolved oxygen but before anaerobic mineralisation occurs. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) of carbon that would be aerobically mineralised in that interval. The same number of moles of nitrate N will be consumed. Reporting units of this diagnostic are carbon Organic matter:Labile Equation (N.14) WQ_DIAG_DOC_BOD5_MG_L BOD5 \\(BOD5_{\\langle computed\\rangle}^{O_2}\\) mg/L The reduction in the concentration of dissolved oxygen that would result by the action of aerobic mineralisation of dissolved organic carbon over a period of 5 days. It is computed at the instantaneous oxygen consumption rate Organic matter:Labile Equation (N.13) WQ_DIAG_POM_VERT_VEL_M_S Labile particulate organic matter settling velocity \\(V_{settle\\langle computed \\rangle}^{lorg}\\) m/s The computed settling velocity of labile particulate organic carbon, nitrogen and phosphorus (which all have the same velocity). Positive (negative) values are upwards (downwards) Organic matter:Labile Section N.8 WQ_DIAG_RPOM_SEDMTN_FLUX_MG_L_D WQ_DIAG_RPOM_SEDMTN_FLUX_MMOL_M3_D RPOM sedimentation flux \\(F_{sedmtn\\langle computed\\rangle}^{RPOM}\\) mg/L/d mmol/m\\(^3\\)/d The flux of settling refractory particulate organic matter that leaves the water column and enters the sediment. This is not flux of RPOM from the sediments. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. Multiply by cell volume (L or m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be exchanged in that interval. Although often thought of as being a per area (per m\\(^2\\)) loss, the volumetric units of this diagnostic (per L or m\\(^3\\)) have been chosen deliberately for consistency with other analogous volumetric losses such as photolysis. This is intended to assist in simplifying post processing Organic matter:Refractory Equation (N.32) WQ_DIAG_PHOTOLYSIS_MG_L_D WQ_DIAG_PHOTOLYSIS_MMOL_M3_D RPOM Photolysis \\(F_{photo\\langle computed\\rangle}^{RDOC}\\) mg/L/d mmol/m\\(^3\\)/d The flux of refractory dissolved organic carbon to labile dissolved organic carbon and potentially DIC (if \\(f_{photo}^{DOM}\\) is not 1.0). This flux is always positive and is the carbon fraction only. Equivalent nitrogen and phosphorus fraction fluxes can be computed as per Equation (N.23) Organic matter:Refractory Equation (N.23) WQ_DIAG_RPOM_VERT_VEL_M_S Refractory particulate organic matter settling velocity \\(V_{settle\\langle computed \\rangle}^{rorg}\\) m/s The computed settling velocity of refractory particulate organic matter. Positive (negative) values are upwards (downwards) Organic matter:Refractory Section N.8 WQ_DIAG_PHY_NAME_INT_NUTR_RATIO_ND Ratio of internal nutrients \\(R_{IN-IP}^{phy}\\) [-] The ratio of internal nitrogen to internal phosphorus for a phytoplankton group. This quantity is reported for both the basic and advanced phytoplankton constituent models, with the former being the constant quotient of user (or default) internal nitrogen and phosphorus to carbon ratios. If the latter, this diagnostic will vary between the quotients of the user defined (or default) minimum and maximum limits of internal nitrogen and phosphorus to carbon ratios. Although noted here as being dimensionless, this quantity can be thought of as having units of (N concentration) / (P concentration) Phytoplankton:Basic WQ_DIAG_PHY_NAME_LGHT_LIM_ND Light limitation function \\(L_{lght}^{phy}\\) 0 The dynamically computed light limitation function for a phytoplankton group. It varies between 0 (complete limitation) and 1 (no limitation) Phytoplankton:Basic Section J.6 WQ_DIAG_PHY_NAME_N_LIM_ND Nitrogen limitation function \\(L_{nit}^{phy}\\) [-] The dynamically computed nitrogen limitation function for a phytoplankton group. It varies between 0 (complete limitation) and 1 (no limitation) Phytoplankton:Basic Section J.3 WQ_DIAG_PHY_NAME_P_LIM_ND Phosphorus limitation function \\(L_{phs}^{phy}\\) [-] The dynamically computed phosphorus limitation function for a phytoplankton group. It varies between 0 (complete limitation) and 1 (no limitation) Phytoplankton:Basic Section J.4 WQ_DIAG_PHY_NAME_SI_LIM_ND Silicate limitation function \\(L_{sil}^{phy}\\) [-] The dynamically computed silicate limitation function for a phytoplankton group. It varies between 0 (complete limitation) and 1 (no limitation) Phytoplankton:Basic Section J.5 WQ_DIAG_PHY_NAME_TMPTR_LIM_ND Temperature limitation function \\(L_T^{phy}\\) [-] The dynamically computed temperature limitation function for a phytoplankton group. It varies between 0 (complete limitation) and a positive number. This limitation function value can be greater than 1, and in such instances this represents an opportunity for augmented phytoplankton growth (subject to the values of other related limitation functions) Phytoplankton:Basic Section J.2 WQ_DIAG_PHY_NAME_SAL_LIM_ND Salinity limitation function \\(L_{sal-r}^{phy}\\) [-] The dynamically computed salinity limitation function applied to respiration of a phytoplankton group. It is always greater than 1 (no limitation). The same diagnostic variable name is used for the corollary primary productivity salinity limitation function because the two limitation functions are mutually exclusive Phytoplankton:Basic Section J.7 WQ_DIAG_PHY_NAME_SAL_LIM_ND Salinity limitation function \\(L_{sal-pp}^{phy}\\) [-] The dynamically computed salinity limitation function applied to primary production of a phytoplankton group. It varies between 0 (complete limitation) and 1 (no limitation). The same diagnostic variable name is used for the corollary respiration salinity limitation function because the two limitation functions are mutually exclusive Phytoplankton:Basic Section J.7 WQ_DIAG_PHY_NAME_PRIM_PROD_MICG_L_D WQ_DIAG_PHY_NAME_PRIM_PROD_MMOL_M3_D Phytoplankton primary productivity \\(F_{prod\\langle computed\\rangle}^{phy}\\) \\(\\mu\\)g/L/d mmol/m\\(^3\\)/d The flux of carbon to phytoplankton as a result of productivity, without accounting for respiration, for a phytoplankton group. Also referred to as growth or gross primary productivity, and typically associated with daytime phytoplankton photosynthesis. Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be taken up via productivity in that interval Phytoplankton:Basic Equation (I.5) WQ_DIAG_PHY_NAME_SEDMTN_MICG_L_D WQ_DIAG_PHY_NAME_SEDMTN_MMOL_M3_D Phytoplankton sedimentation \\(F_{sedmtn\\langle computed\\rangle}^{phy}\\) \\(\\mu\\)g/L/d mmol/m\\(^3\\)/d The flux of phytoplankton chlorophyll a (or carbon) into the sediments as a result of settling for a phytoplankton group. Values are only losses and are only negative. Multiply by cell volume (L or m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost to settling in that interval. Although often thought of as being a per area (per m\\(^2\\)) loss, the volumetric units of this diagnostic (per L or m\\(^3\\)) have been chosen deliberately for consistency with other analogous volumetric losses such as mortality. This is intended to assist in simplifying post processing Phytoplankton:Basic Equation (I.13) WQ_DIAG_PHY_NAME_VERT_VEL_M_S Phytoplankton settling velocity \\(V_{settle}^{phy}\\) m/s Phytoplankton settling velocity, as computed from the user specified (or default) method, for a phytoplankton group. Upwards (downwards) is negaitve (positive) Phytoplankton:Basic Section I.4 WQ_DIAG_PHYTO_COM_SEDMTN_MICG_L_D WQ_DIAG_PHYTO_COM_SEDMTN_MMOL_M3_D Community phytoplankton sedimentation \\(F_{sedmtn\\langle computed\\rangle}^{comm}\\) \\(\\mu\\)g/L/d mmol/m\\(^3\\)/d The flux of phytoplankton into the sediments as a result of settling, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community). Values are only losses and are only negative. Multiply by cell volume (L or m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost to settling in that interval. Although often thought of as being a per area (per m\\(^2\\)) loss, the volumetric units of this diagnostic (per L or m\\(^3\\)) have been chosen deliberately for consistency with other analogous losses such as individual phytoplankton group sedimentation rates. This is intended to assist in simplifying post processing Phytoplankton:Basic Equation (I.13) WQ_DIAG_PHYTO_COM_PRIM_PROD_MICG_L_D WQ_DIAG_PHYTO_COM_PRIM_PROD_MMOL_M3_D Community primary productivity \\(F_{prod\\langle computed\\rangle}^{comm}\\) \\(\\mu\\)g/L/d mmol/m\\(^3\\)/d The flux of carbon (and nutrients) to phytoplankton as a result of productivity, without accounting for respiration, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community). Also referred to as growth, and typically associated with daytime phytoplankton photosynthesis. Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be taken up via productivity in that interval Phytoplankton:Basic Equation (I.5) WQ_DIAG_PHYTO_COM_NET_PROD_MICG_L_D WQ_DIAG_PHYTO_COM_NET_PROD_MMOL_M3_D Community net primary productivity \\(F_{netprod\\langle computed\\rangle}^{comm}\\) \\(\\mu\\)g/L/d mmol/m\\(^3\\)/d The flux of carbon (and nutrients) to phytoplankton as a result of productivity, accounting for respiration losses due only to the consumption of stored energy, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community). Also referred to as net primary productivity. Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be taken up via net productivity in that interval Phytoplankton:Basic Equation (I.9) WQ_DIAG_PHYTO_COM_PROD_RESP_R_ Community primary productivity ratio \\(R_{PP-resp}^{comm}\\) [-] Ratio of primary productivity to true respiration, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community). Currently inactive and reported as 999 Phytoplankton: WQ_DIAG_PHYTO_COM_NET_RESP_R_ Community net primary productivity ratio \\(R_{NPP-resp}^{comm}\\) [-] Ratio of net primary productivity to true respiration, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community). Currently inactive and reported as 999 Phytoplankton: WQ_DIAG_PHYTO_COM_NO3_UPTAKE_MG_L_D WQ_DIAG_PHYTO_COM_NO3_UPTAKE_MMOL_M3_D Community nitrate uptake \\(F_{nit-uptake\\langle computed\\rangle}^{comm}\\) mg/L/d mmol/m\\(^3\\)/d The flux of nitrate to phytoplankton as a result of productivity, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community). Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be taken up in that interval. Although computed differently for the basic and advanced phytoplankton constituent models, the interpretation of this quantity is the same for both Phytoplankton:Basic Equation (K.3) WQ_DIAG_PHYTO_COM_NH4_UPTAKE_MG_L_D WQ_DIAG_PHYTO_COM_NH4_UPTAKE_MMOL_M3_D Community ammonium uptake \\(F_{amm-uptake\\langle computed\\rangle}^{comm}\\) mg/L/d mmol/m\\(^3\\)/d The flux of ammonium to phytoplankton as a result of productivity, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community). Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be taken up in that interval. Although computed differently for the basic and advanced phytoplankton constituent models, the interpretation of this quantity is the same for both Phytoplankton:Basic Equation (K.3) WQ_DIAG_PHYTO_COM_P_UPTAKE_MG_L_D WQ_DIAG_PHYTO_COM_P_UPTAKE_MMOL_M3_D Community FRP uptake \\(F_{P-uptake\\langle computed\\rangle}^{comm}\\) mg/L/d mmol/m\\(^3\\)/d The flux of FRP to phytoplankton as a result of productivity, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community). Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be taken up in that interval. Although computed differently for the basic and advanced phytoplankton constituent models, the interpretation of this quantity is the same for both Phytoplankton:Basic Equation (K.7) WQ_DIAG_PHYTO_COM_C_UPTAKE_MG_L_D WQ_DIAG_PHYTO_COM_C_UPTAKE_MMOL_M3_D Community carbon uptake \\(F_{C-uptake\\langle computed\\rangle}^{comm}\\) \\(\\mu\\)g/L/d mmol/m\\(^3\\)/d The flux of carbon (and nutrients) to phytoplankton as a result of productivity, without accounting for respiration, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community). Also referred to as growth, and typically associated with daytime phytoplankton photosynthesis. Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be taken up via productivity in that interval. This is numerically the same as primary productivity Phytoplankton:Basic Equation (K.1) WQ_DIAG_PHYTO_COM_PAR_W_M2 Community PAR PAR W/m\\(^2\\) The ambient PAR field in each computational cell, as set by the hydrodynamic model Phytoplankton:Basic Section 2.3.2 WQ_DIAG_PHYTO_COM_TCHLA_MICG_L Community chlorophyll a \\(\\left[Chla\\right]^{comm}\\) \\(\\mu\\)g/L The total chlorophyll a summed across all phytoplankton groups Phytoplankton:Basic WQ_DIAG_PHYTO_COM_TPHY_MMOL_C_M3 WQ_DIAG_PHYTO_COM_TPHY_MMOL_C_M3 Community phytoplankton concentration \\(\\left[Chla\\right]^{comm}\\) mmol/m\\(^3\\) mmol/m\\(^3\\) The concentration of phytoplankton in mmols of carbon, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community). Multiplying this number by 12 and dividing (on a cell by cell basis) by the equivalent Community chlorophyll a value (as reported, i.e. in \\(\\mu\\)g/L) will result in an array of the average carbon to chlorophyll a ratio of the community for each cell. This is effectively a concentration weighted average of the individual phytoplankton group carbon to chlorophyll a ratios at any given time and in any given cell Phytoplankton:Basic WQ_DIAG_PHYTO_COM_T_IN_N_MG_L WQ_DIAG_PHYTO_COM_T_IN_N_MMOL_M3 Community internal nitrogen concentration \\(\\left[N\\right]_{in}^{comm}\\) \\(\\mu\\)g/L mmol/m\\(^3\\) The internal nitrogen concentration of phytoplankton, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community), for both the basic and advanced phytoplankton constituent models Phytoplankton:Basic Section K.2.2 WQ_DIAG_PHYTO_COM_T_IN_P_MG_L WQ_DIAG_PHYTO_COM_T_IN_P_MMOL_M3 Community internal phosphorus concentration \\(\\left[P\\right]_{in}^{comm}\\) \\(\\mu\\)g/L mmol/m\\(^3\\) The internal phosphorus concentration of phytoplankton, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community), for both the basic and advanced phytoplankton constituent models Phytoplankton:Basic Section K.3.2 WQ_DIAG_INPUT_O2_SED_FLUX_MG_M2_D WQ_DIAG_INPUT_O2_SED_FLUX_MMOL_M2_D Oxygen user defined sediment flux \\(F_{sed}^{O_2}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The user defined (or model default) flux of oxygen across the sediment water interface. This value is reported for completeness and should not change in time for a given cell. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. This diagnostic cannot be used in mass balance or other related calculations Oxygen:O2 Equation (D.6) WQ_DIAG_INPUT_SI_SED_FLUX_MG_M2_D WQ_DIAG_INPUT_SI_SED_FLUX_MMOL_M2_D Silicate user defined sediment flux \\(F_{sed}^{Si}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The user defined (or model default) flux of silicate across the sediment water interface. This value is reported for completeness and should not change in time for a given cell. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. This diagnostic cannot be used in mass balance or other related calculations Silicate:Si Equation (E.1) WQ_DIAG_INPUT_NH4_SED_FLUX_MG_M2_D WQ_DIAG_INPUT_NH4_SED_FLUX_MMOL_M2_D Ammonium user defined sediment flux \\(F_{sed}^{NH_4}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The user defined (or model default) flux of ammonium across the sediment water interface. This value is reported for completeness and should not change in time for a given cell. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. This diagnostic cannot be used in mass balance or other related calculations Inorganic nitrogen:AmmoniumNitrate Equation (F.1) WQ_DIAG_INPUT_NO3_SED_FLUX_MG_M2_D WQ_DIAG_INPUT_NO3_SED_FLUX_MMOL_M2_D Nitrate user defined sediment flux \\(F_{sed}^{NO_3}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The user defined (or model default) flux of nitrate across the sediment water interface. This value is reported for completeness and should not change in time for a given cell. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. This diagnostic cannot be used in mass balance or other related calculations Inorganic nitrogen:AmmoniumNitrate Equation (F.1) WQ_DIAG_INPUT_FRP_SED_FLUX_MG_M2_D WQ_DIAG_INPUT_FRP_SED_FLUX_MMOL_M2_D FRP user defined sediment flux \\(F_{sed}^{FRP}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The user defined (or model default) flux of FRP across the sediment water interface. This value is reported for completeness and should not change in time for a given cell. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. This diagnostic cannot be used in mass balance or other related calculations Inorganic phosphorus:FRPhs Equation (G.1) WQ_DIAG_INPUT_DOC_SED_FLUX_MG_M2_D WQ_DIAG_INPUT_DOC_SED_FLUX_MMOL_M2_D DOC user defined sediment flux \\(F_{sed}^{DOC}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The user defined (or model default) flux of DOC across the sediment water interface. This value is reported for completeness and should not change in time for a given cell. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. This diagnostic cannot be used in mass balance or other related calculations Organic matter:Labile Equation (N.1) WQ_DIAG_INPUT_DON_SED_FLUX_MG_M2_D WQ_DIAG_INPUT_DON_SED_FLUX_MMOL_M2_D DON user defined sediment flux \\(F_{sed}^{DON}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The user defined (or model default) flux of DON across the sediment water interface. This value is reported for completeness and should not change in time for a given cell. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. This diagnostic cannot be used in mass balance or other related calculations Organic matter:Labile Equation (N.1) WQ_DIAG_INPUT_DOP_SED_FLUX_MG_M2_D WQ_DIAG_INPUT_DOP_SED_FLUX_MMOL_M2_D DOP user defined sediment flux \\(F_{sed}^{DOP}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d The user defined (or model default) flux of DOP across the sediment water interface. This value is reported for completeness and should not change in time for a given cell. Positive (negative) values are fluxes to (from) the water column from (to) the sediment. This diagnostic cannot be used in mass balance or other related calculations Organic matter:Labile Equation (N.1) WQ_DIAG_TOTAL_NITROGEN_MG_L WQ_DIAG_TOTAL_NITROGEN_MMOL_M3 Total nitrogen \\(TN\\) mg/L mmol/m\\(^3\\) The sum of relevant nitrogen species. These are: Simulation class DO: none Simulation class inorganics: ammonium, nitrate, phytoplankton internal nitrogen (whether it is a simulated variable or not it still contributes to total nitrogen) Simulation class organics: ammonium, nitrate, phytoplankton internal nitrogen, DON, PON and RDON if refractory organic constituent model is used WQ_DIAG_TOTAL_PHOSPHORUS_MG_L WQ_DIAG_TOTAL_PHOSPHORUS_MMOL_M3 Total phosphorus \\(TP\\) mg/L mmol/m\\(^3\\) The sum of relevant phosphorus species. These are: Simulation class DO: none Simulation class inorganics: FRP, adsorbed FRP if simulated, phytoplankton internal phosphorus (whether it is a simulated variable or not it still contributes to total phosphorus) Simulation class organics: FRP, adsorbed FRP if simulated, phytoplankton internal phosphorus, DOP, POP and RDOP if refractory organic constituent model is used WQ_DIAG_TOTAL_KJELDAHL_NITROGEN_MG_L WQ_DIAG_TOTAL_KJELDAHL_NITROGEN_MMOL_M3 Total Kjeldahl nitrogen \\(TKN\\) mg/L mmol/m\\(^3\\) The sum of relevant nitrogen species. These are: Simulation class DO: none Simulation class inorganics: ammonium, phytoplankton internal nitrogen (whether it is a simulated variable or not it still contributes to total nitrogen) Simulation class organics: ammonium, phytoplankton internal nitrogen, DON, PON and RDON if refractory organic constituent model is used WQ_DIAG_TOTAL_ORGANIC_CARBON_MG_L WQ_DIAG_TOTAL_ORGANIC_CARBON_MMOL_M3 Total organic carbon \\(TOC\\) mg/L mmol/m\\(^3\\) The sum of relevant carbon species. These are: Simulation class DO: none Simulation class inorganics: phytoplankton carbon Simulation class organics: phytoplankton carbon, DOC, POC, and RDOC and RPOM if refractory organic constituent model is used WQ_DIAG_INPUT_POC_SED_FLUX_MG_M2_D WQ_DIAG_INPUT_POC_SED_FLUX_MMOL_M2_D POC user defined sediment flux \\(F_{sed}^{POC}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_INPUT_PON_SED_FLUX_MG_M2_D WQ_DIAG_INPUT_PON_SED_FLUX_MMOL_M2_D PON user defined sediment flux \\(F_{sed}^{PON}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_INPUT_POP_SED_FLUX_MG_M2_D WQ_DIAG_INPUT_POP_SED_FLUX_MMOL_M2_D POP user defined sediment flux \\(F_{sed}^{POP}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_ACTUAL_POC_SED_FLUX_MG_M2_D WQ_DIAG_ACTUAL_POC_SED_FLUX_MMOL_M2_D POC sediment flux \\(F_{sed\\langle computed\\rangle}^{POC}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d Currently unused and reported as the same as WQ_DIAG_POC_SEDMTN_FLUX_MG_M2_D. Will be activated in future releases WQ_DIAG_ACTUAL_PON_SED_FLUX_MG_M2_D WQ_DIAG_ACTUAL_PON_SED_FLUX_MMOL_M2_D PON sediment flux \\(F_{sed\\langle computed\\rangle}^{PON}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d Currently unused and reported as the same as WQ_DIAG_PON_SEDMTN_FLUX_MG_M2_D. Will be activated in future releases WQ_DIAG_ACTUAL_POP_SED_FLUX_MG_M2_D WQ_DIAG_ACTUAL_POP_SED_FLUX_MMOL_M2_D POP sediment flux \\(F_{sed\\langle computed\\rangle}^{POP}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d Currently unused and reported as the same as WQ_DIAG_POP_SEDMTN_FLUX_MG_M2_D. Will be activated in future releases WQ_DIAG_SEDIMENT_ORGC_MASS_MG_M2 WQ_DIAG_SEDIMENT_ORGC_MASS_MMOL_M2 Organic carbon sediment mass \\(M_{sed}^{OC}\\) mg/m\\(^2\\) mmol/m\\(^2\\) Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_SEDIMENT_ORGN_MASS_MG_M2 WQ_DIAG_SEDIMENT_ORGN_MASS_MMOL_M2 Organic nitrogen sediment mass \\(M_{sed}^{ON}\\) mg/m\\(^2\\) mmol/m\\(^2\\) Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_SEDIMENT_ORGP_MASS_MG_M2 WQ_DIAG_SEDIMENT_ORGP_MASS_MMOL_M2 Organic phosphorus sediment mass \\(M_{sed}^{OP}\\) mg/m\\(^2\\) mmol/m\\(^2\\) Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_POC_RESUS_MG_M2_D WQ_DIAG_POC_RESUS_MMOL_M2_D POC resuspension flux \\(F_{resus}^{POC}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_PON_RESUS_MG_M2_D WQ_DIAG_PON_RESUS_MMOL_M2_D PON resuspension flux \\(F_{resus}^{PON}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_POP_RESUS_MG_M2_D WQ_DIAG_POP_RESUS_MMOL_M2_D POP resuspension flux \\(F_{resus}^{POP}\\) mg/m\\(^2\\)/d mmol/m\\(^2\\)/d Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_PHYTO_COM_N2_UPTAKE_MG_L_D WQ_DIAG_PHYTO_COM_N2_UPTAKE_MMOL_M3_D Community nitrogen fixing uptake \\(F_{N-fix}^{comm}\\) mg/L/d mmol/m\\(^3\\)/d The flux of atmospheric nitrogen fixed by phytoplankton, summed over all phytoplankton groups (i.e. a simulation’s phytoplankton community), for both the basic and advanced phytoplankton constituent models WQ_DIAG_ANAER_NH4_OX_MG_L_D WQ_DIAG_ANAER_NH4_OX_MMOL_M3_D Anaerobic oxidation of ammonium \\(F_{anmx\\langle computed\\rangle}^{N_2}\\) mg/L/d mmol/m\\(^3\\)/d The flux of ammonium-N and nitrate-N to free diatomic nitrogen gas (also referred to as anammox). Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) on N that would be lost via anammox in that interval. The diagnostic variable is the production of nitrogen gas N (not N\\(_2\\)) Inorganic nitrogen:AmmoniumNitrate Equation (F.10) WQ_DIAG_DISS_NO3_RED_MG_L_D WQ_DIAG_DISS_NO3_RED_MMOL_M3_D Dissimilatory reduction of nitrate to ammonium \\(F_{DRNA\\langle computed\\rangle}^{NO_3}\\) mg/L/d mmol/m\\(^3\\)/d The flux of nitrate-N to ammonium-N (also referred to as DRNA). Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) on N that would be lost via DRNA in that interval Inorganic nitrogen:AmmoniumNitrate Equation (F.12) WQ_DIAG_RPOM_BREAKDOWN_MG_L_D WQ_DIAG_RPOM_BREAKDOWN_MMOL_M3_D RPOM breakdown \\(F_{bdn\\langle computed\\rangle}^{RPOM}\\) mg/L/d mmol/m\\(^3\\)/d The flux of refractory particulate organic matter to labile particulate organic matter under microbial activity. This flux is always positive and is applied directly to the carbon fraction of RPOM. Equivalent nitrogen and phosphorus fraction fluxes are computed proportionately as per Equation (N.7) Organic matter:Refractory Equation (N.6) WQ_DIAG_RDOC_ACTV_MG_L_D WQ_DIAG_RDOC_ACTV_MMOL_M3_D RDOC activation \\(F_{act\\langle computed\\rangle}^{RDOC}\\) mg/L/d mmol/m\\(^3\\)/d The flux of refractory dissolved organic carbon to labile dissolved organic carbon under microbial activity. This flux is always positive Organic matter:Refractory Equation (N.18) WQ_DIAG_RDON_ACTV_MG_L_D WQ_DIAG_RDON_ACTV_MMOL_M3_D RDON activation \\(F_{act\\langle computed\\rangle}^{RDON}\\) mg/L/d mmol/m\\(^3\\)/d The flux of refractory dissolved organic nitrogen to labile dissolved organic nitrogen under microbial activity. This flux is always positive Organic matter:Refractory Equation (N.18) WQ_DIAG_RDOP_ACTV_MG_L_D WQ_DIAG_RDOP_ACTV_MMOL_M3_D RDOP activation \\(F_{act\\langle computed\\rangle}^{RDOP}\\) mg/L/d mmol/m\\(^3\\)/d The flux of refractory dissolved organic phosphorus to labile dissolved organic phosphorus under microbial activity. This flux is always positive Organic matter:Refractory Equation (N.18) WQ_DIAG_PHY_NAME_RESP_MICG_L_D WQ_DIAG_PHY_NAME_RESP_MMOL_M3_D Phytoplankton respiration \\(F_{resp\\langle computed\\rangle}^{phy}\\) \\(\\mu\\)g/L/d mmol/m\\(^3\\)/d The flux of carbon from phytoplankton as a result of energy consumption (referred to as true respiration). It is typically seen as a night time phytoplanktonic process but can also occur during the day. Values are only negative. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost via true respiration in that interval Phytoplankton:Basic Equation (I.8) WQ_DIAG_PHY_NAME_RESP_N_MG_L_D WQ_DIAG_PHY_NAME_RESP_N_MMOL_M3_D Phytoplankton respiration - nitrogen \\(F_{resp-N\\langle computed\\rangle}^{phy}\\) mg/L/d mmol/m\\(^3\\)/d The flux of nitrogen from phytoplankton as a result of energy consumption (referred to as true respiration). It is typically seen as a night time phytoplanktonic process but can also occur during the day. Values are only negative. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost via true respiration in that interval Phytoplankton:Basic Equation (I.10) WQ_DIAG_PHY_NAME_RESP_P_MG_L_D WQ_DIAG_PHY_NAME_RESP_P_MMOL_M3_D Phytoplankton respiration - phosphorus \\(F_{resp-P\\langle computed\\rangle}^{phy}\\) mg/L/d mmol/m\\(^3\\)/d The flux of phosphorus from phytoplankton as a result of energy consumption (referred to as true respiration). It is typically seen as a night time phytoplanktonic process but can also occur during the day. Values are only negative. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost via true respiration in that interval Phytoplankton:Basic Equation (I.11) WQ_DIAG_PHY_NAME_PRIM_PROD_N_MG_L_D WQ_DIAG_PHY_NAME_PRIM_PROD_N_MMOL_M3_D Phytoplankton primary productivity - nitrogen \\(F_{N-uptake}^{phy}\\) mg/L/d mmol/m\\(^3\\)/d The flux of nitrogen to phytoplankton as a result of productivity, without accounting for respiration, for a phytoplankton group. Also referred to as growth or gross primary productivity, and typically associated with daytime phytoplankton photosynthesis. Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be taken up via productivity in that interval. This diagnostic varible name is used for both basic and advanced phytoplankton groups, even though the method to compute uptake differs between the two Phytoplankton:Basic Phytoplankton:Advanced Equation (K.2) Equation (K.4) WQ_DIAG_PHY_NAME_PRIM_PROD_P_MG_L_D WQ_DIAG_PHY_NAME_PRIM_PROD_P_MMOL_M3_D Phytoplankton primary productivity - phosphorus \\(F_{P-uptake}^{phy}\\) mg/L/d mmol/m\\(^3\\)/d The flux of phosphorus to phytoplankton as a result of productivity, without accounting for respiration, for a phytoplankton group. Also referred to as growth or gross primary productivity, and typically associated with daytime phytoplankton photosynthesis. Values are only positive. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be taken up via productivity in that interval. This diagnostic varible name is used for both basic and advanced phytoplankton groups, even though the method to compute uptake differs between the two Phytoplankton:Basic Phytoplankton:Advanced Equation (K.7) Equation (K.8) WQ_DIAG_PHY_NAME_SEDMTN_N_MG_L_D WQ_DIAG_PHY_NAME_SEDMTN_N_MMOL_M3_D Phytoplankton sedimentation - nitrogen \\(F_{sedmtn-N\\langle computed\\rangle}^{phy}\\) mg/L/d mmol/m\\(^3\\)/d The flux of phytoplankton nitrogen into the sediments as a result of settling for a phytoplankton group. Values are only losses and are only negative. Multiply by cell volume (L or m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost to settling in that interval. This diagnostic varible name is used for both basic and advanced phytoplankton groups, even though the method to compute uptake differs between the two. Although often thought of as being a per area (per m\\(^2\\)) loss, the volumetric units of this diagnostic (per L or m\\(^3\\)) have been chosen deliberately for consistency with other analogous volumetric losses such as mortality. This is intended to assist in simplifying post processing Phytoplankton:Basic Phytoplankton:Advanced Equation (I.14) Equation (I.15) WQ_DIAG_PHY_NAME_SEDMTN_P_MG_L_D WQ_DIAG_PHY_NAME_SEDMTN_P_MMOL_M3_D Phytoplankton sedimentation - phosphorus \\(F_{sedmtn-P\\langle computed\\rangle}^{phy}\\) mg/L/d mmol/m\\(^3\\)/d The flux of phytoplankton phosphorus into the sediments as a result of settling for a phytoplankton group. Values are only losses and are only negative. Multiply by cell volume (L or m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost to settling in that interval. This diagnostic varible name is used for both basic and advanced phytoplankton groups, even though the method to compute uptake differs between the two. Although often thought of as being a per area (per m\\(^2\\)) loss, the volumetric units of this diagnostic (per L or m\\(^3\\)) have been chosen deliberately for consistency with other analogous volumetric losses such as mortality. This is intended to assist in simplifying post processing Phytoplankton:Basic Phytoplankton:Advanced Equation (I.16) Equation (I.17) WQ_DIAG_PHY_NAME_EXCR_MICG_L_D WQ_DIAG_PHY_NAME_EXCR_MMOL_M3_D Phytoplankton excretion \\(F_{C-excr}^{phy}\\) mg/L/d mmol/m\\(^3\\)/d The flux of carbon from phytoplankton as a result of excretion for a phytoplankton group. Values are only negative. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost via excretion in that interval Phytoplankton:Basic Equation (L.1) WQ_DIAG_PHY_NAME_MORT_MICG_L_D WQ_DIAG_PHY_NAME_MORT_MMOL_M3_D Phytoplankton mortality \\(F_{C-mort}^{phy}\\) mg/L/d mmol/m\\(^3\\)/d The flux of carbon from phytoplankton as a result of mortality for a phytoplankton group. Values are only negative. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost via mortality in that interval Phytoplankton:Basic Equation (L.2) WQ_DIAG_PHY_NAME_EXCR_N_MG_L_D WQ_DIAG_PHY_NAME_EXCR_N_MMOL_M3_D Phytoplankton excretion - nitrogen \\(F_{N-excr}^{phy}\\) mg/L/d mmol/m\\(^3\\)/d The flux of nitrogen from phytoplankton as a result of excretion for a phytoplankton group. Values are only negative. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost via excretion in that interval Phytoplankton:Basic Equation (L.3) WQ_DIAG_PHY_NAME_MORT_N_MG_L_D WQ_DIAG_PHY_NAME_MORT_N_MMOL_M3_D Phytoplankton mortality - nitrogen \\(F_{N-mort}^{phy}\\) mg/L/d mmol/m\\(^3\\)/d The flux of nitrogen from phytoplankton as a result of mortality for a phytoplankton group. Values are only negative. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost via mortality in that interval Phytoplankton:Basic Equation (L.4) WQ_DIAG_PHY_NAME_EXCR_P_MG_L_D WQ_DIAG_PHY_NAME_EXCR_P_MMOL_M3_D Phytoplankton excretion - phosphorus \\(F_{P-excr}^{phy}\\) mg/L/d mmol/m\\(^3\\)/d The flux of phosphorus from phytoplankton as a result of excretion for a phytoplankton group. Values are only negative. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost via excretion in that interval Phytoplankton:Basic Equation (L.5) WQ_DIAG_PHY_NAME_MORT_P_MG_L_D WQ_DIAG_PHY_NAME_MORT_P_MMOL_M3_D Phytoplankton mortality - phosphorus \\(F_{P-mort}^{phy}\\) mg/L/d mmol/m\\(^3\\)/d The flux of phosphorus from phytoplankton as a result of mortality for a phytoplankton group. Values are only negative. Multiply by cell volume (m\\(^3\\)) and time interval of interest (seconds/86400) to compute the mass (or moles) that would be lost via mortality in that interval Phytoplankton:Basic Equation (L.6) WQ_DIAG_FRP_ADS_SEDMTN_FLUX_MG_L_D WQ_DIAG_FRP_ADS_SEDMTN_FLUX_MMOL_M3_D Adsorbed FRP sedimentation rate \\(F_{sed\\langle computed\\rangle}^{FRPAds}\\) mg/L/d mmol/m\\(^3\\)/d Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_FRP_ADS_RESUS_FLUX_MG_L_D WQ_DIAG_FRP_ADS_RESUS_FLUX_MMOL_M3_D Adsorbed FRP resuspension rate \\(F_{resus}^{FRPads}\\) mg/L/d mmol/m\\(^3\\)/d Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_FRP_ADSORPTION_RATE_MG_L_D WQ_DIAG_FRP_ADSORPTION_RATE_MMOL_M3_D FRP adsorption rate \\(F_{ads\\langle computed\\rangle}^{FRP}\\) mg/L/d mmol/m\\(^3\\)/d Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_PATH_NAME_MORTALITY_CFU_100ML_D Pathogen mortality \\(F_{mor}^{pth}\\) CFU/100mL/d The flux of pathogens from alive to dead, as a result of natural (dark death) mortality. This flux includes the mortality of attached pathogens, if they are simulated. This is not the inactivation flux due to irradiation. Pathogen:Free Equation (O.1) WQ_DIAG_PATH_NAME_LIGHT_CFU_100ML_D Pathogen inactivation \\(F_{invn}^{pth}\\) CFU/100mL/d The flux of pathogens from alive to dead, as a result of irradiation. This flux includes the inactivation of attached pathogens, if they are simulated. This is not the dark death flux due to mortality. Pathogen:Free Equation (O.3) WQ_DIAG_PATH_NAME_ATTACHMENT_CFU_100ML_D Pathogen attachment \\(F_{att}^{pth}\\) CFU/100mL/d The flux of pathogens from free to attached, if attached pathogens are simulated. A positive (negative) flux is attachment (detachment) Pathogen:Attached Equation (O.4) WQ_DIAG_PATH_NAME_ALIVE_SEDMTN_CFU_100ML_D Pathogen alive sedimentation \\(F_{sedmtn\\langle computed\\rangle}^{pth_a}\\) CFU/100mL/d The flux of alive pathogens into the sediments as a result of settling for a pathogen group. Values are only losses and are only negative. Multiply by volume and time interval of interest (seconds/86400) to compute the CFU that would be lost to settling in that interval. Although often thought of as being a per area (per m\\(^2\\)) loss, the volumetric units of this diagnostic have been chosen deliberately for consistency with other analogous volumetric losses such as mortality. This is intended to assist in simplifying post processing Pathogen:Free Equation (O.6) WQ_DIAG_PATH_NAME_DEAD_SEDMTN_CFU_100ML_D Pathogen alive sedimentation \\(F_{sedmtn\\langle computed\\rangle}^{pth_d}\\) CFU/100mL/d The flux of dead pathogens into the sediments as a result of settling for a pathogen group. Values are only losses and are only negative. Multiply by volume and time interval of interest (seconds/86400) to compute the CFU that would be lost to settling in that interval. Although often thought of as being a per area (per m\\(^2\\)) loss, the volumetric units of this diagnostic have been chosen deliberately for consistency with other analogous volumetric losses such as mortality. This is intended to assist in simplifying post processing Pathogen:Free Equation (O.6) WQ_DIAG_PATH_NAME_ATTCHD_SEDMTN_CFU_100ML_D Pathogen attached sedimentation \\(F_{sedmtn\\langle computed\\rangle}^{pth_t}\\) CFU/100mL/d The flux of attached pathogens into the sediments as a result of settling for a pathogen group. Values are only losses and are only negative. Multiply by volume and time interval of interest (seconds/86400) to compute the CFU that would be lost to settling in that interval. Although often thought of as being a per area (per m\\(^2\\)) loss, the volumetric units of this diagnostic have been chosen deliberately for consistency with other analogous volumetric losses such as mortality. This is intended to assist in simplifying post processing Pathogen:Attached Equation (O.7) WQ_DIAG_PATH_NAME_GROWTH_CFU_100ML_D Pathogen growth \\(F_{growth\\langle computed\\rangle}^{pth_a}\\) CFU/100mL/d Currently unused and reported as zero. Will be activated in future releases WQ_DIAG_PATH_NAME_TOTAL_CFU_100ML_D Total pathogens \\(\\left[ PTH\\right]^{TOT}\\) CFU/100mL The sum of alive, dead and attached (if the latter is simulated) pathogens for a pathogen group Pathogen:Free Equation (O.8) "],["AppParams.html", "Appendix R Parameters", " Appendix R Parameters .book .book-body .page-wrapper .page-inner { max-width: 95%; } Following are parameters that can be specified within the WQ Module via user commands. Tips for use: Use the search box to dynamically filter the table Sort the filtered (or unfiltered) table by clicking the arrows at the top of each column Use “s” on your keyboard to toggle the contents pane on and off to provide more screen width if needed UD = user defined N/A = not applicable For each parameter, use the links in the final column to navigate to either: A description of the corresponding control file command that includes the parameter (these links are all suffixed with ‘==’) The section describing the relevant science and/or equations (these links are all called ‘science’) Where numerical limits are provided for phytoplankton simulation parameters, the conversion bewteen \\(\\mu\\)g/L Clh a and mmol/m\\(^3\\) or carbon is assumed to be 27.0 mg C/mg Chl a Where parameter ranges are provided, these are not to be taken as fixed, but as indicative only. Some environmental settings may require parameterisation outside the ranges specified in this manual. Table R.1: WQ Module parameters Parameter Notation Units Range Default Description Links Sediment oxygen flux \\(F_{sed}^{O_2}\\) mg O\\(_2\\)/m\\(^2\\)/d mmol O\\(_2\\)/m\\(^2\\)/d (-6400, 0) (-200, 0) 0 0 The rate at which dissolved oxygen is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of oxygen sediment flux oxygen flux == science Sediment half saturation oxygen concentration for oxygen flux \\(K_{sed-O_2}^{O_2}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed sediment oxygen flux is half the user specified rate, at 20\\(^o\\)C. Cannot be varied spatially oxygen benthic == science Sediment oxygen flux temperature coefficient \\(\\theta_{sed}^{O_2}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on oxygen sediment flux. A value of 1.0 will remove the effect of temperature oxygen benthic == science Minimum dissolved oxygen concentration \\(\\left[DO\\right]_{min}^{O_2}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 0.5) (0, 15.6) NA NA The minimum allowable dissolved oxygen concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual oxygen min max == science Maximum dissolved oxygen concentration \\(\\left[DO\\right]_{max}^{O_2}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (6, 20) (187.5, 625) NA NA The maximum allowable dissolved oxygen concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues oxygen min max == science Timestep \\(dt\\) seconds (UD, UD) 900 The timestep at which the WQ Module is called from the hydrodynamic model wq dt == Sediment silicate flux \\(F_{sed}^{Si}\\) mg Si/m\\(^2\\)/d mmol Si/m\\(^2\\)/d (0, 140) (0, 5) 0 0 The rate at which silicate is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of silicate sediment flux silicate flux == science Sediment half saturation oxygen concentration for silicate flux \\(K_{sed-O_2}^{Si}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed sediment silicate flux is half the user specified rate, at 20\\(^o\\)C. Cannot be varied spatially silicate benthic == science Sediment silicate flux temperature coefficient \\(\\theta_{sed}^{Si}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on silicate sediment flux. A value of 1.0 will remove the effect of temperature silicate benthic == science Minimum silicate concentration \\(\\left[Si\\right]_{min}^{Si}\\) mg/L Si mmol/m\\(^3\\) Si (0, 2.8) (0, 100) NA NA The minimum allowable silicate concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual silicate min max == science Maximum silicate concentration \\(\\left[Si\\right]_{max}^{Si}\\) mg/L Si mmol/m\\(^3\\) Si (0, 140) (0, 5000) NA NA The maximum allowable silicate concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues silicate min max == science Sediment ammonium flux \\(F_{sed}^{NH_4}\\) mg NH\\(_4\\)-N/m\\(^2\\)/d mmol NH\\(_4\\)-N/m\\(^2\\)/d (0, 140) (0, 10) 0 0 The rate at which ammonium is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of ammonium sediment flux ammonium flux == science Sediment half saturation oxygen concentration for ammonium flux \\(K_{sed-O_2}^{NH_4}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed sediment ammonium flux is half the user specified rate, at 20\\(^o\\)C. Cannot be varied spatially ammonium benthic == science Sediment ammonium flux temperature coefficient \\(\\theta_{sed}^{NH_4}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on ammonium sediment flux. A value of 1.0 will remove the effect of temperature ammonium benthic == science Minimum ammonium concentration \\(\\left[NH_4\\right]_{min}^{NH_4}\\) mg/L NH\\(_4\\)-N mmol/m\\(^3\\) NH\\(_4\\)-N (0, 0.098) (0, 7) NA NA The minimum allowable ammonium concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual ammonium min max == science Maximum ammonium concentration \\(\\left[NH_4\\right]_{max}^{NH_4}\\) mg/L NH\\(_4\\)-N mmol/m\\(^3\\) NH\\(_4\\)-N (0, 98) (0, 7000) NA NA The maximum allowable ammonium concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues ammonium min max == science Sediment nitrate flux \\(F_{sed}^{NO_3}\\) mg NO\\(_3\\)-N/m\\(^2\\)/d mmol NO\\(_3\\)-N/m\\(^2\\)/d (0, 140) (0, 10) 0 0 The rate at which nitrate is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of nitrate sediment flux nitrate flux == science Sediment half saturation oxygen concentration for nitrate flux \\(K_{sed-O_2}^{NO_3}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed sediment nitrate flux is half the user specified rate, at 20\\(^o\\)C. Cannot be varied spatially nitrate benthic == science Sediment nitrate flux temperature coefficient \\(\\theta_{sed}^{NO_3}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on nitrate sediment flux. A value of 1.0 will remove the effect of temperature nitrate benthic == science Minimum nitrate concentration \\(\\left[NO_3\\right]_{min}^{NO_3}\\) mg/L NO\\(_3\\)-N mmol/m\\(^3\\) NO\\(_3\\)-N (0, 0.098) (0, 7) NA NA The minimum allowable nitrate concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual nitrate min max == science Maximum nitrate concentration \\(\\left[NO_3\\right]_{max}^{NO_3}\\) mg/L NO\\(_3\\)-N mmol/m\\(^3\\) NO\\(_3\\)-N (0, 98) (0, 7000) NA NA The maximum allowable nitrate concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues nitrate min max == science Nitrification rate \\(R_{nitrif}^{NH_4}\\) /d (0, 1) 0 0 The rate at which ammonium is nitrified to nitrate at 20\\(^o\\)C excluding the influence of ambient dissolved oxygen concentration. A value of 0.0 will switch off nitrification nitrification == science Half saturation oxygen concentration for nitrification \\(K_{nitrif-O_2}^{NH_4}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed nitrification rate is half the user specified rate, at 20\\(^o\\)C nitrification == science Nitrification temperature coefficient \\(\\theta_{nitrif}^{NH_4}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on nitrification. A value of 1.0 will remove the effect of temperature nitrification == science Denitrification rate \\(R_{denit}^{NO_3}\\) /d (0, 0.5) 0 0 The rate at which nitrate is denitrified to nitrogen gas N\\(_2\\) at 20\\(^o\\)C excluding the influence of ambient dissolved oxygen and nitrate concentrations. A value of 0.0 will switch off denitrification denitrification == science Half saturation oxygen concentration for denitrification \\(K_{denit-O2-MM}^{NO_3}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed denitrification rate is half the user specified rate, at 20\\(^o\\)C and with no influence of ambient nitrate concentration. This value is used if the ‘Michaelis Menten’ denitrification model is speciifed as the first argument of the denitrification == command denitrification == science Normalising oxygen concentration for denitrification \\(K_{denit-O2-exp}^{NO_3}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration that divides (normalises) the ambient dissolved oxygen concentration in the exponent term of the exponential denitrification model, at 20\\(^o\\)C and with no influence of ambient nitrate concentration. This value is used if the ‘exponential’ denitrification model is speciifed as the first argument of the denitrification == command denitrification == science Denitrification temperature coefficient \\(\\theta_{denit}^{NO_3}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on denitrification. A value of 1.0 will remove the effect of temperature denitrification == science Half saturation nitrate concentration for denitrification \\(K_{denit-NO3}^{NO_3}\\) mg/L NO\\(_3\\)-N mmol/m\\(^3\\) NO\\(_3\\)-N (0, 5) (0, 357.1) 0.07 5 The nitrate concentration for which the computed denitrification rate is half the user specified rate, at 20\\(^o\\)C and with no influence of ambient dissolved oxygen concentration. This is not user specifiable and is set to the default value denitrification == science Denitrification model Michaelis Menten;exponential 0 (, ) 0 The model used to simulate denitrification denitrification == science Wet atmospheric inorganic nitrogen deposition \\(\\left[{TN}\\right]_{rain}\\) mg/L N mmol/m\\(^3\\) N (0, 98) (0, 7000) 0 0 The concentration of total inorganic nitrogen in rainfall. This is the sum of ammonium and nitrate N and is applied as a multiplicative factor to rainfall depth to compute a mass flux atmospheric deposition == science Dry atmospheric inorganic nitrogen deposition \\(R_{atm-dry}^{TN}\\) mg/m\\(^2\\)/d N mmol/m\\(^2\\)/d N (0, 98) (0, 7000) 0 0 The rate of atmopsheric fallout of dry inorganic nitrogen. This is the sum of ammonium and nitrate N and is applied as a spatial and temporal constant value to compute a mass flux atmospheric deposition == science Fraction of atmospheric nitrogen deposition that is nitrate \\(f_{TN}^{NO_3}\\) [-] (0, 1) 0 The fraction of N that is nitrate in atmospheric deposition. The same factor is applied to both wet and dry deposition of N. A value of 1 (0) will set wet and dry deposition to be purely nitrate (ammonium) atmospheric deposition == science Minimum FRP concentration \\(\\left[FRP\\right]_{min}^{FRP}\\) mg/L PO\\(_4\\)-P mmol/m\\(^3\\) PO\\(_4\\)-P (0, 0.01) (0, 0.32) NA NA The minimum allowable FRP concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual FRP min max == science Maximum FRP concentration \\(\\left[FRP\\right]_{max}^{FRP}\\) mg/L PO\\(_4\\)-P mmol/m\\(^3\\) PO\\(_4\\)-P (0, 10) (0, 320) NA NA The maximum allowable FRP concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues FRP min max == science Sediment FRP flux \\(F_{sed}^{FRP}\\) mg FRP-P/m\\(^2\\)/d mmol FRP-P/m\\(^2\\)/d (0, 155) (0, 5) 0 0 The rate at which FRP is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of FRP sediment flux FRP flux == science Sediment half saturation oxygen concentration for FRP flux \\(K_{sed-O_2}^{FRP}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed sediment FRP flux is half the user specified rate, at 20\\(^o\\)C. Cannot be varied spatially FRP benthic == science Sediment FRP flux temperature coefficient \\(\\theta_{sed}^{FRP}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on FRP sediment flux. A value of 1.0 will remove the effect of temperature FRP benthic == science Wet atmospheric FRP deposition \\(\\left[{FRP}\\right]_{rain}\\) mg/L P mmol/m\\(^3\\) P (0, 10) (0, 320) 0 0 The concentration of FRP in rainfall. This is only FRP P and is applied as a multiplicative factor to rainfall depth to compute a mass flux atmospheric deposition == science Dry atmospheric FRP deposition \\(R_{atm-dry}^{FRPads}\\) mg/m\\(^2\\)/d P mmol/m\\(^2\\)/d P (0, 10) (0, 320) 0 0 The rate of atmopsheric fallout of adsorbed FRP. This is only applied to adsorbed FRP P. If adsorbed FRP is not simulated then this value is ignored. If used, it is applied as a spatial and temporal constant value to compute a mass flux atmospheric deposition == science Minimum adsorbed FRP concentration \\(\\left[FRPads\\right]_{min}^{FRPads}\\) mg/L PO\\(_4\\)-P mmol/m\\(^3\\) PO\\(_4\\)-P (0, 0.01) (0, 0.32) NA NA The minimum allowable adsorbed FRP concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual FRPads min max == science Maximum adsorbed FRP concentration \\(\\left[FRPads\\right]_{max}^{FRPads}\\) mg/L PO\\(_4\\)-P mmol/m\\(^3\\) PO\\(_4\\)-P (0, 10) (0, 320) NA NA The maximum allowable adsorbed FRP concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues FRPads min max == science Linear FRP sorption partitioning coefficient \\(K_{ads-L}^{FRP}\\) L/mg (0.01, 0.3) 0.01 The coefficient that determines the partitioning of FRP between free and adsorbed states. Can be estimated by dividing adsorbed FRP by free FRP and the concentration of suspended sediment, if these three quantities are known adsorption == science Quadratic FRP sorption partitioning coefficient \\(K_{ads-Q}^{FRP}\\) L/mg (0.6, 0.8) 0.7 The ratio of adsorption and desorption rate coefficients for phosphorus adsorption == science Maximum adsorption capacity of phosphorus \\(Q^{FRP}_{max}\\) mg FRP-P/mg TSS (0.005, 0.006) 0.0051 The maximum mass of P that can be adsorbed onto ambient suspended sediment, per unit mass of suspended sediment adsorption == science Maximum adsorption particle size \\(D50_{ads-max}^{FRP}\\) m (, ) 0 Not yet used. Will be activated in future releases of the WQ Module Minimum phyto concentration \\(\\left[PHY\\right]_{min}^{PHY}\\) \\(\\mu\\)g/L Chl a mmol/m\\(^3\\) C (0.01, 0.1) (0.023, 0.225) 0.01 0.0225 The minimum allowable group phytoplankton concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. It is also important the this minuimum value not be set to zero. If phytoplankton concentrations are allowed to reduce to zero then the numerical scheme will not allow the group to regrow because growth is applied as a multiplicative factor from one timestep to the next. Multiplying any growth rate by a previous timestep’s zero group concentration will therefore always result in zero group oncentration for subsequent timesteps min max == science Maximum phyto concentration \\(\\left[PHY\\right]_{max}^{PHY}\\) \\(\\mu\\)g/L Chl a mmol/m\\(^3\\) C (0.01, 50) (0.0025, 112.5) NA NA The maximum allowable group phytoplankton concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues min max == science Standard temperature \\(T_{std}^{phy}\\) \\(^o\\)C (5, 25) 10 Used to compute shape of temperature limitation function between T\\(_{std}\\) and T\\(_{max}\\). Below T\\(_{std}\\), the phytoplankton temperature limitation function is a simple Arrhenius relationship. Must always be less than the specified T$_{max} temperature limitation == science Optimum temperature \\(T_{opt}^{phy}\\) \\(^o\\)C (5, 25) 20 Used to compute shape of temperature limitation function between T\\(_{std}\\) and T\\(_{max}\\). Must always be less than the specified T$_{max} temperature limitation == science Maximum temperature \\(T_{max}^{phy}\\) \\(^o\\)C (25, 35) 30 Used to compute shape of temperature limitation function between T\\(_{std}\\) and T\\(_{max}\\). Above T\\(_{max}\\), the phytoplankton temperature limitation function is 0. Must always be greater than the specified T\\(_{std} and T\\)_{opt}$ temperature limitation == science Optimum freshwater salinity \\(S_{opt-fresh}^{phy}\\) g/L (0, 45) 0 Used to compute the freshwater salinity limitation function. It is the maximum salinity at which the freshwater salinity limitation function has a value of 1 salinity limitation == science Maximum freshwater salinity \\(S_{max-fresh}^{phy}\\) g/L (0, 45) 5 Used to compute the freshwater salinity limitation function. It is the maximum salinity at which the freshwater salinity limitation function is greater than the vlaue of \\(L_{max-fresh}^{phy}\\) salinity limitation == science Limitation function at maximum freshwater salinity \\(L_{max-fresh}^{phy}\\) [-] (0, -) 0 Used to compute the freshwater salinity limitation function. It is the value of the freshwater limitation function at a salinity of \\(S_{max-fresh}\\). If this limitation function value is set to be between zero and one (greater than one), then the computed limitation will be applied as a reductive (enhancement) factor to primary productivity (respiration). salinity limitation == science Optimum marine salinity \\(S_{opt-marine}^{phy}\\) g/L (0, 45) 0 Used to compute the marine salinity limitation function. It is the minimum salinity at which the marine salinity limitation function has a value of 1 salinity limitation == science Limitation function at zero marine salinity \\(L_{zero-marine}^{phy}\\) [-] (0, -) 0 Used to compute the marine salinity limitation function. It is the value of the marine limitation function at a salinity of zero. If this limitation function value is set to be between zero and one (greater than one), then the computed limitation will be applied as a reductive (enhancement) factor to primary productivity (respiration). salinity limitation == science Optimum mixed salinity \\(S_{opt-mix}^{phy}\\) g/L (0, 45) 0 Used to compute the mixed salinity limitation function. It is the minimum salinity at which the mixed salinity limitation function has a value of 1 salinity limitation == science Maximum mixed salinity \\(S_{max-mix}^{phy}\\) g/L (0, 45) 5 Used to compute the mixed salinity limitation function. It is the maximum salinity at which the mixed salinity limitation function has a value of 1 salinity limitation == science Limitation function at zero and (\\(S_{opt-mix}^{phy} + S_{max-mix}^{phy}\\)) mixed salinity \\(L_{zero-mix}^{phy}\\) [-] (0, -) 0 Used to compute the mixed salinity limitation function. It is the value of the mixed limitation function at a salinity of zero and (\\(S_{opt-mix}^{phy} + S_{max-mix}^{phy}\\)). If this limitation function value is set to be between zero and one (greater than one), then the computed limitation will be applied as a reductive (enhancement) factor to primary productivity (respiration). salinity limitation == science Optimum estuarine salinity \\(S_{opt-est}^{phy}\\) g/L (0, 45) 0 Used to compute the estuarine salinity limitation function. It is the salinity at which the estuarine salinity limitation function has a value of 1 salinity limitation == science Maximum estuarine salinity \\(S_{max-est}^{phy}\\) g/L (0, 45) 5 Used to compute the estuarine salinity limitation function. It is the maximum salinity at which the estuarine salinity limitation function has a value greater than zero salinity limitation == science Power coefficient for estuarine salinity limitation \\(P_{est}^{phy}\\) [-] (0, 5) 0 Used to compute the estuarine salinity limitation function. It determines the gradient of the estuarine limitation function (with salinity) above and below \\(S_{opt-est}^{phy}\\). Small (large) values of this parameter provide low (high) gradients salinity limitation == science Minimum concentration of N for phytoplankton uptake \\(\\left[N\\right]_{min}^{phy}\\) mg/L N mmol/m\\(^3\\) N (0, 0.1) (0.00, 7.14) 0.01 0.71 Used to compute the nitrogen limitation function in the basic phytoplankton model. Also used by the advanced phytoplankton model if internal nitrogen stores are exhausted. It is the minimum N concentration (as NH\\(_4\\)-N + NO\\(_3\\)-N) at which uptake of nitrogen by phytoplankton can occur nitrogen limitation == science Half saturation N concentration for phytoplankton uptake of N \\(K_{lim-N}^{phy}\\) mg/L N mmol/m\\(^3\\) N (1, 5) (71.4, 357.14) 1 71.43 Used to compute the nitrogen limitation function in the basic phytoplankton model. Also used by the advanced phytoplankton model if internal nitrogen stores are exhausted. It is the concentration of N (NH\\(_4\\)-N + NO\\(_3\\)-N) that when added to the specified minimum \\(\\left[N\\right]_{min}^{phy}\\) sets the nitrogen limitation function to a value of 0.5. A value of zero for this parameter will set the nitrogen limitation function to always be 1 nitrogen limitation == science Minimum ratio of internal phytoplankton N to biomass \\(X_{N-C-min}^{phy}\\) mg N/mg Chl a mmol N/mmol C (2.97, 4.75) (0.09, 0.15) 2.97 0.09 Used to compute the nitrogen limitation function in the advanced phytoplankton model if internal nitrogen stores are not exhausted. It should be based on the Redfield ratio of 106:16:1 or C:N:P (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g nitrogen limitation == science Maximum ratio of internal phytoplankton N to biomass \\(X_{N-C-max}^{phy}\\) mg N/mg Chl a mmol N/mmol C (4.75, 6.54) (0.15, 0.21) 6.54 0.21 Used to compute the nitrogen limitation function in the advanced phytoplankton model if internal nitrogen stores are not exhausted. It should be based on the Redfield ratio of 106:16:1 or C:N:P (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g nitrogen limitation == science Minimum concentration of P for phytoplankton uptake \\(\\left[P\\right]_{min}^{phy}\\) mg/L P mmol/m\\(^3\\) P (0, 0.1) (0.0, 3.23) 0.001 0.03 Used to compute the phosphorus limitation function in the basic phytoplankton model. Also used by the advanced phytoplankton model if internal phosphorus stores are exhausted. It is the minimum P concentration (as FRP-P) at which uptake of phosphorus by phytoplankton can occur phosphorus limitation == science Half saturation P concentration for phytoplankton uptake of P \\(K_{lim-P}^{phy}\\) mg/L P mmol/m\\(^3\\) P (0.1, 0.5) (3.23, 16.13) 0.1 3.23 Used to compute the phosphorus limitation function in the basic phytoplankton model. Also used by the advanced phytoplankton model if internal phosphorus stores are exhausted. It is the concentration of P (FRP-P) that when added to the specified minimum \\(\\left[P\\right]_{min}^{phy}\\) sets the phosphorus limitation function to a value of 0.5. A value of zero for this parameter will set the phosphorus limitation function to always be 1 phosphorus limitation == science Minimum ratio of internal phytoplankton P to biomass \\(X_{P-C-min}^{phy}\\) mg P/mg Chl a mmol P/mmol C (0.33, 0.66) (0.005, 0.009) 0.33 0.005 Used to compute the phosphorus limitation function in the advanced phytoplankton model if internal phosphorus stores are not exhausted. It should be based on the Redfield ratio of 106:16:1 or C:N:P (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g phosphorus limitation == science Maximum ratio of internal phytoplankton P to biomass \\(X_{P-C-max}^{phy}\\) mg P/mg Chl a mmol P/mmol C (0.66, 0.99) (0.009, 0.014) 0.99 0.014 Used to compute the phosphorus limitation function in the advanced phytoplankton model if internal phosphorus stores are not exhausted. It should be based on the Redfield ratio of 106:16:1 or C:N:P (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g phosphorus limitation == science Minimum concentration of silicate for phytoplankton uptake \\(\\left[Si\\right]_{min}^{phy}\\) mg/L Si mmol/m\\(^3\\) Si (0, 0.1) (0.00, 3.57) 0.01 0.36 Used to compute the silicate limitation function in the basic and advanced phytoplankton model. It is the minimum silicate concentration at which uptake of silicate by phytoplankton can occur silicate limitation == science Half saturation silicate concentration for phytoplankton uptake of silicate \\(K_{lim-Si}^{phy}\\) mg/L Si mmol/m\\(^3\\) Si (1, 10) (35.71, 357.14) 1 35.71 Used to compute the silicate limitation function in the basic and advanced phytoplankton model. It is the concentration of silicate that when added to the specified minimum \\(\\left[Si\\right]_{min}^{phy}\\) sets the silicate limitation function to a value of 0.5. A value of zero for this parameter will set the silicate limitation function to always be 1 silicate limitation == science Half saturation constant for basic model light growth limitation \\(I_{K-bas}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the basic light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident on the top and bottom of a computational cell and forms the lower limit of the exponential integral light limitation == science Half saturation constant for monod model light growth limitation \\(I_{K-mon}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the monod light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident at the centre of a computational cell light limitation == science Saturating light intensity for the steele model light growth limitation \\(I_{S-ste}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the steele light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident at the centre of a computational cell. This limitation function includes photoinhibition light limitation == science Half saturation constant for webb model light growth limitation \\(I_{K-web}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the webb light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident at the centre of a computational cell light limitation == science Half saturation constant for jassby model light growth limitation \\(I_{K-jas}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the jassby light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident at the centre of a computational cell light limitation == science Half saturation constant for chalker model light growth limitation \\(I_{K-cha}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the chalker light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident at the centre of a computational cell light limitation == science Saturating light intensity for the klepper model light growth limitation \\(I_{S-kle}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the klepper light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident at the centre of a computational cell. This limitation function includes photoinhibition light limitation == science Saturating light intensity for the integrated model light growth limitation \\(I_{S-int}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the integrated light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident on the top and bottom of a computational cell. This limitation function includes photoinhibition light limitation == science Constant ratio of internal phytoplankton N to biomass \\(X_{N-C-con}^{phy}\\) mg N/mg Chl a mmol N/mmol C (2.97, 6.54) (0.09, 0.21) 4.75 0.15 Used to compute the uptake of nitrogen during growth in the basic phytoplankton constituent model only. It should be based on the Redfield ratio of 106:16:1 or C:N:P (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g uptake == science Constant ratio of internal phytoplankton P to biomass \\(X_{P-C-con}^{phy}\\) mg P/mg Chl a mmol P/mmol C (0.33, 0.99) (0.009, 0.014) 0.66 0.009 Used to compute the uptake of phosphorus during growth in the basic phytoplankton constituent model only. It should be based on the Redfield ratio of 106:16:1 or C:N:P (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g uptake == science Constant ratio of internal phytoplankton silicate to biomass \\(X_{Si-C-con}^{phy}\\) mg Si/mg Chl a mmol Si/mmol C (5.94, 11.89) (0.09, 0.19) 8.92 0.14 Used to compute the uptake of silicate during growth in the basic and advanced phytoplankton constituent models. It should be based on the extended Redfield ratio of 106:16:1:15 or C:N:P:Si (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g uptake == science Rate of inorganic nitrogen uptake by phytoplankton \\(R_{N-uptake}^{phy}\\) mg N/mg Chl a/d mmol N/mmol C/d (0.080, 2.704) (0.0025, 0.086) 0 0 Used to compute the uptake of nitrogen during growth in the advanced phytoplankton constituent model only. It is the nitrogen uptake rate per unit of phytoplankton (per day) without any influence of temperature or nutrient limitation. The unit of phytoplankton is either mg (not \\(\\mu\\)g) Chl a or mmol C, depending on the units system used uptake == science Rate of inorganic phosphorus uptake by phytoplankton \\(R_{P-uptake}^{phy}\\) mg P/mg Chl a/d mmol P/mmol C/d (0.011, 0.374) (0.0002, 0.005) 0 0 Used to compute the uptake of phosphorus during growth in the advanced phytoplankton constituent model only. It is the phosphorus uptake rate per unit of phytoplankton (per day) without any influence of temperature or nutrient limitation. The unit of phytoplankton is either mg (not \\(\\mu\\)g) Chl a or mmol C, depending on the units system used uptake == science Constant rate of phytoplankton settling \\(V_{settle}^{phy}\\) m/d (-50, 0) 0 The constant settling velocity applied to phytoplankton using either the basic or advanced phytoplankton constituent model. It is applied as a constant (in the constant settling model) or modified by density (using the density correction model). A negative value is a downwards velocity settling == science Stokes settling light half saturation light intensity \\(I_{K-sto}\\) W/m\\(^2\\) (0, 1500) 20 The half saturation light intensity used to compute cell density, which is in turn required for calculation of Stokes settling velocity. It can be applied to either the basic or advanced phytoplankton constituent model. This value is ignored if \\(I_K\\) has been specified in a light limitation model within the same phytoplankton constituent model block settling == science Motile settling velocity \\(V_{mot}^{phy}\\) m/d (-50, 0) 0 The motile settling velocity applied to phytoplankton, that is then modified by local light conditions. It can be applied to only to the advanced phytoplankton constituent model. A negative value is a downwards velocity settling == science Motile settling light half saturation light intensity \\(I_{K-mot}\\) W/m\\(^2\\) (0, 1500) 20 The half saturation light intensity used to compute direction of motility. It can be applied only to the advanced phytoplankton constituent model. This value is ignored if \\(I_K\\) has been specified in a light limitation model within the same phytoplankton constituent model block settling == science Carbon to chlorophyll a ratio \\(X_{cc}^{phy}\\) mg carbon / mg chlorophyll a (20, 40) 27 The ratio of carbon to chlorophyll a in the cellular biomass of a phytoplankton group. The units of chlorophyll a in this ratio are milligrams (mg), not \\(\\mu\\)g. This value is constant for a given phytoplankton group carbon chla ratio == science Nitrogen fixing rate \\(R_{nfix}^{N_2}\\) mg N / mg Chl a / d mmol N / mmol C /d (0, 5) (0, 0.16) 0 0 The rate at which nitrogen N is fixed from the atmosphere to complement nitrogen uptake from the water column. This rate excludes the influence of nitrogen limitation due to water column nutrient scarcity. It is the mass (or molar) rate of uptake of nitrogen N from the atmopshere, not N\\(_2\\). Note the units of chlorophyll a are in mg, not \\(\\mu\\)g nitrogen fixing == science Penalty function of nitrogen fixing on primary productivity \\(f_{nfix}^{phy}\\) [-] (0, 1) 1 A rate modifier that accounts for the metabolic cost of nitrogen fixing on primary productivity. This modifier can be thought of as a penalty function, with values of zero and one corresponding to no and maximum penalties, respectively. A penalty of 1 (the default) will always set primary productivity to zero nitrogen fixing == science Phytoplankton primary productivity rate \\(R_{prod}^{phy}\\) /d (0, 3.5) 0 The phytoplankton primary productivity (growth) rate at 20\\(^o\\)C with no light, temperature, salinty, silicate or nutrient limitation. This rate is multiplied by ambient phytoplankton concentration to derive initial carbon, nutrient and silicate uptake fluxes primary productivity == science Phytoplankton primary productivity temperature coefficient \\(\\theta_{prod}^{phy}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on phytoplankton growth in the standard temperature limitation function. A value of 1.0 will remove the effect of temperature primary productivity == science Phytoplankton respiration rate \\(R_{resp}^{phy}\\) /d (0, 0.1) 0 The phytoplankton respiration rate at 20\\(^o\\)C with no temperature or salinty limitation. This rate is multiplied by ambient phytoplankton concentration to derive excretion and mortality fluxes. It is added to the parallel primary productivity and exudation rates and then multiplied by ambient phytoplankton concentration to compute biomass flux respiration == science Phytoplankton respiration temperature coefficient \\(\\theta_{resp}^{phy}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on phytoplankton respiration. A value of 1.0 will remove the effect of temperature respiration == science Fraction of phytoplankton respiration that is true respiration \\(f_{true-resp}^{phy}\\) [-] (0, 1) 1 The proportion of consumed carbohydrates (that were generated during photosynthesis) that are converted to energy, as opposed to waste matter. A value of one (zero) has all consumed carbohydrates converted to energy (waste), and will minimise (maximise) excretive losses respiration == science Fraction of phytoplanton loss that is excretion \\(f_{excr-loss}^{phy}\\) [-] (0, 1) 0 The proportion of combined excretive and mortality losses that are excretive. If \\(f_{true-resp}^{phy}\\) is set to one (zero) then this parameter has no (maximum) effect. respiration == science Fraction of primary production lost to exudation \\(f_{exud}^{phy}\\) [-] (0, 1) 0 The proportion of primary production that does not generate retained cellular carbon biomass, but is lost through exudation (and hence excretion). Exudation losses are summed with potentially modified respiration losses to compute excretion respiration == science Phytoplankton specific shading coefficient \\(Ke^{phy}\\) /(\\(\\mu\\)g Chl a/L)/m /(mmol C/m\\(^3\\))/m (0, 0.0225) (0, 0.01) 0 0 The rate at which light is attenuated by phytoplankton. This coefficient is per unit concentration of phytoplankton, per metre (depth). It is multiplied by phytoplankton concentration in each computational cell to leave a value that has units of per meter, which is the same as standard extinction coefficients and therefore is able to be added to other (e.g. background) parallel extinction coefficients. This parameter is used in all light limitation == commands, but only the reference to the basic model is included in this table. Use the navigation in the commands Appendix to see linkages with other light limitation commands light limitation == science Minimum POC concentration \\(\\left[POC\\right]_{min}^{POC}\\) mg/L C mmol/m\\(^3\\) C (0, 0.1) (0, 8.33) NA NA The minimum allowable labile particulate organic carbon concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual carbon min max == science Maximum POC concentration \\(\\left[POC\\right]_{max}^{POC}\\) mg/L C mmol/m\\(^3\\) C (0, 100) (0, 8333) NA NA The maximum allowable labile particulate organic carbon concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues carbon min max == science Minimum DOC concentration \\(\\left[DOC\\right]_{min}^{DOC}\\) mg/L C mmol/m\\(^3\\) C (0, 0.1) (0, 8.33) NA NA The minimum allowable labile dissolved organic carbon concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual carbon min max == science Maximum DOC concentration \\(\\left[DOC\\right]_{max}^{DOC}\\) mg/L C mmol/m\\(^3\\) C (0, 100) (0, 8333) NA NA The maximum allowable labile dissolved organic carbon concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues carbon min max == science Minimum PON concentration \\(\\left[PON\\right]_{min}^{PON}\\) mg/L N mmol/m\\(^3\\) N (0, 0.1) (0, 7.14) NA NA The minimum allowable labile particulate organic nitrogen concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual nitrogen min max == science Maximum PON concentration \\(\\left[PON\\right]_{max}^{PON}\\) mg/L N mmol/m\\(^3\\) N (0, 100) (0, 7143) NA NA The maximum allowable labile particulate organic nitrogen concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues nitrogen min max == science Minimum DON concentration \\(\\left[DON\\right]_{min}^{DON}\\) mg/L N mmol/m\\(^3\\) N (0, 0.1) (0, 7.14) NA NA The minimum allowable labile dissolved organic nitrogen concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual nitrogen min max == science Maximum DON concentration \\(\\left[DON\\right]_{max}^{DON}\\) mg/L N mmol/m\\(^3\\) N (0, 100) (0, 7143) NA NA The maximum allowable labile dissolved organic nitrogen concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues nitrogen min max == science Minimum POP concentration \\(\\left[POP\\right]_{min}^{POP}\\) mg/L P mmol/m\\(^3\\) P (0, 0.01) (0, 0.32) NA NA The minimum allowable labile particulate organic phosphorus concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual phosphorus min max == science Maximum POP concentration \\(\\left[POP\\right]_{max}^{POP}\\) mg/L P mmol/m\\(^3\\) P (0, 10) (0, 323) NA NA The maximum allowable labile particulate organic phosphorus concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues phosphorus min max == science Minimum DOP concentration \\(\\left[DOP\\right]_{min}^{DOP}\\) mg/L P mmol/m\\(^3\\) P (0, 0.01) (0, 0.32) NA NA The minimum allowable labile dissolved organic phosphorus concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual phosphorus min max == science Maximum DOP concentration \\(\\left[DOP\\right]_{max}^{DOP}\\) mg/L P mmol/m\\(^3\\) P (0, 10) (0, 323) NA NA The maximum allowable labile dissolved organic phosphorus concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues phosphorus min max == science Sediment DOC flux \\(F_{sed}^{DOC}\\) mg C/m\\(^2\\)/d mmol C/m\\(^2\\)/d (0, 120) (0, 10) 0 0 The rate at which labile dissolved organic carbon is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of labile DOC sediment flux DOC flux == science Sediment DON flux \\(F_{sed}^{DON}\\) mg N/m\\(^2\\)/d mmol N/m\\(^2\\)/d (0, 21.126) (0, 1.509) 0 0 The rate at which labile dissolved organic nitrogen is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of labile DON sediment flux DON flux == science Sediment DOP flux \\(F_{sed}^{DOP}\\) mg P/m\\(^2\\)/d mmol P/m\\(^2\\)/d (0, 2.914) (0, 0.094) 0 0 The rate at which labile dissolved organic phosphorus is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of labile DOP sediment flux DOP flux == science Sediment half saturation oxygen concentration for DOM flux \\(K_{sed-O_2}^{DOM}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed sediment labile DOM flux is half the user specified rate, at 20\\(^o\\)C. Cannot be varied spatially. This value is applied equally to labile dissolved organic carbon, nitrogen and phosphorus organics benthic == science Sediment DOM flux temperature coefficient \\(\\theta_{sed}^{DOM}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on labile DOM sediment flux. A value of 1.0 will remove the effect of temperature. This value is applied equally to labile dissolved organic carbon, nitrogen and phosphorus organics benthic == science POC hydrolysis rate \\(R_{hyd}^{POC}\\) /d (0, 0.1) 0 0 The rate at which labile particulate organic carbon is hydrolysed to dissolved organic carbon at 20\\(^o\\)C excluding the influence of ambient dissolved oxygen concentration. This is not the maxuimum rate of POC hydrolysis hydrolysis == science PON hydrolysis rate \\(R_{hyd}^{PON}\\) /d (0, 0.015) 0 0 The rate at which labile particulate organic nitrogen is hydrolysed to dissolved organic nitrogen at 20\\(^o\\)C excluding the influence of ambient dissolved oxygen concentration. This is not the maxuimum rate of PON hydrolysis hydrolysis == science POP hydrolysis rate \\(R_{hyd}^{POP}\\) /d (0, 0.0009) 0 0 The rate at which labile particulate organic phosphorus is hydrolysed to dissolved organic phosphorus at 20\\(^o\\)C excluding the influence of ambient dissolved oxygen concentration. This is not the maxuimum rate of POP hydrolysis hydrolysis == science Half saturation oxygen concentration for POM hydrolysis \\(K_{hyd-O_2}^{POM}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed hydrolysis of labile POM is half the user specified rate, at 20\\(^o\\)C. Cannot be varied spatially. The same value is applied to all labile particulate organic constituents (carbon, nitrogen and phosphorus), and also to the breakdown of refractory particulate organic matter hydrolysis == science POM hydrolysis temperature coefficient \\(\\theta_{hyd}^{POM}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on labile POM hydrolysis. A value of 1.0 will remove the effect of temperature. The same value is applied to all labile particulate organic constituents (carbon, nitrogen and phosphorus), and also to the breakdown of refractory particulate organic matter hydrolysis == science DOM mineralisation rate \\(R_{miner}^{DOM}\\) /d (0, 0.1) 0 0 The rate at which labile dissolved organic carbon, nitrogen and phosphorus are mineralised to their corresponding dissolved inorganic constituents at 20\\(^o\\)C excluding the influence of ambient dissolved oxygen concentration. This is not the maxuimum rate of mineralisation. The same rate is applied to all labile dissolved organic constituents (carbon, nitrogen and phosphorus) mineralisation == science Half saturation oxygen concentration for DOM mineralisation \\(K_{miner-O_2}^{DOM}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed aerobic and anaerobic mineralisation of labile DOM is half the user specified rate, at 20\\(^o\\)C, and with \\(f_{an}\\) equal to 1.0. If \\(f_{an}\\) is equal to zero then this half saturation oxygen concentration is the dissolved oxygen concentration for which the computed aerobic mineralisation of labile DOM is half the user specified rate, again at 20\\(^o\\)C. Cannot be varied spatially. The same value is applied to all labile dissolved organic constituents (carbon, nitrogen and phosphorus), and also to the activation of refractory dissolved organic carbon, nitrogen and phosporus mineralisation == science DOM mineralisation temperature coefficient \\(\\theta_{miner}^{DOM}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on labile DOM mineralisation. A value of 1.0 will remove the effect of temperature. The same value is applied to all labile dissolved organic constituents (carbon, nitrogen and phosphorus), and also to the activation of refractory dissolved organic carbon, nitrogen and phosporus mineralisation == science Anaerobic mineralisation multiplier \\(f_{an}\\) [-] (0, 1) 0 The factor applied to the compenent of mineralisation of labile dissolved organic matter that does not consume dissolved oxygen. A value of 0.0 will entirely suppress the Michaelis-Menten weighting that non dissolved oxygen based processes have in calculating overall mineralisation of labile dissolved organic matter. Setting this parameter to zero does not suppress non dissolved oxygen mineralisation. This same factor is also applied to the activation of refractory dissolved organic carbon, nitrogen and phosphorus to their labile equivalents. If activation is to be simulated then the command mineralisation == will need to be issued to set \\(f_{an}\\). In this case, and if the simulation of dissolved organic matter mineralisation is not desired, then set \\(R_{miner}^{DOM}\\) to be zero in the same mineralisation command mineralisation == science Half saturation nitrate concentration for nitrate consumption via anaerobic mineralisation of dissolved organic carbon \\(K_{miner-NO_3}^{NO_3}\\) mg/L NO\\(_3\\)-N mmol/m\\(^3\\) NO\\(_3\\)-N (0, 2.1) (0, 150) 1.75 125 The nitrate concentration for which the computed consumption of nitrate due to anaerobic mineralisation is half the corresponding anaerobic mineralisation of labile dissolved organic carbon. If this paramter is set to zero, then the consumption of nitrate as a source of oxygen as part of organic matter mineralisation is switched off. Cannot be varied spatially mineralisation == science POM specific shading coefficient \\(Ke^{POM}\\) /(mg POC/L)/m /(mmol POC/m\\(^3\\))/m (0, 8.33) (0, 0.1) 0 0 The rate at which light is attenuated by labile particulate organic matter. This coefficient is per unit concentration of particulate organic carbon (which is used as a proxy for particulate organic matter) per metre (depth). It is multiplied by POC concentration in each computational cell to leave a value that has units of per meter, which is the same as standard extinction coefficients and therefore is able to be added to other (e.g. background) parallel extinction coefficients self shading == science DOM specific shading coefficient \\(Ke^{DOM}\\) /(mg DOC/L)/m /(mmol DOC/m\\(^3\\))/m (0, 8.33) (0, 0.1) 0 0 The rate at which light is attenuated by labile dissolved organic matter. This coefficient is per unit concentration of dissolved organic carbon (which is used as a proxy for dissolved organic matter) per metre (depth). It is multiplied by DOC concentration in each computational cell to leave a value that has units of per meter, which is the same as standard extinction coefficients and therefore is able to be added to other (e.g. background) parallel extinction coefficients self shading == science RPOM breakdown rate \\(R_{bdn}^{RPOM}\\) /d (0, 0.1) 0 0 The rate at which refractory particulate organic matter (a single computed variable) is broken down to labile particulate organic carbon, nitrogen and phosphorus (three computed variables) at 20\\(^o\\)C excluding the influence of ambient dissolved oxygen concentration. This is not the maxuimum rate of breakdown ref breakdown == science Ratio of N to C in refractory particulate organic matter \\(X_N^{RPOM}\\) [-] (0.094, 0.19) 0.15 The molar ratio of N to C in refractory particulate organic matter. This ratio should not differ significantly from the Redfield ratio of 16/106 ref breakdown == science Ratio of P to C in refractory particulate organic matter \\(X_P^{RPOM}\\) [-] (0.00094, 0.019) 0.0094 The molar ratio of P to C in refractory particulate organic matter. This ratio should not differ significantly from the Redfield ratio of 1/106 ref breakdown == science Minimum RPOM concentration \\(\\left[RPOM\\right]_{min}^{RPOM}\\) mg/L C mmol/m\\(^3\\) C (0, 0.1) (0, 8.33) NA NA The minimum allowable refractory particulate organic matter concentration. Although referred to as organic matter, it is accounted as (and in units of) carbon in the WQ Module. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual ref carbon min max == science Maximum RPOM concentration \\(\\left[RPOM\\right]_{max}^{RPOM}\\) mg/L C mmol/m\\(^3\\) C (0, 100) (0, 8333) NA NA The maximum allowable refractory particulate organic matter concentration. Although referred to as organic matter, it is accounted as (and in units of) carbon in the WQ Module. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues ref carbon min max == science Minimum RDOC concentration \\(\\left[RDOC\\right]_{min}^{RDOC}\\) mg/L C mmol/m\\(^3\\) C (0, 0.1) (0, 8.33) NA NA The minimum allowable refractory dissolved organic carbon concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual ref carbon min max == science Maximum RDOC concentration \\(\\left[RDOC\\right]_{max}^{RDOC}\\) mg/L C mmol/m\\(^3\\) C (0, 100) (0, 8333) NA NA The maximum allowable refractory dissolved organic carbon concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues ref carbon min max == science Minimum RDON concentration \\(\\left[RDON\\right]_{min}^{RDON}\\) mg/L N mmol/m\\(^3\\) N (0, 0.1) (0, 7.14) NA NA The minimum allowable refractory dissolved organic nitrogen concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual ref nitrogen min max == science Maximum RDON concentration \\(\\left[RDON\\right]_{max}^{RDON}\\) mg/L N mmol/m\\(^3\\) N (0, 100) (0, 7143) NA NA The maximum allowable refractory dissolved organic nitrogen concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues ref nitrogen min max == science Minimum RDOP concentration \\(\\left[RDOP\\right]_{min}^{RDOP}\\) mg/L P mmol/m\\(^3\\) P (0, 0.01) (0, 0.32) NA NA The minimum allowable refractory dissolved organic phosphorus concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual ref phosphorus min max == science Maximum RDOP concentration \\(\\left[RDOP\\right]_{max}^{RDOP}\\) mg/L P mmol/m\\(^3\\) P (0, 10) (0, 323) NA NA The maximum allowable refractory dissolved organic phosphorus concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues ref phosphorus min max == science RDOM activation rate \\(R_{act}^{RDOM}\\) /d (0, 0.1) 0 0 The rate at which refractory dissolved organic carbon, nitrogen and phosphorus are activated to their corresponding labile dissolved organic constituents at 20\\(^o\\)C excluding the influence of ambient dissolved oxygen concentration. This is not the maxuimum rate of activation. The same rate is applied to all refractory dissolved organic constituents (carbon, nitrogen and phosphorus) ref activation == science RPOM specific shading coefficient \\(Ke^{RPOM}\\) /(mg RPOM/L)/m /(mmol RPOM/m\\(^3\\))/m (0, 8.33) (0, 0.1) 0 0 The rate at which light is attenuated by refractory particulate organic matter. This coefficient is per unit concentration of refractory particulate organic carbon (the units of RPOM) per metre (depth). It is multiplied by RPOM concentration in each computational cell to leave a value that has units of per meter, which is the same as standard extinction coefficients and therefore is able to be added to other (e.g. background) parallel extinction coefficients ref self shading == science CDOM multiplier \\(R_{CDOM}^{RDOM}\\) [-] (0, 2) 0 The linear multiplicative factor applied to the calculated value of CDOM for use in organic matter self shading calculations. A value greater (less) than 1.0 increases (decreases) the CDOM estimate and hence increases (decreases) shading. . This coefficient is dimensionless but can be thought of as light attenuation per unit of CDOM, which are both in units of /m. Multiplying this parameter by CDOM in each computational cell therefore leaves a value that has units of per meter, which is the same as standard extinction coefficients and therefore is able to be added to other (e.g. background) parallel extinction coefficients ref self shading == science RDOM photolysis fraction \\(f_{photo}^{RDOM}\\) [-] (0, 1) 0 The proportion of photolysed refractory dissolved organic matter that is is converted to labile dissolved organic matter. The remaining proportion is converted to dissolved inorganic carbon and nutrients. This multiplier is applied equally to refractory dissolved organic carbon, nitrogen and phosphorus ref photolysis == science Anaerobic oxidation of ammonium rate \\(k_{anmx}^{N_2}\\) mg N/L/d mmol N/m\\(^3\\)/d (0, 0.5) (0, 0.036) 0 0 The rate at which ammonium is oxidised (consuming nitrite) to nitrogen gas N\\(_2\\) at 20\\(^o\\)C excluding the influence of ambient ammonium and nitrite concentrations. This is not solely a per day rate, but is the mass (or mmol) rate of production of nitrogen in free nitrogen gas, per unit volume, per day. Anammox only operates when ambient dissolved oxygen concentrations are less than 0.1 mg/L. A value of 0.0 will switch off anammox anaerobic oxidation of ammonium == science Half saturation ammonium concentration for anammox \\(K_{anmx-NH_4}^{N_2}\\) mg/L NH\\(_4\\)-N mmol/m\\(^3\\) NH\\(_4\\)-N (0, 10) (0, 714) 1.75 125 The ammonium concentration for which the computed consumption of ammonium due to anaerobic oxidation would be half the corresponding anaerobic oxidation rate, excluding the influence of nitrite. Cannot be varied spatially anaerobic oxidation of ammonium == science Half saturation nitrite concentration for anammox \\(K_{anmx-NO_2}^{N_2}\\) mg/L NO\\(_2\\)-N mmol/m\\(^3\\) NO\\(_2\\)-N (0, 10) (0, 714) 1.75 125 The nitrite concentration for which the computed consumption of ammonium due to anaerobic oxidation would be half the corresponding anaerobic oxidation rate, excluding the influence of ammonium. Cannot be varied spatially anaerobic oxidation of ammonium == science Dissimilatory reduction of nitrate to ammonium rate \\(R_{DRNA}^{NO_3}\\) /d (0, 0.05) 0 0 The rate at which nitrate is reduced to ammonium at 20\\(^o\\)C excluding the influence of ambient nitrate concentrations. A value of 0.0 will switch off DRNA diss nitrate reduction to ammonium == science Half saturation oxygen concentration for DRNA \\(K_{DRNA-O_2}^{NO_3}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 10) (0, 312.5) 4 125 The oxygen concentration for which the computed reduction of nitrate to ammonium would be half the corresponding rate. Cannot be varied spatially diss nitrate reduction to ammonium == science Constant rate of adsorbed FRP settling \\(V_{settle}^{FRP}\\) m/d (-50, 0) 0 The constant settling velocity applied to adsorbed FRP. Future releases of the WQ Module will dynamically link this settling velocity to calculations made by the TUFLOW FV ST Module. A negative value is a downwards velocity settling == science Labile organic matter stokes diameter \\(d_{lorg}\\) m (1 e-09, 1 e -06) 1 e-09 The conceptual diameter of labile particulate organic matter applied in stokes calculations of settling velocity. Future releases of the WQ Module will dynamically link settling velocity to calculations made by the TUFLOW FV ST Module settling == science Labile organic matter stokes density \\(\\rho_{lorg}\\) kg/m\\(^3\\) (1000, 3000) 2000 The density of labile particulate organic matter applied in stokes calculations of settling velocity. Future releases of the WQ Module will dynamically link settling velocity to calculations made by the TUFLOW FV ST Module settling == science Labile organic matter settling velocity \\(V_{settle}^{lorg}\\) m/d (-50, 0) 0 The settling velocity applied to labile particulate organic matter for constant or density related settling calculations. A negative value is a downwards velocity. Future releases of the WQ Module will dynamically link settling velocity to calculations made by the TUFLOW FV ST Module settling == science Refractory organic matter stokes diameter \\(d_{rorg}\\) m (1 e-09, 1 e -06) 1 e-09 The conceptual diameter of refractory particulate organic matter applied in stokes calculations of settling velocity. Future releases of the WQ Module will dynamically link settling velocity to calculations made by the TUFLOW FV ST Module ref settling == science Refractory organic matter stokes density \\(\\rho_{rorg}\\) kg/m\\(^3\\) (1000, 3000) 2000 The density of refractory particulate organic matter applied in stokes calculations of settling velocity. Future releases of the WQ Module will dynamically link settling velocity to calculations made by the TUFLOW FV ST Module ref settling == science Refractory organic matter settling velocity \\(V_{settle}^{rorg}\\) m/d (-50, 0) 0 The settling velocity applied to refractory particulate organic matter for constant or density related settling calculations. A negative value is a downwards velocity. Future releases of the WQ Module will dynamically link settling velocity to calculations made by the TUFLOW FV ST Module ref settling == science Minimum water quality calculation depth \\(d_{min-wq}\\) m (0, UD) 0.01 The minimum depth at which water calculations will be computed. This depth is the depth of the entire computational column that immediately overlies the sediment (bed) for a given 2D cell. The depth is specified in the TUFLOW FV control file cell water quality depth == Disable water quality calculation \\(B_{disable-wq}\\) [-] (0, 1) 0 A Boolean flag to disable (1) or enable (0) water quality calculations. The flag is specified in the TUFLOW FV control file disable water quality model == Non-kinetic equilibrium substep frequency \\(fess\\) Number of WQ Module timesteps (1, UD) 1 The frequency (in WQ timesteps) at which the WQ Module calls non-kinetic equilibrium calculations. For example, a value of 12 will call non-kinetic calculations every twelfth time the WQ module is called wq equilibrium substeps == Pathogen dark death rate \\(k_d^{pth}\\) /d (0, 1) 0 The natural mortality rate in freshwater at 20 \\(^o\\)C. Also referred to as the dark death rate mortality == science Salinity effect on mortality \\(C_{SM}^{pth}\\) /d /psu (0, 0.1) 0 The salinity effect on mortality. Set this to zero to remove salinity effects on mortality mortality == science Parameter controlling salinity mortality dependence \\(\\alpha\\) [-] (0, 10) 1 An exponentially applied controller of the mortality response to salinity. Set this to 1.0 to make salinity dependence linear. Do not set this and \\(C_{SM}^{pth}\\) to both be zero mortality == science Parameter controlling DOC trophic mortality dependence \\(\\beta\\) [-] (0, 0) 1 An exponentially applied controller of the mortality response to DOC. Not implemented mortality == science Pathogen mortality temperature coefficient \\(\\theta_{mor}^{pth}\\) [-] (1, 1.2) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on pathogen mortality. A value of 1.0 will remove the effect of temperature mortality == science Pathogen freshwater inactivation rate coefficient for exposure to visible light \\(k_{vis}^{pth}\\) m\\(^2\\) /MJ (0, 1) 0 Inactivation effect of visible radiation. Excludes the effect of salinity and oxygen on inactivation visible inactivation == science Coefficient that enhances the inactivation effect of visible light under saline conditions \\(c_{S_{vis}}^{pth}\\) m\\(^2\\) /MJ /psu (0, 0.007) 0 Enhancement of inactivation of visible radiation due to salinity. A value of 0.0 will remove the effect of salinity visible inactivation == science Half saturation oxygen concentration for visible light inactivation \\(K_{DO_{vis}}^{pth}\\) mg/L O\\(_2\\) (0, 8) (0, 250) 4 125 The dissolved oxygen concentration for which the computed inactivation rate under visible light is half that which would occur without oxygen limitation. A value of 0.0 will remove the effect of oxygen visible inactivation == science Pathogen freshwater inactivation rate coefficient for exposure to UV-A light \\(k_{uva}^{pth}\\) m\\(^2\\) /MJ (0, 20) 0 Inactivation effect of UV-A radiation. Excludes the effect of salinity and oxygen on inactivation uva inactivation == science Coefficient that enhances the inactivation effect of UV-A light under saline conditions \\(c_{S_{uva}}^{pth}\\) m\\(^2\\) /MJ /psu (0, 0.007) 0 Enhancement of inactivation of UV-A radiation due to salinity. A value of 0.0 will remove the effect of salinity uva inactivation == science Half saturation oxygen concentration for UV-A light inactivation \\(K_{DO_{uva}}^{pth}\\) mg/L O\\(_2\\) (0, 8) (0, 250) 4 125 The dissolved oxygen concentration for which the computed inactivation rate under UV-A light is half that which would occur without oxygen limitation. A value of 0.0 will remove the effect of oxygen uva inactivation == science Pathogen freshwater inactivation rate coefficient for exposure to UV-B light \\(k_{uvb}^{pth}\\) m\\(^2\\) /MJ (0, 100) 0 Inactivation effect of UV-B radiation. Excludes the effect of salinity and oxygen on inactivation uvb inactivation == science Coefficient that enhances the inactivation effect of UV-B light under saline conditions \\(c_{S_{uvb}}^{pth}\\) m\\(^2\\) /MJ /psu (0, 0.007) 0 Enhancement of inactivation of UV-B radiation due to salinity. A value of 0.0 will remove the effect of salinity uvb inactivation == science Half saturation oxygen concentration for UV-B light inactivation \\(K_{DO_{uvb}}^{pth}\\) mg/L O\\(_2\\) (0, 8) (0, 250) 4 125 The dissolved oxygen concentration for which the computed inactivation rate under UV-B light is half that which would occur without oxygen limitation. A value of 0.0 will remove the effect of oxygen uvb inactivation == science Minimum alive pathogen concentration \\(\\left[PTH_a\\right]_{min}^{pth}\\) CFU/100mL (0, 0) NA The minimum allowable alive (free) pathogen concentration. If the WQ Module detects a concentration less than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual alive min max == science Maximum alive pathogen concentration \\(\\left[PTH_a\\right]_{max}^{pth}\\) CFU/100mL (0, 1 e 12) NA The maximum allowable alive (free) pathogen concentration. If the WQ Module detects a concentration greater than this, then it will be reset to this value, and reported in the WQ Module log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues alive min max == science Target pathogen attachment fraction \\(f_{att}^{pth}\\) [-] (0, 1) 0 The target fraction of attached pathogens. It is computed as the concentration of attached pathogens, divided by the sum of attached and alive pathogens for each computational target attached fraction == science Unattached pathogen settling velocity \\(V_{settle}^{pth}\\) m/d (-50, 0) 0 The settling velocity of unattached pathogens. A negative value is a downwards velocity. Future releases of the WQ Module will dynamically link settling velocity to calculations made by the TUFLOW FV ST Module settling == science Attached pathogen settling velocity \\(V_{settle}^{pth_t}\\) m/d (-50, 0) 0 The settling velocity of attached pathogens. A negative value is a downwards velocity. Future releases of the WQ Module will dynamically link settling velocity to calculations made by the TUFLOW FV ST Module settling == science "],["AppMBal.html", "Appendix S Mass Conservation Model S.1 Intent S.2 Description S.3 Model suite S.4 Calculations S.5 Mass conservation performance S.6 Access and execution S.7 Results S.8 Mass conservation analysis S.9 Notes", " Appendix S Mass Conservation Model S.1 Intent The TUFLOW FV Water Quality (WQ) Module is supported by a downloadable model suite that is intended to provide users with simple three dimensional models that can be used to: Assess WQ Module mass conservation performance, and/or Support exploration of the features and behaviour of the WQ Module, and/or Use as templates for building water quality control files for other simulations The suite does not need a licence to execute with either existing or altered water quality parameters. This Appendix provides background, analysis and windows usage instructions for the mass conservation model. The model suite can be run on either windows or linux, however this document describes only the windows execution process. TUFLOW FV releases from 2022 onward include the WQ Module and therefore can execute this model. S.2 Description The mass conservation model is configured as follows. General 1 month (745 hours) duration Includes salinity, temperature (and heat calculations), sediment and varying numbers of water quality computed variables 15 minute output 15 minute water quality simulation timestep Designed to mimic a deep lake that cools over an autumnal period Geometry Four three-dimensional flat bottomed columns, with the same bed elevation Lateral cell areas each of approximately 10 km\\(^2\\) Depth of 21 metres 20 vertical layers of variable thickness, with 17 fixed and 3 sigma (which span the top portion of the water column) Boundary conditions No inflows, outflows or other flow boundaries Meteorological boundaries applied Hourly timestep, 15 minute update Typical mid latitude autumnal conditions, with rainfall included Water quality parameterisation WQ Module control files that present the parameters used are included below for each simulation Each simulation includes the most complex simulation construction (for each simulation class) so as to stress test all available processes Parameters are set to be generally within expected ranges, with some deliberate exceptions designed to illustrate the parameter checking features of the WQ Module Figure S.1: WQ Module Mass Conservation Model This setup of essentially stationary water is designed to be challenging for mass conservation. In particular, the exclusion of external flow boundaries (that can reset or overwhelm internal process calculations) is deliberate. These conditions might mimic a low rainfall lacustrine environment. S.3 Model suite The mass conservation model suite comprises six (6) related models. These six models are split into two groups of three, with these groups being identical other than one group using the milligrams per litre (MGL) units system and the other group using the millimoles per cubic metre (MMM) units system. The three models within each group increase in configurational complexity that matches the three currently available water quality simulation classes. These are (with links to the relevant manual sections): Water quality simulation class == DO (Section 3.1) Water quality simulation class == inorganics (Section 3.2) Water quality simulation class == organics (Section 3.3) Detailed model access and execution instructions are provided in Section S.6. S.4 Calculations The primary calculation used to assess mass conservation for each computed variable \\(X\\) follows: \\[\\begin{equation} X_{mb}(t) = 100 \\times \\frac{X_{mp}(t) - X_{mi}(t)}{X_{mi}(t)} \\tag{S.1} \\end{equation}\\] where \\(X_{mb}(t)\\) is the percentage difference between two methods of computing the mass of computed variable \\(X\\) in the domain: \\(X_{mp}(t)\\): Progressively modifying the initial domain mass by adding to it the sum of the relevant fluxes \\(F_i\\) at each timestep \\(t\\). No resetting of this calculation occurs - it is designed (stringently) such that any mass conservation errors will accumulate in time \\(X_{mi}(t)\\): Multiplying the reported concentrations of \\(X\\) in cell \\(j\\) of volume \\(V_j\\) and integrating over the entire model domain at each timestep \\(t\\). This mass is reset at each timestep and corresponds to the mass reported by TUFLOW FV \\(X_{mp}(t)\\) and \\(X_{mi}(t)\\) are computed as per Equation (S.2). \\(F_{i}(t)\\) are the relevant fluxes for \\(X\\) (up to a total number of \\(i=NF\\) fluxes) and are converted from per area (or per volume) and per time amounts to mass amounts. The number of cells in the domain is \\(NC\\), and \\(\\left[X\\right]_{j}(t)\\) is the concentration of computed variable \\(X\\) in cell \\(j\\) at time \\(t\\). The model contains sigma layers and as such \\(V_{j}\\) may be time varying. \\[\\begin{equation} \\left.\\begin{aligned} X_{mp}(t) =&amp; \\sum_{j=1}^{NC} \\left[X\\right]_{j}(0) \\times V_j(0) + \\sum_{i=1}^{NF} F_{i}(t) \\\\ \\\\ X_{mi}(t) =&amp; \\sum_{j=1}^{NC} \\left[X\\right]_{j}(t) \\times V_j(t) \\end{aligned}\\right\\} \\tag{S.2} \\end{equation}\\] As a general note, reported fluxes need to be used with care in mass conservation analyses. This is because fluxes are reported as instantaneous values, and are not integrated or accumulated between overall model output file writing timesteps. For example, if water quality calculations are undertaken every 15 minutes but outputs are written every hour, then several water quality calculations are undertaken between reporting. Whilst the hourly output water quality concentrations will correctly reflect the action of fluxes at every 15 minute increment, the output fluxes will be instantaneous, and equal to those that happen to be occurring at the hourly output time. They will not necessarily be reflective of the fluxes that occurred over the course of the preceding hour. Using these fluxes in mass conservation calculations can therefore lead to spurious outcomes. One solution to this matter is to set the output and water quality (and boundary condition update) timesteps to be the same in mass conservation analyses, noting that this may however generate large output files. Three simulations were executed, with one for each of the DO, inorganics and organics simulation classes. The timeseries of \\(X_{mb}(t)\\), together with the fluxes used in calculations, are presented below for all relevant computed variables. The WQ Module control file commands are also included for reference. Only the MGL units system predictions and calculations are presented. S.5 Mass conservation performance S.5.1 Simulation class: DO This is the simplest simulation class and it has oxygen as the only mandatory model class. For illustrative purposes, the optional pathogens model class has also been included in this mass balance simulation. The computed variables presented are therefore: Dissolved oxygen Pathogen 1 (which includes attachment dynamics) Pathogen 2 (which excludes attachment dynamics) The initial conditions are: Dissolved oxygen: 8.0 mg/L Pathogen 1 alive, attached and dead: 1e6 CFU/100mL, 1e5 CFU/100mL, 1e5 CFU/100mL Pathogen 2 alive and dead: 1e5 CFU/100mL, 1e4 CFU/100mL The relevant fluxes considered are (coloured as sources or sinks): Dissolved oxygen Sediment Atmospheric (both source and sink) Pathogen 1 Natural mortality Inactivation due to irradiance Attachment and detachment Settling Pathogen 2 Natural mortality Inactivation due to irradiance Settling The mass conservation performance of the WQ Module for dissolved oxygen and summed pathogens (i.e. pathogen 1 and pathogen 2 combined) is presented in Figure S.2, via \\(DO_{mb}\\), \\(PTHa_{mb}\\) and \\(PTHd_{mb}\\). Over the duration of the simulation, mass conservation holds to within 0.02%. It is noted that the alive pathogens mass balance (\\(PTHa_{mb}\\)) is truncated at 2 weeks because alive concentrations are six orders of magnitude lower that initial conditions by this time, and this pushes mass balance percentage error calculations to approach a divide by zero. Dead pathogen mass conservation is less affected because overall changes are approximately one order of magnitude only. Relevant fluxes used to compute this mass conservation, as well as total pathogen mass conservation, are presented subsequently. Figure S.2: Dissolved oxygen mass conservation parameters \\(DO_{mb}(t)\\), \\(PTHa_{mb}(t)\\) and \\(PTHd_{mb}(t)\\) Figure S.3: Dissolved oxygen WQ Module fluxes \\(F_i(t)\\) used to compute \\(DO_{mp}(t)\\) The following are pathogen fluxes. Because fluxes vary by several orders of magnitude, they are presented as logarithms, as -log\\(_{10}\\)(-flux). For example, a plotted value of -15 below, means that the actual flux was -1e15 CFU/15 minutes (not 1e-15 CFU/15 minutes), and a change in value from -16 to -15 represents a tenfold decrease in flux. Figure S.4: Pathogen WQ Module fluxes \\(F_i(t)\\) used to compute \\(PTHa_{mp}(t)\\) and \\(PTHd_{mp}(t)\\) Figure S.5: Total pathogen mass conservation parameter \\(PTHT_{mb}(t)\\) Following are the WQ Module control file commands used to generate the above. simulation class == DO wq dt == 900.0 wq units == mgl oxygen model == O2 oxygen min max == 0.0, 12.0 oxygen benthic == 4.7, 1.08 end oxygen model pathogen model == attached, pth1 alive min max == 0.0, 1e7 mortality == 0.0008, 0.0, 6.1, 1.0, 1.14 visible inactivation == 0.0, 0.0667, 0.1 uva inactivation == 0.01, 0.00667, 0.1 uvb inactivation == 0.02, 0.00667, 0.1 settling == -0.001, -0.2 target attached fraction == 0.5 end pathogen model pathogen model == free, pth2 alive min max == 0.0, 1e7 mortality == 0.08, 2e-12, 6.1, 1.0, 1.11 visible inactivation == 0.082, 0.0067, 0.5 uva inactivation == 0.5, 0.0067, 0.5 uvb inactivation == 1.0, 0.0067, 0.5 settling == -0.03 end pathogen model material == default oxygen flux == -1400.0 end material material == 1 oxygen flux == -1100.0 end material material == 2 oxygen flux == -1200.0 end material material == 3 oxygen flux == -1300.0 end material S.5.2 Simulation class: Inorganics The computed variables presented are: Dissolved oxygen Silicate Ammonium Nitrate FRP Adsorbed FRP Two phytoplankton groups (one each for the basic and advanced model) Pathogen behaviour is unchanged from the DO simulation class mass balance model presented in Section S.5.1 so the corresponding mass balance is omitted for clarity. The initial conditions are: Dissolved oxygen: 8.0 mg/L Silicate: 50.0 mg/L Ammonium: 0.15 mg/L Nitrate: 0.2 mg/L FRP: 0.04 mg/L Adsorbed FRP: 0.02 mg/L Blue green phytoplankton: 2.0 \\(\\mu\\)g/L (advanced model) Blue green internal nitrogen: 0.008 mg/L Blue green internal phosphorus: 0.0012 mg/L Green phytoplankton: 5.0 \\(\\mu\\)g/L (basic model) The relevant fluxes considered are: Dissolved oxygen Sediment Atmospheric (both source and sink) Nitrification Phytoplankton primary productivity Phytoplankton respiration Silicate Sediment Phytoplankton primary productivity Phytoplankton mortality Phytoplankton excretion Ammonium Sediment Atmospheric (wet and dry deposition) Nitrification Anaerobic oxidation of ammonium Dissimilatory reduction of nitrate to ammonium Phytoplankton primary productivity Phytoplankton mortality Phytoplankton excretion Nitrate Sediment Atmospheric (wet and dry deposition) Nitrification Denitrification Anaerobic oxidation of ammonium Dissimilatory reduction of nitrate to ammonium Phytoplankton primary productivity FRP Sediment Atmospheric Adsorption and desorption Phytoplankton primary productivity Phytoplankton mortality Phytoplankton excretion FRP Adsorbed Adsorption and desorption Phytoplankton (both groups) Phytoplankton primary productivity Phytoplankton respiration Phytoplankton mortality Phytoplankton excretion Phytoplankton sedimentation The mass conservation performance of the WQ Module is presented in Figure S.6, via \\(DO_{mb}(t)\\), \\(Si_{mb}(t)\\), \\(Amm_{mb}(t)\\), \\(Nit_{mb}(t)\\), \\((FRP+FRPAds)_{mb}(t)\\) and \\(PHY_{mb}(t)\\). Over the duration of the simulation, mass conservation holds to within approximately 0.014%. Relevant fluxes used to compute these mass conservations, as well as total nitrogen and total phosphorus mass conservations, are presented subsequently. Figure S.6: Inorganics mass conservation parameters \\(DO_{mb}(t)\\), \\(Si_{mb}(t)\\), \\(Amm_{mb}(t)\\), \\(Nit_{mb}(t)\\), \\(FRP_{mb}(t)\\) and \\(PHY_{mb}(t)\\) Figure S.7: Dissolved oxygen WQ Module fluxes \\(F_i(t)\\) used to compute \\(DO_{mb}(t)\\) Figure S.8: Silicate WQ Module fluxes \\(F_i(t)\\) used to compute \\(Si_{mb}(t)\\) Figure S.9: Ammonium WQ Module fluxes \\(F_i(t)\\) used to compute \\(Amm_{mb}(t)\\) Ammonium anammox fluxes are zero in the dissolved oxygen conditions of this mass conservation model. Figure S.10: Nitrate WQ Module fluxes \\(F_i(t)\\) used to compute \\(Nit_{mb}(t)\\) Nitrate anammox fluxes are zero in the dissolved oxygen conditions of this mass conservation model. Figure S.11: FRP + FRPAds WQ Module fluxes \\(F_i(t)\\) used to compute \\((FRP+FRPAds)_{mb}(t)\\) Figure S.12: Phytoplankton WQ Module fluxes \\(F_i(t)\\) used to compute \\(PHY_{mb}(t)\\) Figure S.13: Inorganics total nitrogen and total phosphorus mass conservation parameters \\(TN_{mb}(t)\\) and \\(TP_{mb}(t)\\) Following are the WQ Module control file commands used to generate the above. simulation class == inorganics wq dt == 900.0 wq units == mgl oxygen model == O2 oxygen min max == 0.0, 12.0 oxygen benthic == 4.7, 1.08 end oxygen model silicate model == si silicate min max == 0.0, 100.0 silicate benthic == 4.2, 1.01 oxygen == on end silicate model inorganic nitrogen model == ammoniumnitrate ammonium min max == 0.0, 50.0 nitrate min max == 0.0, 50.0 ammonium benthic == 4.05, 1.06 nitrate benthic == 4.25, 1.10 nitrification == 0.05, 4.15, 1.01 denitrification == michaelis menten, 0.05, 4.01, 1.03 oxygen == on atmospheric deposition == 5.0, 0.0, 0.5 anaerobic oxidation of ammonium == 0.005, 2.5, 2.5 diss nitrate reduction to ammonium == 0.005, 5.0 end inorganic nitrogen model inorganic phosphorus model == frphsads FRP min max == 0.0, 5.0 FRP ads min max == 0.0, 5.0 FRP benthic == 4.3, 1.095 oxygen == on atmospheric deposition == 0.5, 0.0 adsorption == linear, 0.25 settling == 0.000 end inorganic phosphorus model phyto model == advanced, bluegreen min max == 0.05, 50.0 temperature limitation == standard, 19.0, 22.0, 29.0 salinity limitation == mixed, 5.0, 10.0, 2.5 light limitation == chalker, 0.0005, 150.0 nitrogen limitation == 0.005, 1.5, 3.0, 5.0 phosphorus limitation == 0.002, 0.12, 0.3, 0.6 silicate limitation == 0.005, 9.0 uptake == 2.5, 0.3, 8.0 primary productivity == 3.4, 1.08 respiration == 0.06, 1.04, 0.2, 0.3, 0.1 carbon chla ratio == 26.8 nitrogen fixing == 0.002, 0.3 settling == constant, -0.3 end phyto model phyto model == basic, green min max == 0.05, 50.0 temperature limitation == standard, 19.0, 22.0, 29.0 salinity limitation == fresh, 2.0, 5.0, 0.0 light limitation == steele, 0.0005, 150.0 nitrogen limitation == 0.01, 2.5 phosphorus limitation == 0.005, 0.05 silicate limitation == 0.01, 4.0 uptake == 3.0, 0.6, 8.0 primary productivity == 2.6, 1.1 respiration == 0.005, 1.1, 0.3, 0.4, 0.5 carbon chla ratio == 27.8 nitrogen fixing == 0.001, 0.5 settling == constant, -0.4 end phyto model pathogen model == attached, pth1 alive min max == 0.0, 1e7 mortality == 0.0008, 0.0, 6.1, 1.0, 1.14 visible inactivation == 0.0, 0.0667, 0.1 uva inactivation == 0.01, 0.00667, 0.1 uvb inactivation == 0.02, 0.00667, 0.1 settling == -0.001, -0.2 target attached fraction == 0.5 end pathogen model pathogen model == free, pth2 alive min max == 0.0, 1e7 mortality == 0.08, 2e-12, 6.1, 1.0, 1.11 visible inactivation == 0.082, 0.0067, 0.5 uva inactivation == 0.5, 0.0067, 0.5 uvb inactivation == 1.0, 0.0067, 0.5 settling == -0.03 end pathogen model material == default oxygen flux == -1400.0 silicate flux == 10.0 ammonium flux == 20.0 nitrate flux == 30.0 frp flux == 5.0 end material material == 1 oxygen flux == -1100.0 silicate flux == 11.0 ammonium flux == 21.0 nitrate flux == 31.0 frp flux == 6.0 end material material == 2 oxygen flux == -1200.0 silicate flux == 12.0 ammonium flux == 22.0 nitrate flux == 32.0 frp flux == 7.0 end material material == 3 oxygen flux == -1300.0 silicate flux == 13.0 ammonium flux == 23.0 nitrate flux == 33.0 frp flux == 8.0 end material S.5.3 Simulation class: Organics The computed variables presented are: Dissolved oxygen Silicate Ammonium Nitrate FRP Adsorbed FRP Particulate organic carbon Dissolved organic carbon Particulate organic nitrogen Dissolved organic nitrogen Particulate organic phosphorus Dissolved organic phosphorus Refractory particulate organic matter Refractory dissolved organic carbon Refractory dissolved organic nitrogen Refractory dissolved organic phosphorus Two phytoplankton groups (one each for the basic and advanced model) Again, pathogen behaviour is unchanged from the DO simulation class mass balance model presented in Section S.5.1 so the corresponding mass balance is omitted for clarity. The initial conditions are: Dissolved oxygen: 8.0 mg/L Silicate: 1.0 mg/L Ammonium: 0.15 mg/L Nitrate: 0.2 mg/L FRP: 0.04 mg/L Adsorbed FRP: 0.02 mg/L Particulate organic carbon: 2.5 mg/L Dissolved organic carbon: 1.5 mg/L Particulate organic nitrogen: 0.3 mg/L Dissolved organic nitrogen: 0.1 mg/L Particulate organic phosphorus: 0.06 mg/L Dissolved organic phosphorus: 0.03 mg/L Refractory particulate organic matter: 2.1 mg/L Refractory dissolved organic carbon: 1.6 mg/L Refractory dissolved organic nitrogen: 0.6 mg/L Refractory dissolved organic phosphorus: 0.04 mg/L Blue green phytoplankton: 2.0 \\(\\mu\\)g/L (advanced model) Blue green internal nitrogen: 0.008 mg/L Blue green internal phosphorus: 0.0012 mg/L Green phytoplankton: 5.0 \\(\\mu\\)g/L (basic model) The relevant fluxes considered are: Dissolved oxygen Sediment Atmospheric (both source and sink) Nitrification Dissolved organic carbon mineralisation (oxygen based) Phytoplankton primary productivity Phytoplankton respiration Silicate Sediment Phytoplankton primary productivity Phytoplankton mortality Phytoplankton excretion Ammonium Sediment Atmospheric (wet and dry deposition) Nitrification Anaerobic oxidation of ammonium Dissimilatory reduction of nitrate to ammonium Dissolved organic nitrogen mineralisation Dissolved refractory organic matter photolysis Phytoplankton primary productivity Nitrate Sediment Atmospheric (wet and dry deposition) Nitrification Denitrification Anaerobic oxidation of ammonium Dissimilatory reduction of nitrate to ammonium Dissolved organic carbon mineralisation (nitrate based) Phytoplankton primary productivity flux FRP Sediment Atmospheric Adsorption and desorption Dissolved organic phosphorus mineralisation Dissolved refractory organic matter photolysis Phytoplankton primary productivity FRP Adsorbed Adsorption and desorption Particulate organic carbon, nitrogen and phosphorus Hydrolysis Breakdown of refractory particulate organic matter Phytoplankton mortality Dissolved organic carbon, nitrogen and phosphorus Sediment Hydrolysis Mineralisation Dissolved refractory organic matter photolysis Dissolved refractory organic matter activation Phytoplankton excretion Refractory particulate organic matter Breakdown Refractory organic carbon, nitrogen and phosphorus Dissolved refractory organic matter photolysis Dissolved refractory organic matter activation Phytoplankton (both groups) Phytoplankton primary productivity Phytoplankton respiration Phytoplankton mortality Phytoplankton excretion Phytoplankton sedimentation The mass conservation performance of the WQ Module is presented in Figure S.14, via \\(DO_{mb}(t)\\), \\(Si_{mb}(t)\\), \\(Amm_{mb}(t)\\), \\(Nit_{mb}(t)\\), \\((FRP+FRPAds)_{mb}(t)\\), \\(POC_{mb}(t)\\), \\(DOC_{mb}(t)\\), \\(PON_{mb}(t)\\), \\(DON_{mb}(t)\\), \\(POP_{mb}(t)\\), \\(DOP_{mb}(t)\\), \\(RPOM_{mb}(t)\\), \\(RDOC_{mb}(t)\\), \\(RDON_{mb}(t)\\), \\(RDOP_{mb}(t)\\) and \\(PHY_{mb}(t)\\). Over the duration of the simulation, mass conservation holds to within 0.024%. Relevant fluxes used to compute these mass conservations, as well as total nitrogen and total phosphorus mass conservations, are presented subsequently. Figure S.14: Organics mass conservation parameters \\(DO_{mb}(t)\\), \\(Si_{mb}(t)\\), \\(Amm_{mb}(t)\\), \\(Nit_{mb}(t)\\), \\(FRP_{mb}(t)\\), \\(POC_{mb}(t)\\), \\(DOC_{mb}(t)\\), \\(PON_{mb}(t)\\), \\(DON_{mb}(t)\\), \\(POP_{mb}(t)\\), \\(DOP_{mb}(t)\\), \\(RPOM_{mb}(t)\\), \\(RDOC_{mb}(t)\\), \\(RDON_{mb}(t)\\), \\(RDOP_{mb}(t)\\) and \\(PHY_{mb}(t)\\) Figure S.15: Dissolved oxygen WQ Module fluxes \\(F_i(t)\\) used to compute \\(DO_{mb}(t)\\) Figure S.16: Silicate WQ Module fluxes \\(F_i(t)\\) used to compute \\(Si_{mb}(t)\\) Figure S.17: Ammonium WQ Module fluxes \\(F_i(t)\\) used to compute \\(Amm_{mb}(t)\\) Ammonium anammox fluxes are zero in the dissolved oxygen conditions of this mass conservation model. Figure S.18: Nitrate WQ Module fluxes \\(F_i(t)\\) used to compute \\(Nit_{mb}(t)\\) Nitrate anammox fluxes are zero in the dissolved oxygen conditions of this mass conservation model. Figure S.19: FRP+FRPAds WQ Module fluxes \\(F_i(t)\\) used to compute \\((FRP+FRPAds)_{mb}(t)\\) Figure S.20: POC WQ Module fluxes \\(F_i(t)\\) used to compute \\(POC_{mb}(t)\\) Figure S.21: DOC WQ Module fluxes \\(F_i(t)\\) used to compute \\(DOC_{mb}(t)\\) Figure S.22: PON WQ Module fluxes \\(F_i(t)\\) used to compute \\(PON_{mb}(t)\\) Figure S.23: DON WQ Module fluxes \\(F_i(t)\\) used to compute \\(DON_{mb}(t)\\) Figure S.24: POP WQ Module fluxes \\(F_i(t)\\) used to compute \\(POP_{mb}(t)\\) Figure S.25: DOP WQ Module fluxes \\(F_i(t)\\) used to compute \\(DOP_{mb}(t)\\) Figure S.26: RPOM WQ Module fluxes \\(F_i(t)\\) used to compute \\(RPOM_{mb}(t)\\) Figure S.27: RDOC WQ Module fluxes \\(F_i(t)\\) used to compute \\(RDOC_{mb}(t)\\) Figure S.28: RDON WQ Module fluxes \\(F_i(t)\\) used to compute \\(RDON_{mb}(t)\\) Figure S.29: RDOP WQ Module fluxes \\(F_i(t)\\) used to compute \\(RDOP_{mb}(t)\\) Figure S.30: Phytoplankton WQ Module fluxes \\(F_i(t)\\) used to compute \\(PHY_{mb}(t)\\) Figure S.31: Organics total nitrogen and total phosphorus mass conservation parameters \\(TN_{mb}(t)\\) and \\(TP_{mb}(t)\\) Following are the WQ Module control file commands used to generate the above. simulation class == organics wq dt == 900.0 wq units == mgl oxygen model == O2 oxygen min max == 0.0, 12.0 oxygen benthic == 4.7, 1.08 end oxygen model silicate model == si silicate min max == 0.0, 100.0 silicate benthic == 4.2, 1.01 oxygen == on end silicate model inorganic nitrogen model == ammoniumnitrate ammonium min max == 0.0, 50.0 nitrate min max == 0.0, 50.0 ammonium benthic == 4.05, 1.06 nitrate benthic == 4.25, 1.10 nitrification == 0.05, 4.15, 1.01 denitrification == michaelis menten, 0.05, 4.01, 1.03 oxygen == on atmospheric deposition == 5.0, 0.0, 0.5 anaerobic oxidation of ammonium == 0.005, 2.5, 2.5 diss nitrate reduction to ammonium == 0.005, 5.0 end inorganic nitrogen model inorganic phosphorus model == frphsads FRP min max == 0.0, 5.0 FRP ads min max == 0.0, 5.0 FRP benthic == 4.3, 1.095 oxygen == on atmospheric deposition == 0.5, 0.0 adsorption == linear, 0.25 settling == 0.000 end inorganic phosphorus model phyto model == advanced, bluegreen min max == 0.05, 50.0 temperature limitation == standard, 19.0, 22.0, 29.0 salinity limitation == mixed, 5.0, 10.0, 2.5 light limitation == chalker, 0.0005, 150.0 nitrogen limitation == 0.005, 1.5, 3.0, 5.0 phosphorus limitation == 0.002, 0.12, 0.3, 0.6 silicate limitation == 0.005, 9.0 uptake == 2.5, 0.3, 8.0 primary productivity == 3.4, 1.08 respiration == 0.06, 1.04, 0.2, 0.3, 0.1 carbon chla ratio == 26.8 nitrogen fixing == 0.002, 0.3 settling == constant, -0.3 end phyto model phyto model == basic, green min max == 0.05, 50.0 temperature limitation == standard, 19.0, 22.0, 29.0 salinity limitation == fresh, 2.0, 5.0, 0.0 light limitation == steele, 0.0005, 150.0 nitrogen limitation == 0.01, 2.5 phosphorus limitation == 0.005, 0.05 silicate limitation == 0.01, 4.0 uptake == 3.0, 0.6, 8.0 primary productivity == 2.6, 1.1 respiration == 0.005, 1.1, 0.3, 0.4, 0.5 carbon chla ratio == 27.8 nitrogen fixing == 0.001, 0.5 settling == constant, -0.4 end phyto model organic matter model == refractory carbon min max == 0.0, 10.0, 0.0, 10.0 nitrogen min max == 0.0, 10.0, 0.0, 10.0 phosphorus min max == 0.0, 9.0, 0.0, 9.0 organics benthic == 1.0, 1.08 hydrolysis == 0.05, 0.007, 0.0004, 1.0, 1.05 mineralisation == 0.01, 1.2, 1.03, 0.5, 0.5 self shading == 0.0, 0.0 settling == stokes, 0.00000035, 2450.8 ref carbon min max == 0.0, 10.0, 0.0, 10.0 ref nitrogen min max == 0.0, 10.0 ref phosphorus min max == 0.0, 9.0 ref breakdown == 0.001, 0.1, 0.01 ref activation == 0.01 ref photolysis == 0.5 ref self shading == 0.0, 0.0 ref settling == stokes, 0.00000045, 2450.8 end organic matter model pathogen model == attached, pth1 alive min max == 0.0, 1e7 mortality == 0.0008, 0.0, 6.1, 1.0, 1.14 visible inactivation == 0.0, 0.0667, 0.1 uva inactivation == 0.01, 0.00667, 0.1 uvb inactivation == 0.02, 0.00667, 0.1 settling == -0.001, -0.2 target attached fraction == 0.5 end pathogen model pathogen model == free, pth2 alive min max == 0.0, 1e7 mortality == 0.08, 2e-12, 6.1, 1.0, 1.11 visible inactivation == 0.082, 0.0067, 0.5 uva inactivation == 0.5, 0.0067, 0.5 uvb inactivation == 1.0, 0.0067, 0.5 settling == -0.03 end pathogen model material == default oxygen flux == -1400.0 silicate flux == 10.0 ammonium flux == 20.0 nitrate flux == 30.0 frp flux == 5.0 doc flux == 20.0 don flux == 10.0 dop flux == 5.0 end material material == 1 oxygen flux == -1100.0 silicate flux == 11.0 ammonium flux == 21.0 nitrate flux == 31.0 frp flux == 6.0 doc flux == 19.0 don flux == 9.0 dop flux == 4.0 end material material == 2 oxygen flux == -1200.0 silicate flux == 12.0 ammonium flux == 22.0 nitrate flux == 32.0 frp flux == 7.0 doc flux == 18.0 don flux == 8.0 dop flux == 3.0 end material material == 3 oxygen flux == -1300.0 silicate flux == 13.0 ammonium flux == 23.0 nitrate flux == 33.0 frp flux == 8.0 doc flux == 17.0 don flux == 7.0 dop flux == 2.0 end material S.6 Access and execution S.6.1 Access To download the mass conservation model: Download the zip from the TUFLOW website by clicking here (under Example / Demo Models section) Unzip the model in a convenient location. For the purposes of this description, the location of the mass conservation model suite is assumed to be: ‘C:\\TUFLOWFV\\Models\\’ The above steps will create a subfolder called ‘wqm’ within the chosen folder location. Within this wqm subfolder will be another subfolder called mass_conservation_model. This is where the mass conservation model resides. S.6.2 Execution Unzipping the above will generate the folder structure within C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\ as below. Figure S.32: Mass conservation model folder structure The above C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\ subfolders are as follows: bc_dbase: Boundary condition data gotm: External turbulence model namelist file matlab: MATLAB post processing files for mass conservation analysis model: Model geometry and related data python: Python post processing files for mass conservation analysis results: Model results (will be empty on initial download) runs: TUFLOW FV hydrodynamic and sediment transport control files wqm: TUFLOW FV WQ Module control files The C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\ folder should also contain five files: execute_mass_conservation_MGL.m: Executes mass conservation calculations in MATLAB for MGL simulations execute_mass_conservation_MGL.py: Executes mass conservation calculations in Python for MGL simulations execute_mass_conservation_MMM.m: Executes mass conservation calculations in MATLAB for MMM simulations execute_mass_conservation_MMM.py: Executes mass conservation calculations in Python for MMM simulations run.bat: Executes a mass conservation simulation The mass conservation model can now be executed via a windows command line as follows: Open a windows command console Click the windows icon in the Task Bar once, and type ‘cmd’ (without the apostrophes) and then hit enter. A command console will appear, with the prompt being in a default directory. Navigate to the directory in which the mass conservation model resides by typing the following (noting that these instructions use the assumed folder location above) cd C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\ Type the following, with user specified arguments being bracketed as &lt;argument&gt; and are separated by a single space: run &lt;simulation class&gt; &lt;units system&gt; &lt;exe path&gt; Each of the arguments above have the following options: &lt;simulation class&gt;: DO inorganics organics &lt;units system&gt;: MGL MMM &lt;exe path&gt;: The full path to the TUFLOW FV executable, here assumed to be C:\\TUFLOWFV\\EXE\\TUFLOWFV.EXE. If there are spaces in the path name to an executable, then enclose the argument in inverted commas, e.g. “C:\\TUFLOW FV\\EXE\\TUFLOWFV.EXE” Example commands using the above are therefore: run DO MGL C:\\TUFLOWFV\\EXE\\TUFLOWFV.EXE This will execute the DO simulation class model in the milligrams per litre units system run organics MMM C:\\TUFLOWFV\\EXE\\TUFLOWFV.EXE This will execute the organics simulation class model in the millimoles per cubic metre units system S.7 Results All relevant water quality and hydrodynamic computed variables and diagnostics are written to the output files produced by executing the above commands. In all cases, results are written to the results folder, and are named based on the executed simulation in the form: MB_&lt;simulation class&gt;_&lt;units system&gt;_&lt;suffix&gt;.nc The &lt;bracketed&gt; options include: &lt;simulation class&gt;: DO inorganics organics &lt;units system&gt;: MGL MMM &lt;suffix&gt;: WQ Example results files produced are therefore: MB_DO_MGL_WQ.nc This is the results file from a DO simulation class model in the milligrams per litre units system MB_INORGANICS_MMM_WQ.nc This is the results file from an inorganics simulation class model in the millimoles per cubic metre units system Predictions of computed and diagnostic variables can be viewed and interrogated either: In QGIS in the same manner as any other TUFLOW FV results, following these instructions, and/or Using MATLAB and/or python tools A log file reporting WQ Module simulation commentary is produced for every execution. This resides in the same folder as the WQ Module control file, and has the same name but with the file extension “fvwqlog”. The log file produced by the mass conservation model should be reviewed to support understanding of the model parameterisation and execution. S.8 Mass conservation analysis Two options are available to assess the mass conservation performance of the WQ Module. These use: MATLAB, or Python These perform identical calculations but are offered to support users in their preference for post processing platforms. Both platforms can handle simulations that have used either the MGL or MMM units systems. The mass conservation analysis (by its nature) deals with mass, and as such, whilst the MMM analysis expects millimoles inputs for both user parameters and WQ Module results files, the core of the analysis engine operates in units of mass. Mass conservation outcomes from both MGL and MMM units systems are similarly reported as mass (not moles) errors. S.8.1 MATLAB The MATLAB mass conservation scripts should be executed using MATLAB R2022a, or later. S.8.1.1 Set up The following steps set up the mass conservation analysis in MATLAB: Open a MATLAB session Navigate to the directory where the mass conservation model has been downloaded (assumed to be C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\ here) Set the working directory to be the same location In the MATLAB editor (or any text editor), open either of the following mfiles, depending on the units systems being used (MGL or MMM): C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\execute_mass_conservation_MGL.m, or C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\execute_mass_conservation_MMM.m These files: Control the mass conservation analysis, and Contain the user specifiable and alterable parameters that are required by the mass conservation analysis In addition to the above, two folders that contain MATLAB scripts need to be added to the MATLAB path, including adding all subfolders. The mass conservation analysis uses scripts in these folders. These folders are: The MATLAB scripts provided here. This folder is named TUFLOWFV_Matlab_Utilities_001 The functions folder included in the zip download, which (using the assumed download location) is here: C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\matlab\\functions\\ None of the scripts in either of these folders should be edited. S.8.1.2 Execution The following steps execute the mass conservation analysis in MATLAB: Set the runID variable in execute_mass_conservation_MGL.m or execute_mass_conservation_MMM.m to be the simulation desired. Do this by uncommenting the required line. This runID will need to be that of a simulation that has already been executed (see Section S.6.2). The naming convention is the same as the commands used previously in the command window to execute a simulation: MB_&lt;simulation class&gt;_&lt;units system&gt; Make sure that the series of parameters set in execute_mass_conservation_MGL.m (or execute_mass_conservation_MMM.m) coincide exactly with those used to execute the relevant water quality simulation. Any differences will adversely impact mass conservation calculations. To do so: Only alter execute_mass_conservation_MGL.m (or execute_mass_conservation_MMM.m). Do not alter any other mfiles Within this mfile, only alter parameters in the section titled ‘% User inputs’: Figure S.33: Mass conservation mfile user inputs section In this regard: Not all parameters are always used. For example, the DO simulation class uses none of the parameters listed in this section, other than runID Hyperlinks to the user manual descriptions of all parameters are included in the mfile Do not alter the lengths of the arrays – only change their values. Do not add further phytoplankton groups. The mass conservation model has two groups, with one each from the Basic and Advanced classes, so does not need additional groups to serve its purpose The user parameters must match those specified in the relevant WQ Module control file. If these differ then mass conservation will not hold. Ensure that any changes made to WQ Module control file parameters are mirrored in the parameter section shown above. The parameters in the WQ Module control files and MGL and MMM mfiles are consistent within the unchanged zip download Do not alter any other mfiles To execute the mass conservation analysis, and having navigated to the MATLAB directory containing execute_mass_conservation_MGL.m (or execute_mass_conservation_MMM.m) type the following in the MATLAB command window: execute_mass_conservation_MGL for MGL units systems, or execute_mass_conservation_MMM for MMM units systems. The following will initially appear (using the MB_DO_MGL model as an example) Figure S.34: Initial MATLAB commentary If running the mass conservation process for the first time, a MATLAB warning similar to the following may appear. This can be ignored, and will not appear on subsequent runs of the same WQ Module simulation name: Could Not Find C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\results\\MB_DO_MGL_mass_conservation.xlsx S.8.1.3 Outputs All outputs are written to the results folder at: C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\results\\ Two results files are written (named according to simulation as above) in the units system adopted (MGL is used as an example here): MB_DO_MGL_mass_conservation.mat. This is a MATLAB datafile that contains all environment, flux and mass conservation data. The latter are timeseries, integrated over the entire mass conservation model domain. This can be loaded into MATLAB for further analysis using the MATLAB command (again, with varying name based on the runID): load(‘C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\results\\MB_DO_MGL_mass_conservation.mat’) MB_DO_MGL_mass_conservation.xlsx. This contains the same flux and mass conservation data as MB_DO_MGL_mass_conservation.mat, but as columns in an Excel spreadsheet. These can also be used in further analysis as required MATLAB also produces figures that graphically present the mass conservation analysis for every computed variable. The x- and y- axes are time (in hours) and mass conservation deviation (%), respectively. In the case of inorganics and organics simulation classes, an additional figure is produced that plots the same information, but for total nutrients. These figures can be reproduced using the data save in either MB_DO_MGL_mass_conservation.mat or MB_DO_MGL_mass_conservation.xlsx. S.8.2 Python The Python mass conservation scripts should be executed using Python 3.8, or later. S.8.2.1 Set up The following steps set up the mass conservation analysis in Python: Install Python (if not already installed). Python installation and configuration are required prior to executing the scripts provided. The steps to do so are presented here in the TUFLOW FV wiki. Install Python integrated development environment (IDE) (if not already installed). An IDE is used to control execution of the provided scripts. Any IDE can be used, although PyCharm is recommended and its setup is also described here in the TUFLOW FV wiki. Check that the following dependent Python packages are installed (e.g. using the command pip list in the command line window if pip is installed), at the noted versions or later: Numpy 1.19.0 netCDF4 1.5.3 pandas 1.2.4 matplotlib 3.2.2 openpyxl 3.0.10 Figure S.35: Check Python package versions in command prompt If any of these packages are missing then install package XXXX using the terminal command pip install XXXX command. For example, if openpyxl is missing, then in the Python terminal type pip install openpyxl, and so on. Open either of the following python script files in the Python IDE selected (PyCharm is recommended), depending on the units systems being used (MGL or MMM): C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\execute_mass_conservation_MGL.py, or C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\execute_mass_conservation_MMM.py These files: Control the mass conservation analysis, and Contain the user specifiable and alterable parameters that are required by the mass conservation analysis The python folder included in the zip download contains supplementary python scripts is here (using the assumed download location): - C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\python\\ Files in this folder should not be altered. S.8.2.2 Execution The following steps execute the mass conservation analysis in Python: Set the runID variable in execute_mass_conservation_MGL.py or execute_mass_conservation_MMM.py to be the simulation desired. Do this by uncommenting the required line. This runID will need to be that of a simulation that has already been executed (see Section S.6.2). The naming convention is the same as the commands used previously in the command window to execute a simulation: MB_&lt;simulation class&gt;_&lt;units system&gt; Make sure that the series of parameters set in execute_mass_conservation_MGL.py (or execute_mass_conservation_MMM.py) coincide exactly with those used to execute the relevant water quality simulation. Any differences will adversely impact mass conservation calculations. To do so: Only alter execute_mass_conservation_MGL.py (or execute_mass_conservation_MMM.py). Do not alter any other scripts Within this script, only alter parameters in the section titled ‘User inputs’. In this regard: Not all parameters are always used. For example, the DO simulation class uses none of the parameters listed in this section, other than runID Hyperlinks to the user manual descriptions of all parameters are included in the scripts. Do not alter the lengths of the arrays – only change their values. Do not add further phytoplankton groups. The mass conservation model has two groups, with one each from the Basic and Advanced classes, so does not need additional groups to serve its purpose The user parameters must match those specified in the relevant WQ Module control file. If these differ then mass conservation will not hold. Ensure that any changes made to WQ Module control file parameters are mirrored in the parameter section shown above. The parameters in the WQ Module control files and MGL and MMM scripts are consistent within the unchanged zip download Do not alter any other scripts Run the Python scripts execute_mass_balance_MGL.py or execute_mass_balance_MMM.py in the Python IDE. As an example, a script can be run by right-clicking its header and selecting ‘run’: Figure S.36: Run scripts in PyCharm The following warning messages can be ignored if they appear: “MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance. In a future version, a new instance will always be created and returned. Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.” “No artists with labels found to put in legend. Note that artists whose label start with an underscore are ignored when legend() is called with no argument.” A window will appear that displays the relevant plot. The figure window can be saved before closing by clicking on the save icon beneath the plot axes. The python script will exit once the plot window has been closed by the user. Some other messages may appear in the python console, but if the following message appears as the final run output, the script has run successfully. Process finished with exit code 0 Following successful execution of the Python scripts, the outputs described in the next section will be generated. S.8.2.3 Outputs All outputs are written to the results folder at: C:\\TUFLOWFV\\Models\\wqm\\mass_conservation_model\\results\\ The result files are written (named according to simulation as above) in the units system adopted (MGL is used as an example here): MB_DO_MGL_mass_conservation.xlsx This contains the flux and mass conservation data as columns in an Excel spreadsheet. These can also be used in further analysis as required. The script also produces figures that graphically present the mass conservation analysis for every computed variable. The x- and y- axes are time (in hours) and mass conservation deviation (%), respectively. In the case of inorganics and organics simulation classes, an additional figure is produced that plots the same information, but for total nutrients. This additional figure is blank if a DO simulation is processed. S.9 Notes S.9.1 Units The WQ Module offers simulation in one of two units systems: milligrams per litre (MGL) and millimoles per cubic metre (MMM). The mass conservation analysis provided with the WQ Module can therefore be run in both units systems. If users choose to do so, and then go on to compare mass conservation outcomes between the MGL and MMM units systems, some differences in behaviour may be observed. For instance, generally (but not always) the MMM system shows smaller cumulative mass conservation errors than its MGL parallel. The key reason for this is that the native computations units of the WQ Module are MMM, and as such, models set up in the MGL system have their MGL computed variable fields converted to and from MMM equivalents at each call by TUFLOW FV of the WQ Module (i.e. at every water quality timestep). These floating point arithmetic operations introduce very small (almost machine precision level) noise variations in computed variable fields that, given the accretive nature of mass conservation calculations, can accumulate over time. Conversely, these operations are bypassed if a user chooses to simulate in MMM units, and as such this noise is not incurred. Notwithstanding the above, the deliberate design choices for the mass conservation model to be essentially static water and execute for a duration of one month (i.e. perform 2,976 water quality calls from TUFLOW FV), intentionally place great challenges on mass conservation. In this context, both the MGL and MMM units systems produce mass conservation errors less than 0.02% over the course of the simulation, which is entirely acceptable. This is orders of magnitude smaller than typical variations in environmental variables and indeed laboratory or field measurements against which model performance is often compared. The differences in mass conservation between the MGL and MMM units systems therefore reduce to being matters of academic computer science interest rather than of material concern to practitioners. S.9.2 Precision The mass conservation presented in this Appendix has used the single precision compilation of TUFLOW FV (noting that the WQ Module is always compiled in double precision). Testing of the same system has been undertaken using the corresponding double precision TUFLOW FV compilation. In general, the double precision mass conservation outcomes are better than single precision, as expected. As per Section S.9.1, however, these gains in conservation performance from single to double precision are immaterial to the practitioner who is concerned with the simulation of significantly less certain real world environmental systems and the verification of numerical model predictions to laboratory or field measurements. S.9.3 Platform The simulations and analyses presented in this section were undertaken using 64 bit windows binaries. Although not reported here, the mass conservation simulations were also all executed using linux binaries and the netcdf output files processed through the same scripts available in the zip download. Mass conservation results were unchanged. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
