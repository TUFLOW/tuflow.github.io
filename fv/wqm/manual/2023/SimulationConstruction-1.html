<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 4 Simulation Construction | TUFLOW FV Water Quality (WQ) Module User Manual</title>
  <meta name="description" content="Section 4 Simulation Construction | TUFLOW FV Water Quality (WQ) Module User Manual" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 4 Simulation Construction | TUFLOW FV Water Quality (WQ) Module User Manual" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/tuflow.png" />
  <meta property="og:description" content="Section 4 Simulation Construction | TUFLOW FV Water Quality (WQ) Module User Manual" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 4 Simulation Construction | TUFLOW FV Water Quality (WQ) Module User Manual" />
  
  <meta name="twitter:description" content="Section 4 Simulation Construction | TUFLOW FV Water Quality (WQ) Module User Manual" />
  <meta name="twitter:image" content="/images/tuflow.png" />

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/TUFLOW.ico" type="image/x-icon" />
<link rel="prev" href="ProcessDescriptions-1.html"/>
<link rel="next" href="AppSyntax.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://www.tuflow.com"><img src="images/tuflow.png" style="width:246px;height:68px;"></a></li>

<li class="divider"></li>
<li><a href="index.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#about-this-manual"><i class="fa fa-check"></i>About this manual</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#how-to-use-this-manual"><i class="fa fa-check"></i>How to use this manual</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#navigation"><i class="fa fa-check"></i>Navigation</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#searching"><i class="fa fa-check"></i>Searching</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#tables"><i class="fa fa-check"></i>Tables</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#figures"><i class="fa fa-check"></i>Figures</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#networks"><i class="fa fa-check"></i>Networks</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#commands"><i class="fa fa-check"></i>Commands</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#parameter-notation"><i class="fa fa-check"></i>Parameter notation</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#concentration-nomenclature"><i class="fa fa-check"></i>Concentration nomenclature</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#feedback"><i class="fa fa-check"></i>Feedback</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="Overview-1.html"><a href="Overview-1.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="Overview-1.html"><a href="Overview-1.html#OverviewContext-2"><i class="fa fa-check"></i><b>1.1</b> Context</a></li>
<li class="chapter" data-level="1.2" data-path="Overview-1.html"><a href="Overview-1.html#Features-2"><i class="fa fa-check"></i><b>1.2</b> Features</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="Overview-1.html"><a href="Overview-1.html#Usability-3"><i class="fa fa-check"></i><b>1.2.1</b> Usability</a></li>
<li class="chapter" data-level="1.2.2" data-path="Overview-1.html"><a href="Overview-1.html#CnsFeats-3"><i class="fa fa-check"></i><b>1.2.2</b> Constituents and processes</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="Overview-1.html"><a href="Overview-1.html#Science-2"><i class="fa fa-check"></i><b>1.3</b> Science</a></li>
<li class="chapter" data-level="1.4" data-path="Overview-1.html"><a href="Overview-1.html#Support-2"><i class="fa fa-check"></i><b>1.4</b> Support</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Architecture-1.html"><a href="Architecture-1.html"><i class="fa fa-check"></i><b>2</b> Architecture</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Architecture-1.html"><a href="Architecture-1.html#ArchitectureContext-2"><i class="fa fa-check"></i><b>2.1</b> Context</a></li>
<li class="chapter" data-level="2.2" data-path="Architecture-1.html"><a href="Architecture-1.html#SimulationTiers-2"><i class="fa fa-check"></i><b>2.2</b> Simulation Tiers</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="Architecture-1.html"><a href="Architecture-1.html#SimulationClass-3"><i class="fa fa-check"></i><b>2.2.1</b> Tier 1: Simulation Class</a></li>
<li class="chapter" data-level="2.2.2" data-path="Architecture-1.html"><a href="Architecture-1.html#ConstituentModel-3"><i class="fa fa-check"></i><b>2.2.2</b> Tier 2: Model Class</a></li>
<li class="chapter" data-level="2.2.3" data-path="Architecture-1.html"><a href="Architecture-1.html#ConMod-3"><i class="fa fa-check"></i><b>2.2.3</b> Tier 3: Constituent Model</a></li>
<li class="chapter" data-level="2.2.4" data-path="Architecture-1.html"><a href="Architecture-1.html#ComputedVariableParameters-3"><i class="fa fa-check"></i><b>2.2.4</b> Tier 4: Computed Variables</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="Architecture-1.html"><a href="Architecture-1.html#ArchitectureLinkageWithFV-2"><i class="fa fa-check"></i><b>2.3</b> Linkage with TUFLOW FV</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="Architecture-1.html"><a href="Architecture-1.html#ArchProc-3"><i class="fa fa-check"></i><b>2.3.1</b> Process</a></li>
<li class="chapter" data-level="2.3.2" data-path="Architecture-1.html"><a href="Architecture-1.html#ProcessDescriptionsLight-3"><i class="fa fa-check"></i><b>2.3.2</b> Treatment of light</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="Architecture-1.html"><a href="Architecture-1.html#ArchAPI"><i class="fa fa-check"></i><b>2.4</b> Linkage with Other Hydrodynamic Models</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html"><i class="fa fa-check"></i><b>3</b> Process Descriptions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#SimProcSimuClDO-2"><i class="fa fa-check"></i><b>3.1</b> Simulation Class: DO</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#DOOverview-3"><i class="fa fa-check"></i><b>3.1.1</b> Overview</a></li>
<li class="chapter" data-level="3.1.2" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModDODO-3"><i class="fa fa-check"></i><b>3.1.2</b> Model Class: Oxygen</a></li>
<li class="chapter" data-level="3.1.3" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModDOPath-3"><i class="fa fa-check"></i><b>3.1.3</b> Model Class: Pathogens (optional)</a></li>
<li class="chapter" data-level="3.1.4" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#DOCompVars-3"><i class="fa fa-check"></i><b>3.1.4</b> Computed variables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#SimProcSimuClInorg-2"><i class="fa fa-check"></i><b>3.2</b> Simulation Class: Inorganics</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#InorgOverview-3"><i class="fa fa-check"></i><b>3.2.1</b> Overview</a></li>
<li class="chapter" data-level="3.2.2" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModInorgDO-3"><i class="fa fa-check"></i><b>3.2.2</b> Model Class: Oxygen</a></li>
<li class="chapter" data-level="3.2.3" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModInorgSi-3"><i class="fa fa-check"></i><b>3.2.3</b> Model Class: Silicate</a></li>
<li class="chapter" data-level="3.2.4" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModInorgN-3"><i class="fa fa-check"></i><b>3.2.4</b> Model Class: Inorganic nitrogen</a></li>
<li class="chapter" data-level="3.2.5" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModInorgP-3"><i class="fa fa-check"></i><b>3.2.5</b> Model Class: Inorganic phosphorus</a></li>
<li class="chapter" data-level="3.2.6" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModInorgPhy-3"><i class="fa fa-check"></i><b>3.2.6</b> Model Class: Phytoplankton</a></li>
<li class="chapter" data-level="3.2.7" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModInorgPath-3"><i class="fa fa-check"></i><b>3.2.7</b> Model Class: Pathogens (optional)</a></li>
<li class="chapter" data-level="3.2.8" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#InorgCompVars-3"><i class="fa fa-check"></i><b>3.2.8</b> Computed variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#SimProcSimuClOrg-2"><i class="fa fa-check"></i><b>3.3</b> Simulation Class: Organics</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#OrgOverview-3"><i class="fa fa-check"></i><b>3.3.1</b> Overview</a></li>
<li class="chapter" data-level="3.3.2" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModOrgDO-3"><i class="fa fa-check"></i><b>3.3.2</b> Model Class: Oxygen</a></li>
<li class="chapter" data-level="3.3.3" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModOrgSi-3"><i class="fa fa-check"></i><b>3.3.3</b> Model Class: Silicate</a></li>
<li class="chapter" data-level="3.3.4" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModOrgN-3"><i class="fa fa-check"></i><b>3.3.4</b> Model Class: Inorganic nitrogen</a></li>
<li class="chapter" data-level="3.3.5" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModOrgP-3"><i class="fa fa-check"></i><b>3.3.5</b> Model Class: Inorganic phosphorus</a></li>
<li class="chapter" data-level="3.3.6" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModOrgOrg-3"><i class="fa fa-check"></i><b>3.3.6</b> Model Class: Organic matter</a></li>
<li class="chapter" data-level="3.3.7" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModOrgPhy-3"><i class="fa fa-check"></i><b>3.3.7</b> Model Class: Phytoplankton</a></li>
<li class="chapter" data-level="3.3.8" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#ConModOrgPath-3"><i class="fa fa-check"></i><b>3.3.8</b> Model Class: Pathogens (optional)</a></li>
<li class="chapter" data-level="3.3.9" data-path="ProcessDescriptions-1.html"><a href="ProcessDescriptions-1.html#OrgCompVars-3"><i class="fa fa-check"></i><b>3.3.9</b> Computed variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html"><i class="fa fa-check"></i><b>4</b> Simulation Construction</a>
<ul>
<li class="chapter" data-level="4.1" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimulationConstructionContext-2"><i class="fa fa-check"></i><b>4.1</b> Context</a></li>
<li class="chapter" data-level="4.2" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimUnits-2"><i class="fa fa-check"></i><b>4.2</b> Units</a></li>
<li class="chapter" data-level="4.3" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#TFVGeneral-2"><i class="fa fa-check"></i><b>4.3</b> General arrangement</a></li>
<li class="chapter" data-level="4.4" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#TFVCommands-2"><i class="fa fa-check"></i><b>4.4</b> TUFLOW FV control file commands</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#WQMActivation-3"><i class="fa fa-check"></i><b>4.4.1</b> WQ Module activation</a></li>
<li class="chapter" data-level="4.4.2" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#InitBCCond-3"><i class="fa fa-check"></i><b>4.4.2</b> Initial and boundary conditions</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#WQctrlfil-2"><i class="fa fa-check"></i><b>4.5</b> Water quality control file commands</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimCtrls-3"><i class="fa fa-check"></i><b>4.5.1</b> Part 1: Simulation controls</a></li>
<li class="chapter" data-level="4.5.2" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#ConModSttngs-3"><i class="fa fa-check"></i><b>4.5.2</b> Part 2: Constituent model settings</a></li>
<li class="chapter" data-level="4.5.3" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#MatSpecs-3"><i class="fa fa-check"></i><b>4.5.3</b> Part 3: Material specifications</a></li>
<li class="chapter" data-level="4.5.4" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimSetSum-2"><i class="fa fa-check"></i><b>4.5.4</b> Summary</a></li>
<li class="chapter" data-level="4.5.5" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimSetLog-2"><i class="fa fa-check"></i><b>4.5.5</b> Log files</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimSetSimClDO-2"><i class="fa fa-check"></i><b>4.6</b> Simulation Class: DO</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#PrereqDO-3"><i class="fa fa-check"></i><b>4.6.1</b> Prerequisites</a></li>
<li class="chapter" data-level="4.6.2" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimCtrlsDO-3"><i class="fa fa-check"></i><b>4.6.2</b> Part 1: Simulation specification</a></li>
<li class="chapter" data-level="4.6.3" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#ConModSttngsDO-3"><i class="fa fa-check"></i><b>4.6.3</b> Part 2: Constituent model specification</a></li>
<li class="chapter" data-level="4.6.4" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#MatSpecsDO-3"><i class="fa fa-check"></i><b>4.6.4</b> Part 3: Material specification</a></li>
<li class="chapter" data-level="4.6.5" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#ConOrdDO-3"><i class="fa fa-check"></i><b>4.6.5</b> Constituent ordering</a></li>
<li class="chapter" data-level="4.6.6" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#ExampleDO"><i class="fa fa-check"></i><b>4.6.6</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimSetSimClInorg-2"><i class="fa fa-check"></i><b>4.7</b> Simulation Class: Inorganics</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#PrereqInorg-3"><i class="fa fa-check"></i><b>4.7.1</b> Prerequisites</a></li>
<li class="chapter" data-level="4.7.2" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimCtrlsInorg-3"><i class="fa fa-check"></i><b>4.7.2</b> Part 1: Simulation specification</a></li>
<li class="chapter" data-level="4.7.3" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#ConModSttngsInorg-3"><i class="fa fa-check"></i><b>4.7.3</b> Part 2: Constituent model specification</a></li>
<li class="chapter" data-level="4.7.4" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#MatSpecsInorg-3"><i class="fa fa-check"></i><b>4.7.4</b> Part 3: Material specification</a></li>
<li class="chapter" data-level="4.7.5" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#ConOrdInorg-3"><i class="fa fa-check"></i><b>4.7.5</b> Constituent ordering</a></li>
<li class="chapter" data-level="4.7.6" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#ExampleInorg"><i class="fa fa-check"></i><b>4.7.6</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimSetSimClOrg-2"><i class="fa fa-check"></i><b>4.8</b> Simulation Class: Organics</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#PrereqOrg-3"><i class="fa fa-check"></i><b>4.8.1</b> Prerequisites</a></li>
<li class="chapter" data-level="4.8.2" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#SimCtrlsOrg-3"><i class="fa fa-check"></i><b>4.8.2</b> Part 1: Simulation specification</a></li>
<li class="chapter" data-level="4.8.3" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#ConModSttngsOrg-3"><i class="fa fa-check"></i><b>4.8.3</b> Part 2: Constituent model specification</a></li>
<li class="chapter" data-level="4.8.4" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#MatSpecsOrg-3"><i class="fa fa-check"></i><b>4.8.4</b> Part 3: Material specification</a></li>
<li class="chapter" data-level="4.8.5" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#ConOrdOrg-3"><i class="fa fa-check"></i><b>4.8.5</b> Constituent ordering</a></li>
<li class="chapter" data-level="4.8.6" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#ExampleOrg"><i class="fa fa-check"></i><b>4.8.6</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#Outputs-3"><i class="fa fa-check"></i><b>4.9</b> Outputs</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#WQMOutputs-4"><i class="fa fa-check"></i><b>4.9.1</b> WQ Module outputs</a></li>
<li class="chapter" data-level="4.9.2" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#FVOutputs-4"><i class="fa fa-check"></i><b>4.9.2</b> TUFLOW FV outputs</a></li>
<li class="chapter" data-level="4.9.3" data-path="SimulationConstruction-1.html"><a href="SimulationConstruction-1.html#units"><i class="fa fa-check"></i><b>4.9.3</b> Units</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="AppSyntax.html"><a href="AppSyntax.html"><i class="fa fa-check"></i><b>A</b> Syntax of command descriptions</a>
<ul>
<li class="chapter" data-level="A.1" data-path="AppSyntax.html"><a href="AppSyntax.html#Appcmds"><i class="fa fa-check"></i><b>A.1</b> Commands</a></li>
<li class="chapter" data-level="A.2" data-path="AppSyntax.html"><a href="AppSyntax.html#Appargmts"><i class="fa fa-check"></i><b>A.2</b> Arguments</a></li>
<li class="chapter" data-level="A.3" data-path="AppSyntax.html"><a href="AppSyntax.html#Appdflts"><i class="fa fa-check"></i><b>A.3</b> Defaults</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="AppCommands.html"><a href="AppCommands.html"><i class="fa fa-check"></i><b>B</b> Commands</a></li>
<li class="chapter" data-level="C" data-path="AppDemoModel.html"><a href="AppDemoModel.html"><i class="fa fa-check"></i><b>C</b> Demonstration model</a></li>
<li class="chapter" data-level="D" data-path="AppO.html"><a href="AppO.html"><i class="fa fa-check"></i><b>D</b> Processes: oxygen</a>
<ul>
<li class="chapter" data-level="D.1" data-path="AppO.html"><a href="AppO.html#AtmosphericAeration-3"><i class="fa fa-check"></i><b>D.1</b> Atmospheric oxygen flux</a></li>
<li class="chapter" data-level="D.2" data-path="AppO.html"><a href="AppO.html#SedOxyCons-3"><i class="fa fa-check"></i><b>D.2</b> Sediment oxygen flux</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="AppSil.html"><a href="AppSil.html"><i class="fa fa-check"></i><b>E</b> Processes: silicate</a>
<ul>
<li class="chapter" data-level="E.1" data-path="AppSil.html"><a href="AppSil.html#SedSilProd-3"><i class="fa fa-check"></i><b>E.1</b> Sediment silicate flux</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="AppIN.html"><a href="AppIN.html"><i class="fa fa-check"></i><b>F</b> Processes: inorganic nitrogen</a>
<ul>
<li class="chapter" data-level="F.1" data-path="AppIN.html"><a href="AppIN.html#SedAmmNitProd-3"><i class="fa fa-check"></i><b>F.1</b> Sediment ammonium and nitrate flux</a></li>
<li class="chapter" data-level="F.2" data-path="AppIN.html"><a href="AppIN.html#Nitrif-3"><i class="fa fa-check"></i><b>F.2</b> Nitrification</a></li>
<li class="chapter" data-level="F.3" data-path="AppIN.html"><a href="AppIN.html#Denitrif-3"><i class="fa fa-check"></i><b>F.3</b> Denitrification</a></li>
<li class="chapter" data-level="F.4" data-path="AppIN.html"><a href="AppIN.html#Anammox-3"><i class="fa fa-check"></i><b>F.4</b> Anaerobic oxidation of ammonium</a></li>
<li class="chapter" data-level="F.5" data-path="AppIN.html"><a href="AppIN.html#DRNA-3"><i class="fa fa-check"></i><b>F.5</b> Dissimilatory reduction of nitrate to ammonium</a></li>
<li class="chapter" data-level="F.6" data-path="AppIN.html"><a href="AppIN.html#WetDepIN-3"><i class="fa fa-check"></i><b>F.6</b> Wet deposition of inorganic nitrogen</a></li>
<li class="chapter" data-level="F.7" data-path="AppIN.html"><a href="AppIN.html#DryDepIN-3"><i class="fa fa-check"></i><b>F.7</b> Dry deposition of inorganic nitrogen</a></li>
</ul></li>
<li class="chapter" data-level="G" data-path="AppIP.html"><a href="AppIP.html"><i class="fa fa-check"></i><b>G</b> Processes: inorganic phosphorus</a>
<ul>
<li class="chapter" data-level="G.1" data-path="AppIP.html"><a href="AppIP.html#SedFRPhsProd-3"><i class="fa fa-check"></i><b>G.1</b> Sediment FRP flux</a></li>
<li class="chapter" data-level="G.2" data-path="AppIP.html"><a href="AppIP.html#WetDepIP-3"><i class="fa fa-check"></i><b>G.2</b> Wet deposition of inorganic phosphorus</a></li>
<li class="chapter" data-level="G.3" data-path="AppIP.html"><a href="AppIP.html#DryDepIP-3"><i class="fa fa-check"></i><b>G.3</b> Dry deposition of inorganic phosphorus</a></li>
<li class="chapter" data-level="G.4" data-path="AppIP.html"><a href="AppIP.html#FRPhsAdsDsp-3"><i class="fa fa-check"></i><b>G.4</b> Adsorption and desorption</a>
<ul>
<li class="chapter" data-level="G.4.1" data-path="AppIP.html"><a href="AppIP.html#FRPhsAdsDspLin-4"><i class="fa fa-check"></i><b>G.4.1</b> Linear model</a></li>
<li class="chapter" data-level="G.4.2" data-path="AppIP.html"><a href="AppIP.html#FRPhsAdsDspQuad-4"><i class="fa fa-check"></i><b>G.4.2</b> Quadratic model</a></li>
</ul></li>
<li class="chapter" data-level="G.5" data-path="AppIP.html"><a href="AppIP.html#SettlingIP-3"><i class="fa fa-check"></i><b>G.5</b> Settling</a></li>
</ul></li>
<li class="chapter" data-level="H" data-path="AppPhy.html"><a href="AppPhy.html"><i class="fa fa-check"></i><b>H</b> Processes: phyto general</a>
<ul>
<li class="chapter" data-level="H.1" data-path="AppPhy.html"><a href="AppPhy.html#PhyGeneral-3"><i class="fa fa-check"></i><b>H.1</b> General</a></li>
<li class="chapter" data-level="H.2" data-path="AppPhy.html"><a href="AppPhy.html#PhyUnits-3"><i class="fa fa-check"></i><b>H.2</b> Units</a></li>
</ul></li>
<li class="chapter" data-level="I" data-path="PhyRates-3.html"><a href="PhyRates-3.html"><i class="fa fa-check"></i><b>I</b> Processes: phyto biomass rates</a>
<ul>
<li class="chapter" data-level="I.1" data-path="PhyRates-3.html"><a href="PhyRates-3.html#PhyProd-4"><i class="fa fa-check"></i><b>I.1</b> Primary productivity</a></li>
<li class="chapter" data-level="I.2" data-path="PhyRates-3.html"><a href="PhyRates-3.html#PhyResp-4"><i class="fa fa-check"></i><b>I.2</b> Respiration</a></li>
<li class="chapter" data-level="I.3" data-path="PhyRates-3.html"><a href="PhyRates-3.html#PhyExud-4"><i class="fa fa-check"></i><b>I.3</b> Exudation</a></li>
<li class="chapter" data-level="I.4" data-path="PhyRates-3.html"><a href="PhyRates-3.html#PhySettle-4"><i class="fa fa-check"></i><b>I.4</b> Settling</a>
<ul>
<li class="chapter" data-level="I.4.1" data-path="PhyRates-3.html"><a href="PhyRates-3.html#PhySettleNone-5"><i class="fa fa-check"></i><b>I.4.1</b> None</a></li>
<li class="chapter" data-level="I.4.2" data-path="PhyRates-3.html"><a href="PhyRates-3.html#PhySettleConst-5"><i class="fa fa-check"></i><b>I.4.2</b> Constant</a></li>
<li class="chapter" data-level="I.4.3" data-path="PhyRates-3.html"><a href="PhyRates-3.html#PhySettleConstD-5"><i class="fa fa-check"></i><b>I.4.3</b> Constant with density correction</a></li>
<li class="chapter" data-level="I.4.4" data-path="PhyRates-3.html"><a href="PhyRates-3.html#PhySettleStokes-5"><i class="fa fa-check"></i><b>I.4.4</b> Stokes</a></li>
<li class="chapter" data-level="I.4.5" data-path="PhyRates-3.html"><a href="PhyRates-3.html#PhySettleMotile-5"><i class="fa fa-check"></i><b>I.4.5</b> Motile</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="J" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html"><i class="fa fa-check"></i><b>J</b> Processes: phyto limitation</a>
<ul>
<li class="chapter" data-level="J.1" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimGen-4"><i class="fa fa-check"></i><b>J.1</b> General</a></li>
<li class="chapter" data-level="J.2" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimT-4"><i class="fa fa-check"></i><b>J.2</b> Temperature</a>
<ul>
<li class="chapter" data-level="J.2.1" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimT0"><i class="fa fa-check"></i><b>J.2.1</b> None</a></li>
<li class="chapter" data-level="J.2.2" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimT1"><i class="fa fa-check"></i><b>J.2.2</b> Standard</a></li>
</ul></li>
<li class="chapter" data-level="J.3" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimN-4"><i class="fa fa-check"></i><b>J.3</b> Nitrogen</a>
<ul>
<li class="chapter" data-level="J.3.1" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimisNB-5"><i class="fa fa-check"></i><b>J.3.1</b> Basic phytoplankton constituent model</a></li>
<li class="chapter" data-level="J.3.2" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimisNA-5"><i class="fa fa-check"></i><b>J.3.2</b> Advanced phytoplankton constituent model</a></li>
</ul></li>
<li class="chapter" data-level="J.4" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimP-4"><i class="fa fa-check"></i><b>J.4</b> Phosphorus</a>
<ul>
<li class="chapter" data-level="J.4.1" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimisPB-5"><i class="fa fa-check"></i><b>J.4.1</b> Basic phytoplankton constituent model</a></li>
<li class="chapter" data-level="J.4.2" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimisPA-5"><i class="fa fa-check"></i><b>J.4.2</b> Advanced phytoplankton constituent model</a></li>
</ul></li>
<li class="chapter" data-level="J.5" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimSi-4"><i class="fa fa-check"></i><b>J.5</b> Silicate</a></li>
<li class="chapter" data-level="J.6" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimLght-4"><i class="fa fa-check"></i><b>J.6</b> Light</a>
<ul>
<li class="chapter" data-level="J.6.1" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimBasic-5"><i class="fa fa-check"></i><b>J.6.1</b> Basic</a></li>
<li class="chapter" data-level="J.6.2" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimMonod-5"><i class="fa fa-check"></i><b>J.6.2</b> Monod</a></li>
<li class="chapter" data-level="J.6.3" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimSteele-5"><i class="fa fa-check"></i><b>J.6.3</b> Steele</a></li>
<li class="chapter" data-level="J.6.4" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimWebb-5"><i class="fa fa-check"></i><b>J.6.4</b> Webb</a></li>
<li class="chapter" data-level="J.6.5" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimJassby-5"><i class="fa fa-check"></i><b>J.6.5</b> Jassby</a></li>
<li class="chapter" data-level="J.6.6" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimChalker-5"><i class="fa fa-check"></i><b>J.6.6</b> Chalker</a></li>
<li class="chapter" data-level="J.6.7" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimKlepper-5"><i class="fa fa-check"></i><b>J.6.7</b> Klepper</a></li>
<li class="chapter" data-level="J.6.8" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimIntegrated-5"><i class="fa fa-check"></i><b>J.6.8</b> Integrated</a></li>
</ul></li>
<li class="chapter" data-level="J.7" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimSal-4"><i class="fa fa-check"></i><b>J.7</b> Salinity</a>
<ul>
<li class="chapter" data-level="J.7.1" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimNone-5"><i class="fa fa-check"></i><b>J.7.1</b> None</a></li>
<li class="chapter" data-level="J.7.2" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimFresh-5"><i class="fa fa-check"></i><b>J.7.2</b> Freshwater</a></li>
<li class="chapter" data-level="J.7.3" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimMarine-5"><i class="fa fa-check"></i><b>J.7.3</b> Marine</a></li>
<li class="chapter" data-level="J.7.4" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimMixed-5"><i class="fa fa-check"></i><b>J.7.4</b> Mixed</a></li>
<li class="chapter" data-level="J.7.5" data-path="PhyLimits-3.html"><a href="PhyLimits-3.html#PhyLimEstuarine-5"><i class="fa fa-check"></i><b>J.7.5</b> Estuarine</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="K" data-path="PhyUptake-3.html"><a href="PhyUptake-3.html"><i class="fa fa-check"></i><b>K</b> Processes: phyto uptake</a>
<ul>
<li class="chapter" data-level="K.1" data-path="PhyUptake-3.html"><a href="PhyUptake-3.html#PhyUptakeC-4"><i class="fa fa-check"></i><b>K.1</b> Carbon</a></li>
<li class="chapter" data-level="K.2" data-path="PhyUptake-3.html"><a href="PhyUptake-3.html#PhyLimUpN-4"><i class="fa fa-check"></i><b>K.2</b> Nitrogen</a>
<ul>
<li class="chapter" data-level="K.2.1" data-path="PhyUptake-3.html"><a href="PhyUptake-3.html#PhyLimUPNB-5"><i class="fa fa-check"></i><b>K.2.1</b> Basic phytoplankton constituent model</a></li>
<li class="chapter" data-level="K.2.2" data-path="PhyUptake-3.html"><a href="PhyUptake-3.html#PhyLimUPNA-5"><i class="fa fa-check"></i><b>K.2.2</b> Advanced phytoplankton constituent model</a></li>
<li class="chapter" data-level="K.2.3" data-path="PhyUptake-3.html"><a href="PhyUptake-3.html#PhyLimUPNFix-5"><i class="fa fa-check"></i><b>K.2.3</b> Nitrogen fixing</a></li>
</ul></li>
<li class="chapter" data-level="K.3" data-path="PhyUptake-3.html"><a href="PhyUptake-3.html#PhyLimUpP-4"><i class="fa fa-check"></i><b>K.3</b> Phosphorus</a>
<ul>
<li class="chapter" data-level="K.3.1" data-path="PhyUptake-3.html"><a href="PhyUptake-3.html#PhyLimUPPB-5"><i class="fa fa-check"></i><b>K.3.1</b> Basic phytoplankton constituent model</a></li>
<li class="chapter" data-level="K.3.2" data-path="PhyUptake-3.html"><a href="PhyUptake-3.html#PhyLimUPPA-5"><i class="fa fa-check"></i><b>K.3.2</b> Advanced phytoplankton constituent model</a></li>
</ul></li>
<li class="chapter" data-level="K.4" data-path="PhyUptake-3.html"><a href="PhyUptake-3.html#PhyLimUpSi-4"><i class="fa fa-check"></i><b>K.4</b> Silicate</a></li>
</ul></li>
<li class="chapter" data-level="L" data-path="PhyLosses-3.html"><a href="PhyLosses-3.html"><i class="fa fa-check"></i><b>L</b> Processes: phyto losses</a>
<ul>
<li class="chapter" data-level="L.1" data-path="PhyLosses-3.html"><a href="PhyLosses-3.html#PhyLossC-4"><i class="fa fa-check"></i><b>L.1</b> Carbon</a></li>
<li class="chapter" data-level="L.2" data-path="PhyLosses-3.html"><a href="PhyLosses-3.html#PhyLossN-4"><i class="fa fa-check"></i><b>L.2</b> Nitrogen</a></li>
<li class="chapter" data-level="L.3" data-path="PhyLosses-3.html"><a href="PhyLosses-3.html#PhyLossP-4"><i class="fa fa-check"></i><b>L.3</b> Phosphorus</a></li>
<li class="chapter" data-level="L.4" data-path="PhyLosses-3.html"><a href="PhyLosses-3.html#PhyLossSi-4"><i class="fa fa-check"></i><b>L.4</b> Silicate</a></li>
</ul></li>
<li class="chapter" data-level="M" data-path="AppphyOther.html"><a href="AppphyOther.html"><i class="fa fa-check"></i><b>M</b> Processes: phyto other</a>
<ul>
<li class="chapter" data-level="M.1" data-path="AppphyOther.html"><a href="AppphyOther.html#PhySelfShad-3"><i class="fa fa-check"></i><b>M.1</b> Self shading</a></li>
<li class="chapter" data-level="M.2" data-path="AppphyOther.html"><a href="AppphyOther.html#PhyCellDens-3"><i class="fa fa-check"></i><b>M.2</b> Cell density</a></li>
</ul></li>
<li class="chapter" data-level="N" data-path="AppOrg.html"><a href="AppOrg.html"><i class="fa fa-check"></i><b>N</b> Processes: organic matter</a>
<ul>
<li class="chapter" data-level="N.1" data-path="AppOrg.html"><a href="AppOrg.html#SedDissOrgProd-3"><i class="fa fa-check"></i><b>N.1</b> Sediment flux</a></li>
<li class="chapter" data-level="N.2" data-path="AppOrg.html"><a href="AppOrg.html#Hydrol-3"><i class="fa fa-check"></i><b>N.2</b> Hydrolysis</a>
<ul>
<li class="chapter" data-level="N.2.1" data-path="AppOrg.html"><a href="AppOrg.html#HydrolCons-4"><i class="fa fa-check"></i><b>N.2.1</b> Consumption</a></li>
<li class="chapter" data-level="N.2.2" data-path="AppOrg.html"><a href="AppOrg.html#HydrolProd-4"><i class="fa fa-check"></i><b>N.2.2</b> Production</a></li>
</ul></li>
<li class="chapter" data-level="N.3" data-path="AppOrg.html"><a href="AppOrg.html#Break-3"><i class="fa fa-check"></i><b>N.3</b> Breakdown</a>
<ul>
<li class="chapter" data-level="N.3.1" data-path="AppOrg.html"><a href="AppOrg.html#BreakCons-4"><i class="fa fa-check"></i><b>N.3.1</b> Consumption</a></li>
<li class="chapter" data-level="N.3.2" data-path="AppOrg.html"><a href="AppOrg.html#BreakProd-4"><i class="fa fa-check"></i><b>N.3.2</b> Production</a></li>
</ul></li>
<li class="chapter" data-level="N.4" data-path="AppOrg.html"><a href="AppOrg.html#Miner-3"><i class="fa fa-check"></i><b>N.4</b> Mineralisation</a>
<ul>
<li class="chapter" data-level="N.4.1" data-path="AppOrg.html"><a href="AppOrg.html#MinerCons-4"><i class="fa fa-check"></i><b>N.4.1</b> Consumption</a></li>
<li class="chapter" data-level="N.4.2" data-path="AppOrg.html"><a href="AppOrg.html#MinerProd-4"><i class="fa fa-check"></i><b>N.4.2</b> Production</a></li>
</ul></li>
<li class="chapter" data-level="N.5" data-path="AppOrg.html"><a href="AppOrg.html#Active-3"><i class="fa fa-check"></i><b>N.5</b> Activation</a>
<ul>
<li class="chapter" data-level="N.5.1" data-path="AppOrg.html"><a href="AppOrg.html#ActiveCons-4"><i class="fa fa-check"></i><b>N.5.1</b> Consumption</a></li>
<li class="chapter" data-level="N.5.2" data-path="AppOrg.html"><a href="AppOrg.html#ActiveProd-4"><i class="fa fa-check"></i><b>N.5.2</b> Production</a></li>
</ul></li>
<li class="chapter" data-level="N.6" data-path="AppOrg.html"><a href="AppOrg.html#OrgPhot-3"><i class="fa fa-check"></i><b>N.6</b> Photolysis</a>
<ul>
<li class="chapter" data-level="N.6.1" data-path="AppOrg.html"><a href="AppOrg.html#PhotCons-4"><i class="fa fa-check"></i><b>N.6.1</b> Consumption</a></li>
<li class="chapter" data-level="N.6.2" data-path="AppOrg.html"><a href="AppOrg.html#PhotProd-4"><i class="fa fa-check"></i><b>N.6.2</b> Production</a></li>
</ul></li>
<li class="chapter" data-level="N.7" data-path="AppOrg.html"><a href="AppOrg.html#OrgLight-3"><i class="fa fa-check"></i><b>N.7</b> Self shading</a></li>
<li class="chapter" data-level="N.8" data-path="AppOrg.html"><a href="AppOrg.html#OrgSettle-3"><i class="fa fa-check"></i><b>N.8</b> Settling</a>
<ul>
<li class="chapter" data-level="N.8.1" data-path="AppOrg.html"><a href="AppOrg.html#OrgSettleNone-5"><i class="fa fa-check"></i><b>N.8.1</b> None</a></li>
<li class="chapter" data-level="N.8.2" data-path="AppOrg.html"><a href="AppOrg.html#OrgSettleConst-5"><i class="fa fa-check"></i><b>N.8.2</b> Constant</a></li>
<li class="chapter" data-level="N.8.3" data-path="AppOrg.html"><a href="AppOrg.html#OrgSettleConstD-5"><i class="fa fa-check"></i><b>N.8.3</b> Constant with density correction</a></li>
<li class="chapter" data-level="N.8.4" data-path="AppOrg.html"><a href="AppOrg.html#OrgSettleStokes-5"><i class="fa fa-check"></i><b>N.8.4</b> Stokes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="O" data-path="AppPath.html"><a href="AppPath.html"><i class="fa fa-check"></i><b>O</b> Processes: pathogens</a>
<ul>
<li class="chapter" data-level="O.1" data-path="AppPath.html"><a href="AppPath.html#Mortal-3"><i class="fa fa-check"></i><b>O.1</b> Mortality</a></li>
<li class="chapter" data-level="O.2" data-path="AppPath.html"><a href="AppPath.html#Inactivation-3"><i class="fa fa-check"></i><b>O.2</b> Inactivation</a></li>
<li class="chapter" data-level="O.3" data-path="AppPath.html"><a href="AppPath.html#PathAttach-3"><i class="fa fa-check"></i><b>O.3</b> Attachment</a></li>
<li class="chapter" data-level="O.4" data-path="AppPath.html"><a href="AppPath.html#PathSettling-3"><i class="fa fa-check"></i><b>O.4</b> Settling</a></li>
<li class="chapter" data-level="O.5" data-path="AppPath.html"><a href="AppPath.html#Pathother-3"><i class="fa fa-check"></i><b>O.5</b> Other</a>
<ul>
<li class="chapter" data-level="O.5.1" data-path="AppPath.html"><a href="AppPath.html#Pathtot-3"><i class="fa fa-check"></i><b>O.5.1</b> Total pathogens</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="P" data-path="AppConstits.html"><a href="AppConstits.html"><i class="fa fa-check"></i><b>P</b> Computed variables</a></li>
<li class="chapter" data-level="Q" data-path="AppDiags.html"><a href="AppDiags.html"><i class="fa fa-check"></i><b>Q</b> Diagnostic variables</a></li>
<li class="chapter" data-level="R" data-path="AppParams.html"><a href="AppParams.html"><i class="fa fa-check"></i><b>R</b> Parameters</a></li>
<li class="chapter" data-level="S" data-path="AppMBal.html"><a href="AppMBal.html"><i class="fa fa-check"></i><b>S</b> Mass Conservation Model</a>
<ul>
<li class="chapter" data-level="S.1" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalIntent"><i class="fa fa-check"></i><b>S.1</b> Intent</a></li>
<li class="chapter" data-level="S.2" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalDescription"><i class="fa fa-check"></i><b>S.2</b> Description</a></li>
<li class="chapter" data-level="S.3" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalMdel"><i class="fa fa-check"></i><b>S.3</b> Model suite</a></li>
<li class="chapter" data-level="S.4" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalCalcs"><i class="fa fa-check"></i><b>S.4</b> Calculations</a></li>
<li class="chapter" data-level="S.5" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalPerformance"><i class="fa fa-check"></i><b>S.5</b> Mass conservation performance</a>
<ul>
<li class="chapter" data-level="S.5.1" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalDO"><i class="fa fa-check"></i><b>S.5.1</b> Simulation class: DO</a></li>
<li class="chapter" data-level="S.5.2" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalInorg"><i class="fa fa-check"></i><b>S.5.2</b> Simulation class: Inorganics</a></li>
<li class="chapter" data-level="S.5.3" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalOrg"><i class="fa fa-check"></i><b>S.5.3</b> Simulation class: Organics</a></li>
</ul></li>
<li class="chapter" data-level="S.6" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalExecuting"><i class="fa fa-check"></i><b>S.6</b> Access and execution</a>
<ul>
<li class="chapter" data-level="S.6.1" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalAccess"><i class="fa fa-check"></i><b>S.6.1</b> Access</a></li>
<li class="chapter" data-level="S.6.2" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalExecu"><i class="fa fa-check"></i><b>S.6.2</b> Execution</a></li>
</ul></li>
<li class="chapter" data-level="S.7" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalRes"><i class="fa fa-check"></i><b>S.7</b> Results</a></li>
<li class="chapter" data-level="S.8" data-path="AppMBal.html"><a href="AppMBal.html#AppMBalMassCons"><i class="fa fa-check"></i><b>S.8</b> Mass conservation analysis</a>
<ul>
<li class="chapter" data-level="S.8.1" data-path="AppMBal.html"><a href="AppMBal.html#AppMBMatlab"><i class="fa fa-check"></i><b>S.8.1</b> MATLAB</a></li>
<li class="chapter" data-level="S.8.2" data-path="AppMBal.html"><a href="AppMBal.html#AppMBPython"><i class="fa fa-check"></i><b>S.8.2</b> Python</a></li>
</ul></li>
<li class="chapter" data-level="S.9" data-path="AppMBal.html"><a href="AppMBal.html#AppMBInterp"><i class="fa fa-check"></i><b>S.9</b> Notes</a>
<ul>
<li class="chapter" data-level="S.9.1" data-path="AppMBal.html"><a href="AppMBal.html#AppMBInterpUnits"><i class="fa fa-check"></i><b>S.9.1</b> Units</a></li>
<li class="chapter" data-level="S.9.2" data-path="AppMBal.html"><a href="AppMBal.html#AppMBPrecision"><i class="fa fa-check"></i><b>S.9.2</b> Precision</a></li>
<li class="chapter" data-level="S.9.3" data-path="AppMBal.html"><a href="AppMBal.html#AppMBPlatform"><i class="fa fa-check"></i><b>S.9.3</b> Platform</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.tuflow.com"><img src="images/tuflow.png" style="width:246px;height:68px;"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><h0 style="color:rgb(0,85,129);">TUFLOW FV Water Quality (WQ) Module User Manual</h0></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="SimulationConstruction-1" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Section 4</span> Simulation Construction<a href="SimulationConstruction-1.html#SimulationConstruction-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="SimulationConstructionContext-2" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Context<a href="SimulationConstruction-1.html#SimulationConstructionContext-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Previous sections have presented the architecture and water quality processes available within the WQ Module. This section describes the construction of a TUFLOW simulation with the WQ Module activated. This includes descriptions of all commands, with hyperlinks to the Appendices where commands and explanations are listed in a searchable and sortable table for ease of access. TUFLOW FV is the hydrodynamic model used in all descriptions that follow.</p>
<p>Optional model classes (such as pathogens) and their construction are first described in the simplest simulation class for which they can be deployed. Commentary on the ordering of optional constituents is provided in subsequent sections only where needed.</p>
</div>
<div id="SimUnits-2" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Units<a href="SimulationConstruction-1.html#SimUnits-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The WQ Module allows for simulation construction in one of two unit systems (see Section <a href="SimulationConstruction-1.html#SimCtrls-3">4.5.1</a>):</p>
<ul>
<li>A milligrams per litre system (which includes micrograms per litre for phytoplankton) that aligns with typical units of laboratory reporting, and</li>
<li>A millimoles per cubic metre system</li>
</ul>
<p>A single units system must be adopted for a WQ Module simulation, and unit systems cannot be mixed within a simulation. This specification has implications for at least the setting of numerical values for:</p>
<ul>
<li>Initial conditions</li>
<li>Boundary conditions</li>
<li>Computed variable parameters</li>
</ul>
<p>When the milligrams per litre system is used, the WQ Module executes internal conversions between milligrams and millimoles, because millimoles are the units expected by the core water quality calculation routines. This conversion follows the form:</p>
<p><span class="math display" id="eq:equ-massmoles">\[\begin{equation}
  n = \frac{m}{M} \tag{4.1}
\end{equation}\]</span>
where <span class="math inline">\(n\)</span> is millimoles (mmol), <span class="math inline">\(m\)</span> is mass (mg) and <span class="math inline">\(M\)</span> is molar weight (mg/mmol). A similar concept applies to concentration and flux quantities. As such, the WQ Module assigns values to <span class="math inline">\(M\)</span> in converting from milligrams to millimoles, i.e.from user specified milligram initial conditions, boundary conditions and computed variable parameters, to the equivalent millimole quantities. The complete list of values of <span class="math inline">\(M\)</span> for all simulated constituents is provided in Table <a href="AppConstits.html#tab:tab-variables2">P.1</a>. The two possibilities for units for each parameter are provided in Appendix <a href="AppParams.html#AppParams">R</a>, where relevant.</p>
<p>As an example, if a user specifies the milligrams per litre units system (or allows the same default to be set) and sets <code>FRP flux == 3.1</code> in a materials block, then this value of 3.1 is assumed to be mg/m<span class="math inline">\(^2\)</span>/day. Consistent with typical laboratory reporting conventions (see below), this mass flux is taken to be that of elemental phosphorus <span class="math inline">\(P\)</span>, not that of the phosphate molecule <span class="math inline">\(PO_4^{3-}\)</span>. This would mean (using Table <a href="AppConstits.html#tab:tab-variables2">P.1</a> and Equation <a href="SimulationConstruction-1.html#eq:equ-massmoles">(4.1)</a>) that the equivalent millimole rate would be computed as:
<span class="math display" id="eq:equ-massmoleseg">\[\begin{equation}
  n = \frac{3.1}{31} = 0.1 \hspace{0.1cm} \text{mmol/m$^2$/day of P} \tag{4.2}
\end{equation}\]</span></p>
<p>Given the above, users opting to construct WQ Module simulations in the milligrams units system need to clearly understand what is being reported in:</p>
<ul>
<li>Field and/or laboratory measurements, and</li>
<li>Other numerical model predictions that may be used as WQ Module boundary conditions (such as catchment pollutant export models)</li>
</ul>
<p>In the case of laboratory nutrient measurements, it is conventional to report concentrations of the typical quantities used by the WQ Module as silicate-Si, ammonium-N, nitrate-N, FRP-P, organic-C, organic-N, and organic-P. Whilst these quantities might be referred to informally as (for example) nitrate concentrations, the reported number is most commonly the concentration of elemental nitrogen contained within nitrate. To be clear, if a nitrate-N concentration is reported by a laboratory to be 3.5 mg/L, this means that in every litre of water, there are 3.5 milligrams of elemental nitrogen contained within nitrate molecules. Given the molar masses of elemental nitrogen and nitrate, this 3.5 milligrams of elemental N means that there are 15.5 milligrams of nitrate molecules (15.5 = 3.5 x 62/14) in the same litre of water. In this example, the concentration with which the WQ Module expects to be provided is 3.5 mg/L, not 15.5 mg/L.</p>
<p>The use of other model data to force WQ Module boundary conditions is also interpreted in this way. For example, a catchment model might report that an inflow to the WQ Module at an upstream riverine boundary condition has a total nitrogen concentration of 10.0 mg/L, and a user may have then speciated this to nitrate by applying a multiplicative factor of 0.15. If this resulting nitrate concentration of 1.5 mg/L is applied to the WQ Module as a boundary condition, it must be a concentration of elemental nitrogen within nitrate, which is consistent with what would be reported by a laboratory. This means that the user must be sure that the total nitrogen reported by the catchment model is in fact an elemental nitrogen concentration.</p>
<p>If users elect to construct WQ Module simulations in units of millimoles, then no internal WQ Module conversions take place, and the nature of the quantity (molecular or elemental) being specified is not relevant. For example, the user could specify millimoles units and a FRP flux of 0.1. This could be interpreted as a mmol/m<span class="math inline">\(^2\)</span>/day rate of either the <span class="math inline">\(PO_4^{3-}\)</span> molecule, or just phosphorus <span class="math inline">\(P\)</span>. This is because in one millimole of <span class="math inline">\(PO_4^{3-}\)</span>, there is also one millimole of elemental <span class="math inline">\(P\)</span>. The same one to one relationship holds for all other WQ Module relevant computed quantities (see Table <a href="AppConstits.html#tab:tab-variables2">P.1</a>), other than oxygen which is treated as a diatomic molecule.</p>
</div>
<div id="TFVGeneral-2" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> General arrangement<a href="SimulationConstruction-1.html#TFVGeneral-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A water quality simulation is set up and executed under the umbrella of a TUFLOW FV control file (Figure <a href="SimulationConstruction-1.html#fig:fig-InteractionWithFV">4.1</a>, with other optional modules shown for illustrative purposes). That is:</p>
<ul>
<li>The TUFLOW FV control file (*.fvc) file remains the central file that initiates and coordinates an overall simulation. This mirrors the way in which other TUFLOW FV modules, such as the ST Module and PT Module, are activated and executed</li>
<li>The TUFLOW FV control file contains a path to a separate WQ Module control file (*.fvwq) that in turn contains all the commands required to configure a WQ Module simulation</li>
</ul>
<span class="math inline">\(\newcommand{\blockindent}{\hspace{0.5cm}}\)</span>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-InteractionWithFV"></span>
<img src="images/InteractionWithFV.jpg" alt="**Simulation Coordination**" width="100%" />
<p class="caption">
Figure 4.1: <strong>Simulation Coordination</strong>
</p>
</div>
<p>TUFLOW FV and WQ Module control file commands are presented following.</p>
</div>
<div id="TFVCommands-2" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> TUFLOW FV control file commands<a href="SimulationConstruction-1.html#TFVCommands-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A TUFLOW FV simulation is executed as described in the TUFLOW FV user manual. If the WQ Module is to be activated in a simulation then the following commands are to be included.</p>
<div id="WQMActivation-3" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> WQ Module activation<a href="SimulationConstruction-1.html#WQMActivation-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Activation of the WQ Module is affected by specification of the following mandatory command in the TUFLOW control file:</p>
<blockquote>
<p><a href="AppCommands.html#FVActivateWQM">water quality model ==</a> <a href="AppCommands.html#FVActivateWQM">TUFLOW</a></p>
</blockquote>
<p>Following this activation, TUFLOW FV will look for the specification of the name of the separate WQ Module control file via the following mandatory command:</p>
<blockquote>
<p><a href="AppCommands.html#FVWQMCtrlFl">water quality control file ==</a> <a href="AppCommands.html#FVWQMCtrlFl">&lt;<em>water quality control file name</em>&gt;.fvwq</a></p>
</blockquote>
<p>This *.fvwq is separate to the *.fvc and contains user specified information that describes the configuration of the water quality simulation. If the *.fvwq is located in the same directory as the *.fvc, then this filename specification needs no associated path. It is recommended however that the *.fvwq be located in a directory separate to the *.fvc so that log and other related water quality specific files can be easily curated. If this approach is adopted, the following additional *.fvc command is required, noting that the folder path is specified as relative to the folder in which the *.fvc resides:</p>
<blockquote>
<p><a href="AppCommands.html#FVWQMCtrlDr">water quality model directory ==</a> <a href="AppCommands.html#FVWQMCtrlDr">&lt;<em>relative path to WQ directory</em>&gt;<span class="math inline">\(\backslash\)</span></a></p>
</blockquote>
<p>This command must terminate in a <span class="math inline">\(\backslash\)</span> character. If this command is issued, then the *.fvwq water quality control file must be located in the directory specified.</p>
<p>In certain circumstances, executing water quality calculations in shallow cells can cause numerical instabilities. To control this behaviour, the WQ Module allows for water quality calculations to be switched off in cells that have depths less than a specified minimum (advection dispersion calculations will however continue to be performed - it is only the water quality-related non-conservative transformations that are turned off). This minimum depth (in meters) is specified in the TUFLOW FV *.fvc via the command:</p>
<blockquote>
<p><a href="AppCommands.html#FVWQMmindpth">cell water quality depth ==</a> <a href="AppParams.html#WQParMinWQDepth"><span class="math inline">\(d_{min-wq}\)</span></a></p>
</blockquote>
<p>If this command is not issued then the default minimum depth of 0.01m (1cm) is applied.</p>
<p>This command parallels the TUFLOW FV command that controls the execution of hydrodynamic calculations as a function of water depth:</p>
<blockquote>
<p>cell wet/dry depths == cell dry depth (m), cell wet depth (m)</p>
</blockquote>
<p>In this TUFLOW FV command:</p>
<ul>
<li>The cell dry depth value (default = 1.0e-06 m) corresponds to the water depth below which a cell is dropped completely from hydrodynamic (TUFLOW FV) computations (subject to the status of surrounding cells) and is therefore considered to be dry. Cells that have dried in a given time step are given a stat value of 0 in all TUFLOW FV results files, so this stat field acts as a mask to determine which cells are wet and dry when using post processing tools and or scripts. Dry cells are not contoured in QGIS or SMS when viewed, but appear as transparent. If set to a negative value the cell dry depth is set to zero.</li>
<li>The cell wet depth value (default = 1.0e-02 m) corresponds to the water depth below which a cells momentum is set to zero in order to avoid unphysical velocities at very low depths. The cell is not considered to be dry and therefore has a stat value of -1. If this value is less than or equal to the cell dry depth, it is set to the cell dry depth.</li>
</ul>
<p>Given this, it is therefore recommended that across these commands and/or defaults, a user ensures that the following holds (as it does for the default values noted above):</p>
<p><span class="math display" id="eq:equ-wet-dry-depth">\[\begin{equation}
  \text{cell dry depth} \lt \text{cell wet depth} \lt \text{cell water quality depth}
    \tag{4.3}
\end{equation}\]</span></p>
<p>If, for example, cell water quality depth is set to a value less than cell dry depth, then water quality calculations will be attempted on cells that TUFLOW FV considers to be dry, which is to be avoided. If a situation arose where it was absolutely necessary, then cell water quality depth could be set to a value less than cell wet depth (but still greater than cell dry depth), but this is not recommended. To summarise, and if the recommended relative magnitudes of depths presented in Equation <a href="SimulationConstruction-1.html#eq:equ-wet-dry-depth">(4.3)</a> is adopted, then the following applies:</p>
<ul>
<li>water depth <span class="math inline">\(\gt\)</span> cell water quality depth: water quality calculations and momentum calculations performed</li>
<li>cell water quality depth <span class="math inline">\(\gt\)</span> water depth <span class="math inline">\(\gt\)</span> cell wet depth : water quality calculations switched off, momentum calculations performed (advection and dispersion calculations also performed on water quality variables)</li>
<li>cell wet depth <span class="math inline">\(\gt\)</span> water depth <span class="math inline">\(\gt\)</span> cell dry depth: water quality calculations switched off, momentum calculations switched off (advection and dispersion calculations also performed)</li>
<li>cell dry depth <span class="math inline">\(\gt\)</span> water depth: no calculations performed - cell is considered dry</li>
</ul>
<p>To support debugging, water quality calculations can also be turned off completely for all cells and all timesteps by issuing this command in the TUFLOW FV *.fvc:</p>
<blockquote>
<p><a href="AppCommands.html#FVWQMdisableWQ">disable water quality model ==</a> <a href="AppParams.html#WQParDisableWQ"><span class="math inline">\(B_{disable-wq}\)</span></a></p>
</blockquote>
<p>and setting <span class="math inline">\(B_{disable-wq}\)</span> = 1. Omitting this command, or setting <span class="math inline">\(B_{disable-wq}\)</span> to zero (0) instead of one (1), will activate water quality calculations. If this command is set to one (1), then the WQ Module will still initialise are report as such, but when TUFLOW executes, the module will not be called.</p>
<p>Consistent with their specification in the *.fvc, the status of these latter two commands and their arguments are reported in the TUFLOW FV log file, rather than the WQ Module log file.</p>
<p>An example block of these five commands that together activate the WQ Module, point TUFLOW FV to the water quality control file ..<span class="math inline">\(\backslash\)</span>WQ<span class="math inline">\(\backslash\)</span>Model_000.fvwq and set the minimum depth for executing water quality calculations to 5 centimetres is:</p>
<pre><code>water quality model == TUFLOW
water quality model directory == ..\WQ\
water quality control file == .\Model_000.fvwq
cell water quality depth == 0.05
disable water quality model == 0</code></pre>
</div>
<div id="InitBCCond-3" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Initial and boundary conditions<a href="SimulationConstruction-1.html#InitBCCond-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In addition to activating the WQ Module and specifying its control file, WQ Module initial and boundary condition information is also set through the TUFLOW FV control file. The processes for doing so are described below. These are followed by discussion of the related matter of constituent ordering within initial and boundary condition specifications.</p>
<div id="ICGeneral-4" class="section level4 hasAnchor" number="4.4.2.1">
<h4><span class="header-section-number">4.4.2.1</span> Initial conditions<a href="SimulationConstruction-1.html#ICGeneral-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Water quality initial conditions are specified within or via the TUFLOW FV control file, akin to the manner in which the sediment initial conditions are set on behalf of the sediment transport module. This specification is mandatory.</p>
<p>There are currently a number of ways that water quality initial conditions may be specified. All are affected through TUFLOW FV commands which are described in the TUFLOW FV user manual. If no water quality initial conditions are specified, then a simulation will not execute. The specifications relevant to water quality simulations are described below. The potential limitations of some of these approaches are recognised and will be addressed in future release of the WQ Module.</p>
<div id="ICRst-5" class="section level5 hasAnchor" number="4.4.2.1.1">
<h5><span class="header-section-number">4.4.2.1.1</span> Restart files<a href="SimulationConstruction-1.html#ICRst-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Restart files are binary files that are generated from previous simulations. These can be used as inputs to initialise water quality simulations, provided that the restart and simulation model geometries, and water quality simulation computed variables and units are identical. A restart file is specified for all simulated quantities (not just water quality) and is controlled through commands described in the TUFLOW FV user manual. The key command is</p>
<blockquote>
<p><a href="AppCommands.html#FVRestart">restart ==</a> <a href="AppCommands.html#FVRestart">&lt;<em>restart file name</em>&gt;.rst</a></p>
</blockquote>
<p>Most often, restart files are located in the <code>log</code> directory, but this is not mandatory.</p>
</div>
<div id="ICGlob-5" class="section level5 hasAnchor" number="4.4.2.1.2">
<h5><span class="header-section-number">4.4.2.1.2</span> Globally uniform<a href="SimulationConstruction-1.html#ICGlob-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Globally uniform (i.e.across all spatial dimensions) initial conditions are set via a command issued from within the TUFLOW FV control file. This is often useful in setting initial conditions for simple small water bodies or at the commencement of a modelling process where initial conditions are set to be placeholders and updated at a later time. The command to do so is:</p>
<blockquote>
<p><a href="AppCommands.html#FVInitWQGlob">initial wq concentration ==</a> <a href="AppCommands.html#FVInitWQGlob">ordered initial conditions</a></p>
</blockquote>
<p>Each water quality computed variable is set to a single value everywhere. These initial concentrations must be specified in a particular order and this order is described in the following sections for different simulation classes. If the above command is used to set water quality initial conditions, then it must be accompanied by parallel commands that set globally uniform salinity, temperature (and optionally sediment) initial conditions:</p>
<pre><code>initial temperature == 15.0
initial Water Level == 1.00
initial sediment concentration == 10.0 
initial salinity == 3.5</code></pre>
<p>Setting a mix of globally uniform and other initial conditions (such as profile, 2d or 3d) is not permitted.</p>
</div>
<div id="ICGlobLat-5" class="section level5 hasAnchor" number="4.4.2.1.3">
<h5><span class="header-section-number">4.4.2.1.3</span> Globally laterally uniform<a href="SimulationConstruction-1.html#ICGlobLat-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Globally laterally uniform initial conditions use an initial profile to set hydrodynamic and water quality computed variable concentrations to be everywhere the same laterally, but to vary vertically. This is often useful in setting initial conditions for deep stationary water bodies such as lakes or reservoirs. The command to do so is:</p>
<blockquote>
<p><a href="AppCommands.html#FVInitWQProf">initial scalar profile ==</a> <a href="AppCommands.html#FVInitWQProf">&lt;<em>initial condition file name</em>&gt;.csv</a></p>
</blockquote>
<p>An example of the form of the text file argument <em>initial condition file name</em>.csv for simulating five water quality constituents is:</p>
<pre><code>Depth,Sal,temp,sed_1,WQ_1,WQ_2,WQ_3,WQ_4,WQ_5
0.0,2.0,22.0,5.0,8.0,22.0,2.6,1.4,0.5
10.0,2.5,15.0,15.0,5.0,32.0,2.6,1.4,0.2
20.0,3.0,10.0,25.0,0.0,42.0,5.6,5.4,0.1</code></pre>
<p>If the above command is used, then it must include profile information that also sets laterally uniform salinity, temperature (and optionally sediment) initial conditions. Setting a mix of laterally uniform and other initial conditions (such as globally uniform, 2d or 3d) is not permitted.</p>
<p>The order of these columns in the argument csv file is not important, but the columns headers are keywords and must be used as shown. For example, the following structure for <em>initial condition file name</em>.csv is permitted:</p>
<pre><code>Depth,temp,WQ_3,Sal,sed_1,WQ_4,WQ_1,WQ_2,WQ_5
0,22,2.6,2,5,1.4,8,22,0.5
10,15,2.6,2.5,15,1.4,5,32,0.2
20,10,3,3,25,5.4,0,42,0.1</code></pre>
<p>Notwithstanding this, it is still considered best practise to develop initial and boundary condition files that have a logically sequential order. Water quality initial conditions headers are labelled WQ_1, WQ_2 onward, and the match between these header labels and water quality computed variables is set by the computed variable ordering of the simulation class deployed.</p>
</div>
<div id="ICGlobVert-5" class="section level5 hasAnchor" number="4.4.2.1.4">
<h5><span class="header-section-number">4.4.2.1.4</span> Globally vertically uniform<a href="SimulationConstruction-1.html#ICGlobVert-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Globally vertically uniform initial conditions use an initial two dimensional map to set hydrodynamic and water quality computed variable concentrations to be everywhere the same vertically, but to vary laterally. This is often useful in setting initial conditions for shallow water bodies that have horizontal concentration gradients such as small estuaries or urban lakes. The command to do so is:</p>
<blockquote>
<p><a href="AppCommands.html#FVInitWQ2D">initial condition 2d ==</a> <a href="AppCommands.html#FVInitWQ2D">&lt;<em>initial condition file name</em>&gt;.csv</a></p>
</blockquote>
<p>An example of the form of the text file argument <em>initial condition file name</em>.csv for simulating five water quality constituents is:</p>
<pre><code>ID,WL,sal,temp,sed_1,WQ_1
1,1.0,3.5,15,10.0,8.0
2,1.0,3.5,15,10.0,7.5
3,1.0,3.5,15,10.0,7.0
4,1.0,3.5,15,10.0,6.5</code></pre>
<p>If the above command is used, then it must include information that also sets vertically uniform salinity and temperature (and optionally sediment) initial conditions, as well as water level. Setting a mix of vertically uniform and other initial conditions (such as globally uniform, laterally uniform or 3d) is not permitted.</p>
<p>The order of these columns in the argument csv file is not important, but the columns headers are keywords and must be used as shown. For example, the following structure for <em>initial condition file name</em>.csv is permitted:</p>
<pre><code>ID,WQ_1,WL,sed_1,sal,temp
1,8.0,1.0,10.0,3.5,15
2,7.5,1.0,10.0,3.5,15
3,7.0,1.0,10.0,3.5,15
4,6.5,1.0,10.0,3.5,15</code></pre>
<p>Notwithstanding this, it is still considered best practise to develop initial and boundary condition files that have a logically sequential order. Water quality initial conditions headers are labelled WQ_1, WQ_2 onward, and the match between these header labels and water quality computed variables is set by the computed variable ordering of the simulation class deployed.</p>
</div>
<div id="ICGlob3d-5" class="section level5 hasAnchor" number="4.4.2.1.5">
<h5><span class="header-section-number">4.4.2.1.5</span> Globally varying<a href="SimulationConstruction-1.html#ICGlob3d-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Globally variable initial conditions use an initial three dimensional map to set hydrodynamic and water quality computed variable concentrations at each 3D cell. This is analogous to using a restart file. The command to do so is:</p>
<blockquote>
<p><a href="AppCommands.html#FVInitWQ3D">initial condition 3d ==</a> <a href="AppCommands.html#FVInitWQ3D">&lt;<em>initial condition file name</em>&gt;.csv</a></p>
</blockquote>
<p>An example of the form of the text file argument <em>initial condition file name</em>.csv for simulating five water quality constituents is as follows, noting that the ID column refers to a three dimensional cell ID, rather than the two dimensional column ID used in the <code>initial condition 2d ==</code> command.</p>
<pre><code>ID,WL,sal,temp,sed_1,WQ_1
1,1.0,3.5,15,10.0,8.0
2,1.0,3.5,14,10.0,7.5
3,1.0,3.5,13,10.0,7.0
4,1.0,3.5,12,8.0,6.5
5,1.0,3.5,15,10.0,8.0
6,1.0,3.5,14,10.0,7.4
7,1.0,3.5,13,10.0,7.1
8,1.0,3.5,11,9.0,6.6</code></pre>
<p>If the above command is used, then it must include information that also sets globally varying salinity and temperature (and optionally sediment) initial conditions, as well as water level. Setting a mix of vertically uniform and other initial conditions (such as globally uniform, laterally uniform or 2d) is not permitted.</p>
<p>The order of these columns in the argument csv file is not important, but the columns headers are keywords and must be used as shown. For example, the following structure for <em>initial condition file name</em>.csv is permitted:</p>
<pre><code>ID,WQ_1,WL,sed_1,sal,temp
1,8.0,1.0,10.0,3.5,15
2,7.5,1.0,10.0,3.5,14
3,7.0,1.0,10.0,3.5,13
4,6.5,1.0,8.0,3.5,12
5,8.0,1.0,10.0,3.5,15
6,7.4,1.0,10.0,3.5,14
7,7.1,1.0,10.0,3.5,13
8,6.6,1.0,9.0,3.5,12</code></pre>
<p>Notwithstanding this, it is still considered best practise to develop initial and boundary condition files that have a logically sequential order. Water quality initial conditions headers are labelled WQ_1, WQ_2 onward, and the match between these header labels and water quality computed variables is set by the computed variable ordering of the simulation class deployed.</p>
</div>
</div>
<div id="BCGeneral-4" class="section level4 hasAnchor" number="4.4.2.2">
<h4><span class="header-section-number">4.4.2.2</span> Boundary conditions<a href="SimulationConstruction-1.html#BCGeneral-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Water quality boundary conditions are also specified via the *.fvc file, either directly or via an include statement that points TUFLOW FV to a subsidiary boundary condition control file(s). This specification of water quality variable concentrations is optional, so in early water quality model construction stages this specification can be omitted. Omitted water quality boundary conditions will be set to zero. It is not recommended that this approach be taken beyond initial simulation setup stages, but that it be used only to develop a water quality simulation to the point where it executes without issuing error or unwanted warning messages. At this point, all water quality boundary conditions should be assigned.</p>
<p>All TUFLOW boundary conditions that specify water temperature or salinity will also require specification of the behaviour of simulated water quality variables. Common boundary conditions to which this applies include inflows (e.g.types Q, QC, QN, QG and others) and tidal boundaries (e.g.types WLS). Wave and meteorological boundary conditions do not need specification of water quality conditions.</p>
<p>As for initial conditions, boundary conditions that use columnar data structures (e.g.*.csv files) are interpreted using column headers specified in an <a href="SimulationConstruction-1.html#Ordering-4">expected order</a> within calling TUFLOW FV BC blocks. Further detail and the associated ordering is provided in the following sections (sections <a href="SimulationConstruction-1.html#SimSetSimClDO-2">4.6</a>, <a href="SimulationConstruction-1.html#SimSetSimClInorg-2">4.7</a> and <a href="SimulationConstruction-1.html#SimSetSimClOrg-2">4.8</a> for simulation classes DO, inorganics and organics, respectively).</p>
</div>
<div id="Ordering-4" class="section level4 hasAnchor" number="4.4.2.3">
<h4><span class="header-section-number">4.4.2.3</span> Ordering<a href="SimulationConstruction-1.html#Ordering-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Specification of initial conditions and most boundary conditions presently relies on listing water quality variables in a particular order. This applies in all instances when water quality initial or boundary conditions are provided in columnar or list form, which is most frequently in text file format. This is conceptually similar to the manner in which TUFLOW FV also relies on ordering of its initial and boundary conditions.</p>
<p>Future releases of TUFLOW FV will allow alternative methods for specification of initial and boundary conditions that do not rely on assumed ordering. In the interim however, the following applies.</p>
<div id="OrderIC-5" class="section level5 hasAnchor" number="4.4.2.3.1">
<h5><span class="header-section-number">4.4.2.3.1</span> Initial Conditions<a href="SimulationConstruction-1.html#OrderIC-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Initial conditions, if set using means other than a restart file, must be specified with water quality constituents in a preset order (globally uniform), or be referenced using incrementally numbered headers as WQ_1, WQ_2 etc (profile, 2d or 3d, see Section <a href="SimulationConstruction-1.html#ICGeneral-4">4.4.2.1</a>).</p>
<p>For globally uniform initial conditions (Section <a href="SimulationConstruction-1.html#ICGlob-5">4.4.2.1.2</a>), the following *.fvc command can be used for a typical inorganics simulation class:</p>
<blockquote>
<p><a href="AppCommands.html#FVInitWQGlob">initial wq concentration ==</a> 7.5, 0.0, 4.2, 10.5, 0.6, 5.5</p>
</blockquote>
<p>There are no references to headers or variable names, but TUFLOW FV assumes that these numbers correspond to the ordered variables of the particular configuration of the inorganics simulation class returned to it from the WQ Module. In this example, this ordering is:</p>
<ul>
<li>Dissolved oxygen (7.5 mg/L)</li>
<li>Silicate (0.0 mg/L)</li>
<li>Ammonium (4.2 mg/L)</li>
<li>Nitrate (10.5 mg/L)</li>
<li>Filterable reactive phosphorus (0.6 mg/L), and</li>
<li>One phytoplankton group (5.5 <span class="math inline">\(\mu\)</span>g/L)</li>
</ul>
<p>The expected ordering is the same as that for boundary condition specifications, as described below.</p>
<p>For other initial condition specifications that involve providing csv files, the headers WQ_1, WQ_2 etc must be used to denote water quality initial conditions. The ordering of the associated columns does not matter, however the assignment of a computed variable initial condition to a WQ_XX header (where XX is a number) does rely on the ordering described below - the first water quality computed variable expected should be headed WQ_1 and so on.</p>
</div>
<div id="OrderBC-5" class="section level5 hasAnchor" number="4.4.2.3.2">
<h5><span class="header-section-number">4.4.2.3.2</span> Boundary Conditions<a href="SimulationConstruction-1.html#OrderBC-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Ordering of water quality boundary conditions is only important when specifying header information via the <code>bc header ==</code> (or equivalent) command within a TUFLOW FV *.fvc file BC block. It is in these commands (where comma separated header strings are specified) that TUFLOW FV expects a particular order of TUFLOW FV and WQ Module constituents. No column ordering is expected in boundary condition data files themselves. Ordering is only expected in the order of headers specified within a BC block within an TUFLOW FV control file. This is best illustrated by example.</p>
<p>If a user has elected to deploy the inorganics simulation class without sediment, then the following will be simulated (beyond the basic velocity and water level hydrodynamic variable suite):</p>
<ul>
<li>Salinity</li>
<li>Temperature</li>
<li>Dissolved oxygen</li>
<li>Silicate</li>
<li>Ammonium</li>
<li>Nitrate</li>
<li>Filterable reactive phosphorus</li>
<li>One (assumed for this example, but can be multiple) phytoplankton group</li>
</ul>
<p>These will eventually need proper boundary condition specification in boundary condition blocks and have supporting data provided in (usually) text files. In a simple model with only one WL boundary condition, a <code>bc block</code> of the following form would be required as a minimum to properly specify the hydrodynamic and water quality boundaries:</p>
<blockquote>
<p>bc == WL, 1, datafile.csv <br>
<span class="math inline">\(\blockindent\)</span> bc header == time, wsel, sali, temp, DOxy, SiO4, NH41, nitr, frph, bluegreen <br>
end bc <br></p>
</blockquote>
<p>To be clear:</p>
<ul>
<li><p>The names listed on the <code>bc header ==</code> line (time, wse etc.) are not keywords or special names, and can be any names that a user chooses</p></li>
<li><p>TUFLOW FV will however, assume that these names (whatever they have been set to) have been listed in such an order that they have a one to one correspondence to the ten computed variables as follows:</p>
<ol style="list-style-type: decimal">
<li>time <span class="math inline">\(\rightarrow\)</span> Time stamp</li>
<li>wsel <span class="math inline">\(\rightarrow\)</span> Water surface elevation</li>
<li>sali <span class="math inline">\(\rightarrow\)</span> Salinity</li>
<li>temp <span class="math inline">\(\rightarrow\)</span> Temperature</li>
<li>DOxy <span class="math inline">\(\rightarrow\)</span> Dissolved oxygen</li>
<li>SiO4 <span class="math inline">\(\rightarrow\)</span> Silicate</li>
<li>NH41 <span class="math inline">\(\rightarrow\)</span> Ammonium</li>
<li>nitr <span class="math inline">\(\rightarrow\)</span> Nitrate</li>
<li>frph <span class="math inline">\(\rightarrow\)</span> Filterable reactive phosphorus</li>
<li>bluegreen <span class="math inline">\(\rightarrow\)</span> Phytoplankton group one</li>
</ol></li>
<li><p>TUFLOW then matches the user specified names to the expected simulation variables, based on this ordering, to then interrogate boundary condition files.</p></li>
</ul>
<p>Following the above matching, TUFLOW FV interrogates the relevant boundary condition file (datafile.csv in the example above), where this file can have its columns arranged in any order: the order of these columns does not matter because TUFLOW FV will use the mapping previously developed via the <code>bc header ==</code> command to look through all data file columns one by one, searching for the headers specified, regardless of the actual ordering of boundary condition file columns. For example, the silicate boundary condition data could be positioned in column 14 of the boundary condition file, but as long as it is labelled with the correct header (SiO4 as specified in <code>bc header ==</code>), TUFLOW FV will know to assign column 14 of the boundary condition data file to the silicate computed variable.</p>
<p>Ordering is set by the users selection of simulation class and constituent models, and is explicitly listed in each simulation class section (Sections <a href="SimulationConstruction-1.html#ConOrdDO-3">4.6.5</a>, <a href="SimulationConstruction-1.html#ConOrdInorg-3">4.7.5</a> and <a href="SimulationConstruction-1.html#ConOrdOrg-3">4.8.5</a> for DO, inorganics and organics, respectively). The expected ordering for a particular simulation is also reported in the simulation water quality log file for checking.</p>
</div>
</div>
</div>
</div>
<div id="WQctrlfil-2" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Water quality control file commands<a href="SimulationConstruction-1.html#WQctrlfil-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The water quality control file comprises three parts, with each part containing different types of commands and flags. Whilst it is recommended that these parts be kept separate and in the order described below (especially given how complex water quality simulations can become), doing so is not mandatory and commands or command blocks may be entered in any order.</p>
<p>These parts are as follows, with the first two mirroring the architecture described in Section <a href="Architecture-1.html#Architecture-1">2</a>:</p>
<ol style="list-style-type: decimal">
<li>Simulation controls (i.e.simulation class)</li>
<li>Constituent model settings (i.e.constituent model class)</li>
<li>Material specifications</li>
</ol>
<p>Notwithstanding this, a WQ Module control file need not contain any commands, and can be completely blank. This is by design, and intended to allow users to rapidly set up and execute a TUFLOW water quality simulation. If the water quality control file is left blank, then the WQ Module will:</p>
<ul>
<li>Construct a simulation using the dissolved oxygen simulation class (which is the simplest class)</li>
<li>Set the simulation units to mg/L</li>
<li>Set library defaults for all parameters</li>
<li>Set the water quality model timestep to the default</li>
<li>Assign zero dissolved oxygen concentration to all boundary conditions. This is by design, and will assist in ensuring that the subsequent user-defined updating of boundary conditions is thorough and complete (zero dissolved oxygen boundary conditions are rare and therefore easily identifiable).</li>
</ul>
<p>Initial conditions will also need to be specified in the TUFLOW FV control file as per Section <a href="SimulationConstruction-1.html#InitBCCond-3">4.4.2</a>. Specification of boundary conditions can be deferred.</p>
<p>The water quality control file sections are described below. Details specific to each simulation class and constituent model are provided in subsequent sections</p>
<div id="SimCtrls-3" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Part 1: Simulation controls<a href="SimulationConstruction-1.html#SimCtrls-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Simulation controls set the high level operation of the WQ Module and are not specific to a simulation class. All are optional. Available commands set the:</p>
<ul>
<li>Simulation class via <a href="AppCommands.html#WQSimulationClass">simulation class ==</a></li>
<li>Timestep <a href="AppParams.html#WQdt">dt</a> (in seconds) at which TUFLOW calls the WQ Module via <a href="AppCommands.html#WQWqDt">wq dt ==</a></li>
<li>Units of simulation via <a href="AppCommands.html#WQWqUnits">wq units ==</a></li>
<li>Frequency of equilibrium substepping <a href="AppParams.html#WQFss">fess</a> (in number of timesteps) to execute non-kinetic equilibrium calculations via <a href="AppCommands.html#WQWqEQSS">wq equilibrium substeps ==</a></li>
<li>Reporting or suppression of minimum / maximum concentration exceedances (see Section <a href="SimulationConstruction-1.html#ConModSttngs-3">4.5.2</a>) via <a href="AppCommands.html#WQSuppressMinMax">report min max warnings ==</a></li>
</ul>
<p>A typical simulation control section might therefore look like the following:</p>
<pre><code>simulation class == DO
wq dt == 600.0
wq units == mgl
wq equilibrium substeps == 1
report min max warnings == on</code></pre>
</div>
<div id="ConModSttngs-3" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Part 2: Constituent model settings<a href="SimulationConstruction-1.html#ConModSttngs-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Constituent model settings are those that:</p>
<ul>
<li>Specify the constituent model to be used within each preset constituent model class. These are referred to as constituent model blocks</li>
<li>Set the parameters for each of these constituent models, as commands within these blocks</li>
</ul>
<p>All are optional, however if a constituent model block is initiated then it requires an <code>end XXXX model</code> command to terminate the block, where XXXX is the name of the constituent model class, such as inorganic nitrogen. An example of a user selecting to use the adsorbed filterable reactive phosphorous constituent model (that is a model available within the inorganic phosphorus constituent model class), and setting some parameters within that model is as follows:</p>
<pre><code>inorganic phosphorus model == frpads
  atmospheric deposition == 12.6, 0.5
end inorganic phosphorus model</code></pre>
<p>Parameters not specified by the user are set to library defaults.</p>
<p>All constituent models allow for constraining (and then reporting) the predictions of their respective computed variable concentrations via the setting of minimum and maximum limits, if desired. This is often useful in identifying unusual model behaviours or instabilities. Where exceedences of these limits are identified by the WQ Module:</p>
<ul>
<li>Time and model cell information is written to the WQ Module log file in real time. This allows for easy identification of potential model issues via periodic examination of the WQ Module log file, rather than waiting for simulation completion</li>
<li>The WQ Module resets the computed concentration to the relevant specified minimum or maximum concentration</li>
</ul>
<p>The above resetting will result in mass conservation errors. It should not be relied on to artificially control the behaviour of an otherwise unstable or runaway water quality simulation. Rather, this functionality should be used as a convenient way to check model performance and flag potential issues, with a view to then implementing corrective action. Equally, suppressing warnings written to the WQ log file using the <a href="AppCommands.html#WQSuppressMinMax">report min max warnings ==</a> command described in Section <a href="SimulationConstruction-1.html#SimCtrls-3">4.5.1</a> is not recommended because doing so may mask underlying model construction issues.</p>
<p>These limits are optionally specified in each constituent model block. An example that sets these limits for ammonium is:</p>
<blockquote>
<p>ammonium min max == 0.0, 25.0</p>
</blockquote>
<p>Although in the strictest sense, sediment (benthic) flux half saturation concentrations and temperature coefficients are benthic properties, the WQ Module does not yet support these parameters being applied on a spatially varying basis (i.e.per material). As such, these are considered to be constituent model global parameters and so are set in this part of the water quality control file, i.e.within respective constituent model blocks. An example that sets an oxygen half saturation and temperature coefficient for benthic flux is:</p>
<blockquote>
<p>oxygen benthic == 5.0, 1.08</p>
</blockquote>
</div>
<div id="MatSpecs-3" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Part 3: Material specifications<a href="SimulationConstruction-1.html#MatSpecs-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The final part of the water quality control file (*.fvwq) provides for specification of benthic (sediment) fluxes, via material blocks. The commands required to commence and terminate a materials block are as follows:</p>
<blockquote>
<p><a href="AppCommands.html#WQInitMatBlck">material ==</a> <a href="AppCommands.html#WQInitMatBlck">&lt;<em>up to 10 comma separated material numbers, or default</em>&gt;</a></p>
</blockquote>
<p>and</p>
<blockquote>
<p><a href="AppCommands.html#WQEndMatBlck">end material</a></p>
</blockquote>
<p>This material block nomenclature mirrors that used in the TUFLOW FV and sediment transport control files. An example of specifying oxygen and nitrate benthic fluxes for materials 2, 7 and 12 is:</p>
<pre><code>material == 2, 7, 12
  oxygen flux == -60.0
  nitrate flux == 12.5
end material</code></pre>
<p>The WQ Module allows for specification of a default set of benthic fluxes that are applied across all materials, by using the key word <code>default</code> instead of specifying material numbers in a material block. These defaults can then be progressively overwritten on a material by material basis by specifying subsequent material blocks.</p>
<p>For example, a model that has ten materials in total, eight of which have the same oxygen benthic flux (all materials except 4 and 7), can have its overall oxygen benthic flux specified as:</p>
<pre><code>material == default
  oxygen flux == -60.0
end material

material == 4, 7
  oxygen flux == -20.0
end material</code></pre>
</div>
<div id="SimSetSum-2" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Summary<a href="SimulationConstruction-1.html#SimSetSum-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In order to set up and execute a water quality simulation using the WQ Module, the following steps are required:</p>
<ul>
<li>Modify the TUFLOW FV control file:
<ul>
<li>Add at least the following commands to TUFLOW FV control file (*.fvc):
<ul>
<li><a href="AppCommands.html#FVActivateWQM">water quality model ==</a> TUFLOW</li>
<li><a href="AppCommands.html#FVWQMCtrlFl">water quality control file ==</a> &lt;<em>water quality control file name</em>&gt;.fvwq</li>
</ul></li>
<li>Optionally add a folder path command to the TUFLOW FV control file (*.fvc) with a trailing backslash:
<ul>
<li><a href="AppCommands.html#FVWQMCtrlDr">water quality model dir ==</a> &lt;<em>relative path to *.fvwq file</em>&gt;<span class="math inline">\(\backslash\)</span></li>
</ul></li>
<li>Add appropriate initial conditions for all water quality constituents, observing <a href="SimulationConstruction-1.html#OrderIC-5">ordering rules</a> where required</li>
<li>Initially optionally add boundary conditions for all water quality constituents, observing <a href="SimulationConstruction-1.html#OrderBC-5">ordering rules</a> in <code>bc header ==</code> commands</li>
</ul></li>
<li>Create the water quality control file with the corresponding name and path</li>
<li>Modify the water quality control file
<ul>
<li>Optionally add to the water quality control file:
<ul>
<li>Part 1: A simulation controls section</li>
<li>Part 2: A constituent model setting section with one or more constituent model blocks with one or more parameter commands</li>
<li>Part 3: A material block specifications section</li>
</ul></li>
</ul></li>
</ul>
<p>Once initially constructed, boundary conditions can be added (if not already in place), and progressive refinement and parameterisation of constituent models and benthic fluxes can be affected. Details of these commands and their options within each specific simulation class are provided in subsequent sections. Subsections are separated into the above water quality control file parts for ease and consistency of reference. All commands are optional.</p>
</div>
<div id="SimSetLog-2" class="section level3 hasAnchor" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> Log files<a href="SimulationConstruction-1.html#SimSetLog-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Every WQ Module water quality simulation generates a log file that contains an echo of the WQ Module construction and execution commentary. It is written to the same location (and with the same name) as the WQ Module control file, with the file extension fvwqlog. This file contains a great deal of information that should be carefully reviewed. Suppressing warnings written to this log file, although possible, is not recommended or encouraged.</p>

</div>
</div>
<div id="SimSetSimClDO-2" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Simulation Class: DO<a href="SimulationConstruction-1.html#SimSetSimClDO-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If no simulation class is specified then a simulation will be automatically constructed using this DO class, and populated with library defaults for all parameters. Computed variables will be:</p>
<ul>
<li>Dissolved oxygen</li>
<li>Pathogens (optional, potentially multiple)</li>
</ul>
<div id="PrereqDO-3" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Prerequisites<a href="SimulationConstruction-1.html#PrereqDO-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The DO simulation class requires simulation of the following in TUFLOW FV:</p>
<ul>
<li>Hydrodynamics, in either two or three dimensions (including any internal one dimensional structures if present)</li>
<li>Salinity</li>
<li>Temperature</li>
<li>Heat module on (i.e.meteorological forcing is required)</li>
</ul>
<p>Simulation of suspended sediment (via TUFLOW FVs sediment transport module) is optional, unless attached pathogens are simulated.</p>
</div>
<div id="SimCtrlsDO-3" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Part 1: Simulation specification<a href="SimulationConstruction-1.html#SimCtrlsDO-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The DO simulation class is set via</p>
<blockquote>
<p><a href="AppCommands.html#WQSimulationClass">simulation class ==</a> DO</p>
</blockquote>
<p>The other commands in this part are not specific to this simulation class. See section <a href="SimulationConstruction-1.html#SimCtrls-3">4.5.1</a>.</p>
</div>
<div id="ConModSttngsDO-3" class="section level3 hasAnchor" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Part 2: Constituent model specification<a href="SimulationConstruction-1.html#ConModSttngsDO-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As per Tables <a href="Architecture-1.html#tab:tab-ConClasses">2.2</a> and <a href="Architecture-1.html#tab:tab-ConClassMods">2.3</a>, oxygen is the only mandatory constituent model class available within the DO simulation class, and there is only one oxygen constituent model within that class, with code O2. Pathogens may be optionally simulated (in any simulation class).</p>
<div id="ConModClssOxy-4" class="section level4 hasAnchor" number="4.6.3.1">
<h4><span class="header-section-number">4.6.3.1</span> Model class: Oxygen<a href="SimulationConstruction-1.html#ConModClssOxy-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="ConModO2-5" class="section level5 hasAnchor" number="4.6.3.1.1">
<h5><span class="header-section-number">4.6.3.1.1</span> Constituent model: O2<a href="SimulationConstruction-1.html#ConModO2-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This constituent model is specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQOxyMod">oxygen model ==</a> O2</p>
</blockquote>
<p>Minimum and maximum concentrations are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQOxyMinMax"><span class="math inline">\(\blockindent\)</span> oxygen min max ==</a> <a href="AppParams.html#WQParMinO2"><span class="math inline">\(\left[DO\right]_{min}^{O_2}\)</span></a>, <a href="AppParams.html#WQParMaxO2"><span class="math inline">\(\left[DO\right]_{max}^{O_2}\)</span></a></p>
</blockquote>
<p>Global benthic parameters (used in Equation <a href="AppO.html#eq:equ-sed-do-flux">(D.6)</a>) are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQOxyBenFlxPars"><span class="math inline">\(\blockindent\)</span> oxygen benthic ==</a> <a href="AppParams.html#WQParKsedO2"><span class="math inline">\(K_{sed-O_2}^{O_2}\)</span></a>, <a href="AppParams.html#WQParthetasedO2"><span class="math inline">\(\theta_{sed}^{O_2}\)</span></a></p>
</blockquote>
<p>The oxygen piston model to be used (in either Equation <a href="AppO.html#eq:equ-atm-Pv1">(D.2)</a> or Equation <a href="AppO.html#eq:equ-atm-Pv4">(D.3)</a>) is specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQOxyPistMod1"><span class="math inline">\(\blockindent\)</span> oxygen piston model ==</a> Wanninkhof92</p>
</blockquote>
<p>or</p>
<blockquote>
<p><a href="AppCommands.html#WQOxyPistMod4"><span class="math inline">\(\blockindent\)</span> oxygen piston model ==</a> Ho16</p>
</blockquote>
<p>The argument (either Wanninkhof92 or Ho16) activates a different oxygen piston model (Equation <a href="AppO.html#eq:equ-atm-Pv1">(D.2)</a> or Equation <a href="AppO.html#eq:equ-atm-Pv4">(D.3)</a>, respectively).</p>
<p>Although not strictly necessary, the use of oxygen to prefix these block commands is deliberate so as to maintain consistency of command style with other constituent model blocks that include more than one computed variable, such as nitrogen, phosphorus and organics. Nonetheless, if the oxygen prefix is omitted within this constituent model block, the WQ Module will still interpret the above commands correctly.</p>
<p>This constituent model block must be terminated using the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQOxyModEnd">end oxygen model</a></p>
</blockquote>
</div>
</div>
<div id="ConModClssPth-4" class="section level4 hasAnchor" number="4.6.3.2">
<h4><span class="header-section-number">4.6.3.2</span> Model class: Pathogens (optional)<a href="SimulationConstruction-1.html#ConModClssPth-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This model class is optional.</p>
<div id="ConModFree-5" class="section level5 hasAnchor" number="4.6.3.2.1">
<h5><span class="header-section-number">4.6.3.2.1</span> Constituent model: Free<a href="SimulationConstruction-1.html#ConModFree-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This constituent model is specified as:</p>
<blockquote>
<p><a href="#WQPthMod">pathogen model ==</a> free, <em>pathname</em></p>
</blockquote>
<p><em>pathname</em> is any user specified pathogen group name that:</p>
<ul>
<li>Uses only alphanumeric characters</li>
<li>Has no spaces</li>
<li>Excludes the keyword PATH, and</li>
<li>Is not the same as any other group name</li>
</ul>
<p>Minimum and maximum concentrations are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQPthMinMax"><span class="math inline">\(\blockindent\)</span> alive min max ==</a> <a href="AppParams.html#WQParMinPth"><span class="math inline">\(\left[PTH_a\right]_{min}^{pth}\)</span></a>, <a href="AppParams.html#WQParMaxPth"><span class="math inline">\(\left[PTH_a\right]_{max}^{pth}\)</span></a></p>
</blockquote>
<p>Mortality parameters are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQPthMort"><span class="math inline">\(\blockindent\)</span> mortality ==</a> <a href="AppParams.html#WQParkdPath"><span class="math inline">\(k_{d}^{pth}\)</span></a>, <a href="AppParams.html#WQParCSMPath"><span class="math inline">\(C_{SM}^{pth}\)</span></a>, <a href="AppParams.html#WQParalphaPath"><span class="math inline">\(\alpha\)</span></a>, <a href="AppParams.html#WQParbetaPath"><span class="math inline">\(\beta\)</span></a>, <a href="AppParams.html#WQParthetamorPath"><span class="math inline">\(\theta_{mor}^{pth}\)</span></a></p>
</blockquote>
<p><span class="math inline">\(\beta\)</span> is not currently used but must be retained as a placeholder in this command for future use.</p>
<p>Light inactivation parameters are specified in three separate but related commands, with one command per light band (visible, UV-A and UV-B):</p>
<blockquote>
<p><a href="AppCommands.html#WQPthvisInvn"><span class="math inline">\(\blockindent\)</span> visible inactivation ==</a> <a href="AppParams.html#WQParkvisPath"><span class="math inline">\(k_{vis}\)</span></a>, <a href="AppParams.html#WQParcSvisPath"><span class="math inline">\(c_{S_{vis}}^{pth}\)</span></a>, <a href="AppParams.html#WQParKDOvisPath"><span class="math inline">\(K_{DO_{vis}}^{pth}\)</span></a></p>
</blockquote>
<blockquote>
<p><a href="AppCommands.html#WQPthuvaInvn"><span class="math inline">\(\blockindent\)</span> uva inactivation ==</a> <a href="AppParams.html#WQParkuvaPath"><span class="math inline">\(k_{uva}\)</span></a>, <a href="AppParams.html#WQParcSuvaPath"><span class="math inline">\(c_{S_{uva}}^{pth}\)</span></a>, <a href="AppParams.html#WQParKDOuvaPath"><span class="math inline">\(K_{DO_{uva}}^{pth}\)</span></a></p>
</blockquote>
<blockquote>
<p><a href="AppCommands.html#WQPthuvbInvn"><span class="math inline">\(\blockindent\)</span> uvb inactivation ==</a> <a href="AppParams.html#WQParkuvbPath"><span class="math inline">\(k_{uvb}\)</span></a>, <a href="AppParams.html#WQParcSuvbPath"><span class="math inline">\(c_{S_{uvb}}^{pth}\)</span></a>, <a href="AppParams.html#WQParKDOuvbPath"><span class="math inline">\(K_{DO_{uvb}}^{pth}\)</span></a></p>
</blockquote>
<p>Settling of non-attached pathogens is specified as follows, with a negative number being a downwards velocity:</p>
<blockquote>
<p><a href="AppCommands.html#WQPthSettleFree"><span class="math inline">\(\blockindent\)</span> settling ==</a> <a href="AppParams.html#WQParVPathAD"><span class="math inline">\(V_{settle}^{pth}\)</span></a></p>
</blockquote>
<p>This constituent model block must be terminated using the command:</p>
<blockquote>
<p><a href="#WQPathModEnd">end pathogen model</a></p>
</blockquote>
</div>
<div id="ConModAtt-5" class="section level5 hasAnchor" number="4.6.3.2.2">
<h5><span class="header-section-number">4.6.3.2.2</span> Constituent model: Attached<a href="SimulationConstruction-1.html#ConModAtt-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This constituent model must be accompanied by simulation of at least one sediment fraction within the TUFLOW FV sediment transport (ST) module, and is specified as:</p>
<blockquote>
<p><a href="#WQPthMod">pathogen model ==</a> attached, <em>pathname</em></p>
</blockquote>
<p><em>pathname</em> is any user specified pathogen group name that:</p>
<ul>
<li>Uses only alphanumeric characters</li>
<li>Has no spaces</li>
<li>Excludes the keyword PATH, and</li>
<li>Is not the same as any other group name</li>
</ul>
<p>The commands are the same as those specified within a free pathogen constituent model block (Section <a href="SimulationConstruction-1.html#ConModFree-5">4.6.3.2.1</a>), with the following modification or additions.</p>
<p>Settling is specified for both free and attached pathogens:</p>
<blockquote>
<p><a href="AppCommands.html#WQPthSettleAtt"><span class="math inline">\(\blockindent\)</span> settling ==</a> <a href="AppParams.html#WQParVPathAD"><span class="math inline">\(V_{settle}^{pth}\)</span></a>, <a href="AppParams.html#WQParVPathT"><span class="math inline">\(V_{settle}^{pth_t}\)</span></a></p>
</blockquote>
<p>The target attached pathogen fraction is specified as:</p>
<blockquote>
<p><a href="#WQPthTargAttFrac"><span class="math inline">\(\blockindent\)</span> target attached fraction ==</a> <a href="AppParams.html#WQParfattPth"><span class="math inline">\(f_{att}^{pth}\)</span></a></p>
</blockquote>
<p>This constituent model block must be terminated using the command:</p>
<blockquote>
<p><a href="#WQPathModEnd">end pathogen model</a></p>
</blockquote>
</div>
</div>
</div>
<div id="MatSpecsDO-3" class="section level3 hasAnchor" number="4.6.4">
<h3><span class="header-section-number">4.6.4</span> Part 3: Material specification<a href="SimulationConstruction-1.html#MatSpecsDO-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Oxygen benthic flux (used in Equation <a href="AppO.html#eq:equ-sed-do-flux">(D.6)</a>) is specified within both default and numbered material blocks as:</p>
<blockquote>
<p><a href="AppCommands.html#WQOxyBenFlx"><span class="math inline">\(\blockindent\)</span> oxygen flux ==</a> <a href="AppDiags.html#WQParFsedO2"><span class="math inline">\(F_{sed}^{O_2}\)</span></a></p>
</blockquote>
</div>
<div id="ConOrdDO-3" class="section level3 hasAnchor" number="4.6.5">
<h3><span class="header-section-number">4.6.5</span> Constituent ordering<a href="SimulationConstruction-1.html#ConOrdDO-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dissolved oxygen is the only mandatory constituent simulated by the WQ Module for this simulation class, and therefore oxygen concentration is specified as the first variable (shown in symbolic form below):</p>
<blockquote>
<p>initial wq concentration == <span class="math inline">\(\left[ DO \right]\)</span></p>
</blockquote>
<p>Similarly, in a <code>bc header ==</code> command within a bc block, oxygen is expected to be the first and only mandatory water quality variable after hydrodynamic boundary conditions.</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>bc header == time, water_elev, sal, temp, clay, sand, DO_mgL</p>
</blockquote>
<p>DO_mgL is the header used to designate oxygen in the related boundary condition file, noting that the DO_mgL column in the boundary condition file can appear in any column in the boundary condition file, and that it does not need to be the seventh column. The header text DO_mgL is just an example, and it can be any header desired, as long as it matches the correct column header in the boundary condition file.</p>
<div id="ConOrdDOPath-4" class="section level4 hasAnchor" number="4.6.5.1">
<h4><span class="header-section-number">4.6.5.1</span> Pathogens (optional)<a href="SimulationConstruction-1.html#ConOrdDOPath-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If pathogens are simulated, then their headers are required at the end of any lists, regardless of the other hydrodynamic and water quality constituents simulated. This therefore applies to all simulation classes from DO to organics. Alive and dead pathogens are always required to be specified, in that order, and if attached pathogens are simulated then that attached pathogens header is listed between those of alive and dead. This pattern is repeated for each specified pathogen group, in the order in which pathogen groups are defined via pathogen constituent model blocks in the water quality control file. For example, where two pathogen groups are simulated (called ECOLI and CRYPTO, and defined in that order in the corresponding water quality control file), with ECOLI including attachment, the above bc header would be extended to the following:</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>bc header == time, water_elev, sal, temp, clay, sand, DO_mgL, ECOLI_alive, ECOLI_att, ECOLI_dead, CRYPTO_al, CRYPTO_de</p>
</blockquote>
</div>
</div>
<div id="ExampleDO" class="section level3 hasAnchor" number="4.6.6">
<h3><span class="header-section-number">4.6.6</span> Example<a href="SimulationConstruction-1.html#ExampleDO" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Following is an example of all the available WQ Module <code>simulation class == DO</code> commands. A single material applied as zeros everywhere as the default, other than for materials 1 and 4 where the default flux is overwritten. One (optional) pathogen constituent model block has been included, but is not required.</p>
<pre><code>simulation class == DO
wq dt == 600
wq units == mgl

oxygen model == O2
    oxygen benthic == 4.0, 1.05
    oxygen min max == 0.0, 15.0
end oxygen model

!optional pathogen constituent model block:
pathogen model == basic, crypto 
    alive min max == 0.0, 1e7
    mortality == 0.08, 2e-12, 6.1, 1.0, 1.11 
    visible inactivation == 0.082, 0.0067, 0.5 
    uva inactivation == 0.5, 0.0067, 0.5 
    uvb inactivation == 1.0, 0.0067, 0.5 
    settling == -0.03
end pathogen model

material == default
    oxygen flux == 0
end material

material == 1, 4
    oxygen flux == -137.0
end material</code></pre>

</div>
</div>
<div id="SimSetSimClInorg-2" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Simulation Class: Inorganics<a href="SimulationConstruction-1.html#SimSetSimClInorg-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If the inorganics simulation class is specified with no subsequent constituent model blocks, then a simulation will be automatically constructed using this inorganics class, and populated with library defaults for all parameters. Computed variables will be:</p>
<ul>
<li>Dissolved oxygen</li>
<li>Silicate</li>
<li>Ammonium</li>
<li>Nitrate</li>
<li>Filterable reactive phosphorus</li>
<li>One phytoplankton group named dummy that uses the basic phytoplankton constituent model</li>
</ul>
<div id="PrereqInorg-3" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Prerequisites<a href="SimulationConstruction-1.html#PrereqInorg-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The inorganics simulation class requires simulation of the following in TUFLOW FV:</p>
<ul>
<li>Hydrodynamics, in either two or three dimensions (including any internal one dimensional structures if present)</li>
<li>Salinity</li>
<li>Temperature</li>
<li>Heat module on (i.e.meteorological forcing is required)</li>
</ul>
<p>Simulation of suspended sediment (via TUFLOW FVs sediment transport module) is required only if adsorbed phosphorus is to be simulated by the WQ Module. This is affected through specification of the adsorbed phosphorus constituent model within the phosphorus constituent model class.</p>
</div>
<div id="SimCtrlsInorg-3" class="section level3 hasAnchor" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> Part 1: Simulation specification<a href="SimulationConstruction-1.html#SimCtrlsInorg-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The inorganics simulation class is set via</p>
<blockquote>
<p><a href="AppCommands.html#WQSimulationClass">simulation class ==</a> inorganics</p>
</blockquote>
<p>The other commands in this part are not specific to this simulation class. See section <a href="SimulationConstruction-1.html#SimCtrls-3">4.5.1</a>.</p>
</div>
<div id="ConModSttngsInorg-3" class="section level3 hasAnchor" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> Part 2: Constituent model specification<a href="SimulationConstruction-1.html#ConModSttngsInorg-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As per Tables <a href="Architecture-1.html#tab:tab-ConClasses">2.2</a> and <a href="Architecture-1.html#tab:tab-ConClassMods">2.3</a>, there are several constituent model classes available within the inorganics simulation class. The commands for each are described following.</p>
<div id="ConModClssInorg-4" class="section level4 hasAnchor" number="4.7.3.1">
<h4><span class="header-section-number">4.7.3.1</span> Model class: Oxygen<a href="SimulationConstruction-1.html#ConModClssInorg-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="ConModO2-5a" class="section level5 hasAnchor" number="4.7.3.1.1">
<h5><span class="header-section-number">4.7.3.1.1</span> Constituent model: O2<a href="SimulationConstruction-1.html#ConModO2-5a" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The commands for this constituent model are described in Section <a href="SimulationConstruction-1.html#ConModO2-5">4.6.3.1.1</a>.</p>
</div>
</div>
<div id="ConModClssSil-4" class="section level4 hasAnchor" number="4.7.3.2">
<h4><span class="header-section-number">4.7.3.2</span> Model class: Silicate<a href="SimulationConstruction-1.html#ConModClssSil-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="ConModSi-5" class="section level5 hasAnchor" number="4.7.3.2.1">
<h5><span class="header-section-number">4.7.3.2.1</span> Constituent model: Si<a href="SimulationConstruction-1.html#ConModSi-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This constituent model is specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQSilMod">silicate model ==</a> Si</p>
</blockquote>
<p>Minimum and maximum concentrations are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQSilMinMax"><span class="math inline">\(\blockindent\)</span> silicate min max ==</a> <a href="AppParams.html#WQParMinSil"><span class="math inline">\(\left[Si\right]_{min}^{Si}\)</span></a>, <a href="AppParams.html#WQParMaxSil"><span class="math inline">\(\left[Si\right]_{max}^{Si}\)</span></a></p>
</blockquote>
<p>Global benthic flux parameters (used in Equation <a href="AppSil.html#eq:equ-sed-sil-flux">(E.1)</a>) are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQSilBenFlxPars"><span class="math inline">\(\blockindent\)</span> silicate benthic ==</a> <a href="AppParams.html#WQParKsedSi"><span class="math inline">\(K_{sed-O_2}^{Si}\)</span></a>, <a href="AppParams.html#WQParthetasedSi"><span class="math inline">\(\theta_{sed}^{Si}\)</span></a></p>
</blockquote>
<p>Although not strictly necessary, the use of silicate to prefix the above block commands is deliberate so as to maintain consistency of command style with other constituent model blocks that include more than one computed variable, such as nitrogen, phosphorus and organics.</p>
<p>Silicate sediment flux calculations are set to be dependent on dissolved oxygen concentrations by default. Although not recommended, the following will switch off this dependence by setting the term labelled Influence of oxygen in Equation <a href="AppSil.html#eq:equ-sed-sil-flux">(E.1)</a> to a value of 1.0.</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span> <a href="AppCommands.html#WQSilOxy">oxygen ==</a> off</p>
</blockquote>
<p>This constituent model block must be terminated using the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQSilModEnd">end silicate model</a></p>
</blockquote>
</div>
</div>
<div id="ConModClssNit-4" class="section level4 hasAnchor" number="4.7.3.3">
<h4><span class="header-section-number">4.7.3.3</span> Model class: Inorganic nitrogen<a href="SimulationConstruction-1.html#ConModClssNit-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="ConModAmmNit-5" class="section level5 hasAnchor" number="4.7.3.3.1">
<h5><span class="header-section-number">4.7.3.3.1</span> Constituent model: AmmoniumNitrate<a href="SimulationConstruction-1.html#ConModAmmNit-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This constituent model is specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQInorgNitMod">inorganic nitrogen model ==</a> AmmoniumNitrate</p>
</blockquote>
<p>Minimum and maximum concentrations for both ammonium and nitrate are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQAmmMinMax"><span class="math inline">\(\blockindent\)</span> ammonium min max ==</a> <a href="AppParams.html#WQParMinAmm"><span class="math inline">\(\left[NH_4\right]_{min}^{NH_4}\)</span></a>, <a href="AppParams.html#WQParMaxAmm"><span class="math inline">\(\left[NH_4\right]_{max}^{NH_4}\)</span></a></p>
</blockquote>
<blockquote>
<p><a href="AppCommands.html#WQNitMinMax"><span class="math inline">\(\blockindent\)</span> nitrate min max ==</a> <a href="AppParams.html#WQParMinNit"><span class="math inline">\(\left[NO_3\right]_{min}^{NO_3}\)</span></a>, <a href="AppParams.html#WQParMaxNit"><span class="math inline">\(\left[NO_3\right]_{max}^{NO_3}\)</span></a></p>
</blockquote>
<p>Global benthic flux parameters (used in Equation <a href="AppIN.html#eq:equ-sed-amm-flux">(F.1)</a>) for ammonium and nitrate are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQAmmBenFlxPars"><span class="math inline">\(\blockindent\)</span> ammonium benthic ==</a> <a href="AppParams.html#WQParKsedAmm"><span class="math inline">\(K_{sed-O_2}^{NH_4}\)</span></a>, <a href="AppParams.html#WQParthetasedAmm"><span class="math inline">\(\theta_{sed}^{NH_4}\)</span></a></p>
</blockquote>
<blockquote>
<p><a href="AppCommands.html#WQNitBenFlxPars"><span class="math inline">\(\blockindent\)</span> nitrate benthic ==</a> <a href="AppParams.html#WQParKsedNit"><span class="math inline">\(K_{sed-O_2}^{NO_3}\)</span></a>, <a href="AppParams.html#WQParthetasedNit"><span class="math inline">\(\theta_{sed}^{NO_3}\)</span></a></p>
</blockquote>
<p>Nitrification parameters (used in <a href="AppIN.html#eq:equ-pel-nitrif-rate">(F.3)</a> and therefore <a href="AppIN.html#eq:equ-pel-nitrif-flux">(F.4)</a>) are set in a single command as:</p>
<blockquote>
<p><a href="AppCommands.html#WQNitrifPars"><span class="math inline">\(\blockindent\)</span> nitrification ==</a> <a href="AppParams.html#WQParRnitrif"><span class="math inline">\(R_{nitrif}^{NH_4}\)</span></a>, <a href="AppParams.html#WQParKNitrif"><span class="math inline">\(K_{nitrif-O_2}^{NH_4}\)</span></a>, <a href="AppParams.html#WQParthetaNitrif"><span class="math inline">\(\theta_{nitrif}^{NH_4}\)</span></a></p>
</blockquote>
<p>Denitrification parameters (used in Equation <a href="AppIN.html#eq:equ-pel-denit-rateMM">(F.5)</a> or Equation <a href="AppIN.html#eq:equ-pel-denit-rateExp">(F.6)</a>) are also set in a single command as:</p>
<blockquote>
<p><a href="AppCommands.html#WQDenitrifParsMM"><span class="math inline">\(\blockindent\)</span> denitrification ==</a> Michaelis Menten, <a href="AppParams.html#WQParRdenit"><span class="math inline">\(R_{denit}^{NO_3}\)</span></a>, <a href="AppParams.html#WQParKdenitO2MM"><span class="math inline">\(K_{denit-O_2-MM}^{NO_3}\)</span></a>, <a href="AppParams.html#WQParthetadenit"><span class="math inline">\(\theta_{denit}^{NO_3}\)</span></a></p>
</blockquote>
<p>or</p>
<blockquote>
<p><a href="AppCommands.html#WQDenitrifParsExp"><span class="math inline">\(\blockindent\)</span> denitrification ==</a> exponential, <a href="AppParams.html#WQParRdenit"><span class="math inline">\(R_{denit}^{NO_3}\)</span></a>, <a href="AppParams.html#WQParKdenitO2Exp"><span class="math inline">\(K_{denit-O_2-exp}^{NO_3}\)</span></a>, <a href="AppParams.html#WQParthetadenit"><span class="math inline">\(\theta_{denit}^{NO_3}\)</span></a></p>
</blockquote>
<p>The first argument (either michaelis menten or exponential) activates a different denitrification model (Equation <a href="AppIN.html#eq:equ-pel-denit-rateMM">(F.5)</a> or Equation <a href="AppIN.html#eq:equ-pel-denit-rateExp">(F.6)</a>, respectively).</p>
<p>Anaerobic oxidation of ammonium parameters (used in Equation <a href="AppIN.html#eq:equ-pel-anmmox-flux">(F.10)</a>) are also set in a single command as:</p>
<blockquote>
<p><a href="AppCommands.html#WQAnammoxPars"><span class="math inline">\(\blockindent\)</span> anaerobic oxidation of ammonium ==</a> <a href="AppParams.html#WQParRanmx"><span class="math inline">\(R_{anmx}^{NH_4,NO_3}\)</span></a>, <a href="AppParams.html#WQParKanmxAmm"><span class="math inline">\(K_{anmx-NH_4}^{NH_4,NO_3}\)</span></a>, <a href="AppParams.html#WQParKanmxNit"><span class="math inline">\(K_{anmx-NO_3}^{NH_4,NO_3}\)</span></a></p>
</blockquote>
<p>Dissimilatory reduction of nitrate to ammonium parameters (used in Equation <a href="AppIN.html#eq:equ-pel-drna-rate">(F.11)</a>) are set in a single command as:</p>
<blockquote>
<p><a href="AppCommands.html#WQDRNAPars"><span class="math inline">\(\blockindent\)</span> diss nitrate reduction to ammonium ==</a> <a href="AppParams.html#WQParRdrna"><span class="math inline">\(R_{DRNA}^{NO_3}\)</span></a>, <a href="AppParams.html#WQParKdrna"><span class="math inline">\(K_{DRNA-O_2}^{NO_3}\)</span></a></p>
</blockquote>
<p>Ammonium and nitrate sediment flux, nitrification, denitrification, anammox and DRNA calculations are all set to be dependent on dissolved oxygen concentrations by default. Although not recommended, the following will switch off this dependence for all these processes.</p>
<blockquote>
<p><a href="AppCommands.html#WQAmmOxy"><span class="math inline">\(\blockindent\)</span> oxygen ==</a> off</p>
</blockquote>
<p>This command overrides any previously specified values of <span class="math inline">\(K_{sed-O_2}^{NH_4}\)</span>, <span class="math inline">\(K_{sed-O_2}^{NO_3}\)</span>, <span class="math inline">\(K_{nitrif-O_2}^{NH_4}\)</span>, <span class="math inline">\(K_{denit-O_2-MM}^{NO_3}\)</span> and <span class="math inline">\(K_{denit-O_2-exp}^{NO_3}\)</span>. It should be specified after all other related commands if the influence of oxygen on nitrogen processes is to be switched off. Setting this command to off will completely disable anammox and DRNA calculations.</p>
<p>Atmospheric deposition parameters (used in Equations <a href="AppIN.html#eq:equ-pel-atm-TN-wammsplit">(F.13)</a>, <a href="AppIN.html#eq:equ-pel-atm-TN-wnitsplit">(F.14)</a>, <a href="AppIN.html#eq:equ-pel-atm-TN-dammsplit">(F.17)</a> and <a href="AppIN.html#eq:equ-pel-atm-TN-ditsplit">(F.18)</a>) are set via the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQAtmNPars"><span class="math inline">\(\blockindent\)</span> atmospheric deposition ==</a> <a href="AppParams.html#WQParAtmWetTN"><span class="math inline">\(\left[TN\right]_{rain}\)</span></a>, <a href="AppParams.html#WQParAtmDryTN"><span class="math inline">\(R_{atm-dry}^{TN}\)</span></a>, <a href="AppParams.html#WQParAtmWetNFrac"><span class="math inline">\(f_{TN}^{NO_3}\)</span></a></p>
</blockquote>
<p>The same split of TN into ammonium and nitrate is applied to both <span class="math inline">\(\left[TN\right]_{rain}\)</span> and <span class="math inline">\(R_{atm-dry}^{TN}\)</span>.</p>
<p>This constituent model block must be terminated using the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQNitModEnd">end inorganic nitrogen model</a></p>
</blockquote>
</div>
</div>
<div id="ConModClssPhs-4" class="section level4 hasAnchor" number="4.7.3.4">
<h4><span class="header-section-number">4.7.3.4</span> Model class: Inorganic phosphorus<a href="SimulationConstruction-1.html#ConModClssPhs-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="ConModFRPhs-5" class="section level5 hasAnchor" number="4.7.3.4.1">
<h5><span class="header-section-number">4.7.3.4.1</span> Constituent model: FRPhs<a href="SimulationConstruction-1.html#ConModFRPhs-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This constituent model is specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQInorgFRPMod">inorganic phosphorus model ==</a> FRPhs</p>
</blockquote>
<p>Minimum and maximum concentrations for FRP are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQFRPMinMax"><span class="math inline">\(\blockindent\)</span> FRP min max ==</a> <a href="AppParams.html#WQParMinFRP"><span class="math inline">\(\left[FRP\right]_{min}^{FRP}\)</span></a>, <a href="AppParams.html#WQParMaxFRP"><span class="math inline">\(\left[FRP\right]_{max}^{FRP}\)</span></a></p>
</blockquote>
<p>Global benthic flux parameters (used in Equation <a href="AppIP.html#eq:equ-sed-frp-flux">(G.1)</a>) are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQFRPBenFlxPars"><span class="math inline">\(\blockindent\)</span> FRP benthic ==</a> <a href="AppParams.html#WQParKsedFRP"><span class="math inline">\(K_{sed-O_2}^{FRP}\)</span></a>, <a href="AppParams.html#WQParthetasedFRP"><span class="math inline">\(\theta_{sed}^{FRP}\)</span></a></p>
</blockquote>
<p>FRP sediment flux calculations are set to be dependent on dissolved oxygen concentrations by default. Although not recommended, the following will switch off this dependence by setting the term labelled Influence of oxygen in Equation <a href="AppIP.html#eq:equ-sed-frp-flux">(G.1)</a> to a value of 1.0.</p>
<blockquote>
<p><a href="AppCommands.html#WQFRPOxy"><span class="math inline">\(\blockindent\)</span> oxygen ==</a> off</p>
</blockquote>
<p>Wet atmospheric deposition parameters (used in Equation <a href="AppIP.html#eq:equ-pel-atm-frp-wflux">(G.2)</a>) are set via the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQAtmPPars"><span class="math inline">\(\blockindent\)</span> atmospheric deposition ==</a> <a href="AppParams.html#WQParAtmWetFRP"><span class="math inline">\(\left[FRP\right]_{rain}\)</span></a></p>
</blockquote>
<p>An additional parameter for dry atmospheric deposition is required in the FRPhsads constituent model (see Section <a href="SimulationConstruction-1.html#ConModFRPhsAds-5">4.7.3.4.2</a>).</p>
<p>This constituent model block must be terminated using the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQFRPModEnd">end inorganic phosphorus model</a></p>
</blockquote>
</div>
<div id="ConModFRPhsAds-5" class="section level5 hasAnchor" number="4.7.3.4.2">
<h5><span class="header-section-number">4.7.3.4.2</span> Constituent model: FRPhsads<a href="SimulationConstruction-1.html#ConModFRPhsAds-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This constituent model is specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQInorgFRPMod">inorganic phosphorus model ==</a> FRPhsads</p>
</blockquote>
<p>The TUFLOW FV Sediment Transport (ST) Module must be used to simulate at least one sediment fraction in order to use this WQ Module constituent model.</p>
<p>In addition to the commands described in Section <a href="SimulationConstruction-1.html#ConModFRPhs-5">4.7.3.4.1</a>, the following commands are available in this constituent model.</p>
<p>Minimum and maximum concentrations for adsorbed FRP are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQAdsFRPMinMax"><span class="math inline">\(\blockindent\)</span> FRP ads min max ==</a> <a href="AppParams.html#WQParMinadsFRP"><span class="math inline">\(\left[FRPads\right]_{min}^{FRPads}\)</span></a>, <a href="AppParams.html#WQParMaxadsFRP"><span class="math inline">\(\left[FRPads\right]_{max}^{FRPads}\)</span></a></p>
</blockquote>
<p>Two FRP adsorption models are available, as per Equations <a href="AppIP.html#eq:equ-pel-frpads-ji">(G.6)</a> and <a href="AppIP.html#eq:equ-pel-frpads-chao">(G.7)</a>. These require specification of one (linear) or two (quadratic) parameters, respectively after specification of the model to be used:</p>
<blockquote>
<p><a href="AppCommands.html#WQAdsFRPParsL"><span class="math inline">\(\blockindent\)</span> adsorption ==</a> linear, <a href="AppParams.html#WQParLinSorpL"><span class="math inline">\(K_{ads-L}^{FRP}\)</span></a></p>
</blockquote>
<p>or</p>
<blockquote>
<p><a href="AppCommands.html#WQAdsFRPParsQ"><span class="math inline">\(\blockindent\)</span> adsorption ==</a> quadratic, <a href="AppParams.html#WQParQSorpRatio"><span class="math inline">\(K_{ads-Q}^{FRP}\)</span></a>, <a href="AppParams.html#WQParQSorpMax"><span class="math inline">\(Q_{max}^{FRP}\)</span></a></p>
</blockquote>
<p>The settling velocity of adsorbed phosphorus is set as follows. Future releases of the WQ Module will dynamically link this settling velocity to the calculations of the TUFLOW FV ST Module.</p>
<blockquote>
<p><a href="AppCommands.html#AdsFRPParsSettle"><span class="math inline">\(\blockindent\)</span> settling ==</a> <a href="AppParams.html#WQParFRPadsV"><span class="math inline">\(V_{settle}^{FRPads}\)</span></a></p>
</blockquote>
<p>Dry atmospheric deposition of FRP is activated in this simulation model (used in Equation <a href="AppIP.html#eq:equ-pel-atm-frp-dflux">(G.3)</a>) and is specified via the same command as wet deposition, but with one additional argument. This additional argument is ignored if the FRPhsads constituent model has not been set:</p>
<blockquote>
<p><a href="AppCommands.html#WQAtmPPars"><span class="math inline">\(\blockindent\)</span> atmospheric deposition ==</a> <a href="AppParams.html#WQParAtmWetFRP"><span class="math inline">\(\left[FRP\right]_{rain}\)</span></a>, <a href="AppParams.html#WQParAtmDryFRP"><span class="math inline">\(R_{atm-dry}^{FRP}\)</span></a></p>
</blockquote>
<p>This constituent model block must be terminated using the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQFRPModEnd">end inorganic phosphorus model</a></p>
</blockquote>
</div>
</div>
<div id="ConModClssPhy-4" class="section level4 hasAnchor" number="4.7.3.5">
<h4><span class="header-section-number">4.7.3.5</span> Model class: Phytoplankton<a href="SimulationConstruction-1.html#ConModClssPhy-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given the large number of potential commands and options for phytoplankton simulation, horizontal rules have been used to separate subsections below for clarity.</p>
<div id="ConModPhyBas-5" class="section level5 hasAnchor" number="4.7.3.5.1">
<h5><span class="header-section-number">4.7.3.5.1</span> Constituent model: Basic<a href="SimulationConstruction-1.html#ConModPhyBas-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This constituent model is specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyMod">phyto model ==</a> basic, <em>groupname</em></p>
</blockquote>
<p><em>groupname</em> is any user specified phytoplankton group name that:</p>
<ul>
<li>Uses only alphanumeric characters</li>
<li>Has no spaces</li>
<li>Excludes the keywords COM and PHYTO, or any combination of letters already included in a standard computed variable name, such as INT_N_, INT_P or _rho, and</li>
<li>Is not the same as any other group name</li>
</ul>
<p>Minimum and maximum concentrations for a phytoplankton group are specified as follows. No prefix keyword (as was the case for constituents such as ammonium) is required:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyMinMax"><span class="math inline">\(\blockindent\)</span> min max ==</a> <a href="AppParams.html#WQParMinPHY"><span class="math inline">\(\left[PHY\right]_{min}^{PHY}\)</span></a>, <a href="AppParams.html#WQParMaxPHY"><span class="math inline">\(\left[PHY\right]_{max}^{PHY}\)</span></a></p>
</blockquote>
<hr>
<div id="ConModPhyTLim-6" class="section level6 hasAnchor" number="4.7.3.5.1.1">
<h6><span class="header-section-number">4.7.3.5.1.1</span> Temperature limitation<a href="SimulationConstruction-1.html#ConModPhyTLim-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Temperature limitation can be specified by one of the following models:</p>
<ul>
<li>None (no temperature limitation applied)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhyTLnone"><span class="math inline">\(\blockindent\)</span> temperature limitation ==</a> <a href="AppCommands.html#WQPhyTLnone">none</a></p>
</blockquote>
<p>or</p>
<ul>
<li>Standard (used in Equations <a href="PhyLimits-3.html#eq:eq-pel-phy-TLim1">(J.1)</a> through to <a href="PhyLimits-3.html#eq:eq-pel-phy-TLimg">(J.8)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhyTLstd"><span class="math inline">\(\blockindent\)</span> temperature limitation ==</a> <a href="AppCommands.html#WQPhyTLstd">standard</a>, <a href="AppParams.html#WQParTstdPHY"><span class="math inline">\(T_{std}^{phy}\)</span></a>, <a href="AppParams.html#WQParToptPHY"><span class="math inline">\(T_{opt}^{phy}\)</span></a>, <a href="AppParams.html#WQParTmaxPHY"><span class="math inline">\(T_{max}^{phy}\)</span></a></p>
</blockquote>
<hr>
</div>
<div id="ConModPhySLim-6" class="section level6 hasAnchor" number="4.7.3.5.1.2">
<h6><span class="header-section-number">4.7.3.5.1.2</span> Salinity limitation<a href="SimulationConstruction-1.html#ConModPhySLim-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Salinity limitation can be specified by one of the following models. All functions can be applied to either (not both) primary productivity or respiration, except for the estuarine limitation model which can only be applied to primary productivity. Specifically:</p>
<ul>
<li>Specifying respective function limitation values (i.e.<span class="math inline">\(L_{max-fresh}^{phy}\)</span> or <span class="math inline">\(L_{zero-marine}^{phy}\)</span> or <span class="math inline">\(L_{zero-mix}^{phy}\)</span>) to be between zero and one will set a function to apply to primary productivity rates as a reducer</li>
<li>Specifying respective function limitation values (i.e.<span class="math inline">\(L_{max-fresh}^{phy}\)</span> or <span class="math inline">\(L_{zero-marine}^{phy}\)</span> or <span class="math inline">\(L_{zero-mix}^{phy}\)</span>) to be greater than one will set a function to apply to respiration rates as an enhancer</li>
</ul>
<p>The available models are as follows:</p>
<ul>
<li>None (no salinity limitation applied)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhySLnone"><span class="math inline">\(\blockindent\)</span> salinity limitation ==</a> <a href="AppCommands.html#WQPhySLnone">none</a></p>
</blockquote>
<p>or</p>
<ul>
<li>Fresh (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-SalLim1">(J.27)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhySLfresh"><span class="math inline">\(\blockindent\)</span> salinity limitation ==</a> <a href="AppCommands.html#WQPhySLfresh">fresh</a>, <a href="AppParams.html#WQParSoptfreshPHY"><span class="math inline">\(S_{opt-fresh}^{phy}\)</span></a>, <a href="AppParams.html#WQParSmaxfreshPHY"><span class="math inline">\(S_{max-fresh}^{phy}\)</span></a>, <a href="AppParams.html#WQParLmaxfreshPHY"><span class="math inline">\(L_{max-fresh}^{phy}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Marine (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-SalLim2">(J.30)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhySLmarine"><span class="math inline">\(\blockindent\)</span> salinity limitation ==</a> <a href="AppCommands.html#WQPhySLmarine">marine</a>, <a href="AppParams.html#WQParSoptmarinePHY"><span class="math inline">\(S_{opt-marine}^{phy}\)</span></a>, <a href="AppParams.html#WQParLzeromarinePHY"><span class="math inline">\(L_{zero-marine}^{phy}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Mixed (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-SalLim3">(J.33)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhySLmixed"><span class="math inline">\(\blockindent\)</span> salinity limitation ==</a> <a href="AppCommands.html#WQPhySLmixed">mixed</a>, <a href="AppParams.html#WQParSoptmixPHY"><span class="math inline">\(S_{opt-mix}^{phy}\)</span></a>, <a href="AppParams.html#WQParSmaxmixPHY"><span class="math inline">\(S_{max-mix}^{phy}\)</span></a>, <a href="AppParams.html#WQParLzeromixPHY"><span class="math inline">\(L_{zero-mix}^{phy}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Estuarine (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-SalLim4">(J.36)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhySLestuarine"><span class="math inline">\(\blockindent\)</span> salinity limitation ==</a> <a href="AppCommands.html#WQPhySLestuarine">estuarine</a>, <a href="AppParams.html#WQParSoptestPHY"><span class="math inline">\(S_{opt-est}^{phy}\)</span></a>, <a href="AppParams.html#WQParSmaxestPHY"><span class="math inline">\(S_{max-est}^{phy}\)</span></a>, <a href="AppParams.html#WQParPestPHY"><span class="math inline">\(P_{est}^{phy}\)</span></a></p>
</blockquote>
<hr>
</div>
<div id="ConModPhyLghtLim-6" class="section level6 hasAnchor" number="4.7.3.5.1.3">
<h6><span class="header-section-number">4.7.3.5.1.3</span> Light limitation<a href="SimulationConstruction-1.html#ConModPhyLghtLim-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Light limitation can be specified by one of the following models:</p>
<ul>
<li>Basic (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-LightLim0">(J.19)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhyLghtLbasic"><span class="math inline">\(\blockindent\)</span> light limitation ==</a> <a href="AppCommands.html#WQPhyLghtLbasic">basic</a>, <a href="AppParams.html#WQParKephy"><span class="math inline">\(Ke^{phy}\)</span></a>, <a href="AppParams.html#WQParKbasLghtlim"><span class="math inline">\(I_{K-bas}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Monod (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-LightLim1">(J.20)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhyLghtLmonod"><span class="math inline">\(\blockindent\)</span> light limitation ==</a> <a href="AppCommands.html#WQPhyLghtLmonod">monod</a>, <a href="AppParams.html#WQParKephy"><span class="math inline">\(Ke^{phy}\)</span></a>, <a href="AppParams.html#WQParKmonLghtlim"><span class="math inline">\(I_{K-mon}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Steele (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-LightLim2">(J.21)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhyLghtLsteele"><span class="math inline">\(\blockindent\)</span> light limitation ==</a> <a href="AppCommands.html#WQPhyLghtLsteele">steele</a>, <a href="AppParams.html#WQParKephy"><span class="math inline">\(Ke^{phy}\)</span></a>, <a href="AppParams.html#WQParSatsteLghtlim"><span class="math inline">\(I_{S-ste}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Webb (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-LightLim3">(J.22)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhyLghtLwebb"><span class="math inline">\(\blockindent\)</span> light limitation ==</a> <a href="AppCommands.html#WQPhyLghtLwebb">webb</a>, <a href="AppParams.html#WQParKephy"><span class="math inline">\(Ke^{phy}\)</span></a>, <a href="AppParams.html#WQParKwebLghtlim"><span class="math inline">\(I_{K-web}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Jassby (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-LightLim4">(J.23)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhyLghtLjassby"><span class="math inline">\(\blockindent\)</span> light limitation ==</a> <a href="AppCommands.html#WQPhyLghtLjassby">jassby</a>, <a href="AppParams.html#WQParKephy"><span class="math inline">\(Ke^{phy}\)</span></a>, <a href="AppParams.html#WQParKjasLghtlim"><span class="math inline">\(I_{K-jas}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Chalker (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-LightLim5">(J.24)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhyLghtLchalker"><span class="math inline">\(\blockindent\)</span> light limitation ==</a> <a href="AppCommands.html#WQPhyLghtLchalker">chalker</a>, <a href="AppParams.html#WQParKephy"><span class="math inline">\(Ke^{phy}\)</span></a>, <a href="AppParams.html#WQParKchaLghtlim"><span class="math inline">\(I_{K-cha}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Klepper (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-LightLim6">(J.25)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhyLghtLklepper"><span class="math inline">\(\blockindent\)</span> light limitation ==</a> <a href="AppCommands.html#WQPhyLghtLklepper">klepper</a>, <a href="AppParams.html#WQParKephy"><span class="math inline">\(Ke^{phy}\)</span></a>, <a href="AppParams.html#WQParSatkleLghtlim"><span class="math inline">\(I_{S-kle}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Integrated (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-LightLim7">(J.26)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhyLghtLintegrated"><span class="math inline">\(\blockindent\)</span> light limitation ==</a> <a href="AppCommands.html#WQPhyLghtLintegrated">integrated</a>, <a href="AppParams.html#WQParKephy"><span class="math inline">\(Ke^{phy}\)</span></a>, <a href="AppParams.html#WQParSatintLghtlim"><span class="math inline">\(I_{S-int}\)</span></a></p>
</blockquote>
<hr>
</div>
<div id="ConModPhyNLimB-6" class="section level6 hasAnchor" number="4.7.3.5.1.4">
<h6><span class="header-section-number">4.7.3.5.1.4</span> Nitrogen limitation<a href="SimulationConstruction-1.html#ConModPhyNLimB-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Nitrogen limitation parameters (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-NLim1">(J.9)</a>, Section <a href="PhyLimits-3.html#PhyLimisNB-5">J.3.1</a>) are set via the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyNLBas"><span class="math inline">\(\blockindent\)</span> nitrogen limitation ==</a> <a href="AppParams.html#WQParMinNlim"><span class="math inline">\(\left[N\right]_{min}^{phy}\)</span></a>, <a href="AppParams.html#WQParKNlim"><span class="math inline">\(K_{lim-N}^{phy}\)</span></a></p>
</blockquote>
<p>These, together with additional parameters, are the same as those used in specifying the nitrogen limitation behaviour of the advanced phytoplankton model (Section <a href="SimulationConstruction-1.html#ConModPhyNLimA-6">4.7.3.5.2.1</a>).</p>
<hr>
</div>
<div id="ConModPhyPLimB-6" class="section level6 hasAnchor" number="4.7.3.5.1.5">
<h6><span class="header-section-number">4.7.3.5.1.5</span> Phosphorus limitation<a href="SimulationConstruction-1.html#ConModPhyPLimB-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Phosphorus limitation parameters (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-PLim1">(J.13)</a>, Section <a href="PhyLimits-3.html#PhyLimisPB-5">J.4.1</a>) are set via the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyPLBas"><span class="math inline">\(\blockindent\)</span> phosphorus limitation ==</a> <a href="AppParams.html#WQParMinPlim"><span class="math inline">\(\left[P\right]_{min}^{phy}\)</span></a>, <a href="AppParams.html#WQParKPlim"><span class="math inline">\(K_{lim-P}^{phy}\)</span></a></p>
</blockquote>
<p>These, together with additional parameters, are the same as those used in specifying the phosphorus limitation behaviour of the advanced phytoplankton model (Section <a href="SimulationConstruction-1.html#ConModPhyPLimA-6">4.7.3.5.2.2</a>).</p>
<hr>
</div>
<div id="ConModPhySiLimB-6" class="section level6 hasAnchor" number="4.7.3.5.1.6">
<h6><span class="header-section-number">4.7.3.5.1.6</span> Silicate limitation<a href="SimulationConstruction-1.html#ConModPhySiLimB-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Silicate limitation parameters (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-SiLim1">(J.17)</a>, Section <a href="PhyLimits-3.html#PhyLimSi-4">J.5</a>) are set via the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyNSiBas"><span class="math inline">\(\blockindent\)</span> silicate limitation ==</a> <a href="AppParams.html#WQParMinSilim"><span class="math inline">\(\left[Si\right]_{min}^{phy}\)</span></a>, <a href="AppParams.html#WQParKSilim"><span class="math inline">\(K_{lim-Si}^{phy}\)</span></a></p>
</blockquote>
<p>Specification of this limitation triggers the uptake of silicate to be on in the phytoplankton groups block in which the command appears. Omit this command to set silicate uptake to off for a given phytoplankton group.</p>
<hr>
</div>
<div id="ConModPhyUptakeB-6" class="section level6 hasAnchor" number="4.7.3.5.1.7">
<h6><span class="header-section-number">4.7.3.5.1.7</span> Uptake<a href="SimulationConstruction-1.html#ConModPhyUptakeB-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Nutrient uptake parameters for nitrogen, phosphorus and silicate (if relevant) (used in Equations <a href="PhyUptake-3.html#eq:eq-pel-phy-NUp">(K.2)</a>, <a href="PhyUptake-3.html#eq:eq-pel-phy-PUp">(K.7)</a> and <a href="PhyUptake-3.html#eq:eq-pel-phy-SiUp">(K.9)</a> respectively) are set via the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyUptakeBas"><span class="math inline">\(\blockindent\)</span> uptake ==</a> <a href="AppParams.html#WQParConNCRat"><span class="math inline">\(X_{N-C-con}^{phy}\)</span></a>, <a href="AppParams.html#WQParConPCRat"><span class="math inline">\(X_{P-C-con}^{phy}\)</span></a>, <a href="AppParams.html#WQParConSiCRat"><span class="math inline">\(X_{Si-C-con}^{phy}\)</span></a></p>
</blockquote>
<p>If specified, the value of <span class="math inline">\(X_{Si-C-con}^{phy}\)</span> is ignored if silicate uptake has not been triggered via specification of silicate limitation parameters via <a href="AppCommands.html#WQPhyNSiBas">silicate limitation ==</a>.</p>
<hr>
</div>
<div id="ConModPhyPP-6" class="section level6 hasAnchor" number="4.7.3.5.1.8">
<h6><span class="header-section-number">4.7.3.5.1.8</span> Primary productivity<a href="SimulationConstruction-1.html#ConModPhyPP-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Primary productivity (growth) parameters (used in Equation <a href="PhyRates-3.html#eq:eq-pel-phy-pprod">(I.2)</a>) are set via the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyGrowth"><span class="math inline">\(\blockindent\)</span> primary productivity ==</a> <a href="AppParams.html#WQParRPrimProd"><span class="math inline">\(R_{prod}^{phy}\)</span></a>, <a href="AppParams.html#WQParthetagrowthPhy"><span class="math inline">\(\theta_{prod}^{phy}\)</span></a></p>
</blockquote>
<hr>
</div>
<div id="ConModPhyResp-6" class="section level6 hasAnchor" number="4.7.3.5.1.9">
<h6><span class="header-section-number">4.7.3.5.1.9</span> Respiration<a href="SimulationConstruction-1.html#ConModPhyResp-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Respiration parameters are set via the following command. The first two parameters are used directly to compute the respiration rate <span class="math inline">\(R_{resp\langle computed\rangle}^{phy}\)</span> via Equation <a href="PhyRates-3.html#eq:eq-pel-phy-resp">(I.6)</a>. The third and fourth parameters are used to compute excretive and mortality fluxes in Equations <a href="PhyLosses-3.html#eq:eq-pel-phy-Cexcr">(L.1)</a> and <a href="PhyLosses-3.html#eq:eq-pel-phy-Cmort">(L.2)</a>, respectively. Both these equations use the respiration rate computed from the first two parameters <span class="math inline">\(R_{resp}^{phy}\)</span> and <span class="math inline">\(\theta_{resp}^{phy}\)</span>. Although not strictly related to respiration, the final parameter does represent a reduction of biomass and is used to compute exudation loss using Equation <a href="PhyRates-3.html#eq:eq-pel-phy-exud">(I.12)</a>.</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyResp"><span class="math inline">\(\blockindent\)</span> respiration ==</a> <a href="AppParams.html#WQParRRespPhy"><span class="math inline">\(R_{resp}^{phy}\)</span></a>, <a href="AppParams.html#WQParthetarespphy"><span class="math inline">\(\theta_{resp}^{phy}\)</span></a>, <a href="AppParams.html#WQParftrueresp"><span class="math inline">\(f_{true-resp}^{phy}\)</span></a>, <a href="AppParams.html#WQParfdomloss"><span class="math inline">\(f_{excr-loss}^{phy}\)</span></a>, <a href="AppParams.html#WQParfracexud"><span class="math inline">\(f_{exud}^{phy}\)</span></a></p>
</blockquote>
<hr>
</div>
<div id="ConModPhyXcc-6" class="section level6 hasAnchor" number="4.7.3.5.1.10">
<h6><span class="header-section-number">4.7.3.5.1.10</span> Carbon to Chlorophyll <em>a</em> ratio<a href="SimulationConstruction-1.html#ConModPhyXcc-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>The carbon to chlorophyll <em>a</em> ratio (used in converting between simulation units, and reporting total chlorophyll <em>a</em> as a diagnostic variable if the mmol units system is used) is specified via the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyXcc"><span class="math inline">\(\blockindent\)</span> carbon chla ratio ==</a> <a href="AppParams.html#WQParXcc"><span class="math inline">\(X_{cc}^{phy}\)</span></a></p>
</blockquote>
<hr>
</div>
<div id="ConModPhyNFix-6" class="section level6 hasAnchor" number="4.7.3.5.1.11">
<h6><span class="header-section-number">4.7.3.5.1.11</span> Nitrogen fixing<a href="SimulationConstruction-1.html#ConModPhyNFix-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Nitrogen fixing parameters are specified as follows. The first parameter is used in Equation <a href="PhyUptake-3.html#eq:eq-pel-phy-NUp">(K.2)</a> to compute the nitrogen fixation flux, and the second parameter modifies computed primary productivity via Equation <a href="PhyRates-3.html#eq:eq-pel-phy-pprodNfx">(I.3)</a>.</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyNFixRate"><span class="math inline">\(\blockindent\)</span> nitrogen fixing ==</a> <a href="AppParams.html#WQParRNFix"><span class="math inline">\(R_{nfix}^{N_2}\)</span></a>, <a href="AppParams.html#WQParkNFix"><span class="math inline">\(f_{nfix}^{phy}\)</span></a></p>
</blockquote>
<p>Setting this command triggers nitrogen fixing to be on, otherwise it is off by default.</p>
<hr>
</div>
<div id="ConModPhySettleB-6" class="section level6 hasAnchor" number="4.7.3.5.1.12">
<h6><span class="header-section-number">4.7.3.5.1.12</span> Settling<a href="SimulationConstruction-1.html#ConModPhySettleB-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Settling can be specified by one of the following models:</p>
<ul>
<li>None</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhySettNone"><span class="math inline">\(\blockindent\)</span> settling ==</a> <a href="AppCommands.html#WQPhySettNone">none</a></p>
</blockquote>
<p>or</p>
<ul>
<li>Constant</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhySettConst"><span class="math inline">\(\blockindent\)</span> settling ==</a> <a href="AppCommands.html#WQPhySettConst">constant</a>, <a href="AppParams.html#WQParConV"><span class="math inline">\(V_{settle}^{phy}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Constant with density correction (as per Equation <a href="PhyRates-3.html#eq:eq-pel-phy-settdens">(I.18)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhySettRho"><span class="math inline">\(\blockindent\)</span> settling ==</a> <a href="AppCommands.html#WQPhySettRho">thermal</a>, <a href="#WQParThermV"><span class="math inline">\(V_{settle}^{phy}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Stokes (used in Equation <a href="PhyRates-3.html#eq:eq-pel-phy-settstokes">(I.19)</a>), where density is required to be simulated as a computed variable, and thus requires the specification of <span class="math inline">\(I_K\)</span>.</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhySettStokes"><span class="math inline">\(\blockindent\)</span> settling ==</a> <a href="AppCommands.html#WQPhySettStokes">stokes</a>, <a href="AppParams.html#WQParKstoSett"><span class="math inline">\(I_{K-sto}\)</span></a></p>
</blockquote>
<p>If <span class="math inline">\(I_K\)</span> is specified in any light limitation model applied to a phytoplankton group with stokes settling, then a value of <span class="math inline">\(I_{K-sto}\)</span> specified in the stokes model will be ignored. Cell density limits are applied as the defaults and are not user specifiable.</p>
<hr>
</div>
<div id="ConModPhyTerm-6" class="section level6 hasAnchor" number="4.7.3.5.1.13">
<h6><span class="header-section-number">4.7.3.5.1.13</span> Termination<a href="SimulationConstruction-1.html#ConModPhyTerm-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>This constituent model block must be terminated using the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyModEnd">end phyto model</a></p>
</blockquote>
</div>
</div>
<div id="ConModPhyAdv-5" class="section level5 hasAnchor" number="4.7.3.5.2">
<h5><span class="header-section-number">4.7.3.5.2</span> Constituent model: Advanced<a href="SimulationConstruction-1.html#ConModPhyAdv-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This constituent model is specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyMod">phyto model ==</a> advanced, <em>groupname</em></p>
</blockquote>
<p><em>groupname</em> is any user specified phytoplankton group name that:</p>
<ul>
<li>Uses only alphanumeric characters</li>
<li>Has no spaces</li>
<li>Excludes the keywords COM and PHYTO, or any combination of letters already included in a standard computed variable name, such as INT_N_, INT_P or _rho, and</li>
<li>Is not the same as any other group name</li>
</ul>
<hr>
<p>The following commands are the same as those described for the basic phytoplankton model in Section <a href="SimulationConstruction-1.html#ConModPhyBas-5">4.7.3.5.1</a> (links are to relevant sections above rather than to the command Appendix, for ease of cross reference):</p>
<blockquote>
<p><a href="SimulationConstruction-1.html#ConModPhyBas-5"><span class="math inline">\(\blockindent\)</span> min max ==</a></p>
</blockquote>
<blockquote>
<p><a href="SimulationConstruction-1.html#ConModPhyTLim-6"><span class="math inline">\(\blockindent\)</span> temperature limitation ==</a></p>
</blockquote>
<blockquote>
<p><a href="SimulationConstruction-1.html#ConModPhyLghtLim-6"><span class="math inline">\(\blockindent\)</span> light limitation ==</a></p>
</blockquote>
<blockquote>
<p><a href="#ConModPhySiLim-6"><span class="math inline">\(\blockindent\)</span> silicate limitation ==</a></p>
</blockquote>
<blockquote>
<p><a href="SimulationConstruction-1.html#ConModPhyPP-6"><span class="math inline">\(\blockindent\)</span> primary productivity ==</a></p>
</blockquote>
<blockquote>
<p><a href="SimulationConstruction-1.html#ConModPhyResp-6"><span class="math inline">\(\blockindent\)</span> respiration ==</a></p>
</blockquote>
<blockquote>
<p><a href="SimulationConstruction-1.html#ConModPhyXcc-6"><span class="math inline">\(\blockindent\)</span> carbon chla ratio ==</a></p>
</blockquote>
<blockquote>
<p><a href="SimulationConstruction-1.html#ConModPhyNFix-6"><span class="math inline">\(\blockindent\)</span> nitrogen fixing ==</a></p>
</blockquote>
<blockquote>
<p><a href="SimulationConstruction-1.html#ConModPhySettleB-6"><span class="math inline">\(\blockindent\)</span> settling ==</a></p>
</blockquote>
<blockquote>
<p><a href="SimulationConstruction-1.html#ConModPhyTerm-6">end phyto model</a></p>
</blockquote>
<p>The following commands differ for the advanced phytoplankton model compared to the basic model.</p>
<hr>
<div id="ConModPhyNLimA-6" class="section level6 hasAnchor" number="4.7.3.5.2.1">
<h6><span class="header-section-number">4.7.3.5.2.1</span> Nitrogen limitation<a href="SimulationConstruction-1.html#ConModPhyNLimA-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Nitrogen limitation parameters (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-NLimA1">(J.11)</a>, Section <a href="PhyLimits-3.html#PhyLimisNA-5">J.3.2</a>) are set via the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyNLAdv"><span class="math inline">\(\blockindent\)</span> nitrogen limitation ==</a> <a href="AppParams.html#WQParMinNlim"><span class="math inline">\(\left[N\right]_{min}^{phy}\)</span></a>, <a href="AppParams.html#WQParKNlim"><span class="math inline">\(K_{N}^{phy}\)</span></a>, <a href="AppParams.html#WQParMinNClim"><span class="math inline">\(X_{N-C-min}^{phy}\)</span></a>, <a href="AppParams.html#WQParMaxNClim"><span class="math inline">\(X_{N-C-max}^{phy}\)</span></a></p>
</blockquote>
<p>The first two parameters are the same as those that would be specified using the same command in the basic phytoplankton model (Section <a href="SimulationConstruction-1.html#ConModPhyNLimB-6">4.7.3.5.1.4</a>).</p>
<hr>
</div>
<div id="ConModPhyPLimA-6" class="section level6 hasAnchor" number="4.7.3.5.2.2">
<h6><span class="header-section-number">4.7.3.5.2.2</span> Phosphorus limitation<a href="SimulationConstruction-1.html#ConModPhyPLimA-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Phosphorus limitation parameters (used in Equation <a href="PhyLimits-3.html#eq:eq-pel-phy-PLimA1">(J.15)</a>, Section <a href="PhyLimits-3.html#PhyLimisPA-5">J.4.2</a>) are set via the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyPLAdv"><span class="math inline">\(\blockindent\)</span> phosphorus limitation ==</a> <a href="AppParams.html#WQParMinPlim"><span class="math inline">\(\left[P\right]_{min}^{phy}\)</span></a>, <a href="AppParams.html#WQParKPlim"><span class="math inline">\(K_{P}^{phy}\)</span></a>, <a href="AppParams.html#WQParMinPClim"><span class="math inline">\(X_{P-C-min}^{phy}\)</span></a>, <a href="AppParams.html#WQParMaxPClim"><span class="math inline">\(X_{P-C-max}^{phy}\)</span></a></p>
</blockquote>
<p>The first two parameters are the same as those that would be specified using the same command in the basic phytoplankton model (Section <a href="SimulationConstruction-1.html#ConModPhyPLimB-6">4.7.3.5.1.5</a>).</p>
<hr>
</div>
<div id="ConModPhyUptakeA-6" class="section level6 hasAnchor" number="4.7.3.5.2.3">
<h6><span class="header-section-number">4.7.3.5.2.3</span> Uptake<a href="SimulationConstruction-1.html#ConModPhyUptakeA-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Nutrient uptake parameters for nitrogen, phosphorus and silicate (if relevant) (used in Equations <a href="PhyUptake-3.html#eq:eq-pel-phy-NUpA">(K.4)</a>, <a href="PhyUptake-3.html#eq:eq-pel-phy-PUpA">(K.8)</a> and <a href="PhyUptake-3.html#eq:eq-pel-phy-SiUp">(K.9)</a> respectively) are set via the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyUptakeAdv"><span class="math inline">\(\blockindent\)</span> uptake ==</a> <a href="AppParams.html#WQParNuptake"><span class="math inline">\(R_{N-uptake}^{phy}\)</span></a>, <a href="AppParams.html#WQParPuptake"><span class="math inline">\(R_{P-uptake}^{phy}\)</span></a>, <a href="AppParams.html#WQParConSiCRat"><span class="math inline">\(X_{Si-C-con}^{phy}\)</span></a></p>
</blockquote>
<p>The value of <span class="math inline">\(X_{Si-C-con}^{phy}\)</span> is ignored if silicate uptake has not been triggered through specification of a silicate limitation function.</p>
<hr>
</div>
<div id="ConModPhySettleA-6" class="section level6 hasAnchor" number="4.7.3.5.2.4">
<h6><span class="header-section-number">4.7.3.5.2.4</span> Settling<a href="SimulationConstruction-1.html#ConModPhySettleA-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>An additional settling model can be specified in the advanced phytoplankton constituent model as:</p>
<ul>
<li>Motile (Section <a href="PhyRates-3.html#PhySettleMotile-5">I.4.5</a>), where internal nutrient simulation is required to simulate motility</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQPhySettMotile"><span class="math inline">\(\blockindent\)</span> settling ==</a> <a href="AppCommands.html#WQPhySettMotile">motile</a>, <a href="AppParams.html#WQParMotV"><span class="math inline">\(V_{mot}^{phy}\)</span></a>, <a href="AppParams.html#WQParKmotSett"><span class="math inline">\(I_{K-mot}\)</span></a></p>
</blockquote>
<p>If <span class="math inline">\(I_K\)</span> is specified in any light limitation model applied to an advanced constituent model phytoplankton group with motile settling, then a value of <span class="math inline">\(I_{K-mot}\)</span> specified in the motile model will be ignored. Cell density limits are applied as the defaults and are not user specifiable.</p>
<p>This constituent model block must be terminated using the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQPhyModEnd">end phyto model</a></p>
</blockquote>
</div>
</div>
</div>
<div id="ConModClssPth-4a" class="section level4 hasAnchor" number="4.7.3.6">
<h4><span class="header-section-number">4.7.3.6</span> Model class: Pathogens (optional)<a href="SimulationConstruction-1.html#ConModClssPth-4a" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This model class is optional.</p>
<div id="ConModFree-5a" class="section level5 hasAnchor" number="4.7.3.6.1">
<h5><span class="header-section-number">4.7.3.6.1</span> Constituent model: Free<a href="SimulationConstruction-1.html#ConModFree-5a" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The commands for this constituent model are described in Section <a href="SimulationConstruction-1.html#ConModFree-5">4.6.3.2.1</a>.</p>
</div>
<div id="ConModAtt-5a" class="section level5 hasAnchor" number="4.7.3.6.2">
<h5><span class="header-section-number">4.7.3.6.2</span> Constituent model: Attached<a href="SimulationConstruction-1.html#ConModAtt-5a" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The commands for this constituent model are described in Section <a href="SimulationConstruction-1.html#ConModAtt-5">4.6.3.2.2</a>.</p>
</div>
</div>
</div>
<div id="MatSpecsInorg-3" class="section level3 hasAnchor" number="4.7.4">
<h3><span class="header-section-number">4.7.4</span> Part 3: Material specification<a href="SimulationConstruction-1.html#MatSpecsInorg-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Oxygen, silicate, ammonium, nitrate and FRP benthic fluxes are specified within both default and numbered material blocks as:</p>
<blockquote>
<p><a href="AppCommands.html#WQOxyBenFlx"><span class="math inline">\(\blockindent\)</span> oxygen flux ==</a> <a href="AppDiags.html#WQParFsedO2"><span class="math inline">\(F_{sed}^{O_2}\)</span></a> <br> <br>
<a href="AppCommands.html#WQSilBenFlx"><span class="math inline">\(\blockindent\)</span> silicate flux ==</a> <a href="AppDiags.html#WQParFsedSi"><span class="math inline">\(F_{sed}^{sil}\)</span></a> <br> <br>
<a href="AppCommands.html#WQAmmBenFlx"><span class="math inline">\(\blockindent\)</span> ammonium flux ==</a> <a href="AppDiags.html#WQParFsedAmm"><span class="math inline">\(F_{sed}^{NH_4}\)</span></a> <br> <br>
<a href="AppCommands.html#WQNitBenFlx"><span class="math inline">\(\blockindent\)</span> nitrate flux ==</a> <a href="AppDiags.html#WQParFsedNit"><span class="math inline">\(F_{sed}^{NO_3}\)</span></a> <br> <br>
<a href="AppCommands.html#WQFRPBenFlx"><span class="math inline">\(\blockindent\)</span> FRP flux ==</a> <a href="AppDiags.html#WQParFsedFRP"><span class="math inline">\(F_{sed}^{FRP}\)</span></a></p>
</blockquote>
<p>No adsorbed FRP or phytoplankton sediment fluxes are required.</p>
</div>
<div id="ConOrdInorg-3" class="section level3 hasAnchor" number="4.7.5">
<h3><span class="header-section-number">4.7.5</span> Constituent ordering<a href="SimulationConstruction-1.html#ConOrdInorg-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Different constituent model selections result in different ordering requirements for specifying computed variable initial conditions (either globally with an implied order, or setting the ordered map from water quality computed variables to WQ_1, WQ_2 etc) and <code>bc header ==</code> commands. For clarity, these are initially presented below using only phytoplankton placeholders in lists. This is possible because phytoplankton specifications are always appended at the end of initial condition or <code>bc header ==</code> lists. Phytoplankton specifications are then presented as additive to these lists in subsequent sections. This is not meant to imply that phytoplankton simulation is optional in the inorganics simulation class - it is mandatory and has only been described separately here only for clarity of presentation.</p>
<div id="ConOrdExPhy-4" class="section level4 hasAnchor" number="4.7.5.1">
<h4><span class="header-section-number">4.7.5.1</span> Excluding phytoplankton<a href="SimulationConstruction-1.html#ConOrdExPhy-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The only constituent model choice that influences ordering (other than phytoplankton) is the phosphorus model. These two possibilities are described below.</p>
<div id="ConOrdInorgFRPhs-5" class="section level5 hasAnchor" number="4.7.5.1.1">
<h5><span class="header-section-number">4.7.5.1.1</span> Phosphorus model FRPhs<a href="SimulationConstruction-1.html#ConOrdInorgFRPhs-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>If adsorbed FRP is not simulated (i.e.<code>phosphorus model == FRPhs</code>), then in all columnar and list style initial conditions, computed variables are expected in the following order (and map to WQ_1 etc accordingly):</p>
<blockquote>
<p>initial wq concentration == <span class="math inline">\(\left[ DO \right]\)</span>, <span class="math inline">\(\left[ Si \right]\)</span>, <span class="math inline">\(\left[ NH_4 \right]\)</span>, <span class="math inline">\(\left[ NO_3 \right]\)</span>, <span class="math inline">\(\left[ FRP \right]\)</span>, <span class="math inline">\(\ldots\)</span> {phytoplankton placeholder/s}</p>
</blockquote>
<p>Similarly, in a <code>bc header ==</code> command within a bc block, the following order of computed variables is expected after hydrodynamic (HD BCs) boundary conditions:</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>bc header == {HD BCs} <span class="math inline">\(\ldots\)</span> DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL, <span class="math inline">\(\ldots\)</span> {phytoplankton placeholder/s}</p>
</blockquote>
<p>With regard to the above<code>bc header ==</code> command:</p>
<ul>
<li>DO_mgL, Si_mgL, Amm_mgL, Nit_mgL and FRP_mgL are the headers used to designate oxygen, silicate, ammonium, nitrate and FRP in the related boundary condition file, respectively</li>
<li>Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file</li>
<li>The header texts DO_mgL, Si_mgL, Amm_mgL, Nit_mgL and FRP_mgL are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers</li>
</ul>
</div>
<div id="ConOrdInorgFRPhsads-5" class="section level5 hasAnchor" number="4.7.5.1.2">
<h5><span class="header-section-number">4.7.5.1.2</span> Phosphorus model FRPhsads<a href="SimulationConstruction-1.html#ConOrdInorgFRPhsads-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>If adsorbed FRP is simulated (i.e.<code>phosphorus model == FRPhsads</code>), then in all columnar and list style initial conditions, computed variables are expected in the following order (and map to WQ_1 etc accordingly):</p>
<blockquote>
<p>initial wq concentration == <span class="math inline">\(\left[ DO \right]\)</span>, <span class="math inline">\(\left[ Si \right]\)</span>, <span class="math inline">\(\left[ NH_4 \right]\)</span>, <span class="math inline">\(\left[ NO_3 \right]\)</span>, <span class="math inline">\(\left[ FRP \right]\)</span>, <span class="math inline">\(\left[ FRPads \right]\)</span>, <span class="math inline">\(\ldots\)</span> {phytoplankton placeholder/s}</p>
</blockquote>
<p>Similarly, in a <code>bc header ==</code> command within a bc block, the following order of computed variables is expected after hydrodynamic boundary conditions:</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>bc header == {HD BCs} <span class="math inline">\(\ldots\)</span> DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL, FRP_ads_mgL, <span class="math inline">\(\ldots\)</span> {phytoplankton placeholder/s}</p>
</blockquote>
<p>With regard to the above<code>bc header ==</code> command:</p>
<ul>
<li>DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL and FRP_ads_mgL are the headers used to designate oxygen, silicate, ammonium, nitrate, FRP and adsorbed FRP in the related boundary condition file, respectively</li>
<li>Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file</li>
<li>The header texts DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL and FRP_ads_mgLare not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers
#### Including phytoplankton {#ConOrdIncPhy-4}
Phytoplankton initial conditions and <code>bc header ==</code> fields are appended directly to the above computed variable specifications, as denoted by the {phytoplankton placeholder/s} flag above.</li>
</ul>
<p>Each phytoplankton group is specified using a cluster of values (initial conditions) or headers (bc block) and these clusters must appear in the same order as phytoplankton groups are specified in the water quality control file. The content of each phytoplankton cluster is determined both by the phytoplankton constituent model used and the settling model selected. These are described below, using a placeholder for preceding (non-phytoplankton) computed variables for clarity. These are described above and can be interpreted as either of the orderings specified in sections <a href="SimulationConstruction-1.html#ConOrdInorgFRPhs-5">4.7.5.1.1</a> or <a href="SimulationConstruction-1.html#ConOrdInorgFRPhsads-5">4.7.5.1.2</a>.</p>
<p>Two phytoplankton groups are used in all examples.</p>
</div>
<div id="ConOrdPhyBas-5" class="section level5 hasAnchor" number="4.7.5.1.3">
<h5><span class="header-section-number">4.7.5.1.3</span> Basic phytoplankton model<a href="SimulationConstruction-1.html#ConOrdPhyBas-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>If the basic phytoplankton constituent model is used, then in all columnar and list style initial conditions, computed variables are expected in the following order (and map to WQ_XX after the final computed variable number accordingly):</p>
<blockquote>
<p>initial wq concentration == {non-phytoplankton placeholders} <span class="math inline">\(\ldots\)</span> <span class="math inline">\(\underbrace{[PHY_1]}_{\text{Cluster 1}}\)</span>, <span class="math inline">\(\underbrace{[PHY_2]}_{\text{Cluster 2}}\)</span></p>
</blockquote>
<p>In order to match water quality control file groups with initial conditions, it is assumed that the groups clusters of initial conditions are specified above in the same order that <code>phyto model ==</code> blocks are presented in the water quality control file.</p>
<p>Similarly, in a <code>bc header ==</code> command within a bc block, the following order of computed variables is expected after hydrodynamic and non-phytoplankton boundary conditions:</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>bc header == {HD BCs} <span class="math inline">\(\ldots\)</span> {non-phytoplankton placeholders} <span class="math inline">\(\ldots\)</span> <span class="math inline">\(\underbrace{\text{phyto_green}}_{\text{Cluster 1}}\)</span>, <span class="math inline">\(\underbrace{\text{phyto_bluegreen}}_{\text{Cluster 2}}\)</span></p>
</blockquote>
<p>With regard to the above<code>bc header ==</code> command:</p>
<ul>
<li>phyto_green and phyto_bluegreen are the headers used to designate the boundary concentrations of the two phytoplankton groups listed in the water quality control file</li>
<li>In order to match water quality control file groups with these boundary condition clusters, it is assumed that the groups boundary condition header clusters are specified above in the same order that <code>phyto model ==</code> blocks appear in the water quality control file</li>
<li>Although the names listed in the <code>bc header ==</code> command above do not need to match the names listed in the water quality control file phytoplankton blocks, it is recommended that they do have names that are correlated with the phytoplankton group names in the water quality control file, for model integrity</li>
<li>Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file</li>
<li>The header texts phyto_green and phyto_bluegreen are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers</li>
</ul>
<p>If the command <code>settling == stokes</code> is used for a phytoplankton group, then phytoplankton cell density must be simulated as a computed variable that requires initial and boundary conditions. This therefore affects the clustering of phytoplankton initial and boundary conditions. For example, if the first (and not the second) phytoplankton group above used the stokes settling model, then the following initial condition command would be required:</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>initial wq concentration == {HD} <span class="math inline">\(\ldots\)</span> {non-phytoplankton placeholders} <span class="math inline">\(\ldots\)</span> <span class="math inline">\(\underbrace{[PHY_1],\rho_{phy1}}_{\text{Cluster 1}}\)</span>, <span class="math inline">\(\underbrace{[PHY_2]}_{\text{Cluster 2}}\)</span></p>
</blockquote>
<p><span class="math inline">\(\rho_{phy1}\)</span> is the initial density of the first phytoplankton groups cells. A density initial condition is not required for the second phytoplankton species because it does not use stokes settling.</p>
<p>Similarly, in a <code>bc header ==</code> command within a bc block, the following order of computed variables is expected after hydrodynamic and non-phytoplankton boundary conditions:</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>bc header == {HD BCs} <span class="math inline">\(\ldots\)</span> {non-phytoplankton placeholders} <span class="math inline">\(\ldots\)</span> <span class="math inline">\(\underbrace{\text{phyto_green, phyto_green_density}}_{\text{Cluster 1}}\)</span>, <span class="math inline">\(\underbrace{\text{phyto_bluegreen}}_{\text{Cluster 2}}\)</span></p>
</blockquote>
<p>If both phytoplankton groups simulated density then the corresponding initial condition and boundary condition commands would be as follows:</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>initial wq concentration == {HD} <span class="math inline">\(\ldots\)</span> {non-phytoplankton placeholders} <span class="math inline">\(\ldots\)</span> <span class="math inline">\(\underbrace{[PHY_1],\rho_{phy1}}_{\text{Cluster 1}}\)</span>, <span class="math inline">\(\underbrace{[PHY_2],\rho_{phy2} }_{\text{Cluster 2}}\)</span></p>
</blockquote>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>bc header == {HD BCs} <span class="math inline">\(\ldots\)</span> {non-phytoplankton placeholders} <span class="math inline">\(\ldots\)</span> <span class="math inline">\(\underbrace{\text{phyto_green, phyto_green_density}}_{\text{Cluster 1}}\)</span>, <span class="math inline">\(\underbrace{\text{phyto_bluegreen, phyto_bluegreen_density}}_{\text{Cluster 2}}\)</span></p>
</blockquote>
<p><span class="math inline">\(\rho_{phy1}\)</span> and <span class="math inline">\(\rho_{phy1}\)</span> are the initial densities of the first and second phytoplankton groups cells.</p>
<p>The same notes provided above apply to these commands.</p>
</div>
<div id="ConOrdPhyAdv-5" class="section level5 hasAnchor" number="4.7.5.1.4">
<h5><span class="header-section-number">4.7.5.1.4</span> Advanced phytoplankton model<a href="SimulationConstruction-1.html#ConOrdPhyAdv-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>If the advanced phytoplankton constituent model is used, then in all columnar and list style initial conditions, computed variables are expected in the following order (and map to WQ_XX after the final computed variable number accordingly):</p>
<blockquote>
<p>initial wq concentration == {non-phytoplankton placeholders} <span class="math inline">\(\ldots\)</span> <span class="math inline">\(\underbrace{[PHY_1],[IN_1],[IP_1]}_{\text{Cluster 1}}\)</span>, <span class="math inline">\(\underbrace{[PHY_2],[IN_2],[IP_2]}_{\text{Cluster 2}}\)</span></p>
</blockquote>
<p>In order to match water quality control file groups with initial conditions, it is assumed that the groups initial conditions are specified above in the same order that <code>phyto model ==</code> blocks are presented in the water quality control file.</p>
<p>Similarly, in a <code>bc header ==</code> command within a bc block, the following order of computed variables is expected after hydrodynamic and non-phytoplankton boundary conditions:</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>bc header == {HD BCs} <span class="math inline">\(\ldots\)</span> {non-phytoplankton placeholders} <span class="math inline">\(\ldots\)</span> <span class="math inline">\(\underbrace{\text{phyto_gr, gr_intN, gr_intP}}_{\text{Cluster 1}}\)</span>, <span class="math inline">\(\underbrace{\text{phyto_blgr, blgr_intN, blgr_intP}}_{\text{Cluster 2}}\)</span></p>
</blockquote>
<p>With regard to the above<code>bc header ==</code> command:</p>
<ul>
<li>phyto_gr and phyto_blgr are the headers used to designate the boundary concentrations of the two phytoplankton groups listed in the water quality control file</li>
<li>gr_intN and gr_intP are the headers used to designate the boundary concentrations of internal nitrogen and internal phosphorus for the green phytoplankton group, respectively</li>
<li>blgr_intN and blgr_intP are the headers used to designate the boundary concentrations of internal nitrogen and internal phosphorus for the bluegreen group, respectively</li>
<li>In order to match water quality control file groups with these boundary conditions, it is assumed that the groups boundary condition header clusters are specified above in the same order that <code>phyto model ==</code> blocks appear in the water quality control file</li>
<li>Although the names listed in the <code>bc header ==</code> command above do not need to match the names listed in the water quality control file phytoplankton blocks, it is recommended that they do have names that are correlated with the phytoplankton group names in the water quality control file, for model integrity</li>
<li>Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file</li>
<li>The header texts phyto_gr and phyto_blgr are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers</li>
</ul>
<p>If the command <code>settling == stokes</code> is used for a phytoplankton group, then phytoplankton cell density must be simulated as a computed variable that requires initial and boundary conditions. This therefore affects the clustering of phytoplankton initial and boundary conditions. If the first phytoplankton group above used the advanced phytoplankton model with the stokes settling model, and the second group used the basic phytoplankton model without stokes settling, then the following commands would be required:</p>
<blockquote>
<p>initial wq concentration == {non-phytoplankton placeholders} <span class="math inline">\(\ldots\)</span> <span class="math inline">\(\underbrace{[PHY_1],\rho_{phy_1},[IN_1],[IP_1]}_{\text{Cluster 1}}\)</span>, <span class="math inline">\(\underbrace{[PHY_2]}_{\text{Cluster 2}}\)</span></p>
</blockquote>
<p>Similarly, in a <code>bc header ==</code> command within a bc block, the following order of computed variables is expected after hydrodynamic and non-phytoplankton boundary conditions:</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>bc header == {HD BCs} <span class="math inline">\(\ldots\)</span> {non-phytoplankton placeholders} <span class="math inline">\(\ldots\)</span> <span class="math inline">\(\underbrace{\text{phyto_gr, gr_dens, gr_intN, gr_intP}}_{\text{Cluster 1}}\)</span>, <span class="math inline">\(\underbrace{\text{phyto_blgr}}_{\text{Cluster 2}}\)</span></p>
</blockquote>
<p>If both phytoplankton groups simulated density, again with the first and second groups using the advanced and basic models respectively, then the corresponding commands would be as follows:</p>
<blockquote>
<p>initial wq concentration == {non-phytoplankton placeholders} <span class="math inline">\(\ldots\)</span> <span class="math inline">\(\underbrace{[PHY_1],\rho_{phy_1},[IN_1],[IP_1]}_{\text{Cluster 1}}\)</span>, <span class="math inline">\(\underbrace{[PHY_2],\rho_{phy_2}}_{\text{Cluster 2}}\)</span></p>
</blockquote>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>bc header == {HD BCs} <span class="math inline">\(\ldots\)</span> {non-phytoplankton placeholders} <span class="math inline">\(\ldots\)</span> <span class="math inline">\(\underbrace{\text{phyto_gr, gr_dens, gr_intN, gr_intP}}_{\text{Cluster 1}}\)</span>, <span class="math inline">\(\underbrace{\text{phyto_blgr, blgr_dens}}_{\text{Cluster 2}}\)</span></p>
</blockquote>
<p>The same notes provided above apply to these commands.</p>
</div>
</div>
<div id="ConOrdInorgIncPth-4" class="section level4 hasAnchor" number="4.7.5.2">
<h4><span class="header-section-number">4.7.5.2</span> Including pathogens (optional)<a href="SimulationConstruction-1.html#ConOrdInorgIncPth-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The ordering requirements for pathogens are the same as those described in Section <a href="SimulationConstruction-1.html#ConOrdDOPath-4">4.6.5.1</a>. Pathogen headers are always included last (i.e.after phytoplankton in the inorganics simulation class).</p>
</div>
</div>
<div id="ExampleInorg" class="section level3 hasAnchor" number="4.7.6">
<h3><span class="header-section-number">4.7.6</span> Example<a href="SimulationConstruction-1.html#ExampleInorg" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Following is an example of all the available WQ Module <code>simulation class == inorganics</code> commands, with a single material applied as zeros everywhere as the default, and then modified by a further specification for materials 3 and 7. Two phytoplankton groups (one each of the basic and advanced models) are set. Pathogens have been omitted for clarity, but could be added as per Section @(ExampleDO).</p>
<pre><code>simulation class == inorganics
wq dt == 3600
wq units == mgl

oxygen model == O2
    oxygen benthic == 4.0, 1.05
    oxygen min max == 0.0, 25.0
end oxygen model

silicate model == si
    silicate benthic == 4.0, 1.05
    silicate min max == 0.0, 2500.0
    oxygen == on
end silicate model  

inorganic nitrogen model == AmmoniumNitrate
    ammonium benthic == 4.0, 1.05
    nitrate benthic == 4.0, 1.05
    ammonium min max == 0.0, 50.0
    nitrate min max == 0.0, 110.0
    nitrification == 0.1, 4.0, 1.05
    denitrification == exponential, 0.5, 8.0, 1.05
    atmospheric deposition == 10.0, 2.4, 0.15
    oxygen == on
end inorganic nitrogen model
    
inorganic phosphorus model == frphsads
    frp benthic == 4.0, 1.05
    frp min max == 0.0, 50.0
    frpads min max == 0.0, 50.0
    atmospheric deposition == 5.0, 1.4
    adsorption == quadratic, 1.5, 0.5
    settling == 0.000001
    oxygen == on
end inorganic phosphorus model  
    
phyto model == basic, green
    min max == 0.01, 40.0
    temperature limitation == standard, 11.0, 14.0, 30.0
    salinity limitation == none 
    light limitation == monod, 0.3, 70.0
    settling == constant, 0.01
    nitrogen limitation == 0.01, 1.5
    phosphorus limitation == 0.001, 0.03
    silicate limitation == 0.5, 7.0
    uptake == 4.7, 0.6, 8.9
    carbon chla ratio == 32.0
    primary productivity == 2.0, 1.06
    respiration == 0.02, 1.04, 0.1, 0.05, 0.6
end phyto model

phyto model == advanced, bluegreen
    min max == 0.5, 50.0
    temperature limitation == standard, 10.0, 15.0, 25.0
    salinity limitation == estuarine, 22.0, 35.0, 0.0 
    light limitation == monod, 0.5, 51.0
    settling == motile, 0.5
    nitrogen limitation == 0.05, 2.5, 4.0, 5.0
    phosphorus limitation == 0.01, 0.05, 0.64, 0.67
    silicate limitation == 1.0, 5.0
    uptake == 0.05, 0.05, 8.9
    carbon chla ratio == 27.0
    nitrogen fixing == 0.100, 0.100
    primary productivity == 1.0, 1.08
    respiration == 0.01, 1.01, 0.2, 0.0, 0.4
end phyto model

material == default
    oxygen flux == 0.0 
    silicate flux == 0.0 
    ammonium flux == 0.0 
    nitrate flux == 0.0 
    frp flux == 0.0 
end material

material == 3, 7
    oxygen flux == -800.0 
    silicate flux == 122.0 
    ammonium flux == 37.0 
    nitrate flux == 3.7 
    frp flux == 1.4 
end material</code></pre>

</div>
</div>
<div id="SimSetSimClOrg-2" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Simulation Class: Organics<a href="SimulationConstruction-1.html#SimSetSimClOrg-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If the organics simulation class is specified with no subsequent constituent model blocks, then a simulation will be automatically constructed using this organics class, and populated with library defaults for all parameters. Computed variables will be:</p>
<ul>
<li>Dissolved oxygen</li>
<li>Silicate</li>
<li>Ammonium</li>
<li>Nitrate</li>
<li>Filterable reactive phosphorus</li>
<li>Dissolved organic carbon</li>
<li>Particulate organic carbon</li>
<li>Dissolved organic nitrogen</li>
<li>Particulate organic nitrogen</li>
<li>Dissolved organic phosphorus</li>
<li>Particulate organic phosphorus</li>
<li>One phytoplankton group named dummy that uses the basic phytoplankton constituent model</li>
</ul>
<p>For clarity, this section uses acronyms for some computed variable names, and these acronyms are expanded in Appendix <a href="AppConstits.html#AppConstits">P</a>. All references below to organic matter are to labile organic computed variables, unless specifically termed as refractory.</p>
<div id="PrereqOrg-3" class="section level3 hasAnchor" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> Prerequisites<a href="SimulationConstruction-1.html#PrereqOrg-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The organics simulation class requires simulation of the following in TUFLOW FV:</p>
<ul>
<li>Hydrodynamics, in either two or three dimensions (including any internal one dimensional structures if present)</li>
<li>Salinity</li>
<li>Temperature</li>
<li>Heat module on (i.e.meteorological forcing is required)</li>
</ul>
<p>Simulation of suspended sediment (via TUFLOW FVs sediment transport module) is required only if adsorbed phosphorus is to be simulated by the WQ Module.</p>
</div>
<div id="SimCtrlsOrg-3" class="section level3 hasAnchor" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> Part 1: Simulation specification<a href="SimulationConstruction-1.html#SimCtrlsOrg-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The organics simulation class is set via</p>
<blockquote>
<p><a href="AppCommands.html#WQSimulationClass">simulation class ==</a> organics</p>
</blockquote>
<p>The other commands in this part are not specific to this simulation class. See section <a href="SimulationConstruction-1.html#SimCtrls-3">4.5.1</a>.</p>
</div>
<div id="ConModSttngsOrg-3" class="section level3 hasAnchor" number="4.8.3">
<h3><span class="header-section-number">4.8.3</span> Part 2: Constituent model specification<a href="SimulationConstruction-1.html#ConModSttngsOrg-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As per Tables <a href="Architecture-1.html#tab:tab-ConClasses">2.2</a> and <a href="Architecture-1.html#tab:tab-ConClassMods">2.3</a>, there are several constituent model classes available within the organics simulation class. The commands for each are described following. To avoid repetition, cross references to explanations are provided for commands that are included in previous simulation classes and remain the same for this class.</p>
<div id="ConModClssInorg-4a" class="section level4 hasAnchor" number="4.8.3.1">
<h4><span class="header-section-number">4.8.3.1</span> Model class: Oxygen<a href="SimulationConstruction-1.html#ConModClssInorg-4a" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="ConModO2-5b" class="section level5 hasAnchor" number="4.8.3.1.1">
<h5><span class="header-section-number">4.8.3.1.1</span> Constituent model: O2<a href="SimulationConstruction-1.html#ConModO2-5b" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The commands for this constituent model are described in Section <a href="SimulationConstruction-1.html#ConModO2-5a">4.7.3.1.1</a>.</p>
</div>
</div>
<div id="ConModClssSil-4a" class="section level4 hasAnchor" number="4.8.3.2">
<h4><span class="header-section-number">4.8.3.2</span> Model class: Silicate<a href="SimulationConstruction-1.html#ConModClssSil-4a" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="ConModSi-5a" class="section level5 hasAnchor" number="4.8.3.2.1">
<h5><span class="header-section-number">4.8.3.2.1</span> Constituent model: Si<a href="SimulationConstruction-1.html#ConModSi-5a" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The commands for this constituent model are described in Section <a href="SimulationConstruction-1.html#ConModSi-5">4.7.3.2.1</a>.</p>
</div>
</div>
<div id="ConModClssNit-4a" class="section level4 hasAnchor" number="4.8.3.3">
<h4><span class="header-section-number">4.8.3.3</span> Model class: Inorganic nitrogen<a href="SimulationConstruction-1.html#ConModClssNit-4a" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="ConModAmmNit-5a" class="section level5 hasAnchor" number="4.8.3.3.1">
<h5><span class="header-section-number">4.8.3.3.1</span> Constituent model: AmmoniumNitrate<a href="SimulationConstruction-1.html#ConModAmmNit-5a" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The commands for this constituent model are described in Section <a href="SimulationConstruction-1.html#ConModAmmNit-5">4.7.3.3.1</a>.</p>
</div>
</div>
<div id="ConModClssPhs-4a" class="section level4 hasAnchor" number="4.8.3.4">
<h4><span class="header-section-number">4.8.3.4</span> Model class: Inorganic phosphorus<a href="SimulationConstruction-1.html#ConModClssPhs-4a" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="ConModFRPhs-5a" class="section level5 hasAnchor" number="4.8.3.4.1">
<h5><span class="header-section-number">4.8.3.4.1</span> Constituent model: FRPhs<a href="SimulationConstruction-1.html#ConModFRPhs-5a" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The commands for this constituent model are described in Section <a href="SimulationConstruction-1.html#ConModFRPhs-5">4.7.3.4.1</a>.</p>
</div>
<div id="ConModFRPhsAds-5a" class="section level5 hasAnchor" number="4.8.3.4.2">
<h5><span class="header-section-number">4.8.3.4.2</span> Constituent model: FRPhsads<a href="SimulationConstruction-1.html#ConModFRPhsAds-5a" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The commands for this constituent model are described in Section <a href="SimulationConstruction-1.html#ConModFRPhsAds-5">4.7.3.4.2</a>.</p>
</div>
</div>
<div id="ConModClssOrgs-4" class="section level4 hasAnchor" number="4.8.3.5">
<h4><span class="header-section-number">4.8.3.5</span> Model class: Organic matter<a href="SimulationConstruction-1.html#ConModClssOrgs-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="ConModOrgLab-5" class="section level5 hasAnchor" number="4.8.3.5.1">
<h5><span class="header-section-number">4.8.3.5.1</span> Constituent model: Labile<a href="SimulationConstruction-1.html#ConModOrgLab-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This constituent model is specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQOrgMod">organic matter model ==</a> labile</p>
</blockquote>
<p>Minimum and maximum concentrations are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQOCMinMax"><span class="math inline">\(\blockindent\)</span> carbon min max ==</a> <a href="AppParams.html#WQParMinPOC"><span class="math inline">\(\left[POC\right]_{min}^{POC}\)</span></a>, <a href="AppParams.html#WQParMaxPOC"><span class="math inline">\(\left[POC\right]_{max}^{POC}\)</span></a>, <a href="AppParams.html#WQParMinDOC"><span class="math inline">\(\left[DOC\right]_{min}^{DOC}\)</span></a>, <a href="AppParams.html#WQParMaxDOC"><span class="math inline">\(\left[DOC\right]_{max}^{DOC}\)</span></a></p>
</blockquote>
<blockquote>
<p><a href="AppCommands.html#WQONMinMax"><span class="math inline">\(\blockindent\)</span> nitrogen min max ==</a> <a href="AppParams.html#WQParMinPON"><span class="math inline">\(\left[PON\right]_{min}^{PON}\)</span></a>, <a href="AppParams.html#WQParMaxPON"><span class="math inline">\(\left[PON\right]_{max}^{PON}\)</span></a>, <a href="AppParams.html#WQParMinDON"><span class="math inline">\(\left[DON\right]_{min}^{DON}\)</span></a>, <a href="AppParams.html#WQParMaxDON"><span class="math inline">\(\left[DON\right]_{max}^{DON}\)</span></a></p>
</blockquote>
<blockquote>
<p><a href="AppCommands.html#WQOPMinMax"><span class="math inline">\(\blockindent\)</span> phosphorus min max ==</a> <a href="AppParams.html#WQParMinPOP"><span class="math inline">\(\left[POP\right]_{min}^{POP}\)</span></a>, <a href="AppParams.html#WQParMaxPOP"><span class="math inline">\(\left[POP\right]_{max}^{POP}\)</span></a>, <a href="AppParams.html#WQParMinDOP"><span class="math inline">\(\left[DOP\right]_{min}^{DOP}\)</span></a>, <a href="AppParams.html#WQParMaxDOP"><span class="math inline">\(\left[DOP\right]_{max}^{DOP}\)</span></a></p>
</blockquote>
<p>Global benthic flux parameters (used in Equation <a href="AppOrg.html#eq:equ-sed-org-flux">(N.1)</a>) are specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQOrgBenFlxPars"><span class="math inline">\(\blockindent\)</span> organics benthic ==</a> <a href="AppParams.html#WQParKsedDOM"><span class="math inline">\(K_{sed-O_2}^{DOM}\)</span></a>, <a href="AppParams.html#WQParthetasedDOM"><span class="math inline">\(\theta_{sed}^{DOM}\)</span></a></p>
</blockquote>
<p>Although not strictly necessary, the use of organics to prefix the above block command is deliberate so as to maintain consistency of command style with other constituent model blocks that include more than one computed variable, such as nitrogen and phosphorus. The command will also be accepted simply as <code>benthic ==</code>.</p>
<p>Particulate organic hydrolysis parameters (used in <a href="AppOrg.html#eq:equ-pel-hydrolysis-rate">(N.2)</a> and therefore <a href="AppOrg.html#eq:equ-pel-hydrolysis-fluxcons">(N.3)</a>) are set in a single command as:</p>
<blockquote>
<p><a href="AppCommands.html#WQPOMHydPars"><span class="math inline">\(\blockindent\)</span> hydrolysis ==</a> <a href="AppParams.html#WQParRhydPOC"><span class="math inline">\(R_{hyd}^{POC}\)</span></a>, <a href="AppParams.html#WQParRhydPON"><span class="math inline">\(R_{hyd}^{PON}\)</span></a>, <a href="AppParams.html#WQParRhydPOP"><span class="math inline">\(R_{hyd}^{POP}\)</span></a>, <a href="AppParams.html#WQParKhydPOM"><span class="math inline">\(K_{hyd-O_2}^{POM}\)</span></a>, <a href="AppParams.html#WQParthetahydPOM"><span class="math inline">\(\theta_{hyd}^{POM}\)</span></a></p>
</blockquote>
<p>Dissolved organic mineralisation parameters (used in <a href="AppOrg.html#eq:equ-pel-miner-rate">(N.8)</a> and therefore <a href="AppOrg.html#eq:equ-pel-miner-fluxcons">(N.9)</a>) are set in a single command, together with the corresponding denitrification parameters describing associated consumption of nitrate due to mineralisation (used in Equations <a href="AppOrg.html#eq:equ-pel-miner-dosink">(N.10)</a> and <a href="AppOrg.html#eq:equ-pel-miner-flux-no3sink">(N.14)</a>) as:</p>
<blockquote>
<p><a href="AppCommands.html#WQDOMMinerPars"><span class="math inline">\(\blockindent\)</span> mineralisation ==</a> <a href="AppParams.html#WQParRminerDOM"><span class="math inline">\(R_{miner}^{DOM}\)</span></a>, <a href="AppParams.html#WQParKminerDOM"><span class="math inline">\(K_{miner-O_2}^{DOM}\)</span></a>, <a href="AppParams.html#WQParthetaminerDOM"><span class="math inline">\(\theta_{miner}^{DOM}\)</span></a>, <a href="AppParams.html#WQParfanminer"><span class="math inline">\(f_{an}\)</span></a>, <a href="AppParams.html#WQParKminerNitDOM"><span class="math inline">\(K_{miner-NO_3}^{NO_3}\)</span></a></p>
</blockquote>
<p>If <span class="math inline">\(K_{miner-NO_3}^{NO_3}\)</span> is set to 0.0, then the consumption of nitrate due to mineralisation of organic matter is switched off.</p>
<p>Settling of labile particulate organic matter can be specified by one of the following models:</p>
<ul>
<li>None</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQOrgSettNone"><span class="math inline">\(\blockindent\)</span> settling ==</a> <a href="AppCommands.html#WQOrgSettNone">none</a></p>
</blockquote>
<p>or</p>
<ul>
<li>Constant</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQOrgSettConst"><span class="math inline">\(\blockindent\)</span> settling ==</a> <a href="AppCommands.html#WQOrgSettConst">constant</a>, <a href="AppParams.html#WQParConVLOrg"><span class="math inline">\(V_{settle}^{lorg}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Constant with density correction (as per Equation <a href="AppOrg.html#eq:eq-pel-org-settdens">(N.28)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQOrgSettRho"><span class="math inline">\(\blockindent\)</span> settling ==</a> <a href="AppCommands.html#WQOrgSettRho">thermal</a>, <a href="AppParams.html#WQParConVLOrg"><span class="math inline">\(V_{settle}^{lorg}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Stokes (used in Equation <a href="AppOrg.html#eq:eq-pel-org-settstokes1">(N.29)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQOrgSettStokes"><span class="math inline">\(\blockindent\)</span> settling ==</a> <a href="AppCommands.html#WQOrgSettStokes">stokes</a>, <a href="AppParams.html#WQParDLOrg"><span class="math inline">\(d_{lorg}\)</span></a>, <a href="AppParams.html#WQParRhoLOrg"><span class="math inline">\(\rho_{lorg}\)</span></a></p>
</blockquote>
<p>Self shading due to the presence of labile organics (used in Equation <a href="AppOrg.html#eq:eq-pel-org-selfshad">(N.26)</a>) parameters are set as:</p>
<blockquote>
<p><a href="AppCommands.html#WQDOMSelShadPars"><span class="math inline">\(\blockindent\)</span> self shading ==</a> <a href="AppParams.html#WQParKePOM"><span class="math inline">\(Ke^{POM}\)</span></a>, <a href="AppParams.html#WQParKeDOM"><span class="math inline">\(Ke^{DOM}\)</span></a></p>
</blockquote>
<p>This constituent model block must be terminated using the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQOrgModEnd">end organic matter model</a></p>
</blockquote>
</div>
<div id="ConModOrgRef-5" class="section level5 hasAnchor" number="4.8.3.5.2">
<h5><span class="header-section-number">4.8.3.5.2</span> Constituent model: Refractory<a href="SimulationConstruction-1.html#ConModOrgRef-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This constituent model encompasses all the functionality (and commands) of the labile organic matter constituent model, but offers further commands to simulate refractory organic processes, and their interaction with labile organic and inorganic computed variables.</p>
<p>This constituent model is specified as:</p>
<blockquote>
<p><a href="AppCommands.html#WQOrgMod">organic matter model ==</a> refractory</p>
</blockquote>
<p>Minimum and maximum concentrations are specified as follows. The carbon command includes the specification of refractory particulate organic matter minimums and maximums, as well as dissolved refractories.</p>
<blockquote>
<p><a href="AppCommands.html#WQROCMinMax"><span class="math inline">\(\blockindent\)</span> ref carbon min max ==</a> <a href="AppParams.html#WQParMinRPOM"><span class="math inline">\(\left[RPOM\right]_{min}^{RPOM}\)</span></a>, <a href="AppParams.html#WQParMaxRPOM"><span class="math inline">\(\left[RPOM\right]_{max}^{RPOM}\)</span></a>, <a href="AppParams.html#WQParMinRDOC"><span class="math inline">\(\left[RDOC\right]_{min}^{RDOC}\)</span></a>, <a href="AppParams.html#WQParMaxRDOC"><span class="math inline">\(\left[RDOC\right]_{max}^{RDOC}\)</span></a></p>
</blockquote>
<blockquote>
<p><a href="AppCommands.html#WQRONMinMax"><span class="math inline">\(\blockindent\)</span> ref nitrogen min max ==</a> <a href="AppParams.html#WQParMinRDON"><span class="math inline">\(\left[RDON\right]_{min}^{RDON}\)</span></a>, <a href="AppParams.html#WQParMaxRDON"><span class="math inline">\(\left[RDON\right]_{max}^{RDON}\)</span></a></p>
</blockquote>
<blockquote>
<p><a href="AppCommands.html#WQROPMinMax"><span class="math inline">\(\blockindent\)</span> ref phosphorus min max ==</a> <a href="AppParams.html#WQParMinRDOP"><span class="math inline">\(\left[RDOP\right]_{min}^{RDOP}\)</span></a>, <a href="AppParams.html#WQParMaxRDOP"><span class="math inline">\(\left[RDOP\right]_{max}^{RDOP}\)</span></a></p>
</blockquote>
<p>The breakdown of refractory particulate organic matter into labile particulate organic matter (used in Equations <a href="AppOrg.html#eq:equ-pel-bdown-rate">(N.5)</a> and <a href="AppOrg.html#eq:equ-pel-bdown-fluxcons">(N.6)</a>) parameters are set as:</p>
<blockquote>
<p><a href="AppCommands.html#WQRPOMbdnPars"><span class="math inline">\(\blockindent\)</span> ref breakdown ==</a> <a href="AppParams.html#WQParRbdnRPOM"><span class="math inline">\(R_{bdn}^{RPOM}\)</span></a>, <a href="AppParams.html#WQParXNRPOM"><span class="math inline">\(X_N^{RPOM}\)</span></a>, <a href="AppParams.html#WQParXPRPOM"><span class="math inline">\(X_P^{RPOM}\)</span></a></p>
</blockquote>
<p>The activation of refractory dissolved organic matter to labile dissolved organic matter (used in Equations <a href="AppOrg.html#eq:equ-pel-active-rate">(N.17)</a> and <a href="AppOrg.html#eq:equ-pel-active-fluxcons">(N.18)</a>) parameter is set as:</p>
<blockquote>
<p><a href="AppCommands.html#WQRDOMactPars"><span class="math inline">\(\blockindent\)</span> ref activation ==</a> <a href="AppParams.html#WQParRactRDOM"><span class="math inline">\(R_{act}^{RDOM}\)</span></a></p>
</blockquote>
<p>The photolysis of refractory organics (used in Equation <a href="AppOrg.html#eq:eq-pel-rorg-selfshad">(N.27)</a>) is not turned on unless the following command is issued. It sets the parameter that proportions the split of photolysed refractory dissolved organics to labile dissolved organics and inorganics:</p>
<blockquote>
<p><a href="AppCommands.html#WQRefphotoPars"><span class="math inline">\(\blockindent\)</span> ref photolysis ==</a> <a href="AppParams.html#WQParfphotoDOM"><span class="math inline">\(f_{photo}^{RDOM}\)</span></a></p>
</blockquote>
<p>Settling of refractory particulate organic matter can be specified by one of the following models:</p>
<ul>
<li>None</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQOrgSettNoneR"><span class="math inline">\(\blockindent\)</span> ref settling ==</a> <a href="AppCommands.html#WQOrgSettNoneR">none</a></p>
</blockquote>
<p>or</p>
<ul>
<li>Constant</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQOrgSettConstR"><span class="math inline">\(\blockindent\)</span> ref settling ==</a> <a href="AppCommands.html#WQOrgSettConstR">constant</a>, <a href="AppParams.html#WQParConVROrg"><span class="math inline">\(V_{settle}^{rorg}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Constant with density correction (as per Equation <a href="AppOrg.html#eq:eq-pel-org-settdens">(N.28)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQOrgSettRhoR"><span class="math inline">\(\blockindent\)</span> ref settling ==</a> <a href="AppCommands.html#WQOrgSettRhoR">thermal</a>, <a href="AppParams.html#WQParConVROrg"><span class="math inline">\(V_{settle}^{rorg}\)</span></a></p>
</blockquote>
<p>or</p>
<ul>
<li>Stokes (used in Equation <a href="AppOrg.html#eq:eq-pel-org-settstokes1">(N.29)</a>)</li>
</ul>
<blockquote>
<p><a href="AppCommands.html#WQOrgSettStokesR"><span class="math inline">\(\blockindent\)</span> ref settling ==</a> <a href="AppCommands.html#WQOrgSettStokesR">stokes</a>, <a href="AppParams.html#WQParDROrg"><span class="math inline">\(d_{rorg}\)</span></a>, <a href="AppParams.html#WQParRhoROrg"><span class="math inline">\(\rho_{rorg}\)</span></a></p>
</blockquote>
<p>The settling model selected for the refractory particulate organic matter model must be the same as that of the labile particulate organic matter. The input parameters to this model may be different.</p>
<p>Self shading due to the presence of refractory organics (used in Equation <a href="AppOrg.html#eq:eq-pel-rorg-selfshad">(N.27)</a>) parameters are set as:</p>
<blockquote>
<p><a href="AppCommands.html#WQDOMRSelShadPars"><span class="math inline">\(\blockindent\)</span> ref self shading ==</a> <a href="AppParams.html#WQParKeRPOM"><span class="math inline">\(Ke^{RPOM}\)</span></a>, <a href="AppParams.html#WQParKeRDOM"><span class="math inline">\(R_{CDOM}^{RDOM}\)</span></a></p>
</blockquote>
<p>This constituent model block must be terminated using the command:</p>
<blockquote>
<p><a href="AppCommands.html#WQOrgModEnd">end organic matter model</a></p>
</blockquote>
</div>
</div>
<div id="ConModClssPhy-4a" class="section level4 hasAnchor" number="4.8.3.6">
<h4><span class="header-section-number">4.8.3.6</span> Model class: Phytoplankton<a href="SimulationConstruction-1.html#ConModClssPhy-4a" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="ConModPhyBas-5a" class="section level5 hasAnchor" number="4.8.3.6.1">
<h5><span class="header-section-number">4.8.3.6.1</span> Constituent model: Basic<a href="SimulationConstruction-1.html#ConModPhyBas-5a" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The commands for this constituent model are described in Section <a href="SimulationConstruction-1.html#ConModPhyBas-5">4.7.3.5.1</a>.</p>
</div>
<div id="ConModPhyAdv-5a" class="section level5 hasAnchor" number="4.8.3.6.2">
<h5><span class="header-section-number">4.8.3.6.2</span> Constituent model: Advanced<a href="SimulationConstruction-1.html#ConModPhyAdv-5a" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The commands for this constituent model are described in Section <a href="SimulationConstruction-1.html#ConModPhyAdv-5">4.7.3.5.2</a>.</p>
</div>
</div>
<div id="ConModClssPth-4b" class="section level4 hasAnchor" number="4.8.3.7">
<h4><span class="header-section-number">4.8.3.7</span> Model class: Pathogens (optional)<a href="SimulationConstruction-1.html#ConModClssPth-4b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This model class is optional.</p>
<div id="ConModFree-5b" class="section level5 hasAnchor" number="4.8.3.7.1">
<h5><span class="header-section-number">4.8.3.7.1</span> Constituent model: Free<a href="SimulationConstruction-1.html#ConModFree-5b" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The commands for this constituent model are described in Section <a href="SimulationConstruction-1.html#ConModFree-5">4.6.3.2.1</a>.</p>
</div>
<div id="ConModAtt-5b" class="section level5 hasAnchor" number="4.8.3.7.2">
<h5><span class="header-section-number">4.8.3.7.2</span> Constituent model: Attached<a href="SimulationConstruction-1.html#ConModAtt-5b" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The commands for this constituent model are described in Section <a href="SimulationConstruction-1.html#ConModAtt-5">4.6.3.2.2</a>.</p>
</div>
</div>
</div>
<div id="MatSpecsOrg-3" class="section level3 hasAnchor" number="4.8.4">
<h3><span class="header-section-number">4.8.4</span> Part 3: Material specification<a href="SimulationConstruction-1.html#MatSpecsOrg-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Oxygen, silicate, ammonium, nitrate FRP, dissolved organic carbon, dissolved organic nitrogen and dissolved organic phosphorus benthic fluxes are specified within both default and numbered material blocks as:</p>
<blockquote>
<p><a href="AppCommands.html#WQOxyBenFlx"><span class="math inline">\(\blockindent\)</span> oxygen flux ==</a> <a href="AppDiags.html#WQParFsedO2"><span class="math inline">\(F_{sed}^{O_2}\)</span></a> <br> <br>
<a href="AppCommands.html#WQSilBenFlx"><span class="math inline">\(\blockindent\)</span> silicate flux ==</a> <a href="AppDiags.html#WQParFsedSi"><span class="math inline">\(F_{sed}^{sil}\)</span></a> <br> <br>
<a href="AppCommands.html#WQAmmBenFlx"><span class="math inline">\(\blockindent\)</span> ammonium flux ==</a> <a href="AppDiags.html#WQParFsedAmm"><span class="math inline">\(F_{sed}^{NH_4}\)</span></a> <br> <br>
<a href="AppCommands.html#WQNitBenFlx"><span class="math inline">\(\blockindent\)</span> nitrate flux ==</a> <a href="AppDiags.html#WQParFsedNit"><span class="math inline">\(F_{sed}^{NO_3}\)</span></a> <br> <br>
<a href="AppCommands.html#WQFRPBenFlx"><span class="math inline">\(\blockindent\)</span> FRP flux ==</a> <a href="AppDiags.html#WQParFsedFRP"><span class="math inline">\(F_{sed}^{FRP}\)</span></a> <br> <br>
<a href="AppCommands.html#WQDOCBenFlx"><span class="math inline">\(\blockindent\)</span> DOC flux ==</a> <a href="AppDiags.html#WQParFsedDOC"><span class="math inline">\(F_{sed}^{DOC}\)</span></a> <br> <br>
<a href="AppCommands.html#WQDONBenFlx"><span class="math inline">\(\blockindent\)</span> DON flux ==</a> <a href="AppDiags.html#WQParFsedDON"><span class="math inline">\(F_{sed}^{DON}\)</span></a> <br> <br>
<a href="AppCommands.html#WQDOPBenFlx"><span class="math inline">\(\blockindent\)</span> DOP flux ==</a> <a href="AppDiags.html#WQParFsedDOP"><span class="math inline">\(F_{sed}^{DOP}\)</span></a></p>
</blockquote>
<p>No adsorbed FRP, phytoplankton or particulate organic fluxes are required.</p>
</div>
<div id="ConOrdOrg-3" class="section level3 hasAnchor" number="4.8.5">
<h3><span class="header-section-number">4.8.5</span> Constituent ordering<a href="SimulationConstruction-1.html#ConOrdOrg-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As for the inorganics simulation class (see Section <a href="SimulationConstruction-1.html#ConOrdInorg-3">4.7.5</a>) different organic matter constituent model selections require different orderings in specifying computed variable initial conditions and <code>bc header ==</code> commands. Notwithstanding this, all the ordering information presented in Section <a href="SimulationConstruction-1.html#ConOrdInorg-3">4.7.5</a> for the inorganics simulation class applies equally to the organics simulation class, other than for insertions related to the simulation of organics (described below). As such, that section should be reviewed with regard to ordering of the following:</p>
<ul>
<li>Dissolved oxygen</li>
<li>Silicate</li>
<li>Inorganic nitrogen</li>
<li>Inorganic phosphorus (including the optional simulation of adsorbed FRP), and</li>
<li>Phytoplankton groups (including the basic and advanced phytoplankton constituent models, with and without simulation of cell density)</li>
</ul>
<p>The additional initial condition and <code>bc header ==</code> fields related to the organics simulation class do not change the order of computed variable fields presented in Section <a href="SimulationConstruction-1.html#ConOrdInorg-3">4.7.5</a> other than to insert organic matter constituent model computed variables immediately after FRP computed variables and immediately prior to required phytoplankton fields. This insertion and ordering is presented following for the labile and refractory organic matter constituent models.</p>
<div id="ConOrdLabOrg-4" class="section level4 hasAnchor" number="4.8.5.1">
<h4><span class="header-section-number">4.8.5.1</span> Labile<a href="SimulationConstruction-1.html#ConOrdLabOrg-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The computed variables required to be specified within the labile organic matter constituent model are, in order:</p>
<ul>
<li>Dissolved organic carbon</li>
<li>Particulate organic carbon</li>
<li>Dissolved organic nitrogen</li>
<li>Particulate organic nitrogen</li>
<li>Dissolved organic phosphorus</li>
<li>Particulate organic phosphorus</li>
</ul>
<p>All columnar and list style initial condition computed variables are therefore expected in the following order (and map to WQ_1 etc accordingly)</p>
<blockquote>
<p>initial wq concentration == <span class="math inline">\(\left[ DO \right]\)</span>, <span class="math inline">\(\left[ Si \right]\)</span>, <span class="math inline">\(\left[ NH_4 \right]\)</span>, <span class="math inline">\(\left[ NO_3 \right]\)</span>, <span class="math inline">\(\left[ FRP \right]\)</span>, (optionally <span class="math inline">\(\left[ FRPads \right]\)</span>), <span class="math inline">\(\left[ DOC \right]\)</span>, <span class="math inline">\(\left[ POC \right]\)</span>, <span class="math inline">\(\left[ DON \right]\)</span>, <span class="math inline">\(\left[ PON \right]\)</span>, <span class="math inline">\(\left[ DOP \right]\)</span>, <span class="math inline">\(\left[ POP \right]\)</span>, <span class="math inline">\(\ldots\)</span> {phytoplankton placeholder/s}</p>
</blockquote>
<p>Similarly, in a <code>bc header ==</code> command within a bc block, the following order of computed variables is expected after hydrodynamic (HD BCs) boundary conditions (and map to WQ_1 etc accordingly):</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>bc header == {HD BCs} <span class="math inline">\(\ldots\)</span> DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL, (optionally FRPads_mgL), DOC_mgL, POC_mgL, DON_mgL, PON_mgL, DOP_mgL, POP_mgL, <span class="math inline">\(\ldots\)</span> {phytoplankton placeholder/s}</p>
</blockquote>
<p>With regard to the above<code>bc header ==</code> command:</p>
<ul>
<li>DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL (optionally FRPads_mgL), DOC_mgL, POC_mgL, DON_mgL, PON_mgL, DOP_mgL and POP_mgL are the headers used to designate oxygen, silicate, ammonium, nitrate, FRP (optionally adsorbed FRP), dissolved organic carbon, particulate organic carbon, dissolved organic nitrogen, particulate organic nitrogen, dissolved organic phosphorus and particulate organic phosphorus in the related boundary condition file, respectively</li>
<li>Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file</li>
<li>The header texts DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL (optionally FRPads_mgL), DOC_mgL, POC_mgL, DON_mgL, PON_mgL, DOP_mgL and POP_mgL are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers</li>
</ul>
</div>
<div id="ConOrdRefOrg-4" class="section level4 hasAnchor" number="4.8.5.2">
<h4><span class="header-section-number">4.8.5.2</span> Refractory<a href="SimulationConstruction-1.html#ConOrdRefOrg-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The computed variables required to be specified within the labile organic matter constituent model are, in order:</p>
<ul>
<li>Dissolved organic carbon</li>
<li>Particulate organic carbon</li>
<li>Dissolved organic nitrogen</li>
<li>Particulate organic nitrogen</li>
<li>Dissolved organic phosphorus</li>
<li>Particulate organic phosphorus</li>
<li>Refractory dissolved organic carbon</li>
<li>Refractory dissolved organic nitrogen</li>
<li>Refractory dissolved organic phosphorus</li>
<li>Refractory particulate organic matter</li>
</ul>
<p>All columnar and list style initial condition computed variables are therefore expected in the following order (and map to WQ_1 etc accordingly)</p>
<blockquote>
<p>initial wq concentration == <span class="math inline">\(\left[ DO \right]\)</span>, <span class="math inline">\(\left[ Si \right]\)</span>, <span class="math inline">\(\left[ NH_4 \right]\)</span>, <span class="math inline">\(\left[ NO_3 \right]\)</span>, <span class="math inline">\(\left[ FRP \right]\)</span>, (optionally <span class="math inline">\(\left[ FRPads \right]\)</span>), <span class="math inline">\(\left[ DOC \right]\)</span>, <span class="math inline">\(\left[ POC \right]\)</span>, <span class="math inline">\(\left[ DON \right]\)</span>, <span class="math inline">\(\left[ PON \right]\)</span>, <span class="math inline">\(\left[ DOP \right]\)</span>, <span class="math inline">\(\left[ POP \right]\)</span>, <span class="math inline">\(\left[ RDOC \right]\)</span>, <span class="math inline">\(\left[ RDON \right]\)</span>, <span class="math inline">\(\left[ RDOP \right]\)</span>, <span class="math inline">\(\left[ RPOM \right]\)</span>, <span class="math inline">\(\ldots\)</span> {phytoplankton placeholder/s}</p>
</blockquote>
<p>Similarly, in a <code>bc header ==</code> command within a bc block, the following order of computed variables is expected after hydrodynamic (HD BCs) boundary conditions (and map to WQ_1 etc accordingly):</p>
<blockquote>
<p><span class="math inline">\(\blockindent\)</span>bc header == {HD BCs} <span class="math inline">\(\ldots\)</span> DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL, (optionally FRPads_mgL), DOC_mgL, POC_mgL, DON_mgL, PON_mgL, DOP_mgL, POP_mgL, RDOC_mgL, RDON_mgL, RDOP_mgL, RPOM_mgL, <span class="math inline">\(\ldots\)</span> {phytoplankton placeholder/s}</p>
</blockquote>
<p>With regard to the above<code>bc header ==</code> command:</p>
<ul>
<li>DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL (optionally FRPads_mgL), DOC_mgL, POC_mgL, DON_mgL, PON_mgL, DOP_mgL, POP_mgL, RDOC_mgL, RDON_mgL, RDOP_mgL and RPOM_mgL are the headers used to designate oxygen, silicate, ammonium, nitrate, FRP (optionally adsorbed FRP), dissolved organic carbon, particulate organic carbon, dissolved organic nitrogen, particulate organic nitrogen, dissolved organic phosphorus, particulate organic phosphorus, refractory dissolved organic carbon, refractory dissolved nitrogen, refractory dissolved phosphorus and refractory particulate organic matter in the related boundary condition file, respectively</li>
<li>Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file</li>
<li>The header texts DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL (optionally FRPads_mgL), DOC_mgL, POC_mgL, DON_mgL, PON_mgL, DOP_mgL, POP_mgL, RDOC_mgL, RDON_mgL, RDOP_mgL and RPOM_mgL are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers.</li>
</ul>
</div>
<div id="ConOrdOrgIncPth-4" class="section level4 hasAnchor" number="4.8.5.3">
<h4><span class="header-section-number">4.8.5.3</span> Including pathogens (optional)<a href="SimulationConstruction-1.html#ConOrdOrgIncPth-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The ordering requirements for pathogens are the same as those described in Section <a href="SimulationConstruction-1.html#ConOrdDOPath-4">4.6.5.1</a>. Pathogen headers are always included last (i.e.after phytoplankton in the organics simulation class).</p>
</div>
</div>
<div id="ExampleOrg" class="section level3 hasAnchor" number="4.8.6">
<h3><span class="header-section-number">4.8.6</span> Example<a href="SimulationConstruction-1.html#ExampleOrg" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Following is an example of all the available WQ Module <code>simulation class == organics</code> commands, with a single material applied as zeros everywhere as the default, and then modified by a further specification for materials 3 and 7. Two phytoplankton groups (one each of the basic and advanced models) are set, and the refractory organic matter constituent model deployed. Pathogens have been omitted for clarity, but could be added as per Section @(ExampleDO).</p>
<pre><code>simulation class == organics
wq dt == 900
wq units == mgl

oxygen model == O2
    oxygen benthic == 4.0, 1.05
    oxygen min max == 0.0, 25.0
end oxygen model

silicate model == si
    silicate benthic == 4.0, 1.05
    silicate min max == 0.0, 2500.0
    oxygen == on
end silicate model  

inorganic nitrogen model == AmmoniumNitrate
    ammonium benthic == 4.0, 1.05
    nitrate benthic == 4.0, 1.05
    ammonium min max == 0.0, 50.0
    nitrate min max == 0.0, 50.0
    nitrification == 0.1, 4.0, 1.05
    denitrification == exponential, 0.5, 8.0, 1.05
    atmospheric deposition == 10.0, 2.4, 0.15
    oxygen == on
end inorganic nitrogen model
    
inorganic phosphorus model == frphsads
    frp benthic == 4.0, 1.05
    frp min max == 0.0, 35.0
    frpads min max == 0.0, 35.0
    atmospheric deposition == 5.0, 1.4
    adsorption == quadratic, 1.5, 0.5
    oxygen == on
end inorganic phosphorus model  
    
phyto model == basic, green
    min max == 0.01, 40.0
    temperature limitation == standard, 11.0, 14.0, 30.0
    salinity limitation == none 
    light limitation == monod, 0.3, 70.0
    settling == constant, 0.01
    nitrogen limitation == 0.01, 1.5
    phosphorus limitation == 0.001, 0.03
    silicate limitation == 0.5, 7.0
    uptake == 4.7, 0.6, 8.9
    carbon chla ratio == 32.0
    primary productivity == 2.0, 1.06
    respiration == 0.02, 1.04, 0.1, 0.05, 0.6
end phyto model

phyto model == advanced, bluegreen
    min max == 0.5, 50.0
    temperature limitation == standard, 10.0, 15.0, 25.0
    salinity limitation == estuarine, 22.0, 35.0, 0.0 
    light limitation == monod, 0.5, 51.0
    settling == motile, 0.5
    nitrogen limitation == 0.05, 2.5, 4.0, 5.0
    phosphorus limitation == 0.01, 0.05, 0.64, 0.67
    silicate limitation == 1.0, 5.0
    uptake == 0.05, 0.05, 8.9
    carbon chla ratio == 27.0
    nitrogen fixing == 0.100, 0.100
    primary productivity == 1.0, 1.08
    respiration == 0.01, 1.01, 0.2, 0.0, 0.4
end phyto model

organic matter model == refractory
  carbon min max == 0.0, 35.0, 0.0, 35.0, 0.0, 50.0
  nitrogen min max == 0.0, 25.0, 0.0, 25.0  
  phosphorus min max == 0.0, 5.0, 0.0, 5.0 
  organics benthic == 4.5, 1.03  
  hydrolysis == 1.2, 0.19, 0.031, 4.2, 1.1  
  mineralisation == 0.053, 4.1, 1.02, 0.6, 1.2  
  self shading == 0.0003, 0.00025  
  ref carbon min max == 0.0, 40.0, 0.0, 35.0 
  ref nitrogen min max == 0.0, 25.0     
  ref phosphorus min max == 0.0, 5.0  
  ref breakdown == 0.002, 0.15, 0.0094  
  ref activation == 0.02  
  ref photolysis == 0.03  
  ref self shading == 0.00031, 0.00022  
end organic matter model

material == default
    oxygen flux == 0.0 
    silicate flux == 0.0 
    ammonium flux == 0.0 
    nitrate flux == 0.0 
    frp flux == 0.0 
    DOC flux == 0.0
    DON flux == 0.0
    DOP flux == 0.0
end material

material == 3, 7
    oxygen flux == -400.0 
    silicate flux == 12.0 
    ammonium flux == 33.0 
    nitrate flux == 3.7 
    frp flux == 1.4 
    DOC flux == 12.0
    DON flux == 1.81
    DOP flux == 0.29
end material</code></pre>
</div>
</div>
<div id="Outputs-3" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> Outputs<a href="SimulationConstruction-1.html#Outputs-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>WQ Module outputs are set via commands specified in the TUFLOW FV control file, as described below. Available outputs include:</p>
<ul>
<li>WQ Module outputs:
<ul>
<li>Computed variables, i.e.time varying concentrations of simulated quantities (e.g.dissolved oxygen). See Appendix <a href="AppConstits.html#AppConstits">P</a></li>
<li>Diagnostic variables, i.e.time varying quantities that describe rates, and similar such processes which modify computed variables (e.g.sediment flux of nitrate). See Appendix <a href="AppDiags.html#AppDiags">Q</a></li>
</ul></li>
<li>TUFLOW FV integrated outputs of WQ Module variables:
<ul>
<li>Fluxes, e.g.the time varying flux of a WQ Module computed variable integrated by TUFLOW FV across a two dimensional vertical curtain, and</li>
<li>Masses, e.g.the time varying integrated mass of a WQ Module computed or diagnostic variable, computed across the entire model domain</li>
</ul></li>
</ul>
<p>Computed and diagnostic variables are output directly by the WQ Module, whilst integrated outputs are computed by TUFLOW FV, using WQ Module computed and diagnostic variables as inputs.</p>
<p>All these types of outputs use the same structures as described in the TUFLOW FV user manual for hydrodynamic and other TUFLOW FV outputs, namely via specification of <code>output ==</code> blocks. The relevant sections of the TUFLOW FV manual should be reviewed to supplement the material presented here. WQ Module and TUFLOW FV outputs are described below.</p>
<div id="WQMOutputs-4" class="section level3 hasAnchor" number="4.9.1">
<h3><span class="header-section-number">4.9.1</span> WQ Module outputs<a href="SimulationConstruction-1.html#WQMOutputs-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All WQ Module output computed and diagnostic variables, together with their output names, are included in Appendices <a href="AppConstits.html#AppConstits">P</a> and <a href="AppDiags.html#AppDiags">Q</a>. The listed output names can be copied and pasted directly from the Appendices to a control file, with the exception of phytoplankton variables, where the user specified group name is included within the variable name, so will need to be inserted by the user.</p>
<p>The most common <code>output ==</code> blocks used by the WQ Module to report the time variation of computed and/or diagnostic variables are:</p>
<ul>
<li>0D points: <code>output == points</code> (these are depth averaged timeseries outputs at an X/Y location)</li>
<li>1D profiles: <code>output == profiles</code></li>
<li>2D maps: <code>output == datv</code></li>
<li>3D fields: <code>output == netcdf</code></li>
</ul>
<p>The simplest manner in which to specify the computed and diagnostic variables to be included in these blocks is to use the wq_all and wq_diag_all flags against the <code>output parameters</code> command. An example of a 3D netcdf output block that reports computed variables (wq_all) and diagnostic variables (wq_diag_all) every hour is:</p>
<pre><code>output == netcdf
   output parameters == wq_all, wq_diag_all
   output interval == 3600.00
end output </code></pre>
<p>WQ Module outputs need not be in distinct output blocks of their own, but can be added to existing TUFLOW output blocks, for example:</p>
<pre><code>output == datv
   output parameters == h, V, wq_all, wq_diag_all
   output interval == 3600.00
   vertical averaging == depth-all
end output </code></pre>
<p>Water quality outputs are often voluminous. In order to avoid potentially cumbersome data handling issues around large output files, the <code>output parameters ==</code> command arguments can be tailored to list only those computed or diagnostic variables required for analysis, rather than using the blanket wq_all and wq_diag_all arguments. An example of such an output command block that only reports dissolved oxygen concentration and atmospheric oxygen exchange is:</p>
<pre><code>output == netcdf
   output parameters == h, WQ_DISS_OXYGEN_MG_L, WQ_DIAG_O2_ATMOS_EXCHANGE_MG_M2_D
   output interval == 3600.00
end output </code></pre>
</div>
<div id="FVOutputs-4" class="section level3 hasAnchor" number="4.9.2">
<h3><span class="header-section-number">4.9.2</span> TUFLOW FV outputs<a href="SimulationConstruction-1.html#FVOutputs-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The most common <code>output ==</code> blocks used to report the time variation of integrated quantities computed by TUFLOW FV are:</p>
<ul>
<li>Mass: <code>output == mass</code></li>
<li>flux: <code>output == flux</code></li>
</ul>
<p>Variable names are not specified, with all available variables being included by default. Examples of such output blocks are:</p>
<pre><code>output == mass
   output interval == 3600.00
end output </code></pre>
<pre><code>output == flux
   output interval == 3600.00
end output </code></pre>
<p>Both these output types produce .csv files with headers that append _MASS and _FLUX to the variable names presented in the Appendices.</p>
</div>
<div id="units" class="section level3 hasAnchor" number="4.9.3">
<h3><span class="header-section-number">4.9.3</span> Units<a href="SimulationConstruction-1.html#units" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All output units are as set by the user (i.e.either the mg/L or mmol/m<span class="math inline">\(^3\)</span> systems).</p>
<p>In binary outputs (i.e.netcdf and datv outputs) quantities are reported simply in the simulated units. The names of variables in these binary files will also denote the units of reporting. For example, dissolved oxygen concentrations reported in a three dimensional netcdf file that was generated by a mg/L water quality simulation will:</p>
<ul>
<li>Be in units of mg/L. A reported value of 6.5 will be 6.5 mg/L</li>
<li>Have the variable name WQ_DISS_OXYGEN_MG_L</li>
</ul>
<p>In text based outputs (i.e.mass, flux and points outputs), units are reported in column headers. For consistency, SI units of kg, m<span class="math inline">\(^3\)</span> and seconds are used to report in the mg/L system. In the mmol system, reporting units are moles, m<span class="math inline">\(^3\)</span> and seconds. In both cases, these units may also deploy engineering notation (e.g.x10^3 or x10^6) so that text field outputs are manageable. In these cases, the reported numbers in the columns have been multiplied by the noted magnitude in each header before being written to file. For example, a unit header of x10^3 kg that subsequently reports a value of 4,000, indicates that the simulated quantity was actually 4 kg - the simulated quantity has been multiplied by 10^3 before being reported. Some specific examples of header notated units, and their simplifications include:</p>
<ul>
<li>mg/L system:
<ul>
<li>x 10^3 kg m^-3 is mg/L</li>
<li>x 10^6 kg Chla m^-3 is <span class="math inline">\(\mu\)</span>g/L</li>
<li>x 10^3 kg is grams</li>
<li>x 10^6 kg is milligrams</li>
<li>x 10^3 kg s^-1 is grams per second</li>
</ul></li>
<li>mmol/m<span class="math inline">\(^3\)</span> system:
<ul>
<li>x 10^3 mol m^-3 is mmol/m<span class="math inline">\(^3\)</span></li>
<li>x 10^3 mol is mmol</li>
<li>x 10^3 mols^-1 is millimoles per second</li>
</ul></li>
</ul>
<p>Another way of thinking about this conversion is that if a unit is reported as x 10^z units, then the reported quantity needs to be divided by 10<span class="math inline">\(^z\)</span> to recover the original quantity in units.</p>
<p>For diagnostic variables, the outputting of points (which are depth averaged), mass and flux files is rarely meaningful and should be avoided. No support for units of these output types is therefore provided. Binary files of these outputs are meaningful (they are used in the mass balance analysis for example) so have the units of each diagnostic denoted in its name (e.g.WQ_DIAG_FRP_ADS_SEDMTN_FLUX_MG_M2_D is in mg/m<span class="math inline">\(^2\)</span>/day).</p>
<p><img src="images/WQFooter.jpg" width="100%" /></p>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="ProcessDescriptions-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="AppSyntax.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": false,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
